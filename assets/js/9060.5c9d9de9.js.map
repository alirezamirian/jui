{"version":3,"file":"assets/js/9060.5c9d9de9.js","mappings":"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","sources":["webpack://website/../example-app/src/resources/loading.gif","webpack://website/../example-app/src/LoadingGif.tsx","webpack://website/../example-app/src/resources/loading_dark.gif","webpack://website/../example-app/src/DefaultSuspense.tsx","webpack://website/../example-app/src/file-utils.tsx","webpack://website/../example-app/src/Editor/useEditorTheme.ts","webpack://website/../example-app/src/Editor/Editor.tsx","webpack://website/../example-app/src/fs/fs.tsx","webpack://website/../example-app/src/fs/createBrowserFsBackend.tsx","webpack://website/../example-app/src/fs/fs.state.ts","webpack://website/../example-app/src/Project/project-utils.ts","webpack://website/../example-app/src/Project/project.state.ts","webpack://website/../example-app/src/Editor/editor.state.ts","webpack://website/../example-app/src/VersionControl/file-status.ts","webpack://website/../example-app/src/VersionControl/file-status.state.ts","webpack://website/../example-app/src/VersionControl/FileStatusColor.tsx","webpack://website/../example-app/src/ProjectView/ProjectView.state.ts","webpack://website/../example-app/src/TreeUtils/StyledTreeNodeWrapper.tsx","webpack://website/../example-app/src/TreeUtils/SelectionAwareSpan.tsx","webpack://website/../example-app/src/TreeUtils/StyledTreeNodeHint.tsx","webpack://website/../example-app/src/ProjectView/ProjectViewPane.tsx","webpack://website/../example-app/src/TreeUtils/tree-utils.ts","webpack://website/../example-app/src/ProjectView/ProjectViewActionButtons.tsx","webpack://website/../example-app/src/Terminal/Terminal.tsx","webpack://website/../example-app/src/VersionControl/Changes/change-lists.state.ts","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/changesGroupings.ts","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ChangesView.state.ts","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ActionButtons/ViewOptionsActionButton.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ActionButtons/GroupByActionButton.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ActionButtons/ChangeListsActionButton.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/StyledRepoColorSquare.tsx","webpack://website/../example-app/src/VersionControl/CurrentBranchName.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/StyledCurrentBranchTag.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ChangeViewTree.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ChangesViewPane.tsx","webpack://website/../example-app/src/Project/toolWindows.tsx","webpack://website/../example-app/src/Project/toolWindows.state.ts","webpack://website/../example-app/src/Editor/FileEditor.tsx","webpack://website/../example-app/src/Project/Project.tsx","webpack://website/../example-app/src/SampleRepoInitializer.tsx","webpack://website/../example-app/src/App.tsx","webpack://website/../example-app/src/index.ts"],"sourcesContent":["export default \"data:image/gif;base64,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\"","import { Img } from \"@intellij-platform/core\";\nimport React, { ComponentProps } from \"react\";\nimport loadingGif from \"./resources/loading.gif\";\nimport loadingDarkGif from \"./resources/loading_dark.gif\";\n\nexport const LoadingGif: React.FC = (\n  props: Omit<ComponentProps<typeof Img>, \"src\" | \"darkSrc\" | \"srcSet\">\n) => <Img {...props} src={loadingGif} darkSrc={loadingDarkGif} />;\n","export default \"data:image/gif;base64,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\"","import React, { SuspenseProps } from \"react\";\nimport styled from \"styled-components\";\nimport { LoadingGif } from \"./LoadingGif\";\n\nconst Loading = styled(LoadingGif)`\n  width: fit-content;\n  margin: auto;\n`;\nexport const DefaultSuspense: React.FC<Partial<SuspenseProps>> = ({\n  fallback = <Loading />,\n  children,\n}) => <React.Suspense fallback={fallback}>{children}</React.Suspense>;\n","import path from \"path\";\n\nexport const FILE_ICON = \"fileTypes/text\";\nexport const DIR_ICON = \"nodes/folder\";\n\nconst extensionIconMap: Record<string, string> = {\n  editorconfig: \"nodes/editorconfig\",\n  js: \"fileTypes/javaScript\",\n  gitignore: \"vcs/ignore_file\",\n  archive: \"fileTypes/archive\",\n  as: \"fileTypes/as\",\n  config: \"fileTypes/config\",\n  css: \"fileTypes/css\",\n  dtd: \"fileTypes/dtd\",\n  hpr: \"fileTypes/hprof\",\n  htaccess: \"fileTypes/htaccess\",\n  html: \"fileTypes/html\",\n  idl: \"fileTypes/idl\",\n  java: \"fileTypes/java\",\n  jfr: \"fileTypes/jfr\",\n  json: \"fileTypes/json\",\n  jsp: \"fileTypes/jsp\",\n  jspx: \"fileTypes/jspx\",\n  manifest: \"fileTypes/manifest\",\n  properties: \"fileTypes/properties\",\n  txt: \"fileTypes/text\",\n  wsdl: \"fileTypes/wsdlFile\",\n  xhtml: \"fileTypes/xhtml\",\n  xml: \"fileTypes/xml\",\n  xsd: \"fileTypes/xsdFile\",\n  yaml: \"fileTypes/yaml\",\n};\n\nexport const getIconForFile = (filepath: string) => {\n  const extension = getExtension(filepath);\n  return extensionIconMap[extension] || FILE_ICON;\n};\n\n/**\n * A little different from path.extname(). For \".gitignore\" path.extname returns \"\" while this returns \"gitignore\".\n */\nconst getExtension = (filepath: string): string =>\n  filepath.split(\".\").pop() || \"\";\n\n/**\n * @example\n * \"/a/b/c.ext\" => [\"/a/b\", \"/a\"]\n */\nexport function getParentPaths(\n  filepath: string,\n  upperLimit: string = path.sep\n): string[] {\n  return getParentPathsRecursive(filepath, upperLimit);\n}\n\nfunction getParentPathsRecursive(\n  filepath: string,\n  upperLimit: string,\n  previousPaths: string[] = []\n): string[] {\n  const dirname = path.dirname(filepath);\n  if (dirname !== upperLimit) {\n    return [dirname].concat(\n      getParentPathsRecursive(dirname, upperLimit, previousPaths)\n    );\n  }\n  return previousPaths;\n}\n","import { EditorProps, useMonaco } from \"@monaco-editor/react\";\nimport { Theme } from \"@intellij-platform/core\";\nimport { editor } from \"monaco-editor\";\nimport { useLayoutEffect, useState } from \"react\";\nimport { useTheme } from \"styled-components\";\n\nimport vsCodeTheme from \"../resources/dracula-color-theme.json\"; // FIXME: don't read a fixed color scheme\n\nconst darculaColorSchemeTokenRules: editor.ITokenThemeRule[] = vsCodeTheme.tokenColors.flatMap(\n  ({ scope, settings }) =>\n    ([] as string[])\n      .concat(scope)\n      .flatMap((scope) => scope.split(\" \"))\n      .map((token) => {\n        const values: editor.ITokenThemeRule = {\n          token,\n        };\n        Object.keys(settings).forEach((key) => {\n          const value = settings[key as keyof typeof settings];\n          if (value) {\n            values[key as keyof typeof settings] = value;\n          }\n        });\n        return values;\n      })\n);\n\nexport const useEditorTheme = () => {\n  const monaco = useMonaco();\n  const theme = useTheme() as Theme;\n  const [themeName, setThemeName] = useState<EditorProps[\"theme\"]>(\n    theme.dark ? \"vs-dark\" : \"light\"\n  );\n  useLayoutEffect(() => {\n    if (monaco) {\n      const name = `jui-theme-${theme.name.replace(\" \", \"\")}`;\n      monaco.editor.defineTheme(name, {\n        base: theme.dark ? \"vs-dark\" : \"vs\",\n        inherit: true,\n        // colors and rules should come from color scheme xml files.\n        // see platform/platform-resources/src/DefaultColorSchemesManager.xml\n        colors: theme.dark\n          ? {\n              // FIXME: read from color scheme files. List of available keys: https://github.com/microsoft/monaco-editor/issues/1631\n              \"editor.background\": \"#2B2B2B\",\n              \"editor.lineHighlightBackground\": \"#323232\",\n              \"editor.lineHighlightBorder\": \"none\",\n              \"editorLineNumber.foreground\": \"#606366\", // LINE_NUMBERS_COLOR\n              \"editorActiveLineNumber.foreground\": \"#a4a3a3\", // LINE_NUMBER_ON_CARET_ROW_COLOR\n              \"editorIndentGuide.background\": \"#373737\", // INDENT_GUIDE\n              \"editorIndentGuide.activeBackground\": \"#505050\", // SELECTED_INDENT_GUIDE\n              \"editorGutter.background\": theme.dark ? \"#313335\" : \"#f0f0f0\",\n            }\n          : {},\n        // token rules for syntax highlighting\n        rules: darculaColorSchemeTokenRules,\n      });\n      setThemeName(name);\n    }\n  }, [monaco, theme]);\n\n  return themeName;\n};\n","import MonacoEditor, { EditorProps } from \"@monaco-editor/react\";\nimport { styled } from \"@intellij-platform/core\";\nimport React from \"react\";\nimport { useEditorTheme } from \"./useEditorTheme\";\n\nexport const StyledEditor = styled(MonacoEditor)`\n  .monaco-editor {\n    .margin-view-overlays .line-numbers {\n      text-align: left;\n      padding-left: 7px;\n    }\n  }\n`;\n/**\n * Monaco Editor styled to look like Intellij Platform's editor.\n * TODO:\n *  - folding controls appearance is different and should be changed\n *  - highlighting pairs of parens, brackets, etc. is different.\n *  - context menu look different.\n *  - selection look different.\n *  - BUG: height is more than necessary. Needs investigation first.\n */\nexport const Editor = (props: Omit<EditorProps, \"theme\">) => {\n  const editorTheme = useEditorTheme();\n  return (\n    <StyledEditor\n      {...props}\n      options={{\n        minimap: { enabled: false },\n        lineHeight: 20,\n        showFoldingControls: \"always\",\n        renderIndentGuides: true,\n        scrollbar: {\n          verticalScrollbarSize: 10,\n          verticalSliderSize: 7,\n        },\n        ...props.options,\n      }}\n      theme={editorTheme as any} // FIXME\n    />\n  );\n};\n","import LightningFS from \"@isomorphic-git/lightning-fs\";\nimport React from \"react\";\nimport {\n  createBrowserFsBackend,\n  CustomizedBrowserFsBackend,\n} from \"./createBrowserFsBackend\";\n\nexport let fs: CustomizedBrowserFsBackend | LightningFS;\n\nlet fsPromise = createFS().then((theFs) => (fs = theFs));\n\nasync function createFS(): Promise<CustomizedBrowserFsBackend | LightningFS> {\n  // We ended up using BrowserFS InMemory, because of low performance of IndexedDB used in LightningFS.\n  // There might be room for investigation and improvement regarding FS backend, but an InMemory backend should be\n  // good enough for now, and we can simply toggle the following lines to switch to locally persisted IndexedDB-based\n  // backend. Note that since LightningFS persists data locally, it's slow only in the clone time\n\n  // return new LightningFS(\"fs\", { wipe: false }); // LightningFS is slow because of IndexedDB :(\n  return createBrowserFsBackend();\n}\n\nconst fsResource = wrapPromise(fsPromise);\n\n/**\n * Suspense aware wrapper for waiting for FS to be initialized. initialization API in some fs backends such as\n * BrowserFs, is async. That's why it's safe to use this on a high level.\n */\nexport const WaitForFs: React.FC = ({ children }) => {\n  fsResource.read();\n  return children as React.ReactElement;\n};\n\n/**\n * wrapPromise util for suspense for arbitrary async operation, represented as a promise.\n */\nfunction wrapPromise<T>(promise: Promise<T>) {\n  let status = \"pending\";\n  let response: T;\n\n  const suspender = promise.then(\n    (res) => {\n      status = \"success\";\n      response = res;\n    },\n    (err) => {\n      status = \"error\";\n      response = err;\n    }\n  );\n  const read = () => {\n    switch (status) {\n      case \"pending\":\n        throw suspender;\n      case \"error\":\n        throw response;\n      default:\n        return response;\n    }\n  };\n\n  return { read };\n}\n","import { FSModule } from \"browserfs/dist/node/core/FS\";\nimport * as BrowserFS from \"browserfs\";\n// @ts-expect-error: who needs types for pify here\nimport pify from \"pify\";\nimport LightningFS from \"@isomorphic-git/lightning-fs\"; // transitive dependency! üò± üòÅ\n\nexport type CustomizedBrowserFsBackend = FSModule & {\n  promises: LightningFS[\"promises\"];\n};\n\n// TODO: We are importing everything from browserFS, which might be too much, considering many backends it supports\n//  we may want to change imports somehow to improve this. Check the bundle first.\nexport async function createBrowserFsBackend() {\n  return new Promise<CustomizedBrowserFsBackend>((resolve) => {\n    BrowserFS.configure({ fs: \"InMemory\", options: {} }, function (err) {\n      if (err) {\n        return console.error(err);\n      }\n      // ugly with many ts errors, but who cares for now :D\n      // @ts-ignore\n      const fs: CustomizedBrowserFsBackend = BrowserFS.BFSRequire(\"fs\");\n      // @ts-ignore\n      fs.promises = {};\n      Object.keys(fs).forEach((key) => {\n        // @ts-ignore\n        if (typeof fs[key] === \"function\") {\n          // @ts-ignore\n          fs.promises[key] = pify(fs[key]);\n        }\n      });\n      resolve(fs);\n    });\n  });\n}\n","import {\n  atomFamily,\n  selectorFamily,\n  useRecoilRefresher_UNSTABLE,\n} from \"recoil\";\nimport { fs } from \"./fs\";\n\nexport interface FsItem {\n  type: \"dir\" | \"file\";\n  path: string;\n  size: number;\n}\n\n/**\n * recoil atoms and selectors for keeping list and content of files in recoil state, for components that need on such\n * state.\n * NOTE: still not clear if we should be using atomFamily or selectorFamily for this. changing the current\n * implementation to atomFamily however is easy and side effect free.\n */\nexport const dirContentState = selectorFamily({\n  key: \"dirContents\",\n  get: (path: string) => async (): Promise<null | FsItem[]> => {\n    console.log(\"reading directory content\", path);\n    let fileNames: string[];\n    try {\n      fileNames = await fs.promises.readdir(path);\n    } catch (e) {\n      return null;\n    }\n    const stats = await Promise.all(\n      fileNames.map((fileName) => {\n        const filePath = `${path}/${fileName}`;\n        return fs.promises.stat(filePath).then((stat) => ({\n          ...stat,\n          type: stat.isDirectory() ? (\"dir\" as const) : (\"file\" as const),\n          filePath,\n        }));\n      })\n    );\n    return stats.map((stat) => ({\n      type: stat.type,\n      path: stat.filePath,\n      size: stat.size,\n    }));\n  },\n});\n\n/**\n * **Note**: Still not quite clear if we should use atom and [synchronize with source of truth (FS)][recoil-atom-effects],\n * or if we should use selector and refresh it when needed. We probably need a proper [VFS][vfs] implementation at\n * some point, which would be capable of tracking modifications, and setting up listeners for it, and then atoms, can\n * hold the states like directory content, with effects which uses the listener API.\n * A few things to consider in that regard:\n * - if modifications to files are not directly synchronized to fs, using isomorphic-git for updating the file status\n *   can be tricky, unless an FS implementation is provided which uses the file content that is not yet synced with\n *   the actual local FS. Maybe something like Intellij's VFS, can be implemented as a BrowserFS backend impl.\n *\n * **Note**: currently, only text file is supported, for simplicity.\n *\n * [recoil-atom-effects]: https://recoiljs.org/docs/guides/atom-effects#write-through-cache-example\n * [vfs]: https://plugins.jetbrains.com/docs/intellij/virtual-file-system.html\n **/\nexport const fileContent = atomFamily<string, string>({\n  key: \"fileContent\",\n  default: (filepath: string) => {\n    if (!filepath) {\n      return \"\";\n    }\n    // @ts-expect-error return type is wrong\n    return fs.promises.readFile(filepath, { encoding: \"utf8\" }) as string;\n  },\n  effects: (filepath) => [\n    ({ onSet }) => {\n      onSet((content) => {\n        // Should a sync API be used here?\n        fs.promises\n          .writeFile(\n            filepath,\n            // @ts-expect-error: string should also be acceptable. Seems like bad typing\n            content,\n            { encoding: \"utf8\" }\n          )\n          .catch((e) => {\n            console.error(\"failed to sync the file back to the fs\", e);\n          });\n      });\n    },\n  ],\n});\n\nexport const useReloadFromDisk = (path: string) => {\n  return useRecoilRefresher_UNSTABLE(dirContentState(path));\n};\n","import { FsItem } from \"../fs/fs.state\";\n\nexport const filterPath = ({ path }: FsItem) =>\n  !path.split(\"/\").includes(\".git\");\n","import { atom, selector, selectorFamily } from \"recoil\";\nimport { dirContentState, FsItem } from \"../fs/fs.state\";\nimport { filterPath } from \"./project-utils\";\n\nexport interface Project {\n  name: string;\n  path: string;\n}\n\nconst sampleRepos = {\n  JUI: {\n    path: \"/workspace/jui\",\n    url: \"https://github.com/alirezamirian/jui.git\",\n  },\n  \"React Spectrum\": {\n    path: \"/workspace/react-spectrum\",\n    url: \"https://github.com/adobe/react-spectrum.git\",\n  },\n  Recoil: {\n    path: \"/workspace/recoil\",\n    url: \"https://github.com/facebookexperimental/Recoil.git\",\n  },\n};\nconst sampleRepoKey: keyof typeof sampleRepos = \"JUI\";\n\n/**\n * temporary hard coded sample repo, until clone UI is implemented.\n */\nexport const sampleRepo = sampleRepos[sampleRepoKey];\n\nexport const currentProjectState = atom<Project>({\n  key: \"project\",\n  default: {\n    name: sampleRepoKey,\n    path: sampleRepo.path,\n  },\n});\n\nexport const projectFilePath = selectorFamily({\n  key: \"projectFilePath\",\n  get: (projectRelativePath: string) => ({ get }) =>\n    `${get(currentProjectState).path}/${projectRelativePath}`,\n});\n\nexport const currentProjectFilesState = selector({\n  key: \"projectFiles\",\n  get: async ({ get }): Promise<FsItem[]> => {\n    const project = get(currentProjectState);\n    const items = get(dirContentState(project.path));\n    const files: FsItem[] = [];\n    const addItem = (item: FsItem) => {\n      if (item.type === \"dir\" && filterPath(item)) {\n        const childItems = get(dirContentState(item.path));\n        if (childItems) {\n          childItems.map(addItem);\n        }\n      } else {\n        files.push(item);\n      }\n    };\n    (items || []).forEach((item) => addItem(item));\n    return files;\n  },\n});\n","import {\n  atom,\n  selector,\n  useRecoilCallback,\n  useRecoilState,\n  useSetRecoilState,\n} from \"recoil\";\nimport { Focusable } from \"../common-types\";\nimport { descend, sortWith } from \"ramda\";\nimport {\n  currentProjectFilesState,\n  projectFilePath,\n} from \"../Project/project.state\";\n\ninterface TextEditorState {\n  cursorPos: { lineNumber: number; column: number };\n}\ntype EditorState = TextEditorState;\n\ninterface EditorTabState {\n  editorState: EditorState;\n  filePath: string;\n}\n\n// in order to showcase tabs behaviour when many tabs are open. Later on, it should be based on persisted project\n// settings.\nconst temporaryTabsDefaultValue = selector({\n  key: \"editor.tabs/Default\",\n  get: ({ get }) =>\n    sortWith(\n      [\n        // first README.md, then ts and js files.\n        descend((file) => file.path === get(projectFilePath(\"README.md\"))),\n        descend((file) => file.path.endsWith(\".ts\")),\n        descend((file) => file.path.endsWith(\".js\")),\n      ],\n      get(currentProjectFilesState).filter((item) => item.type === \"file\")\n    )\n      .slice(0, 12)\n      // map project file to editor state object\n      .map((file) => ({\n        filePath: file.path,\n        editorState: { cursorPos: { lineNumber: 0, column: 0 } },\n      })),\n});\n\n// it should become something under \"project\" state later.\nconst editorTabsState = atom<EditorTabState[]>({\n  key: \"editor.tabs\",\n  default: temporaryTabsDefaultValue,\n});\n\nconst activeEditorTabIndexState = atom<number>({\n  key: \"editor.activeTabIndex\",\n  default: 0,\n});\n\nexport const activeEditorTabState = selector({\n  key: \"editor.activeTab\",\n  get: ({ get }) => get(editorTabsState)[get(activeEditorTabIndexState)],\n});\n\n/**\n * could be a global variable also, since there is no re-rendering need for it. It's kept as an atom, just to avoid\n * global variable and its issues.\n */\nexport const editorRefState = atom<null | Focusable>({\n  key: \"editor.focusHandle\",\n  default: null,\n});\n\nexport interface EditorStateManager {\n  tabs: EditorTabState[];\n  openPath(filePath: string, focus?: boolean): void;\n  closePath(path: string): void;\n  closeTab(index: number): void;\n  select(index: number): void;\n}\n\nexport const useEditorStateManager = (): EditorStateManager => {\n  const [tabsState, setTabsState] = useRecoilState(editorTabsState);\n  const setActiveTabIndex = useSetRecoilState(activeEditorTabIndexState);\n  const focus = useRecoilCallback(\n    ({ snapshot }) => () => {\n      snapshot.getLoadable(editorRefState).valueOrThrow()?.focus();\n    },\n    []\n  );\n\n  const select = (index: number) => {\n    setActiveTabIndex(index);\n  };\n  const closePath = (filePath: string) => {\n    const index = tabsState.findIndex((tab) => tab.filePath === filePath);\n    if (index > -1) {\n      closeTab(index);\n      setActiveTabIndex(Math.max(index - 1, 0));\n    }\n  };\n  const openPath = (filePath: string, shouldFocus = true) => {\n    const index = tabsState.findIndex((tab) => tab.filePath === filePath);\n    if (index > -1) {\n      select(index);\n    } else {\n      const newIndex = tabsState.length;\n      setTabsState((currentState) => [\n        ...currentState,\n        {\n          filePath,\n          editorState: { cursorPos: { lineNumber: 0, column: 0 } }, // no persistence of cursor position for now.\n        },\n      ]);\n      select(newIndex);\n    }\n    if (shouldFocus) {\n      focus();\n    }\n  };\n  const closeTab = (index: number) => {\n    setTabsState((tabsState) =>\n      tabsState.filter((_, tabIndex) => tabIndex !== index)\n    );\n  };\n  return {\n    tabs: tabsState,\n    // This should become an action. Something like \"open project file\", when action system is implemented.\n    openPath,\n    closePath,\n    closeTab,\n    select,\n  };\n};\n","import { status as getStatus } from \"isomorphic-git\";\nimport { StatusRow } from \"isomorphic-git\";\n\n// platform/editor-ui-api/src/com/intellij/openapi/vcs/FileStatus.java\nexport type FileStatus =\n  | \"UNKNOWN\"\n  | \"ADDED\"\n  | \"NOT_CHANGED\"\n  | \"MODIFIED\"\n  | \"DELETED\";\n\n// platform/vcs-api/src/com/intellij/openapi/vcs/VcsDirectoryMapping.java\nexport interface VcsDirectoryMapping {\n  dir: string;\n  vcs: \"git\"; // only supported vcs for now.\n}\n\n// TODO: remove when upgraded TS to >=4.5\ntype Awaited<T> = T extends PromiseLike<infer U> ? U : T;\n\n/**\n * Converts isomorphic-git status string or StatusRow to FileStatus.\n *\n * for status row:\n *   [\"a.txt\", 0, 2, 0], // new, untracked\n *   [\"b.txt\", 0, 2, 2], // added, staged\n *   [\"c.txt\", 0, 2, 3], // added, staged, with unstaged changes\n *   [\"d.txt\", 1, 1, 1], // unmodified\n *   [\"e.txt\", 1, 2, 1], // modified, unstaged\n *   [\"f.txt\", 1, 2, 2], // modified, staged\n *   [\"g.txt\", 1, 2, 3], // modified, staged, with unstaged changes\n *   [\"h.txt\", 1, 0, 1], // deleted, unstaged\n *   [\"i.txt\", 1, 0, 0], // deleted, staged\n *\n * for status:\n *   | status                | description                                                                           |\n * | --------------------- | ------------------------------------------------------------------------------------- |\n * | `\"ignored\"`           | file ignored by a .gitignore rule                                                     |\n * | `\"unmodified\"`        | file unchanged from HEAD commit                                                       |\n * | `\"*modified\"`         | file has modifications, not yet staged                                                |\n * | `\"*deleted\"`          | file has been removed, but the removal is not yet staged                              |\n * | `\"*added\"`            | file is untracked, not yet staged                                                     |\n * | `\"absent\"`            | file not present in HEAD commit, staging area, or working dir                         |\n * | `\"modified\"`          | file has modifications, staged                                                        |\n * | `\"deleted\"`           | file has been removed, staged                                                         |\n * | `\"added\"`             | previously untracked file, staged                                                     |\n * | `\"*unmodified\"`       | working dir and HEAD commit match, but index differs                                  |\n * | `\"*absent\"`           | file not present in working dir or HEAD commit, but present in the index              |\n * | `\"*undeleted\"`        | file was deleted from the index, but is still in the working dir                      |\n * | `\"*undeletemodified\"` | file was deleted from the index, but is present with modifications in the working dir |\n */\nexport function convertGitStatus(\n  status: Awaited<ReturnType<typeof getStatus>> | StatusRow\n): FileStatus {\n  // TODO: complete and refine this logic.\n  if (Array.isArray(status)) {\n    if (status[1] === 1) {\n      return ([\"DELETED\", \"NOT_CHANGED\", \"MODIFIED\"] as const)[status[2]];\n    }\n    if (status[1] === 0) {\n      if (status[3] === 0) {\n        return \"UNKNOWN\";\n      } else {\n        return \"ADDED\";\n      }\n    }\n    return \"UNKNOWN\";\n  }\n  if (status === \"modified\" || status === \"*modified\") {\n    return \"MODIFIED\";\n  }\n  if (status === \"deleted\" || status === \"*deleted\") {\n    return \"DELETED\";\n  }\n  if (status === \"added\") {\n    return \"ADDED\";\n  }\n  if (status === \"unmodified\") {\n    return \"NOT_CHANGED\";\n  }\n  return \"UNKNOWN\";\n}\n","import {\n  atom,\n  atomFamily,\n  CallbackInterface,\n  GetRecoilValue,\n  selector,\n  selectorFamily,\n  useRecoilCallback,\n} from \"recoil\";\nimport { currentProjectState } from \"../Project/project.state\";\nimport { status, statusMatrix } from \"isomorphic-git\";\nimport { fs } from \"../fs/fs\";\nimport {\n  convertGitStatus,\n  FileStatus,\n  VcsDirectoryMapping,\n} from \"./file-status\";\nimport { useEffect } from \"react\";\nimport * as path from \"path\";\n\nconst temporaryVcsMappingsDefault = ({\n  get,\n}: {\n  get: GetRecoilValue;\n}): VcsDirectoryMapping[] => [\n  {\n    dir: get(currentProjectState).path,\n    vcs: \"git\",\n  },\n];\n\n// This should be refactored to have the configuration file(s) as the source of truth.\nexport const vcsRootsState = atom<VcsDirectoryMapping[]>({\n  key: \"vcsRoots\",\n  default: selector({\n    key: \"vcsRoots/temporaryDefault\",\n    get: temporaryVcsMappingsDefault,\n  }),\n});\n\n/**\n * Given the absolute path of a file, returns the relevant VCS root path, if any.\n */\nexport const VcsRootForFile = selectorFamily<string | null, string>({\n  key: \"gitRootForFile\",\n  get: (filepath: string) => ({ get }) =>\n    get(vcsRootsState).find((root) => filepath.startsWith(root.dir))?.dir ??\n    null,\n});\n\n/**\n * Keeps FileStatus of files based on their absolute path.\n * NOTE: Should it be an atom or selector?\n * NOTE: updating files status is now not connected to file updates, as there is no proper (V)FS API allowing change\n * listener. `useUpdateFileStatus` and `useUpdateVcsFileStatuses` can be used to update status of a file, or all files\n * in a git root.\n */\nexport const fileStatusState = atomFamily<FileStatus, string>({\n  key: \"fileStatus\",\n  default: \"NOT_CHANGED\",\n});\n\nexport const useUpdateFileStatus = () =>\n  useRecoilCallback(\n    ({ snapshot, set }: CallbackInterface) => async (filepath: string) => {\n      const repoRoot = await snapshot.getPromise(VcsRootForFile(filepath));\n      if (repoRoot != null) {\n        set(\n          fileStatusState(filepath),\n          convertGitStatus(\n            await status({\n              fs,\n              dir: repoRoot,\n              filepath: path.relative(repoRoot, filepath),\n            })\n          )\n        );\n      }\n    },\n    []\n  );\n\nexport const useUpdateVcsFileStatuses = () =>\n  useRecoilCallback(\n    ({ snapshot, transact_UNSTABLE }: CallbackInterface) => async () => {\n      const vcsDirectoryMappings = await snapshot.getPromise(vcsRootsState);\n      return Promise.all(\n        vcsDirectoryMappings\n          .filter(({ vcs }) => vcs === \"git\")\n          .map(async ({ dir }) => {\n            const rows = await statusMatrix({ fs, dir });\n            transact_UNSTABLE(({ set }) => {\n              rows.forEach((row) => {\n                set(fileStatusState(`${dir}/${row[0]}`), convertGitStatus(row));\n              });\n            });\n          })\n      );\n    },\n    []\n  );\n\nexport const useInitializeVcs = () => {\n  const updateVcsFileStatuses = useUpdateVcsFileStatuses();\n  useEffect(() => {\n    updateVcsFileStatuses().catch((e) => {\n      console.error(\"could not initialize VCS file statuses\", e);\n    });\n  }, []);\n};\n","import { useTheme } from \"styled-components\";\nimport { Theme } from \"@intellij-platform/core\";\nimport { useRecoilValue } from \"recoil\";\nimport { fileStatusState } from \"./file-status.state\";\nimport React from \"react\";\n\nexport const useFileStatusColor = (filepath: string): string | undefined => {\n  const fileStatus = useRecoilValue(fileStatusState(filepath));\n  const theme = useTheme() as Theme;\n\n  switch (fileStatus) {\n    case \"MODIFIED\":\n      return theme.dark ? \"#6897bb\" : \"#0032a0\"; // FILESTATUS_MODIFIED key from colorScheme\n    case \"ADDED\":\n      return theme.dark ? \"#629755\" : \"#0a7700\"; // FILESTATUS_ADDED key from colorScheme\n    case \"DELETED\":\n      return theme.dark ? \"#6c6c6c\" : \"#616161\"; // FILESTATUS_DELETED key from colorScheme\n    case \"UNKNOWN\":\n      return theme.dark ? \"#d1675a\" : \"#993300\"; // FILESTATUS_UNKNOWN key from colorScheme\n  }\n  return undefined;\n};\n\nexport const FileStatusColor: React.FC<{ filepath: string }> = ({\n  children,\n  filepath,\n}) => {\n  const color = useFileStatusColor(filepath);\n  return <span style={{ color }}>{children}</span>;\n};\n","import { Selection } from \"@react-types/shared\";\nimport { TreeRef } from \"@intellij-platform/core\";\nimport { Key, RefObject } from \"react\";\nimport { atom, CallbackInterface, GetRecoilValue, selector } from \"recoil\";\nimport { currentProjectState, Project } from \"../Project/project.state\";\nimport { dirContentState, FsItem } from \"../fs/fs.state\";\nimport { filterPath } from \"../Project/project-utils\";\nimport { getParentPaths } from \"../file-utils\";\nimport * as path from \"path\";\n\ninterface FileTreeNodeBase {\n  parent: (FileTreeNodeBase & { children: FsItem[] }) | null;\n  name: string;\n}\n\nexport type FileTreeDirNode = FileTreeNodeBase &\n  FsItem & {\n    children: FileTreeNode[];\n  };\nexport type FileTreeFileNode = FileTreeNodeBase & FsItem;\nexport type FileTreeNode = FileTreeFileNode | FileTreeDirNode;\n\ninterface ProjectTreeRoot extends FileTreeNodeBase {\n  type: \"project\";\n  path: string;\n  children: FileTreeNode[];\n}\n\nexport type ProjectTreeNode =\n  | ProjectTreeRoot\n  | ProjectTreeRoot[\"children\"][number]; // type def can be improved\n\nexport const foldersOnTopState = atom({\n  key: \"projectView.foldersOnTop\",\n  default: true,\n});\n\nexport const expandedKeysState = atom({\n  key: \"projectView.expandedKeys\",\n  default: selector({\n    key: \"projectView.expandedKeys/default\",\n    get: ({ get }) => new Set<Key>([get(currentProjectState).path]),\n  }),\n});\n\nexport const selectedKeysState = atom<Selection>({\n  key: \"projectView.selectedKeys\",\n  default: new Set<Key>([]),\n});\n\nexport const projectViewTreeRefState = atom<null | RefObject<TreeRef>>({\n  key: \"projectView.focusHandle\",\n  default: null,\n  dangerouslyAllowMutability: true,\n});\n\nexport const currentProjectTreeState = selector({\n  key: \"projectTree\",\n  get: ({ get }) => {\n    const project = get(currentProjectState);\n    return createProjectTree(project, get);\n  },\n});\n\n// NOTE: this function could be sync, and those `await`s before `get` are unnecessary. They are there simply because\n// I didn't realize `get` returns the value, not Promise. But interestingly, when this function is made sync,\n// performance drastically drops for some reason. That needs to be investigated.\nasync function createProjectTree(\n  project: Project,\n  get: GetRecoilValue\n): Promise<ProjectTreeRoot> {\n  const rootItems = await get(dirContentState(project.path));\n  const mapItem = (parent: FileTreeDirNode | null) => async (\n    item: FsItem\n  ): Promise<FileTreeNode> => {\n    const name = path.basename(item.path);\n    const node = {\n      ...item,\n      name,\n      parent,\n    };\n    const dirNode: FileTreeDirNode = { ...node, children: [] };\n    if (item.type === \"dir\") {\n      dirNode.children = await Promise.all(\n        ((await get(dirContentState(item.path))) ?? ([] as FsItem[])).map(\n          mapItem(dirNode)\n        )\n      );\n    }\n    return item.type === \"dir\" ? dirNode : node;\n  };\n\n  return {\n    type: \"project\",\n    path: project.path,\n    name: project.name,\n    parent: null,\n    children: await Promise.all(\n      (rootItems || []).filter(filterPath).map(mapItem(null))\n    ),\n  };\n}\n\n/**\n * a function to be passed to useRecoilCallback to get back a callback for expanding to a certain path in project view.\n * @param snapshot\n * @param set\n */\nexport const expandToPathCallback = ({ snapshot, set }: CallbackInterface) => (\n  path: string\n) => {\n  const expandedKeys = snapshot.getLoadable(expandedKeysState).valueOrThrow();\n  const keysToExpand = [\n    snapshot.getLoadable(currentProjectState).valueOrThrow().path,\n  ].concat(getParentPaths(path));\n  set(expandedKeysState, new Set([...expandedKeys, ...keysToExpand]));\n};\n\n/**\n * a function to be passed to useRecoilCallback to get back a callback for selecting a file in project view and focusing\n * the project view.\n * // TODO: open project view tool window if needed, when tool window state is also moved to recoil instead of local\n * //  state.\n */\nexport const selectKeyAndFocusCallback = ({ snapshot }: CallbackInterface) => (\n  key: Key\n) => {\n  const treeRef = snapshot.getLoadable(projectViewTreeRefState).valueOrThrow()\n    ?.current;\n  treeRef?.replaceSelection(key);\n  treeRef?.focus(key);\n};\n","import { styled } from \"@intellij-platform/core\";\n\nexport const StyledTreeNodeWrapper = styled.div`\n  display: flex;\n  align-items: center;\n`;\n","import React, { useContext } from \"react\";\nimport { ItemStateContext } from \"@intellij-platform/core\";\n\n/**\n * Overrides color to a legible one, if the tree/list item (in which this span is rendered) is selected.\n * TODO(lib-candidate)\n * @param children\n * @param className\n * @constructor\n */\nexport const SelectionAwareSpan: React.FC<{ className?: string }> = ({\n  children,\n  className,\n}) => {\n  const { isSelected, isFocused } = useContext(ItemStateContext) || {\n    isSelected: false,\n    isFocused: false,\n  };\n  return (\n    <span\n      className={className}\n      style={{ color: isSelected && isFocused ? \"inherit\" : undefined }}\n    >\n      {children}\n    </span>\n  );\n};\n","import React from \"react\";\nimport { styled } from \"@intellij-platform/core\";\nimport { SelectionAwareSpan } from \"./SelectionAwareSpan\";\n\nexport const StyledTreeNodeHint = styled(SelectionAwareSpan)`\n  display: inline-flex;\n  color: ${({ theme }) => theme.commonColors.inactiveTextColor};\n  padding-left: 0.35rem;\n`;\n","import {\n  HighlightedTextValue,\n  Item,\n  ItemStateContext,\n  PlatformIcon,\n  SpeedSearchTree,\n  StyledListIconWrapper,\n  TreeRef,\n} from \"@intellij-platform/core\";\nimport { identity, sortBy } from \"ramda\";\nimport React, { useContext, useLayoutEffect, useRef } from \"react\";\nimport { useRecoilState, useRecoilValue, useSetRecoilState } from \"recoil\";\nimport { DefaultSuspense } from \"../DefaultSuspense\";\nimport { useEditorStateManager } from \"../Editor/editor.state\";\nimport { DIR_ICON, FILE_ICON, getIconForFile } from \"../file-utils\";\nimport { currentProjectState } from \"../Project/project.state\";\nimport {\n  currentProjectTreeState,\n  expandedKeysState,\n  FileTreeDirNode,\n  FileTreeFileNode,\n  FileTreeNode,\n  foldersOnTopState,\n  ProjectTreeNode,\n  projectViewTreeRefState,\n  selectedKeysState,\n} from \"./ProjectView.state\";\nimport { FileStatusColor } from \"../VersionControl/FileStatusColor\";\nimport { StyledTreeNodeWrapper } from \"../TreeUtils/StyledTreeNodeWrapper\";\nimport { StyledTreeNodeHint } from \"../TreeUtils/StyledTreeNodeHint\";\n\nexport const ProjectViewPane = (): React.ReactElement => {\n  const project = useRecoilValue(currentProjectState);\n  const editor = useEditorStateManager();\n  const treeRef = useRef<TreeRef>(null);\n  const setProjectViewTreeRef = useSetRecoilState(projectViewTreeRefState);\n  useLayoutEffect(() => {\n    setProjectViewTreeRef(treeRef);\n  }, [treeRef]);\n\n  const projectTree = useRecoilValue(currentProjectTreeState);\n\n  const [expandedKeys, setExpandedKeys] = useRecoilState(expandedKeysState);\n  const [selectedKeys, setSelectedKeys] = useRecoilState(selectedKeysState);\n  const foldersOnTop = useRecoilValue(foldersOnTopState);\n\n  const sortItems = foldersOnTop\n    ? sortBy<ProjectTreeNode>((a) => (a.type === \"dir\" ? 1 : 2))\n    : identity;\n\n  return (\n    <DefaultSuspense>\n      <SpeedSearchTree\n        ref={treeRef}\n        items={[projectTree] as ProjectTreeNode[]}\n        onAction={(path) => {\n          editor.openPath(`${path}`);\n        }}\n        fillAvailableSpace\n        disallowEmptySelection\n        selectionMode=\"multiple\"\n        selectedKeys={selectedKeys}\n        onSelectionChange={setSelectedKeys}\n        expandedKeys={expandedKeys}\n        onExpandedChange={setExpandedKeys}\n      >\n        {(item) => (\n          <Item\n            key={item.path}\n            textValue={item.name}\n            childItems={\n              \"children\" in item ? sortItems(item.children) : undefined\n            }\n          >\n            <StyledTreeNodeWrapper>\n              {<ProjectViewNodeIcon node={item} />}\n              {item.type === \"project\" ? (\n                <>\n                  <b>\n                    <HighlightedTextValue />\n                  </b>\n                  <StyledTreeNodeHint>{project.path}</StyledTreeNodeHint>\n                </>\n              ) : (\n                <FileTreeNodeText node={item} />\n              )}\n              {/* {\"loadingState\" in item &&\n                item.loadingState === \"loading\" && (\n                  <TreeNodeHint>\n                    <Img height={16} src={loading} darkSrc={loadingDark} />\n                  </TreeNodeHint>\n                )}*/}\n            </StyledTreeNodeWrapper>\n          </Item>\n        )}\n      </SpeedSearchTree>\n    </DefaultSuspense>\n  );\n};\n\nconst FileTreeNodeText = ({ node }: { node: FileTreeNode }) => {\n  return node.type === \"dir\" ? (\n    // why is the explicit casting necessary? :/ isn't \"type\" enough for TS to figure out the right type?\n    <FileTreeDirNodeText node={node as FileTreeDirNode} />\n  ) : (\n    <FileTreeFileNodeText node={node as FileTreeFileNode} />\n  );\n};\n\nconst FileTreeDirNodeText = ({}: { node: FileTreeFileNode }) => (\n  // TODO: add support for \"Highlight directories that contain modified files in the Project tree\" (showDirtyRecursively)\n  <HighlightedTextValue />\n);\n\nconst FileTreeFileNodeText = ({\n  node,\n}: {\n  node: FileTreeFileNode;\n}): React.ReactElement => {\n  const state = useContext(ItemStateContext);\n  return state?.isSelected && state?.isFocused ? (\n    <HighlightedTextValue />\n  ) : (\n    <FileStatusColor filepath={node.path}>\n      <HighlightedTextValue />\n    </FileStatusColor>\n  );\n};\n\nconst nodeTypeIconMap: { [key in ProjectTreeNode[\"type\"]]?: string } = {\n  project: \"nodes/folder\",\n  dir: DIR_ICON,\n  file: FILE_ICON,\n};\n\nfunction findNodeIcon(value: ProjectTreeNode): string | null {\n  if (value.type === \"file\") {\n    return getIconForFile(value.name);\n  }\n  return nodeTypeIconMap[value.type] ?? null;\n}\n\nfunction ProjectViewNodeIcon({\n  node,\n}: {\n  node: ProjectTreeNode;\n}): React.ReactElement {\n  const icon = findNodeIcon(node);\n  return (\n    <StyledListIconWrapper>\n      {icon && <PlatformIcon icon={icon} />}\n    </StyledListIconWrapper>\n  );\n}\n","import { Key } from \"react\";\n\ntype TreeFn<T> = (root: T | null) => null | readonly T[];\n\nexport const getExpandAllKeys = <T>(\n  /**\n   * represents a tree as a function. Given a node, it should return the array of children or null, if the node is a\n   * leaf. Note that even an empty array will make the node to be considered a non-leaf node and the key is included.\n   * if null is passed, the root(s) node(s) should be returned.\n   */\n  getChildren: TreeFn<T>,\n  /**\n   * a function that converts each node into a key\n   */\n  getKey: (t: T) => Key\n) => {\n  const roots = getChildren(null) || [];\n  const keys: Key[] = roots.map(getKey);\n  const processItem = (node: T | null) => {\n    const children = node ? getChildren(node) : null;\n    if (node == null || !children) {\n      return;\n    }\n    keys.push(getKey(node));\n    children.forEach(processItem);\n  };\n  roots.map(getChildren).flat().forEach(processItem);\n  return keys;\n};\n\nexport const dfsVisit = <T, R>(\n  getChildren: TreeFn<T>,\n  visit: (node: T, childrenValues: null | R[]) => R\n) => {\n  const nodes = getChildren(null) || [];\n  const dfs = (node: T): R => {\n    const children = getChildren(node);\n    const values = children?.map(dfs) ?? null;\n    return visit(node, values);\n  };\n  nodes.forEach(dfs);\n};\n","import { ActionButton, PlatformIcon } from \"@intellij-platform/core\";\nimport React from \"react\";\nimport { useRecoilCallback, useRecoilValue, useSetRecoilState } from \"recoil\";\nimport { activeEditorTabState } from \"../Editor/editor.state\";\nimport {\n  currentProjectTreeState,\n  expandedKeysState,\n  expandToPathCallback,\n  FileTreeDirNode,\n  ProjectTreeNode,\n  selectKeyAndFocusCallback,\n} from \"./ProjectView.state\";\nimport { getExpandAllKeys } from \"../TreeUtils/tree-utils\";\n\nexport const ProjectViewActionButtons = (): React.ReactElement => {\n  const setExpandedKeys = useSetRecoilState(expandedKeysState);\n  const root = useRecoilValue(currentProjectTreeState);\n  const activeTab = useRecoilValue(activeEditorTabState);\n\n  const expandToOpenedFile = useRecoilCallback(expandToPathCallback, []);\n  const selectKeyAndFocus = useRecoilCallback(selectKeyAndFocusCallback, []);\n  const selectOpenedFile = () => {\n    if (activeTab) {\n      expandToOpenedFile(activeTab.filePath);\n      selectKeyAndFocus(activeTab.filePath);\n    }\n  };\n\n  const collapseAll = () => setExpandedKeys(new Set()); // in Intellij, it also changes selection sometimes.\n  const expandAll = () => {\n    setExpandedKeys(\n      new Set(\n        getExpandAllKeys<ProjectTreeNode>(\n          (node) =>\n            node === null ? [root] : (node as FileTreeDirNode)?.children,\n          (node) => node.path\n        )\n      )\n    );\n  };\n  return (\n    <>\n      <ActionButton onPress={selectOpenedFile} isDisabled={!activeTab}>\n        <PlatformIcon icon=\"general/locate\" />\n      </ActionButton>\n      <ActionButton onPress={expandAll}>\n        <PlatformIcon icon=\"actions/expandall\" />\n      </ActionButton>\n      <ActionButton onPress={collapseAll}>\n        <PlatformIcon icon=\"actions/collapseall\" />\n      </ActionButton>\n    </>\n  );\n};\n","import React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport styled from \"styled-components\";\nimport * as Xterm from \"xterm\";\nimport { XTerm } from \"xterm-for-react\";\n\nconst useTerminalXtermOptions = (): Xterm.ITerminalOptions => {\n  return useMemo(\n    () => ({\n      theme: {\n        background: \"rgb(43,43,43)\", // CONSOLE_BACKGROUND_KEY from color scheme\n        selection: \"#214283\", // SELECTION_BACKGROUND?\n        // TODO: more colors\n      },\n      fontFamily: \"sans-serif\",\n      letterSpacing: -8,\n      fontSize: 12,\n      lineHeight: 1.3,\n      cursorStyle: \"block\",\n      cursorBlink: true,\n      cursorWidth: 8,\n      rendererType: \"dom\",\n    }),\n    []\n  );\n};\n\nconst StyledXterm = styled(XTerm)`\n  height: 100%;\n  background: rgb(43, 43, 43); // CONSOLE_BACKGROUND_KEY from color scheme\n`;\nexport const Terminal = (): React.ReactElement => {\n  const [input, setInput] = useState(\"\");\n  const xtermRef = useRef<XTerm | null>(null);\n\n  const options = useTerminalXtermOptions();\n  const PROMPT = \"$ \";\n  useEffect(() => {\n    setTimeout(() => {\n      xtermRef.current?.terminal.resize(80, 10);\n      xtermRef.current?.terminal.write(PROMPT);\n    }, 3000);\n  }, []);\n  return (\n    <StyledXterm\n      ref={xtermRef}\n      options={options}\n      onData={(data) => {\n        const code = data.charCodeAt(0);\n        // If the user hits empty and there is something typed echo it.\n        if (code === 13) {\n          if (input.length > 0) {\n            xtermRef.current?.terminal.write(\"\\r\\nYou typed: '\" + input + \"'\");\n          }\n          xtermRef.current?.terminal.write(\"\\r\\n\" + PROMPT);\n          setInput(\"\");\n        } else if (code < 32 || code === 127) {\n          // Disable control Keys such as arrow keys\n          return;\n        } else {\n          // Add general key press characters to the terminal\n          xtermRef.current?.terminal.write(data);\n          setInput(input + data);\n        }\n      }}\n    />\n  );\n};\n","import { atom, CallbackInterface, selector, useRecoilCallback } from \"recoil\";\nimport { statusMatrix, StatusRow } from \"isomorphic-git\";\nimport { fs } from \"../../fs/fs\";\nimport { vcsRootsState } from \"../file-status.state\";\nimport { useEffect } from \"react\";\n\nexport type Revision = {\n  path: string;\n  isDir: boolean;\n};\n\nexport interface Change {\n  before: Revision;\n  after: Revision;\n}\n\nexport interface ChangeListObj {\n  id: string;\n  name: string;\n  comment: string;\n  active: boolean;\n  changes: Change[];\n}\n\nexport const changeListsState = atom<ChangeListObj[]>({\n  key: \"changelists.lists\",\n  default: [\n    {\n      id: \"some-UUID\",\n      name: \"Changes\",\n      comment: \"last modified commit message\",\n      changes: [\n        {\n          after: { path: \"/workspace/jui/README.md\", isDir: false },\n          before: { path: \"/workspace/jui/README.md\", isDir: false },\n        },\n        {\n          after: {\n            path: \"/workspace/jui/packages/example-app/src/Project/Project.tsx\",\n            isDir: false,\n          },\n          before: {\n            path: \"/workspace/jui/packages/example-app/src/Project/Project.tsx\",\n            isDir: false,\n          },\n        },\n        {\n          after: {\n            path:\n              \"/workspace/jui/packages/example-app/src/ProjectView/ProjectViewPane.tsx\",\n            isDir: false,\n          },\n          before: {\n            path:\n              \"/workspace/jui/packages/example-app/src/ProjectView/ProjectViewPane.tsx\",\n            isDir: false,\n          },\n        },\n      ],\n      active: true,\n    },\n    {\n      id: \"some-other-UUID\",\n      name: \"Empty changelist\",\n      comment: \"Some empty changelist for testing\",\n      changes: [],\n      active: false,\n    },\n  ],\n});\n\nexport const activeChangeListState = selector<ChangeListObj | null>({\n  key: \"changelists.lists/default\",\n  get: ({ get }) =>\n    get(changeListsState).find((changeList) => changeList.active) ?? null,\n});\n\nexport const allChangesState = selector<ReadonlyArray<Change>>({\n  key: \"changelists.allChanges\",\n  get: ({ get }) =>\n    get(changeListsState)\n      .map((changeLists) => changeLists.changes)\n      .flat(),\n});\n\nconst isAChange = ([, head, workingDir, stage]: StatusRow): boolean =>\n  head !== 1 || workingDir !== 1 || stage !== 1;\n\nconst refreshChanges = ({ snapshot }: CallbackInterface) => async () => {\n  const gitRoots = (await snapshot.getPromise(vcsRootsState)).filter(\n    (root) => root.vcs === \"git\"\n  );\n  const allStatusMatrices = await Promise.all(\n    gitRoots.map(({ dir }) => statusMatrix({ fs, dir }))\n  );\n  const rows = allStatusMatrices.flat().filter(isAChange);\n  console.log(rows);\n  // FIXME\n  const unversionedPaths = [];\n  rows.forEach((row) => {});\n};\n\nexport interface ChangeListManager {\n  addChangeList(name: string, comment: string): void;\n  removeChangeList(id: string): void;\n  editChangeList(\n    id: string,\n    edits: { name?: string; comment?: string; active?: boolean }\n  ): void;\n  setActiveChangeList(id: string): void;\n  mergeChangeLists(sourceId: string, targetId: string): void;\n  moveChange(change: Change, toChangeListId: string): void;\n  refresh(): Promise<void>;\n}\n\n/**\n * Exposes actions related to managing change lists, such as CRUD on change lists or refreshing the list of changes, etc.\n * NOTE: ChangeListManager is not used to get the list of changes or change lists, etc. that is to prevent unnecessary\n * re-renders when a component only needs to perform actions related to change lists, without caring about the state\n * of change lists. to get the list of change lists or active change list or list of all changes, there are several\n * other recoil values that can be used simply by `useRecoilValue` hook. of course setting those recoil values\n * is not expected to be done directly via recoil API, and can be prevented by not exposing the atoms/selectors\n * directly, and exposing small hooks that would simply call useRecoilValue.\n */\nexport const useChangeListManager = (): ChangeListManager => {\n  const refresh = useRecoilCallback(refreshChanges, []);\n\n  const addChangeList = (name: string, comment: string) => {\n    throw new Error(\"Not implemented\");\n  };\n  const editChangeList = (\n    id: string,\n    edits: { name?: string; comment?: string; active?: boolean }\n  ) => {\n    throw new Error(\"Not implemented\");\n  };\n  const mergeChangeLists = (sourceId: string, targetId: string) => {\n    throw new Error(\"Not implemented\");\n  };\n  const moveChange = (change: Change, toChangeListId: string) => {\n    throw new Error(\"Not implemented\");\n  };\n  const removeChangeList = (id: string) => {\n    throw new Error(\"Not implemented\");\n  };\n  const setActiveChangeList = (id: string) => {\n    throw new Error(\"Not implemented\");\n  };\n  return {\n    addChangeList,\n    editChangeList,\n    mergeChangeLists,\n    moveChange,\n    removeChangeList,\n    setActiveChangeList,\n    refresh,\n  };\n};\n\n// temporary, perhaps\nexport const useInitializeChanges = () => {\n  const { refresh } = useChangeListManager();\n  useEffect(() => {\n    refresh().catch((e) => console.error(\"could not initialize changes\", e));\n  }, [refresh]);\n};\n","import { constSelector, GetRecoilValue, selector } from \"recoil\";\nimport { vcsRootsState } from \"../../file-status.state\";\nimport { uniq } from \"ramda\";\nimport {\n  ChangeGrouping,\n  ChangeNode,\n  DirectoryNode,\n  directoryNode,\n  isDirectoryNode,\n  RepositoryNode,\n  repositoryNode,\n} from \"./ChangesView.state\";\nimport { getParentPaths } from \"../../../file-utils\";\n\nconst repositoryGrouping: ChangeGrouping<RepositoryNode, \"repository\"> = {\n  id: \"repository\",\n  title: \"Repository\",\n  isAvailable: selector({\n    key: \"repositoryGrouping/isAvailable\",\n    get: ({ get }) => get(vcsRootsState).length > 0,\n  }),\n  groupFn: selector({\n    key: \"repositoryGrouping/groupFn\",\n    get: ({ get }: { get: GetRecoilValue }) => (\n      nodes: ReadonlyArray<ChangeNode>\n    ) => {\n      const repos = get(vcsRootsState);\n      return repos.map(\n        (repository): RepositoryNode => {\n          return repositoryNode(\n            repository,\n            nodes.filter((node) =>\n              (node.change.after?.path || node.change.before?.path).startsWith(\n                repository.dir\n              )\n            )\n          );\n        }\n      );\n    },\n  }),\n};\n\nconst directoryGrouping: ChangeGrouping<DirectoryNode, \"directory\"> = {\n  id: \"directory\",\n  title: \"Directory\",\n  isAvailable: constSelector(true),\n  groupFn: (nodes: ReadonlyArray<ChangeNode>) => {\n    const pathToNodeCache: Record<string, DirectoryNode> = {};\n    const rootDirNodes = nodes.map((node) => {\n      if (node.change.after.isDir) {\n        throw new Error(\"isDir=true is not supported for changes ATM!\");\n      }\n      const filepath = node.change.after.path;\n      // noinspection UnnecessaryLocalVariableJS\n      const rootDirNode = getParentPaths(filepath).reduce(\n        (prevNode: DirectoryNode | ChangeNode, dirPath) => {\n          if (!pathToNodeCache[dirPath]) {\n            pathToNodeCache[dirPath] = directoryNode(dirPath, \"\");\n          }\n          if (prevNode.type === \"directory\") {\n            prevNode.parentNodePath = dirPath;\n          }\n          const dirNode = pathToNodeCache[dirPath];\n          dirNode.children = dirNode.children.includes(prevNode)\n            ? dirNode.children\n            : [prevNode, ...dirNode.children];\n          return dirNode;\n        },\n        node\n      ) as DirectoryNode; // This is gonna be true if the array is non-empty, but TS can't recongnize it.\n      // whether the array can be empty might be something to consider and guard against\n      return rootDirNode;\n    });\n    const collapseDirectories = (dirNode: DirectoryNode): DirectoryNode => {\n      let { children, dirPath } = dirNode;\n      if (\n        dirNode.children.length === 1 &&\n        isDirectoryNode(dirNode.children[0])\n      ) {\n        children = dirNode.children[0].children;\n        dirPath = dirNode.children[0].dirPath;\n      }\n      return {\n        ...dirNode,\n        dirPath,\n        children: children.map((child) =>\n          isDirectoryNode(child) ? collapseDirectories(child) : child\n        ),\n      };\n    };\n    return uniq(rootDirNodes).map(collapseDirectories);\n  },\n};\n\nexport const groupings = [repositoryGrouping, directoryGrouping];\n","import { atom, atomFamily, isRecoilValue, RecoilValue, selector } from \"recoil\";\nimport { Selection } from \"@react-types/shared\";\nimport { Key } from \"react\";\nimport { Change, ChangeListObj, changeListsState } from \"../change-lists.state\";\nimport { groupings } from \"./changesGroupings\";\nimport { VcsDirectoryMapping } from \"../../file-status\";\nimport { dfsVisit } from \"../../../TreeUtils/tree-utils\";\nimport { NestedSelection, NestedSelectionState } from \"@intellij-platform/core\";\nimport { createMapSetInterface } from \"@intellij-platform/core/utils/useSet\";\n\nexport interface ChangeBrowserNode<T extends string> {\n  type: T;\n  key: string;\n}\n\nexport interface GroupNode<T extends string> extends ChangeBrowserNode<T> {\n  children: ReadonlyArray<AnyNode>;\n}\n\nexport interface ChangeNode extends ChangeBrowserNode<\"change\"> {\n  change: Change;\n}\n\nexport interface ChangeListNode extends GroupNode<\"changelist\"> {\n  changeList: ChangeListObj;\n}\n\nexport interface DirectoryNode extends GroupNode<\"directory\"> {\n  dirPath: string;\n  parentNodePath: string;\n}\n\nexport interface RepositoryNode extends GroupNode<\"repo\"> {\n  repository: VcsDirectoryMapping;\n}\n\nexport type AnyGroupNode = ChangeListNode | RepositoryNode | DirectoryNode;\nexport type AnyNode = AnyGroupNode | ChangeNode;\n\ntype MaybeRecoilValue<T> = T | RecoilValue<T>;\n\nexport type GroupFn<T extends AnyGroupNode> = (\n  nodes: ReadonlyArray<ChangeNode>\n) => ReadonlyArray<T>;\n\nexport interface ChangeGrouping<T extends AnyGroupNode, I = string> {\n  id: I;\n  title: string;\n  isAvailable: MaybeRecoilValue<boolean>;\n  groupFn: MaybeRecoilValue<GroupFn<T>>;\n}\n\nexport const currentBranchState = atomFamily<string, string>({\n  key: \"vcs/currentBranchName\",\n  default: \"master\",\n  // TODO: effect for syncing (when toolWindow state changes?)\n});\n\nexport const showIgnoredFilesState = atom({\n  key: \"changesView/showIgnoredFiles\",\n  default: false,\n});\n\nexport const showRelatedFilesState = atom({\n  key: \"changesView/showRelatedFiles\",\n  default: false,\n});\n\n// in a more extensible implementation, the id would be just string. but now that groupings are statically defined,\n// why not have more type safety\nexport type GroupingIds = typeof groupings[number][\"id\"];\n\nexport const changesGroupingState = atomFamily<boolean, GroupingIds>({\n  key: \"changesView/grouping\",\n  default: true, // it's false in IntelliJ\n});\n\n/**\n * Selection state for the changes tree. Selection here means UI selection of tree nodes.\n */\nexport const selectedKeysState = atom<Selection>({\n  key: \"changesView.selectedKeys\",\n  default: new Set<Key>([]),\n});\n\n/**\n * The list of changes that are included for the commit (via checkboxes).\n * TODO: for both this and tree selection state, value should be updated to exclude removed keys, when the tree data\n *  is changed\n */\nexport const selectedChangesState = atom<Set<string>>({\n  key: \"changesView.selectedChanges\",\n  default: new Set<string>([]),\n});\n\nexport const selectedChangesNestedSelection = selector<\n  NestedSelectionState<AnyNode>\n>({\n  key: \"changesView.selectedChanges.nestedSelectionState\",\n  get: ({ get, getCallback }) => {\n    const { rootNodes } = get(changesTreeNodesState);\n    const selectedChangeKeys = get(selectedChangesState);\n    const setSelectedKeys = getCallback(\n      ({ set }) => (setValue: (currentValue: Set<string>) => Set<string>) =>\n        set(selectedChangesState, setValue)\n    );\n    return new NestedSelection(\n      {\n        items: selectedChangeKeys,\n        ...createMapSetInterface(setSelectedKeys),\n      },\n      {\n        rootNodes,\n        getChildren: (item: AnyNode) =>\n          isGroupNode(item) ? item.children : null,\n        getKey: (item) => item.key,\n      }\n    );\n  },\n});\n\nexport const expandedKeysState = atom<Selection>({\n  key: \"changesView.expandedKeys\",\n  default: selector({\n    key: \"changesView.expandedKeys/temporaryDefault\",\n    get: ({ get }) => {\n      return new Set<Key>(\n        get(changesTreeNodesState)\n          .rootNodes.map((node) => [\n            node.key,\n            ...node.children.map((child) => child.key),\n          ])\n          .flat()\n      );\n    },\n  }),\n});\n\nexport const availableGroupingsState = selector({\n  key: \"changes.availableGroupings\",\n  get: ({ get }) =>\n    groupings\n      .filter((grouping) =>\n        isRecoilValue(grouping.isAvailable)\n          ? get(grouping.isAvailable)\n          : grouping.isAvailable\n      )\n      .map((grouping) => ({\n        grouping,\n        isActive: get(changesGroupingState(grouping.id)),\n      })),\n});\n\nconst changeBrowserNodeKey = (type: string, id: string): string =>\n  `${type}_${id}`;\n\nexport const changeNode = (change: Change): ChangeNode => ({\n  type: \"change\",\n  key: changeBrowserNodeKey(\"change\", change.after.path),\n  change,\n});\n\nexport const changeListNode = (\n  changeList: ChangeListObj,\n  groupFn: GroupFn<any> = (i) => i\n): ChangeListNode => ({\n  type: \"changelist\",\n  key: changeBrowserNodeKey(\"changelist\", changeList.id),\n  changeList,\n  children: groupFn(changeList.changes.map((change) => changeNode(change))),\n});\n\nexport const directoryNode = (\n  dirPath: string,\n  parentNodePath: string,\n  children: AnyNode[] = []\n): DirectoryNode => ({\n  type: \"directory\",\n  key: changeBrowserNodeKey(\"directory\", dirPath),\n  dirPath,\n  parentNodePath,\n  children,\n});\n\nexport const repositoryNode = (\n  repository: VcsDirectoryMapping,\n  children: AnyNode[] = []\n): RepositoryNode => ({\n  type: \"repo\",\n  key: changeBrowserNodeKey(\"repo\", repository.dir),\n  repository,\n  children,\n});\n\nexport const isGroupNode = (\n  node: ChangeBrowserNode<any>\n): node is GroupNode<any> => \"children\" in node;\n\nconst isChangeNode = (node: ChangeBrowserNode<any>): node is ChangeNode =>\n  node.type === \"change\";\n\nexport const isDirectoryNode = (node: AnyNode): node is DirectoryNode =>\n  node.type === \"directory\";\n\nconst recursiveGrouping = (\n  groupingFns: Array<GroupFn<AnyGroupNode>>,\n  nodes: ReadonlyArray<ChangeBrowserNode<any>>\n): ReadonlyArray<AnyGroupNode> => {\n  if (groupingFns.length === 0 || nodes.length === 0) {\n    return nodes as ReadonlyArray<AnyGroupNode>; // can we avoid explicit cast?\n  }\n  const nextGroupingFns = groupingFns.slice(1);\n  const changeNodes = nodes.filter(isChangeNode);\n  const groupNodes = nodes.filter(isGroupNode);\n  const groups = groupingFns[0](changeNodes);\n\n  [...groupNodes, ...groups].forEach((groupNode) => {\n    groupNode.children = recursiveGrouping(nextGroupingFns, groupNode.children);\n  });\n  return groups;\n};\n\nconst getChildren = (node: AnyNode) =>\n  isGroupNode(node) ? node.children : null;\n\nexport const changesTreeNodesState = selector<{\n  rootNodes: ChangeListNode[];\n  fileCountsMap: Map<string, number>;\n}>({\n  key: \"changesView.treeNodes\",\n  get: ({ get }) => {\n    const resolve = <T>(value: MaybeRecoilValue<T>): T =>\n      isRecoilValue(value) ? get(value) : value;\n    const changeLists = get(changeListsState);\n    const groupFns = get(availableGroupingsState)\n      .filter(({ isActive }) => isActive)\n      .map(({ grouping }) => {\n        return resolve(grouping.groupFn);\n      });\n\n    const groupChanges = (changes: readonly ChangeNode[]) =>\n      recursiveGrouping(groupFns, changes);\n\n    const rootNodes = changeLists.map((changeList) =>\n      changeListNode(changeList, groupChanges)\n    );\n    const fileCountsMap = new Map();\n    const getFileCount = (node: GroupNode<any>): number => {\n      return node.children.reduce(\n        (totalSum, child) =>\n          totalSum + (isGroupNode(child) ? getFileCount(child) : 1),\n        0\n      );\n    };\n    dfsVisit<AnyNode, number>(\n      (root) => (root === null ? rootNodes : getChildren(root)),\n      (node, childrenFileCount) => {\n        if (!childrenFileCount) {\n          return 1;\n        }\n        const fileCount = childrenFileCount.reduce(\n          (total, count) => total + count,\n          0\n        );\n        fileCountsMap.set(node.key, fileCount);\n        return fileCount;\n      }\n    );\n    return { rootNodes, fileCountsMap };\n  },\n});\n","import React from \"react\";\nimport { useRecoilState } from \"recoil\";\nimport {\n  showIgnoredFilesState,\n  showRelatedFilesState,\n} from \"../ChangesView.state\";\nimport {\n  ActionButtonWithMenu,\n  Item,\n  Menu,\n  PlatformIcon,\n} from \"@intellij-platform/core\";\n\nexport const ViewOptionsActionButton = (): React.ReactElement => {\n  const [showRelatedFiles, setShowRelatedFiles] = useRecoilState(\n    showRelatedFilesState\n  );\n  const [showIgnoredFiles, setShowIgnoredFiles] = useRecoilState(\n    showIgnoredFilesState\n  );\n  const viewOptions = { showRelatedFiles, showIgnoredFiles };\n\n  return (\n    <ActionButtonWithMenu\n      renderMenu={({ menuProps, close }) => (\n        <Menu\n          {...menuProps}\n          selectedKeys={Object.keys(viewOptions).filter(\n            (key) => viewOptions[key as keyof typeof viewOptions]\n          )}\n          onAction={(key) => {\n            close();\n            switch (key) {\n              case \"showIgnoredFiles\":\n                return setShowIgnoredFiles((value) => !value);\n              case \"showRelatedFiles\":\n                return setShowRelatedFiles((value) => !value);\n            }\n          }}\n        >\n          <Item key=\"showIgnoredFiles\">Show Ignored Files</Item>\n          <Item key=\"showRelatedFiles\">\n            Show Files Related to Active Changelist\n          </Item>\n        </Menu>\n      )}\n    >\n      <PlatformIcon icon=\"actions/show.svg\" />\n    </ActionButtonWithMenu>\n  );\n};\n","import React from \"react\";\nimport { useRecoilCallback, useRecoilValue } from \"recoil\";\nimport {\n  availableGroupingsState,\n  changesGroupingState,\n  GroupingIds,\n} from \"../ChangesView.state\";\nimport {\n  ActionButtonWithMenu,\n  Item,\n  Menu,\n  PlatformIcon,\n  Section,\n} from \"@intellij-platform/core\";\n\nexport const GroupByActionButton = (): React.ReactElement => {\n  // Grouping is extensible in Intellij platform, but we only support grouping by directory here.\n\n  const availableGroupings = useRecoilValue(availableGroupingsState);\n\n  const toggleGroup = useRecoilCallback(\n    ({ set }) => (id: GroupingIds) => {\n      set(changesGroupingState(id), (value) => !value);\n    },\n    []\n  );\n\n  return (\n    <ActionButtonWithMenu\n      renderMenu={({ menuProps, close }) => (\n        <Menu\n          {...menuProps}\n          selectedKeys={availableGroupings\n            .filter(({ isActive }) => isActive)\n            .map(({ grouping }) => grouping.id)}\n          onAction={(key) => {\n            close();\n            const id = availableGroupings.find(\n              ({ grouping }) => grouping.id === key\n            )?.grouping.id;\n            if (id) {\n              toggleGroup(id);\n            }\n          }}\n        >\n          <Section title=\"Group By\">\n            {availableGroupings.map(({ grouping }) => (\n              <Item key={grouping.id}>{grouping.title}</Item>\n            ))}\n          </Section>\n        </Menu>\n      )}\n    >\n      <PlatformIcon icon=\"actions/groupBy.svg\" />\n    </ActionButtonWithMenu>\n  );\n};\n","import React from \"react\";\nimport {\n  ActionButtonWithMenu,\n  Item,\n  Menu,\n  MenuItemLayout,\n  PlatformIcon,\n} from \"@intellij-platform/core\";\n\nexport const ChangeListsActionButton = (): React.ReactElement => {\n  // Grouping is extensible in Intellij platform, but we only support grouping by directory here.\n\n  return (\n    <ActionButtonWithMenu\n      renderMenu={({ menuProps, close }) => (\n        <Menu\n          {...menuProps}\n          onAction={(key) => {\n            alert(\"Not implemented\");\n            close();\n          }}\n        >\n          <Item key=\"new\">\n            <MenuItemLayout\n              content=\"New Changelist...\"\n              icon={<PlatformIcon icon=\"general/add.svg\" />}\n            />\n          </Item>\n          <Item key=\"edit\">\n            <MenuItemLayout\n              content=\"Edit Changelist...\"\n              icon={<PlatformIcon icon=\"actions/edit.svg\" />}\n            />\n          </Item>\n          <Item key=\"delete\">\n            <MenuItemLayout\n              content=\"Delete Changelist\"\n              icon={<PlatformIcon icon=\"general/remove.svg\" />}\n            />\n          </Item>\n          <Item key=\"moveToAnotherChangelist\">\n            <MenuItemLayout content=\"Move Files to Another Changelist...\" />\n          </Item>\n        </Menu>\n      )}\n    >\n      <PlatformIcon icon=\"vcs/changelist.svg\" />\n    </ActionButtonWithMenu>\n  );\n};\n","import { styled, Theme } from \"@intellij-platform/core\";\nimport React from \"react\";\nimport { useRecoilValue } from \"recoil\";\nimport { vcsRootsState } from \"../../file-status.state\";\nimport { useTheme } from \"styled-components\";\n\nconst StyledRepoColorSquare = styled.span`\n  width: 14px;\n  height: 14px;\n  align-self: center;\n  margin-right: 6px;\n  position: relative;\n\n  //  after pseudo element is used to create the color mixing implemented here:\n  //  https://github.com/JetBrains/intellij-community/blob/82f201386c3f7a339ff25fc8f3389024c8078a87/platform/vcs-log/impl/src/com/intellij/vcs/log/ui/VcsLogColorManagerImpl.java#L60\n  &&:after {\n    content: \"\";\n    position: absolute;\n    inset: 0;\n    opacity: 0.75;\n    background: ${({ theme }) =>\n      theme.color(\"Table.background\") || (theme.dark ? \"#3C3F41\" : \"#fff\")};\n  }\n`;\n\nconst useRepoRootColor = (rootPath: string) => {\n  const index = useRecoilValue(vcsRootsState).findIndex(\n    (root) => root.dir === rootPath\n  );\n  const theme = useTheme() as Theme;\n  const colors = [theme.commonColors.red, theme.commonColors.blue];\n  return colors[index % colors.length] ?? colors[0];\n};\n\nexport const RepoColorIcon = ({ rootPath }: { rootPath: string }) => (\n  <StyledRepoColorSquare\n    style={{ backgroundColor: useRepoRootColor(rootPath) }}\n  />\n);\n","import React from \"react\";\nimport { VcsDirectoryMapping } from \"./file-status\";\nimport { currentBranchState } from \"./Changes/ChangesView/ChangesView.state\";\nimport { useRecoilValue } from \"recoil\";\n\nexport const CurrentBranchName = ({ repo }: { repo?: VcsDirectoryMapping }) => {\n  const branch = useRecoilValue(currentBranchState(repo?.dir ?? \"\"));\n  return <>{branch}</>;\n};\n","import React from \"react\";\nimport { Color, styled, UnknownThemeProp } from \"@intellij-platform/core\";\nimport { SelectionAwareSpan } from \"../../../TreeUtils/SelectionAwareSpan\";\n\nexport const StyledCurrentBranchTag = styled(SelectionAwareSpan)`\n  margin-left: 0.3rem;\n  display: inline-flex;\n  align-self: center;\n  height: 1.1rem;\n  line-height: 1.1rem;\n  padding: 0 0.25rem;\n\n  background: ${({ theme }) =>\n    new Color(\n      theme.color(\n        \"VersionControl.RefLabel.backgroundBase\",\n        theme.dark ? \"#fff\" : \"#000\"\n      )\n    )\n      .withTransparency(\n        theme.value<number>(\"VersionControl.RefLabel.backgroundBrightness\") ??\n          0.08\n      )\n      .toString()};\n  color: ${({ theme }) =>\n    theme.color(\n      \"VersionControl.RefLabel.foreground\" as UnknownThemeProp,\n      theme.dark ? \"#909090\" : \"#7a7a7a\"\n    )};\n`;\n","import React from \"react\";\nimport { useRecoilState, useRecoilValue } from \"recoil\";\nimport {\n  HighlightedTextValue,\n  Item,\n  PlatformIcon,\n  SpeedSearchTreeWithCheckboxes,\n  StyledListIconWrapper,\n  TreeNodeCheckbox,\n} from \"@intellij-platform/core\";\nimport { DIR_ICON, getIconForFile } from \"../../../file-utils\";\nimport { StyledTreeNodeWrapper } from \"../../../TreeUtils/StyledTreeNodeWrapper\";\nimport {\n  AnyNode,\n  ChangeBrowserNode,\n  ChangeListNode,\n  ChangeNode,\n  changesGroupingState,\n  changesTreeNodesState,\n  DirectoryNode,\n  expandedKeysState,\n  RepositoryNode,\n  selectedChangesNestedSelection,\n  selectedKeysState,\n} from \"./ChangesView.state\";\nimport { RepoColorIcon } from \"./StyledRepoColorSquare\";\nimport { StyledTreeNodeHint } from \"../../../TreeUtils/StyledTreeNodeHint\";\nimport { IntlMessageFormat } from \"intl-messageformat\";\nimport { CurrentBranchName } from \"../../CurrentBranchName\";\nimport { StyledCurrentBranchTag } from \"./StyledCurrentBranchTag\";\nimport * as path from \"path\";\n\n/**\n * Necessary properties for each node, to be passed to `Item`s rendered in tree.\n * Some properties like `key` or `childItems` are not included, as they are calculated similarly\n * for all types of nodes.\n */\ntype RenderedNode = { textValue: string; element: React.ReactNode };\n\ntype NodeRenderer<T extends ChangeBrowserNode<any>> = (\n  node: T,\n  metadata: { fileCount: number; dirCount: number }\n) => RenderedNode;\n\nconst fileCountMsg = new IntlMessageFormat(\n  `{fileCount, plural,\n    =0 {No files}\n    =1 {1 file}\n    other {# files}\n  }`,\n  \"en-US\"\n);\n\nconst repoNodeItemProps: NodeRenderer<RepositoryNode> = (\n  node,\n  { fileCount }\n) => ({\n  textValue: path.basename(node.repository.dir),\n  element: (\n    <>\n      <RepoColorIcon rootPath={node.repository.dir} />\n      <HighlightedTextValue />\n      <StyledTreeNodeHint>\n        {fileCountMsg.format({ fileCount })}\n      </StyledTreeNodeHint>\n      <StyledCurrentBranchTag>\n        <CurrentBranchName repo={node.repository} />\n      </StyledCurrentBranchTag>\n    </>\n  ),\n});\n\nconst directoryNodeItemProps: NodeRenderer<DirectoryNode> = (\n  node,\n  { fileCount }\n) => ({\n  textValue: path.relative(node.parentNodePath, node.dirPath),\n  element: (\n    <StyledTreeNodeWrapper>\n      <StyledListIconWrapper>\n        <PlatformIcon icon={DIR_ICON} />\n      </StyledListIconWrapper>\n      <HighlightedTextValue />\n      <StyledTreeNodeHint>\n        {fileCountMsg.format({ fileCount })}\n      </StyledTreeNodeHint>\n    </StyledTreeNodeWrapper>\n  ),\n});\n\nconst changeListNodeItemProps: NodeRenderer<ChangeListNode> = (\n  node,\n  { fileCount }\n) => ({\n  textValue: node.changeList.name,\n  element: (\n    <StyledTreeNodeWrapper>\n      <span style={{ fontWeight: node.changeList.active ? \"bold\" : undefined }}>\n        <HighlightedTextValue />\n      </span>\n      <StyledTreeNodeHint>\n        {fileCountMsg.format({ fileCount })}{\" \"}\n        {/*in IntelliJ it's not shown if it's empty, but why not!*/}\n      </StyledTreeNodeHint>\n    </StyledTreeNodeWrapper>\n  ),\n});\n\nconst ChangeNodeHint = ({ node }: { node: ChangeNode }): React.ReactElement => {\n  const isGroupedByDirectory = useRecoilValue(\n    changesGroupingState(\"directory\")\n  );\n  return (\n    <>\n      {!isGroupedByDirectory && (\n        <StyledTreeNodeHint>\n          {path.dirname(node.change.after.path)}\n        </StyledTreeNodeHint>\n      )}\n    </>\n  );\n};\nconst changeNodeItemProps: NodeRenderer<ChangeNode> = (node) => ({\n  textValue: path.basename(node.change.after.path),\n  element: (\n    <StyledTreeNodeWrapper>\n      <StyledListIconWrapper>\n        <PlatformIcon icon={getIconForFile(node.change.after.path)} />\n      </StyledListIconWrapper>\n      <HighlightedTextValue />\n      <ChangeNodeHint node={node} />\n    </StyledTreeNodeWrapper>\n  ),\n});\n\nconst nodeRenderers: {\n  [type in AnyNode[\"type\"]]: NodeRenderer<AnyNode & { type: type }>;\n} = {\n  repo: repoNodeItemProps,\n  directory: directoryNodeItemProps,\n  changelist: changeListNodeItemProps,\n  change: changeNodeItemProps,\n};\n\n/**\n * TODO: fix horizontal scroll issue (https://github.com/alirezamirian/jui/issues/6)\n * TODO: use the real changes instead of the dummy ones\n * TODO: unversioned files\n * TODO: show diff/source on double click (on action to be more precise)\n */\nexport const ChangeViewTree = (): JSX.Element => {\n  const { rootNodes, fileCountsMap } = useRecoilValue(changesTreeNodesState);\n  const [selectedKeys, setSelectedKeys] = useRecoilState(selectedKeysState);\n  const [expandedKeys, setExpandedKeys] = useRecoilState(expandedKeysState);\n  const nestedSelection = useRecoilValue(selectedChangesNestedSelection);\n\n  return (\n    <SpeedSearchTreeWithCheckboxes\n      items={rootNodes}\n      selectionMode=\"multiple\"\n      selectedKeys={selectedKeys}\n      expandedKeys={expandedKeys}\n      onExpandedChange={setExpandedKeys}\n      onSelectionChange={setSelectedKeys}\n      nestedSelection={nestedSelection}\n      disallowEmptySelection\n      fillAvailableSpace\n    >\n      {(node) => {\n        // Would make sense to handle missing renderer case if implementation is changed to be extensible with regard\n        // to node types\n        const { textValue, element } = nodeRenderers[node.type](node, {\n          fileCount: fileCountsMap.get(node.key) || 0,\n          dirCount: 0, // It seems it's only used for ignored files subtree\n        });\n        return (\n          <Item\n            key={node.key}\n            childItems={node.children}\n            hasChildItems={node.children?.length > 0}\n            textValue={textValue}\n          >\n            {node.children?.length !== 0 && (\n              <TreeNodeCheckbox\n                selectionState={nestedSelection.getSelectionState(node)}\n                onToggle={() => nestedSelection.toggle(node)}\n              />\n            )}\n            {element}\n          </Item>\n        );\n      }}\n    </SpeedSearchTreeWithCheckboxes>\n  );\n};\n","import { useRecoilCallback, useSetRecoilState } from \"recoil\";\nimport React from \"react\";\nimport {\n  ActionButton,\n  ActionToolbar,\n  ActionToolbarSeparator,\n  PlatformIcon,\n} from \"@intellij-platform/core\";\nimport { ViewOptionsActionButton } from \"./ActionButtons/ViewOptionsActionButton\";\nimport { GroupByActionButton } from \"./ActionButtons/GroupByActionButton\";\nimport { ChangeListsActionButton } from \"./ActionButtons/ChangeListsActionButton\";\nimport { useChangeListManager } from \"../change-lists.state\";\nimport { ChangeViewTree } from \"./ChangeViewTree\";\nimport { getExpandAllKeys } from \"../../../TreeUtils/tree-utils\";\nimport {\n  AnyNode,\n  changesTreeNodesState,\n  expandedKeysState,\n  GroupNode,\n} from \"./ChangesView.state\";\nimport styled from \"styled-components\";\n\nconst StyledContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n`;\n\nexport const ChangesViewPane = () => {\n  const { refresh } = useChangeListManager();\n\n  const setExpandedKeys = useSetRecoilState(expandedKeysState);\n  const collapseAll = () => setExpandedKeys(new Set()); // in Intellij, it also changes selection sometimes.\n  const expandAll = useRecoilCallback(\n    ({ set, snapshot }) => () => {\n      set(\n        expandedKeysState,\n        new Set(\n          getExpandAllKeys<AnyNode>(\n            (node) =>\n              node === null\n                ? snapshot.getLoadable(changesTreeNodesState).valueMaybe()\n                    ?.rootNodes || []\n                : (node as GroupNode<any>)?.children,\n            (item) => item.key\n          )\n        )\n      );\n    },\n    []\n  );\n\n  return (\n    <StyledContainer>\n      <ActionToolbar hasBorder>\n        <ActionButton onPress={refresh}>\n          <PlatformIcon icon=\"actions/refresh.svg\" />\n        </ActionButton>\n        <ActionButton>\n          <PlatformIcon icon=\"actions/rollback.svg\" />\n        </ActionButton>\n        <ActionButton>\n          <PlatformIcon icon=\"actions/diff.svg\" />\n        </ActionButton>\n        <ChangeListsActionButton />\n        <ActionButton>\n          <PlatformIcon icon=\"vcs/shelveSilent.svg\" />\n        </ActionButton>\n        <ActionToolbarSeparator />\n        <GroupByActionButton />\n        <ViewOptionsActionButton />\n        <ActionButton onPress={expandAll}>\n          <PlatformIcon icon=\"actions/expandall.svg\" />\n        </ActionButton>\n        <ActionButton onPress={collapseAll}>\n          <PlatformIcon icon=\"actions/collapseall.svg\" />\n        </ActionButton>\n      </ActionToolbar>\n      <ChangeViewTree />\n    </StyledContainer>\n  );\n};\n","import React from \"react\";\nimport { indexBy } from \"ramda\";\nimport { ProjectViewPane } from \"../ProjectView/ProjectViewPane\";\nimport { ProjectViewActionButtons } from \"../ProjectView/ProjectViewActionButtons\";\nimport {\n  DefaultToolWindow,\n  MultiContentToolWindow,\n  MultiContentToolWindowContent,\n  ToolWindowState,\n  toolWindowState,\n} from \"@intellij-platform/core\";\nimport { Terminal } from \"../Terminal\";\nimport { ChangesViewPane } from \"../VersionControl/Changes/ChangesView/ChangesViewPane\";\nimport { CurrentBranchName } from \"../VersionControl/CurrentBranchName\";\n\ntype ToolWindowDescriptor = {\n  id: string;\n  title: string;\n  icon: string;\n  element: React.ReactElement;\n  initialState: ToolWindowState;\n};\nconst windows: ToolWindowDescriptor[] = [\n  {\n    id: \"project\",\n    title: \"Project\",\n    icon: \"toolwindows/toolWindowProject\",\n    element: (\n      <DefaultToolWindow\n        headerContent=\"Project\"\n        additionalActions={<ProjectViewActionButtons />}\n      >\n        <ProjectViewPane />\n      </DefaultToolWindow>\n    ),\n    initialState: toolWindowState({ isVisible: true, weight: 0.22 }),\n  },\n  {\n    id: \"terminal\",\n    title: \"Terminal\",\n    icon: \"toolwindows/toolWindowProject\",\n    element: (\n      <DefaultToolWindow headerContent=\"Terminal\">\n        <Terminal />\n      </DefaultToolWindow>\n    ),\n    initialState: toolWindowState({ anchor: \"bottom\" }),\n  },\n  {\n    id: \"commit\",\n    title: \"Commit\",\n    icon: \"toolwindows/toolWindowCommit\",\n    element: (\n      <MultiContentToolWindow>\n        <MultiContentToolWindowContent\n          tabContent={\n            <>\n              Commit to <CurrentBranchName />\n            </>\n          }\n          key=\"commit\"\n        >\n          <ChangesViewPane />\n        </MultiContentToolWindowContent>\n      </MultiContentToolWindow>\n    ),\n    initialState: toolWindowState({ anchor: \"left\", isVisible: false }),\n  },\n].filter(\n  ({ id }) =>\n    id !== \"commit\" /*FIXME: remove this when change window is good enough*/\n);\nexport const windowById = indexBy(({ id }) => id, windows);\n","import { atom, useRecoilState } from \"recoil\";\nimport { ToolWindowsState, ViewMode } from \"@intellij-platform/core\";\nimport { filter, map } from \"ramda\";\nimport { windowById } from \"./toolWindows\";\nimport { useRef } from \"react\";\n\nexport const toolWindowsState = atom({\n  key: \"toolWindows\",\n  default: new ToolWindowsState(\n    map(({ initialState }) => initialState, windowById)\n  ),\n});\n\ninterface ToolWindowsManager {\n  toggleHideAll(): void;\n}\n\nexport const useToolWindowsManager = (): ToolWindowsManager => {\n  const [state, setState] = useRecoilState(toolWindowsState);\n  const hideAllIdsToRestore = useRef<string[]>([]);\n\n  const toggleHideAll = (): void => {\n    const viewModes: ViewMode[] = [\n      \"docked_unpinned\",\n      \"docked_pinned\",\n      \"undock\",\n    ];\n    const idsToHide = Object.keys(\n      filter(\n        ({ viewMode, isVisible }) => isVisible && viewModes.includes(viewMode),\n        state.windows\n      )\n    );\n    if (idsToHide.length > 0) {\n      hideAllIdsToRestore.current = idsToHide;\n      setState(\n        state.mapWindows((toolWindow, id) =>\n          idsToHide.includes(id)\n            ? {\n                ...toolWindow,\n                isVisible: false,\n              }\n            : toolWindow\n        )\n      );\n    } else {\n      setState(\n        state.mapWindows((toolWindow, id) =>\n          hideAllIdsToRestore.current.includes(id)\n            ? {\n                ...toolWindow,\n                isVisible: true,\n              }\n            : toolWindow\n        )\n      );\n    }\n  };\n  return {\n    toggleHideAll,\n  };\n};\n","import { Monaco } from \"@monaco-editor/react\";\nimport { MenuItemLayout, PlatformIcon, styled } from \"@intellij-platform/core\";\nimport { EditorTabs, TabItem } from \"@intellij-platform/core/Tabs\";\nimport { EditorTabContent } from \"@intellij-platform/core/Tabs/EditorTabs\";\nimport { useLatest } from \"@intellij-platform/core/utils/useLatest\";\nimport { editor, languages } from \"monaco-editor\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport {\n  useRecoilValue,\n  useRecoilValueLoadable,\n  useSetRecoilState,\n} from \"recoil\";\nimport { getIconForFile } from \"../file-utils\";\nimport { LoadingGif } from \"../LoadingGif\";\nimport { Editor } from \"./Editor\";\nimport {\n  activeEditorTabState,\n  editorRefState,\n  useEditorStateManager,\n} from \"./editor.state\";\nimport { fileContent } from \"../fs/fs.state\";\nimport { useUpdateFileStatus } from \"../VersionControl/file-status.state\";\nimport { FileStatusColor } from \"../VersionControl/FileStatusColor\";\nimport { useToolWindowsManager } from \"../Project/toolWindows.state\";\nimport * as path from \"path\";\n\n/**\n * Used as main content in the main ToolWindows. Shows currently opened files tabs and the editor.\n *\n * TODO: preserve editor state when switching between tabs\n * TODO: support multiple editors in split view.\n */\nexport const FileEditor = () => {\n  const { tabs, closePath, select: selectTab } = useEditorStateManager();\n  const toolWindowsManager = useToolWindowsManager();\n  const activeTab = useRecoilValue(activeEditorTabState);\n  const editorRef = useRef<editor.IEditor>();\n  const [active, setActive] = useState(false);\n\n  // For functions that are needed in tab action callbacks. Because items are cached and referencing anything\n  // other than the collection item (tab) itself has a risk of working with stale data because of the caching\n  // More info: https://react-spectrum.adobe.com/react-stately/collections.html#why-not-array-map\n  // We can alternatively switch to mapping over tabs array, instead of using the Collection's dynamic api (items),\n  // which is subject to this caching.\n  const tabActionsRef = useLatest({ closePath });\n  const toolWindowsManagerRef = useLatest(toolWindowsManager);\n\n  const setEditorRef = useSetRecoilState(editorRefState);\n\n  const fileContentState = fileContent(activeTab?.filePath);\n  const contentLoadable = useRecoilValueLoadable(fileContentState);\n  const setContent = useSetRecoilState(fileContentState);\n  const updateFileStatus = useUpdateFileStatus();\n\n  const updateContent = (newContent: string = \"\") => {\n    setActive(false);\n    setContent(newContent);\n    updateFileStatus(activeTab.filePath).catch((e) => {\n      console.error(\"Could not update file status\", e);\n    });\n  };\n\n  // For now, when the first tab content is changed, we focus the editor.\n  // FIXME when action system is implemented and there is an action like \"open project file\".\n  // Note that it's event currently buggy\n  useEffect(() => {\n    editorRef.current?.focus();\n    if (activeTab?.editorState.cursorPos) {\n      editorRef.current?.setPosition(activeTab?.editorState.cursorPos);\n    }\n  }, [activeTab?.filePath]);\n\n  const content = contentLoadable.valueMaybe();\n\n  return (\n    <StyledFileEditorContainer\n      onFocus={() => {\n        setActive(true);\n        setEditorRef({\n          focus: () => editorRef.current?.focus(),\n        });\n      }}\n    >\n      {tabs.length > 0 && (\n        <EditorTabs\n          items={tabs}\n          active={active}\n          selectedKey={activeTab?.filePath}\n          onSelectionChange={(key) =>\n            selectTab(tabs.findIndex((tab) => tab.filePath === key))\n          }\n          noBorders\n        >\n          {(tab) => {\n            const filename = path.basename(tab.filePath);\n            const icon = <PlatformIcon icon={getIconForFile(tab.filePath)} />;\n            return (\n              <TabItem\n                key={tab.filePath}\n                textValue={filename}\n                inOverflowMenu={\n                  <MenuItemLayout content={filename} icon={icon} />\n                }\n              >\n                <EditorTabContent\n                  icon={icon}\n                  title={\n                    <FileStatusColor filepath={tab.filePath}>\n                      {filename}\n                    </FileStatusColor>\n                  }\n                  onClose={() => {\n                    tabActionsRef.current.closePath(tab.filePath);\n                  }}\n                  containerProps={{\n                    onDoubleClick: () => {\n                      toolWindowsManagerRef.current.toggleHideAll();\n                    },\n                  }}\n                />\n              </TabItem>\n            );\n          }}\n        </EditorTabs>\n      )}\n      {activeTab && (\n        <Editor\n          height=\"100%\"\n          path={activeTab.filePath}\n          onMount={(monacoEditor, monaco) => {\n            monacoEditor.focus();\n            enableJsx(monaco);\n            editorRef.current = monacoEditor;\n          }}\n          onChange={updateContent}\n          value={typeof content === \"string\" ? content : \"UNSUPPORTED CONTENT\"}\n        />\n      )}\n      {contentLoadable.state === \"loading\" && <FileEditorLoading />}\n    </StyledFileEditorContainer>\n  );\n};\n\nconst StyledFileEditorContainer = styled.div`\n  position: relative;\n  height: 100%;\n  background: ${({ theme }) =>\n    theme.color(\n      \"Editor.background\",\n      theme.isUnderDarcula()\n        ? \"rgb(40,40,40)\"\n        : theme.commonColors.panelBackground // FIXME: ColorUtil.darker(theme.commonColors.panelBackground, 3)\n    )};\n`;\n\nconst FileEditorLoading = styled(LoadingGif)`\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n`;\n\nfunction enableJsx(monaco: Monaco) {\n  monaco.languages.typescript.typescriptDefaults.setCompilerOptions({\n    jsx: languages.typescript.JsxEmit.React,\n  });\n\n  monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({\n    noSemanticValidation: false,\n    noSyntaxValidation: false,\n  });\n}\n","import { PlatformIcon, ToolWindows } from \"@intellij-platform/core\";\nimport React from \"react\";\nimport { FileEditor } from \"../Editor/FileEditor\";\nimport { useInitializeVcs } from \"../VersionControl/file-status.state\";\nimport { windowById } from \"./toolWindows\";\nimport { useRecoilState } from \"recoil\";\nimport { toolWindowsState } from \"./toolWindows.state\";\nimport { useInitializeChanges } from \"../VersionControl/Changes/change-lists.state\";\n\nexport const Project = () => {\n  const [state, setState] = useRecoilState(toolWindowsState);\n\n  useInitializeVcs();\n  useInitializeChanges();\n\n  return (\n    <ToolWindows\n      height={\"100vh\"}\n      toolWindowsState={state}\n      onToolWindowStateChange={setState}\n      renderToolbarButton={(id) => (\n        <>\n          <PlatformIcon icon={windowById[id].icon} />\n          &nbsp;\n          {windowById[id].title}\n        </>\n      )}\n      renderWindow={(id) => windowById[id].element}\n    >\n      <FileEditor />\n    </ToolWindows>\n  );\n};\n","import React, { useEffect, useState } from \"react\";\nimport { sampleRepo } from \"./Project/project.state\";\nimport { fs, WaitForFs } from \"./fs/fs\";\nimport { clone } from \"isomorphic-git\";\nimport http from \"isomorphic-git/http/web\";\nimport styled from \"styled-components\";\nimport { MAC_WINDOW_SHADOW } from \"@intellij-platform/core/style-constants\";\n\nconst StyledDialog = styled.div`\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  background: ${({ theme }) => theme.color(\"*.background\")};\n  color: ${({ theme }) => theme.color(\"*.foreground\")};\n  ${MAC_WINDOW_SHADOW};\n  text-align: center;\n  line-height: 1.5;\n`;\nconst StyledDialogHeader = styled.div`\n  background: ${({ theme }) => theme.color(\"Popup.Header.activeBackground\")};\n  padding: 4px;\n  text-align: center;\n`;\nconst StyledDialogContent = styled.div`\n  padding: 8px 16px;\n`;\n\nasync function isSuccessfullyCloned(dir: string) {\n  try {\n    const stats = await fs.promises.stat(dir);\n    if (!stats.isDirectory()) {\n      console.info(`Not a successful Clone. \"${dir}\" is not a directory.`);\n      return false;\n    }\n    const files = await fs.promises.readdir(dir);\n    if (files.length === 1 && files[0] === \".git\") {\n      console.info(\n        `Not a successful Clone. \".git\" folder exists, but it's not successfully unpacked.`\n      );\n      return false;\n    }\n  } catch (e) {\n    console.info(`Not a successful Clone. \"${dir}\" doesn't exist`);\n    return false;\n  }\n  return true;\n}\n\nexport const SampleRepoInitializer: React.FC = ({ children }) => {\n  const [state, setState] = useState<\n    \"error\" | \"cloning\" | \"uninitialized\" | \"initialized\"\n  >(\"uninitialized\");\n  useEffect(() => {\n    async function init(dir: string, repoUrl: string) {\n      if (!(await isSuccessfullyCloned(dir))) {\n        setState(\"cloning\");\n        await cloneRepo(dir, repoUrl);\n      }\n    }\n\n    init(sampleRepo.path, sampleRepo.url)\n      .then(() => {\n        console.log(\"demo repo initialized\");\n        setState(\"initialized\");\n      })\n      .catch((e) => {\n        console.error(\"could not initialize the demo repo\", e);\n        setState(\"error\");\n      });\n  }, []);\n\n  if (state === \"uninitialized\") {\n    return null;\n  }\n  if (state === \"initialized\") {\n    return <>{children}</>;\n  }\n  return (\n    <WaitForFs>\n      <StyledDialog>\n        <StyledDialogHeader>Cloning sample repo</StyledDialogHeader>\n        <StyledDialogContent>\n          {state === \"cloning\" ? (\n            <>\n              Cloning <b>{sampleRepo.url}</b>. <br />\n              It may take several seconds.\n            </>\n          ) : (\n            <>Something went wrong!</>\n          )}\n        </StyledDialogContent>\n      </StyledDialog>\n    </WaitForFs>\n  );\n};\n\nasync function cloneRepo(dir: string, repoUrl: string) {\n  console.log(\"cloning repo: \");\n  await clone({\n    fs,\n    url: repoUrl,\n    http,\n    corsProxy: \"https://cors.isomorphic-git.org\",\n    dir,\n    singleBranch: true,\n  });\n}\n","import React from \"react\";\nimport { RecoilRoot } from \"recoil\";\nimport { DefaultSuspense } from \"./DefaultSuspense\";\nimport { Project } from \"./Project/Project\";\nimport { SampleRepoInitializer } from \"./SampleRepoInitializer\";\n\nexport const App = () => {\n  return (\n    <DefaultSuspense>\n      <SampleRepoInitializer>\n        <RecoilRoot>\n          <Project />\n        </RecoilRoot>\n      </SampleRepoInitializer>\n    </DefaultSuspense>\n  );\n};\n","import { App } from \"./App\";\n\nexport { App };\nexport default App;\n"],"names":["LoadingGif","props","Img","src","darkSrc","Loading","styled","DefaultSuspense","fallback","children","FILE_ICON","DIR_ICON","extensionIconMap","editorconfig","js","gitignore","archive","as","config","css","dtd","hpr","htaccess","html","idl","java","jfr","json","jsp","jspx","manifest","properties","txt","wsdl","xhtml","xml","xsd","yaml","getIconForFile","filepath","extension","getExtension","split","pop","getParentPaths","upperLimit","path","getParentPathsRecursive","previousPaths","dirname","concat","darculaColorSchemeTokenRules","vsCodeTheme","scope","settings","flatMap","map","token","values","Object","keys","forEach","key","value","StyledEditor","MonacoEditor","Editor","editorTheme","monaco","useMonaco","theme","useTheme","themeName","setThemeName","useState","dark","useLayoutEffect","name","replace","editor","defineTheme","base","inherit","colors","rules","useEditorTheme","options","minimap","enabled","lineHeight","showFoldingControls","renderIndentGuides","scrollbar","verticalScrollbarSize","verticalSliderSize","fs","fsResource","promise","response","status","suspender","then","res","err","read","wrapPromise","async","Promise","resolve","BrowserFS","console","error","promises","pify","createBrowserFsBackend","createFS","theFs","WaitForFs","dirContentState","selectorFamily","get","fileNames","log","readdir","e","all","fileName","filePath","stat","type","isDirectory","size","fileContent","atomFamily","default","readFile","encoding","effects","onSet","content","catch","filterPath","includes","sampleRepo","url","currentProjectState","atom","projectFilePath","projectRelativePath","currentProjectFilesState","selector","project","items","files","addItem","item","childItems","push","temporaryTabsDefaultValue","sortWith","descend","file","endsWith","filter","slice","editorState","cursorPos","lineNumber","column","editorTabsState","activeEditorTabIndexState","activeEditorTabState","editorRefState","useEditorStateManager","tabsState","setTabsState","useRecoilState","setActiveTabIndex","useSetRecoilState","focus","useRecoilCallback","snapshot","getLoadable","valueOrThrow","select","index","closeTab","_","tabIndex","tabs","openPath","shouldFocus","findIndex","tab","newIndex","length","currentState","closePath","Math","max","convertGitStatus","Array","isArray","vcsRootsState","dir","vcs","VcsRootForFile","find","root","startsWith","fileStatusState","useInitializeVcs","updateVcsFileStatuses","transact_UNSTABLE","vcsDirectoryMappings","getPromise","rows","statusMatrix","set","row","useEffect","FileStatusColor","color","fileStatus","useRecoilValue","useFileStatusColor","style","foldersOnTopState","expandedKeysState","Set","selectedKeysState","projectViewTreeRefState","dangerouslyAllowMutability","currentProjectTreeState","rootItems","mapItem","parent","node","dirNode","createProjectTree","expandToPathCallback","expandedKeys","keysToExpand","selectKeyAndFocusCallback","treeRef","current","replaceSelection","StyledTreeNodeWrapper","SelectionAwareSpan","className","isSelected","isFocused","useContext","ItemStateContext","undefined","StyledTreeNodeHint","commonColors","inactiveTextColor","ProjectViewPane","useRef","setProjectViewTreeRef","projectTree","setExpandedKeys","selectedKeys","setSelectedKeys","sortItems","sortBy","a","identity","SpeedSearchTree","ref","onAction","fillAvailableSpace","disallowEmptySelection","selectionMode","onSelectionChange","onExpandedChange","Item","textValue","ProjectViewNodeIcon","HighlightedTextValue","FileTreeNodeText","FileTreeDirNodeText","FileTreeFileNodeText","state","nodeTypeIconMap","icon","StyledListIconWrapper","PlatformIcon","getExpandAllKeys","getChildren","getKey","roots","processItem","flat","ProjectViewActionButtons","activeTab","expandToOpenedFile","selectKeyAndFocus","ActionButton","onPress","isDisabled","StyledXterm","XTerm","Terminal","input","setInput","xtermRef","useMemo","background","selection","fontFamily","letterSpacing","fontSize","cursorStyle","cursorBlink","cursorWidth","rendererType","setTimeout","terminal","resize","write","onData","data","code","charCodeAt","changeListsState","id","comment","changes","after","isDir","before","active","isAChange","changeList","changeLists","head","workingDir","stage","refreshChanges","gitRoots","useChangeListManager","addChangeList","Error","editChangeList","edits","mergeChangeLists","sourceId","targetId","moveChange","change","toChangeListId","removeChangeList","setActiveChangeList","refresh","groupings","title","isAvailable","groupFn","nodes","repository","repositoryNode","constSelector","pathToNodeCache","rootDirNodes","reduce","prevNode","dirPath","directoryNode","parentNodePath","collapseDirectories","isDirectoryNode","child","uniq","currentBranchState","showIgnoredFilesState","showRelatedFilesState","changesGroupingState","selectedChangesState","selectedChangesNestedSelection","getCallback","rootNodes","changesTreeNodesState","selectedChangeKeys","setValue","NestedSelection","createMapSetInterface","isGroupNode","availableGroupingsState","grouping","isRecoilValue","isActive","changeBrowserNodeKey","changeListNode","i","changeNode","isChangeNode","recursiveGrouping","groupingFns","nextGroupingFns","changeNodes","groupNodes","groups","groupNode","groupFns","groupChanges","fileCountsMap","Map","visit","dfs","dfsVisit","childrenFileCount","fileCount","total","count","ViewOptionsActionButton","showRelatedFiles","setShowRelatedFiles","showIgnoredFiles","setShowIgnoredFiles","viewOptions","ActionButtonWithMenu","renderMenu","menuProps","close","Menu","GroupByActionButton","availableGroupings","toggleGroup","Section","ChangeListsActionButton","alert","MenuItemLayout","StyledRepoColorSquare","useRepoRootColor","rootPath","red","blue","RepoColorIcon","backgroundColor","CurrentBranchName","repo","branch","StyledCurrentBranchTag","Color","withTransparency","toString","fileCountMsg","IntlMessageFormat","ChangeNodeHint","isGroupedByDirectory","nodeRenderers","element","format","directory","changelist","fontWeight","ChangeViewTree","nestedSelection","SpeedSearchTreeWithCheckboxes","dirCount","hasChildItems","TreeNodeCheckbox","selectionState","getSelectionState","onToggle","toggle","StyledContainer","ChangesViewPane","expandAll","valueMaybe","ActionToolbar","hasBorder","ActionToolbarSeparator","windows","DefaultToolWindow","headerContent","additionalActions","initialState","toolWindowState","isVisible","weight","anchor","MultiContentToolWindow","MultiContentToolWindowContent","tabContent","windowById","indexBy","toolWindowsState","ToolWindowsState","FileEditor","selectTab","toolWindowsManager","setState","hideAllIdsToRestore","toggleHideAll","viewModes","idsToHide","viewMode","mapWindows","toolWindow","useToolWindowsManager","editorRef","setActive","tabActionsRef","useLatest","toolWindowsManagerRef","setEditorRef","fileContentState","contentLoadable","useRecoilValueLoadable","setContent","updateFileStatus","repoRoot","setPosition","StyledFileEditorContainer","onFocus","selectedKey","noBorders","filename","inOverflowMenu","onClose","containerProps","onDoubleClick","height","onMount","monacoEditor","languages","typescript","typescriptDefaults","setCompilerOptions","jsx","setDiagnosticsOptions","noSemanticValidation","noSyntaxValidation","enableJsx","onChange","newContent","FileEditorLoading","isUnderDarcula","panelBackground","Project","useInitializeChanges","ToolWindows","onToolWindowStateChange","renderToolbarButton","renderWindow","StyledDialog","MAC_WINDOW_SHADOW","StyledDialogHeader","StyledDialogContent","SampleRepoInitializer","repoUrl","info","isSuccessfullyCloned","clone","http","corsProxy","singleBranch","cloneRepo","init","App"],"sourceRoot":""}