{"version":3,"file":"assets/js/89dea562.fe0500fc.js","mappings":"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","sources":["webpack://website/../jui/src/ActionButton/ActionButton.tsx","webpack://website/../jui/src/ActionToolbar/ActionToolbar.tsx","webpack://website/../jui/src/Collections/Divider.ts","webpack://website/../jui/src/Collections/ItemStateContext.tsx","webpack://website/../jui/src/Icon/StyledIconWrapper.tsx","webpack://website/../jui/src/utils/useForwardedRef.ts","webpack://website/../jui/src/Icon/useSvgIcon.tsx","webpack://website/../jui/src/Icon/LafIcon.tsx","webpack://website/../jui/src/Icon/PlatformIcon.tsx","webpack://website/../jui/src/Icon/StyledIconLiveIndicator.tsx","webpack://website/../jui/src/List/ListDivider.tsx","webpack://website/../jui/src/Menu/StyledMenu.tsx","webpack://website/../jui/src/Menu/StyledMenuItem.tsx","webpack://website/../jui/src/Menu/MenuItem.tsx","webpack://website/../jui/src/Menu/Menu.tsx","webpack://website/../jui/src/Menu/MenuItemLayout.tsx","webpack://website/../jui/src/Menu/MenuTrigger.tsx","webpack://website/../jui/src/StyledSeparator.tsx","webpack://website/../jui/src/ToolWindow/FocusScope.tsx","webpack://website/../jui/src/Tree/__tmp__useTreeState.ts","webpack://website/../jui/src/Tree/useTreeRef.tsx","webpack://website/../jui/src/utils/interaction-utils/textSelection.ts","webpack://website/../jui/src/ToolWindow/useMove.tsx","webpack://website/../jui/src/Resizer/useResizer.ts","webpack://website/../jui/src/Resizer/VerticalResizer.tsx","webpack://website/../jui/src/Resizer/TopResizer.tsx","webpack://website/../jui/src/Resizer/BottomResizer.tsx","webpack://website/../jui/src/Resizer/HorizontalResizer.tsx","webpack://website/../jui/src/Resizer/RightResizer.tsx","webpack://website/../jui/src/Resizer/LeftResizer.tsx","webpack://website/../jui/src/ThreeViewSplitter/ThreeViewSplitter.tsx","webpack://website/../jui/src/ResizableView.tsx","webpack://website/../jui/src/ToolWindow/WindowResizeHandles.tsx","webpack://website/../jui/src/ToolWindow/FloatView.tsx","webpack://website/../jui/src/ToolWindow/FloatToolWindows.tsx","webpack://website/../jui/src/ToolWindow/MovableToolWindowStripeProvider.tsx","webpack://website/../jui/src/ToolWindow/StyledToolWindowOuterLayout.tsx","webpack://website/../jui/src/ToolWindow/utils.ts","webpack://website/../jui/src/ToolWindow/ToolWindowsState/ToolWindowsLayoutState.ts","webpack://website/../jui/src/ToolWindow/ToolWindowsState/ToolWindowStateProvider.tsx","webpack://website/../jui/src/ToolWindow/createGetDropPosition.tsx","webpack://website/../jui/src/ToolWindow/StyledToolWindowStripeButton.tsx","webpack://website/../jui/src/Theme/parseColorString.ts","webpack://website/../jui/src/Theme/Color.ts","webpack://website/../jui/src/ToolWindow/StyledToolWindowStripe.tsx","webpack://website/../jui/src/ToolWindow/useElementMove.tsx","webpack://website/../jui/src/ToolWindow/findEffectiveBackgroundColor.tsx","webpack://website/../jui/src/ToolWindow/ToolWindowStripe.tsx","webpack://website/../jui/src/ToolWindow/UndockSide.tsx","webpack://website/../jui/src/ToolWindow/ToolWindows.tsx","webpack://website/../jui/src/ToolWindow/ToolWindowSettingsIconMenu.tsx","webpack://website/../jui/src/ToolWindow/ToolWindowHeader.tsx","webpack://website/../jui/src/ToolWindow/useToolWindow.tsx","webpack://website/../jui/src/ToolWindow/useToolWindowMoveHandle.tsx","webpack://website/../jui/src/ToolWindow/DefaultToolWindow.tsx","webpack://website/../jui/src/ToolWindow/ToolWindowsState/ToolWindowsState.ts","webpack://website/../jui/src/TextWithHighlights/TextWithHighlights.tsx","webpack://website/../jui/src/TextRange.ts","webpack://website/../jui/src/CollectionSpeedSearch/CollectionSpeedSearchContext.tsx","webpack://website/../jui/src/CollectionSpeedSearch/HighlightedTextValue.tsx","webpack://website/../jui/src/Img.tsx","webpack://website/../jui/src/List/StyledList.tsx","webpack://website/../jui/src/utils/keyboard-utils.ts","webpack://website/../jui/src/selection/SelectionManager.ts","webpack://website/../jui/src/SpeedSearch/SpeedSearchPopup.tsx","webpack://website/../jui/src/Tree/useTreeVirtualizer.tsx","webpack://website/../jui/src/List/StyledListItem.tsx","webpack://website/../jui/src/Tree/TreeNodeIcon.tsx","webpack://website/../jui/src/Tree/useTreeNodeToggleButton.tsx","webpack://website/../jui/src/Tree/TreeContext.tsx","webpack://website/../jui/src/Tree/TreeNode.tsx","webpack://website/../jui/src/Tree/useTreeNode.tsx","webpack://website/../jui/src/SpeedSearch/useGhostInput.tsx","webpack://website/../jui/src/utils/string-utils.ts","webpack://website/../jui/src/minusculeMatch.ts","webpack://website/../jui/src/CollectionSpeedSearch/createSpeedSearchSelectionManager.ts","webpack://website/../jui/src/CollectionSpeedSearch/useCollectionSpeedSearchResult.ts","webpack://website/../jui/src/CollectionSpeedSearch/useCollectionSpeedSearch.ts","webpack://website/../jui/src/SpeedSearch/useSpeedSearch.tsx","webpack://website/../jui/src/CollectionSpeedSearch/createSpeedSearchKeyboardDelegate.ts","webpack://website/../jui/src/Tree/TreeKeyboardDelegate.tsx","webpack://website/../jui/src/Tree/useSelectableTree.tsx","webpack://website/../jui/src/selection/useSelectableCollection.ts","webpack://website/../jui/src/Collections/useCollectionAutoScroll.ts","webpack://website/../jui/src/Tree/SpeedSearchTree/SpeedSearchTree.tsx","webpack://website/../jui/src/selection/replaceSelectionManager.ts","webpack://website/../jui/src/Tree/SpeedSearchTree/useSpeedSearchTree.ts","webpack://website/../jui/src/Theme/GithubIconResolver.ts","webpack://website/../jui/src/Theme/cache.decorator.ts","webpack://website/../jui/src/Theme/Theme.ts","webpack://website/../jui/src/style-constants.ts","webpack://website/../jui/src/styled.ts","webpack://website/../jui/src/tabs/EditorTabs/StyledEditorTab.ts","webpack://website/../jui/src/tabs/EditorTabs/StyledEditorTabs.ts","webpack://website/../jui/src/tabs/EditorTabs/EditorTabs.tsx","webpack://website/../jui/src/tabs/EditorTabs/EditorTabContent.tsx","webpack://website/../jui/src/tabs/StyledDefaultTab.ts","webpack://website/../jui/src/tabs/StyledDefaultTabs.ts","webpack://website/../jui/src/tabs/TabCloseButton.tsx","webpack://website/../jui/src/tabs/TabContentLayout.tsx","webpack://website/../jui/src/tabs/TabTheme.ts","webpack://website/../jui/src/tabs/StyledHorizontalOverflowShadows.tsx","webpack://website/../jui/src/tabs/Tab.tsx","webpack://website/../jui/src/tabs/Tabs.tsx","webpack://website/../jui/src/tabs/useIsScrolled.tsx","webpack://website/../jui/src/tabs/useCollectionOverflowObserver.tsx","webpack://website/../jui/src/tabs/TabsOverflowMenu.tsx","webpack://website/../jui/src/tabs/ToolWindowTabs/StyledToolWindowTab.ts","webpack://website/../jui/src/tabs/ToolWindowTabs/StyledToolWindowTabs.ts","webpack://website/../jui/src/tabs/TabItem.tsx","webpack://website/../jui/src/tabs/DebuggerTabs/StyledDebuggerTab.ts","webpack://website/../jui/src/utils/useContextOrThrow.tsx","webpack://website/../jui/src/utils/useLatest.ts","webpack://website/./src/components/ExampleContext.tsx","webpack://website/./src/components/RefToIntellijPlatform.tsx","webpack://website/../jui/src/Menu/Menu.stories.tsx","webpack://website/./docs/components/2-menu.mdx"],"sourcesContent":["import { PressProps, usePress } from \"@react-aria/interactions\";\nimport React, { ForwardedRef } from \"react\";\nimport { styled } from \"../styled\";\n\ninterface ActionButtonProps extends PressProps {\n  children?: React.ReactNode;\n  minSize?: number;\n}\n\nexport const DEFAULT_MINIMUM_BUTTON_SIZE = 22;\nexport const NAVBAR_MINIMUM_BUTTON_SIZE = 20;\n\nexport const StyledActionButton = styled.button<{ minSize: number }>`\n  background: none;\n  color: inherit;\n  border: 1px solid transparent;\n  border-radius: 2px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  min-height: ${({ minSize }) => `${minSize}px`};\n  min-width: ${({ minSize }) => `${minSize}px`};\n  padding: 0;\n  margin: 0;\n  &:disabled {\n    opacity: 0.25; // not quite accurate implementation. There might be better ways to style disabled state.\n  }\n  &:hover:not(:disabled),\n  &:focus:not(:disabled) /* in intellij platform, the button doesn't grab the focus after being active. This is not the case in web,\n  for better accessibility. But there is no existing UI spec for it in intellij platform obviously. So for now, we\n  fallback to the same UI as hover state. Perhaps it can be improved with a opacity or something.*/ {\n    outline: none;\n    background: ${({ theme }) =>\n      theme.color(\"ActionButton.hoverBackground\", \"#DFDFDF\")};\n    border-color: ${({ theme }) =>\n      theme.color(\"ActionButton.hoverBorderColor\", \"#DFDFDF\")};\n  }\n  &:active:not(:disabled),\n  &.active:not(:disabled) {\n    background: ${({ theme }) =>\n      theme.color(\"ActionButton.pressedBackground\", \"#CFCFCF\")};\n    border-color: ${({ theme }) =>\n      theme.color(\"ActionButton.pressedBorderColor\", \"#CFCFCF\")};\n  }\n`;\n\nexport const ActionButton = React.forwardRef(function ActionButton(\n  { minSize = DEFAULT_MINIMUM_BUTTON_SIZE, ...otherProps }: ActionButtonProps,\n  ref: ForwardedRef<HTMLButtonElement>\n) {\n  const { pressProps, isPressed } = usePress(otherProps);\n\n  return (\n    <StyledActionButton\n      className={isPressed ? \"active\" : \"\"}\n      disabled={otherProps.isDisabled}\n      {...pressProps}\n      minSize={minSize}\n      ref={ref}\n    />\n  );\n});\n","import { Theme } from \"@intellij-platform/core/Theme\";\nimport React from \"react\";\nimport { StyledActionButton } from \"../ActionButton/ActionButton\";\nimport { styled } from \"../styled\";\nimport {\n  StyledHorizontalSeparator,\n  StyledVerticalSeparator,\n} from \"../StyledSeparator\";\n\ninterface ActionToolbarProps {\n  orientation?: \"vertical\" | \"horizontal\";\n  /**\n   * Whether to include a border to the bottom/right the toolbar, or not.\n   */\n  hasBorder?: boolean;\n}\nconst StyledActionToolbar = styled.div`\n  display: flex;\n`;\n\nconst getBorder = ({\n  theme,\n  hasBorder,\n}: {\n  theme: Theme;\n  hasBorder?: boolean;\n}) =>\n  hasBorder\n    ? `1px solid ${theme.color(\n        \"Borders.color\",\n        theme.dark ? \"rgb(50,50,50)\" : \"rgb(192, 192, 192)\"\n      )}`\n    : \"none\";\nconst StyledHorizontalActionToolbar = styled(StyledActionToolbar)<{\n  hasBorder?: boolean;\n}>`\n  padding: 2px 0;\n  border-bottom: ${getBorder};\n  ${StyledHorizontalSeparator} {\n    margin: 1px 3px;\n  }\n  // NOTE: in the original implementation, there is no empty space between buttons, but buttons have kind of an\n  // invisible left padding, which is mouse-intractable, but doesn't visually seem a part of the button.\n  // Although implementable, it didn't seem necessary to follow the exact same thing. Margin should be fine.\n  ${StyledActionButton} {\n    margin: 0 2px 0 1px;\n  }\n`;\n\nconst StyledVerticalActionToolbar = styled(StyledActionToolbar)<{\n  hasBorder?: boolean;\n}>`\n  flex-direction: column;\n  padding: 0 2px;\n  border-right: ${getBorder};\n\n  ${StyledVerticalSeparator} {\n    margin: 4px 1px;\n  }\n  ${StyledActionButton} {\n    margin: 2px 0 1px 0;\n  }\n`;\n\n/**\n * Remaining features:\n * - overflow behaviour:\n *   - wrap. like main action toolbar.\n *   - hidden, shown by arrow. Similar to actions in Git->Log. Note that the behaviour for horizontal and vertical\n *     modes are different apparently.\n */\nexport const ActionToolbar: React.FC<ActionToolbarProps> = ({\n  orientation = \"horizontal\",\n  hasBorder = false,\n  children,\n}) => {\n  return orientation === \"horizontal\" ? (\n    <StyledHorizontalActionToolbar hasBorder={hasBorder}>\n      {children}\n    </StyledHorizontalActionToolbar>\n  ) : (\n    <StyledVerticalActionToolbar hasBorder={hasBorder}>\n      {children}\n    </StyledVerticalActionToolbar>\n  );\n};\n","/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport { ItemProps } from \"@react-types/shared\";\nimport { ReactElement } from \"react\";\nimport { PartialNode } from \"@react-stately/collections\";\n\ninterface DividerProps {}\nexport function Divider({}: DividerProps): ReactElement {\n  // eslint-disable-line @typescript-eslint/no-unused-vars\n  return null as any;\n}\n\nDivider.getCollectionNode = function* getCollectionNode<T>(\n  props: ItemProps<T>\n): Generator<PartialNode<T>> {\n  let rendered = null;\n\n  yield {\n    type: \"divider\",\n    element: null as any, // to prevent check on key, which is not necessary for divider\n    props: props,\n    rendered,\n    hasChildNodes: false,\n  };\n};\n\n/**\n * To be used in dynamic collections, just to provide a key and make it easy to check in the render\n * function to figure out what to render (an Item or a Divider)\n */\nexport class DividerItem {\n  private static seq = 0;\n  key = \"divider_\" + DividerItem.seq++;\n}\n","import React from \"react\";\n\n/**\n * Generic state of items in collections, provided via a context.\n * To be used in Menu, Tree, or anything that deals with a collection of items for which the common states like\n * **disabled** or **selected** is applicable.\n */\nexport interface ItemStateContextType {\n  isSelected: boolean;\n  isFocused: boolean;\n  isDisabled: boolean;\n}\n\nexport const ItemStateContext = React.createContext<ItemStateContextType | null>(\n  null\n);\n","import { styled } from \"../styled\";\n\nexport type IconSize = 16;\nconst DEFAULT_ICON_SIZE: IconSize = 16;\nexport const StyledIconWrapper = styled.span<{\n  size?: IconSize;\n  useCurrentColor?: boolean;\n}>`\n  box-sizing: border-box;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  line-height: 0;\n  width: ${({ size = DEFAULT_ICON_SIZE }) => `${size}px`};\n  height: ${({ size = DEFAULT_ICON_SIZE }) => `${size}px`};\n  position: relative; // to allow absolute positioned indicators and overlays on icon\n`;\n","import React, { useRef } from \"react\";\n\n/**\n * For when a component needs to forward ref, but it too needs to use the same ref. Since forwarded ref can be in form\n * of a callback too, this will normalize it as a RefObject.\n * NOTE: Should we keep the ref in state because of edge cases?\n */\nexport default function useForwardedRef<T>(\n  forwardedRef: React.Ref<T>\n): React.RefObject<T> {\n  const innerRef = useRef<T>(null);\n  React.useEffect(() => {\n    if (!forwardedRef) {\n      return;\n    }\n\n    if (typeof forwardedRef === \"function\") {\n      forwardedRef(innerRef.current);\n    } else {\n      (forwardedRef as React.MutableRefObject<T | null>).current =\n        innerRef.current;\n    }\n  });\n\n  return innerRef;\n}\n","import { RefObject, useEffect } from \"react\";\nimport { useTheme } from \"styled-components\";\nimport { Theme } from \"../Theme/Theme\";\n\nexport function useSvgIcon(\n  { path, fallbackPath }: { path: string; fallbackPath?: string },\n  /**\n   * ref to the icon wrapper element in which the svg should be injected.\n   * This hook used to return svg string, and that svg was set as dangerouslySetInnerHTML. But now it injects the svg.\n   * by direct DOM manipulation. That's to eliminate the need for using dangerouslySetInnerHTML, so that we can allow\n   * arbitrary children (like LiveIndicator) as overlays on top of icons.\n   */\n  ref: RefObject<HTMLElement>\n) {\n  const theme = useTheme() as Theme; // TODO: investigate why useTheme is typed like this\n  useEffect(() => {\n    let unmounted = false;\n    const fetchIcon = async () => {\n      if (!path) {\n        console.error(\"icon path is empty\");\n        return;\n      }\n      const svg = await theme.getSvgIcon(path).catch((e) => {\n        if (fallbackPath) {\n          return theme.getSvgIcon(fallbackPath);\n        }\n        throw e;\n      });\n\n      if (svg) {\n        if (!unmounted && ref?.current) {\n          if (ref) {\n            // potential SSR issues here?\n            ref.current?.querySelector(\"svg\")?.remove();\n            const svgElement = document.createElement(\"svg\");\n            ref.current?.appendChild(svgElement);\n            svgElement.outerHTML = svg;\n          }\n        }\n      } else {\n        console.error(\"Could not resolve icon:\", path);\n      }\n    };\n    fetchIcon().catch(console.error);\n    return () => {\n      unmounted = true;\n    };\n  }, [path]);\n}\n","import useForwardedRef from \"@intellij-platform/core/utils/useForwardedRef\";\nimport React, { ForwardedRef } from \"react\";\nimport { useTheme } from \"styled-components\";\nimport { Theme } from \"../Theme/Theme\";\nimport { IconProps } from \"./IconProps\";\nimport { StyledIconWrapper } from \"./StyledIconWrapper\";\nimport { useSvgIcon } from \"./useSvgIcon\";\n\ninterface IconModifiers {\n  Selected?: boolean;\n  Focused?: boolean;\n  Disabled?: boolean;\n  Editable?: boolean;\n  Pressed?: boolean;\n}\ninterface ThemeIconProps extends IconProps {\n  /**\n   * Icon which will be resolved against the default icon location based on theme type\n   */\n  icon: string | { name: string; modifiers: IconModifiers };\n\n  /**\n   * A theme key that can optionally override the icon.\n   */\n  themePath?: string;\n}\n\nconst ICONS_DIR_PREFIX = \"/com/intellij/ide/ui/laf/icons/\";\n\n// Similar to LafIconLookup\nfunction findIconPath(\n  theme: Theme,\n  name: string,\n  modifiers: IconModifiers = {}\n) {\n  const basePath = `${ICONS_DIR_PREFIX}${\n    theme.isUnderDarcula() ? \"darcula/\" : \"intellij/\"\n  }`;\n  const suffix = ([\n    \"Editable\",\n    \"Selected\",\n    \"Pressed\",\n    \"Focused\",\n    \"Disabled\",\n  ] as Array<keyof typeof modifiers>).reduce(\n    (soFar, modifier) => soFar + (modifiers[modifier] ? modifier : \"\"),\n    \"\"\n  );\n  return `${basePath}${name}${suffix}.svg`;\n}\n\nfunction useIconPath(\n  iconDescriptor: string | { name: string; modifiers?: IconModifiers },\n  themePath?: string\n) {\n  const theme = useTheme() as Theme; // TODO: investigate why useTheme is typed like this\n  const resolvedValue = themePath && theme.value(themePath);\n  if (resolvedValue) {\n    return resolvedValue;\n  }\n  const { modifiers = {}, name } =\n    typeof iconDescriptor === \"string\"\n      ? { name: iconDescriptor }\n      : iconDescriptor;\n  return findIconPath(theme, name, modifiers);\n}\n\nexport const LafIcon = React.forwardRef(\n  (\n    { themePath, icon, size, ...props }: ThemeIconProps,\n    forwardedRef: ForwardedRef<HTMLElement>\n  ) => {\n    const resolvedIconPath = useIconPath(icon, themePath);\n\n    const ref = useForwardedRef(forwardedRef);\n    useSvgIcon({ path: `platform/platform-impl/src/${resolvedIconPath}` }, ref);\n    return <StyledIconWrapper {...props} ref={ref} />;\n  }\n);\n","import useForwardedRef from \"@intellij-platform/core/utils/useForwardedRef\";\nimport React, { ForwardedRef } from \"react\";\nimport { useTheme } from \"styled-components\";\nimport { Theme } from \"../Theme/Theme\";\nimport { IconProps } from \"./IconProps\";\nimport { StyledIconWrapper } from \"./StyledIconWrapper\";\nimport { useSvgIcon } from \"./useSvgIcon\";\n\ninterface PlatformIconProps extends IconProps {\n  icon: string;\n  darkIcon?: string;\n}\n\nexport const getDarkPath = (path: string, darkPath?: string) => {\n  const [name, ext] = path.split(\".\");\n  return darkPath || `${name}_dark${ext ? `.${ext}` : \"\"}`;\n};\n\nconst getPlatformIconPath = (relativePath: string) =>\n  `platform/icons/src/${relativePath}`;\n\n/**\n * Renders an icon from the predefined list of platform icons.\n * icon name must follow the directory structure in platform icons.\n * @example <PlatformIcon icon=\"general/hideToolWindow\" />\n * @example <PlatformIcon icon=\"toolbar/pin\" />\n * @example <PlatformIcon icon=\"toolbar/pin.svg\" />\n */\nexport const PlatformIcon = React.forwardRef(\n  (\n    { icon, darkIcon, size, ...props }: PlatformIconProps,\n    forwardedRef: ForwardedRef<HTMLElement>\n  ) => {\n    const ref = useForwardedRef(forwardedRef);\n    const theme = useTheme() as Theme; // TODO: investigate why useTheme is typed like this\n    const iconName = theme.dark ? getDarkPath(icon, darkIcon) : icon;\n    useSvgIcon(\n      {\n        path: getPlatformIconPath(iconName),\n        fallbackPath: getPlatformIconPath(icon),\n      },\n      ref\n    );\n\n    return <StyledIconWrapper {...props} ref={ref} />;\n  }\n);\n","import React from \"react\";\nimport styled from \"styled-components\";\n\n/**\n * Green circle indicator used with icons.\n * Reference: platform/execution/src/com/intellij/execution/runners/IndicatorIcon.kt\n */\nexport const StyledIconLiveIndicator = styled.span`\n  position: absolute;\n  width: 4px;\n  height: 4px;\n  border-radius: 1000px;\n  background: #00ff00;\n  box-shadow: 0.5px 0.5px 1px 1px rgba(0, 0, 0, 0.4);\n  bottom: 1px;\n  right: 1px;\n`;\n","import React from \"react\";\nimport { StyledVerticalSeparator } from \"../StyledSeparator\";\nimport { useSeparator } from \"@react-aria/separator\";\n\nexport const ListDivider: React.FC = () => {\n  return (\n    <StyledVerticalSeparator\n      as={\"li\"}\n      {...useSeparator({ orientation: \"vertical\" })}\n    />\n  );\n};\n","import { isMac } from \"@react-aria/utils\";\nimport { css } from \"styled-components\";\nimport { MAC_WINDOW_SHADOW } from \"../style-constants\";\nimport { styled } from \"../styled\";\nimport { StyledVerticalSeparator } from \"../StyledSeparator\";\nimport { Theme, UnknownThemeProp } from \"../Theme/Theme\";\n\nexport const MENU_VERTICAL_PADDING = 5;\nexport const MENU_BORDER_WIDTH = 1;\n\nexport const StyledMenu = styled.ul`\n  font-size: 0.92rem;\n  margin: 0;\n  padding: ${MENU_VERTICAL_PADDING}px 0;\n  outline: none;\n  list-style: none;\n  width: fit-content;\n  min-width: 100px;\n  border: ${MENU_BORDER_WIDTH}px solid\n    ${({ theme }) => theme.color(\"Menu.borderColor\")};\n  ${isMac() &&\n  css<{ theme: Theme }>`\n    ${MAC_WINDOW_SHADOW};\n    border-color: ${({ theme }) =>\n      theme.dark ? \"rgba(0, 0, 0, 0.15)\" : undefined};\n  `}\n  background: ${({ theme }) =>\n    theme.color(\"PopupMenu.background\" as UnknownThemeProp)};\n  color: ${({ theme }) =>\n    theme.color(\"PopupMenu.foreground\" as UnknownThemeProp)};\n\n  ${StyledVerticalSeparator} {\n    background-color: ${({ theme }) =>\n      theme.color(\"Menu.separatorColor\" as UnknownThemeProp)};\n    height: ${({ theme }) =>\n      `${theme.value(\"PopupMenuSeparator.height\" as UnknownThemeProp) ?? 3}px`};\n    padding: ${({ theme }) =>\n      `${\n        theme.value(\"PopupMenuSeparator.stripeIndent\" as UnknownThemeProp) ?? 1\n      }px 0`};\n  }\n`;\n","import { css } from \"styled-components\";\nimport { styled } from \"../styled\";\nimport { UnknownThemeProp } from \"../Theme/Theme\";\n\nexport const StyledMenuItem = styled.li<{\n  isDisabled: boolean;\n  isActive: boolean;\n}>`\n  position: relative; // for being able to position arrow icon absolutely\n  outline: none;\n  cursor: default;\n  white-space: nowrap;\n  color: ${({ isActive, isDisabled, theme }) => {\n    if (isDisabled) {\n      return theme.color(\"MenuItem.disabledForeground\");\n    }\n    if (isActive) {\n      return theme.color(\"MenuItem.selectionForeground\" as UnknownThemeProp);\n    }\n    return theme.color(\"MenuItem.foreground\" as UnknownThemeProp);\n  }};\n  ${({ isActive, theme }) =>\n    isActive &&\n    css`\n      background: ${theme.color(\n        \"MenuItem.selectionBackground\" as UnknownThemeProp\n      )};\n      color: ${undefined};\n      // Kind of a solution for hard coded fill values in svg icons. Is there a better approaches?\n      svg {\n        filter: brightness(2);\n      }\n    `}\n  // would be nice to have a visual clue for focus visible state, but it's not like that in intellij platform\n  //border-left: 3px solid transparent;\n  //&:focus-visible {\n  //  border-left: 3px solid rgba(255, 255, 255, 0.1);\n  //}\n  padding: 0 20px 0 27px;\n  line-height: 1.35; // to make the item have the right height\n  display: flex;\n  align-items: center;\n`;\n","import { useHover, useKeyboard } from \"@react-aria/interactions\";\nimport { useMenuItem } from \"@react-aria/menu\";\nimport { OverlayContainer, useOverlayPosition } from \"@react-aria/overlays\";\nimport { mergeProps } from \"@react-aria/utils\";\nimport { Item } from \"@react-stately/collections\";\nimport { TreeState } from \"@react-stately/tree\";\nimport { Node } from \"@react-types/shared\";\nimport React, { Key } from \"react\";\nimport { ItemStateContext } from \"../Collections/ItemStateContext\";\nimport { LafIcon, PlatformIcon } from \"../Icon\";\n\nimport { styled } from \"../styled\";\nimport { FocusScope } from \"../ToolWindow/FocusScope\";\nimport { Menu } from \"./Menu\";\nimport { MENU_BORDER_WIDTH, MENU_VERTICAL_PADDING } from \"./StyledMenu\";\nimport { StyledMenuItem } from \"./StyledMenuItem\";\n\nexport interface MenuItemProps<T> {\n  item: Node<T>;\n  state: TreeState<T>;\n  onAction?: (key: Key) => void;\n  onSubmenuClose?: () => void;\n  expandOn?: \"hover\" | \"press\";\n}\n\nconst StyledNestedArrow = styled.span`\n  margin-right: -11px;\n  margin-left: 11px;\n  display: inline-flex; // to make it not take more height than the icon\n`;\n\nconst StyledSelectedMark = styled.span`\n  position: absolute;\n  left: 4px;\n  top: 50%;\n  transform: translateY(-50%);\n  display: inline-flex; // to make it not take more height than the icon\n`;\n\nexport function MenuItem<T>({\n  item,\n  state,\n  onAction,\n  expandOn,\n}: MenuItemProps<T>) {\n  // Get props for the menu item element\n  const ref = React.useRef<HTMLLIElement>(null);\n  const nestedMenuRef = React.useRef<HTMLDivElement>(null);\n  const isDisabled = state.disabledKeys.has(item.key);\n  const isExpanded = state.expandedKeys.has(item.key);\n  const isSelected = state.selectionManager.selectedKeys.has(item.key);\n  const isFocused = state.selectionManager.focusedKey === item.key;\n\n  const { menuItemProps } = useMenuItem(\n    {\n      key: item.key,\n      isDisabled,\n      onAction: !item.hasChildNodes ? onAction : undefined,\n    },\n    state,\n    ref\n  );\n\n  const maybeOpenSubmenu = () => {\n    // Not the best way to clear expandedKeys, but current implementation of tree state only allows toggling keys\n    state.expandedKeys.forEach((key) => {\n      state.toggleKey(key);\n    });\n    if (item.hasChildNodes) {\n      state.toggleKey(item.key);\n    }\n  };\n\n  const { hoverProps } = useHover({\n    isDisabled: isDisabled || expandOn !== \"hover\",\n    onHoverStart: () => {\n      maybeOpenSubmenu();\n    },\n  });\n\n  const { keyboardProps } = useKeyboard({\n    onKeyDown: (e) => {\n      if ([\"ArrowRight\", \"Enter\", \" \"].includes(e.key)) {\n        maybeOpenSubmenu();\n      } else {\n        e.continuePropagation();\n      }\n    },\n  });\n\n  let { overlayProps: positionProps } = useOverlayPosition({\n    targetRef: ref,\n    overlayRef: nestedMenuRef,\n    placement: \"right top\",\n    shouldFlip: true,\n    onClose: () => {\n      console.log(\"on close\");\n    },\n    offset: 0,\n    crossOffset: -(MENU_VERTICAL_PADDING + MENU_BORDER_WIDTH),\n    isOpen: isExpanded,\n  });\n\n  const { subMenuProps } = useSubmenu({\n    onClose: () => {\n      state.toggleKey(item.key);\n      // setting focus with selection manager didn't work. Perhaps because of patchy implementation of nested menus\n      ref.current?.focus();\n    },\n  });\n\n  return (\n    <>\n      <StyledMenuItem\n        {...mergeProps(menuItemProps, hoverProps, keyboardProps)}\n        isDisabled={isDisabled}\n        isActive={isFocused}\n        ref={ref}\n      >\n        {isSelected && (\n          <StyledSelectedMark>\n            <LafIcon\n              icon={{\n                name: \"checkmark\",\n                modifiers: { Selected: isFocused },\n              }}\n            />\n          </StyledSelectedMark>\n        )}\n        <ItemStateContext.Provider\n          value={{ isDisabled, isFocused, isSelected }}\n        >\n          {item.rendered}\n        </ItemStateContext.Provider>\n        {item.hasChildNodes && (\n          <StyledNestedArrow>\n            <PlatformIcon icon=\"icons/ide/menuArrow\" />\n          </StyledNestedArrow>\n        )}\n      </StyledMenuItem>\n      {isExpanded && (\n        /**\n         * A note about using OverlayContainer and FocusScope here:\n         * If sub-menu is not rendered in a portal, useOverlayPosition doesn't work properly and the submenu may\n         * be rendered offscreen. Worse, it may introduce scroll in body (or some scrollable ancestor), which will\n         * trigger a scroll event which closes the menu if the menu is rendered in an overlay (like in MenuTrigger),\n         * which is almost always the case.\n         * So we need to render in a portal and that's done by OverlayContainer. We also need to render a FocusScope,\n         * because now that we are rendering in a portal, we are dom-wise outside the focus scope of the menu in\n         * MenuTrigger (or any other implementation that renders menu in an overlay with a focus scope), and therefore\n         * the auto focus behaviour for the nested menu doesn't work. That's because FocusScope works based on dom\n         * tree, not react tree. Although it's not clear why this problem persists while `contain` is not set on the\n         * FocusScope in MenuTrigger.\n         * So we need focus scope. Rendering a FocusScope here messes with the `restoreFocus` behaviour of the one\n         * in MenuTrigger, and that's why `forceRestoreFocus` is introduced in the locally implemented FocusScope.\n         * In a nutshell:\n         * Positioning -> need for OverlayContainer\n         * using OverlayContainer -> need for FocusScope\n         * FocusScope -> problem in focus restoration in MenuTrigger -> forceRestoreFocus as a patchy solution.\n         */\n        <OverlayContainer>\n          <FocusScope>\n            <div\n              ref={nestedMenuRef}\n              {...mergeProps(positionProps, subMenuProps)}\n            >\n              <Menu\n                aria-label={item[\"aria-label\"] || item.textValue}\n                items={item.childNodes}\n                disabledKeys={state.disabledKeys}\n                selectedKeys={state.selectionManager.selectedKeys}\n                onAction={onAction}\n                autoFocus\n              >\n                {(childItem) => {\n                  // FIXME: This is not complete and doesn't support section and divider\n                  return (\n                    <Item\n                      childItems={childItem.childNodes}\n                      hasChildItems={childItem.hasChildNodes}\n                      textValue={childItem.textValue}\n                    >\n                      {childItem.rendered}\n                    </Item>\n                  );\n                }}\n              </Menu>\n            </div>\n          </FocusScope>\n        </OverlayContainer>\n      )}\n    </>\n  );\n}\n\nconst useSubmenu = ({ onClose }: { onClose: () => void }) => {\n  const { keyboardProps } = useKeyboard({\n    onKeyDown: (e) => {\n      if (e.key === \"ArrowLeft\" || e.key === \"Escape\") {\n        onClose();\n      } else if (![\"ArrowUp\", \"ArrowDown\"].includes(e.key)) {\n        e.continuePropagation();\n      }\n    },\n  });\n  return { subMenuProps: keyboardProps };\n};\n","import { useMenu } from \"@react-aria/menu\";\nimport { AriaMenuProps } from \"@react-types/menu\";\nimport { Node } from \"@react-types/shared\";\nimport React, { Key, useEffect } from \"react\";\nimport { ListDivider } from \"../List/ListDivider\";\nimport { useTreeState } from \"../Tree/__tmp__useTreeState\";\nimport { MenuItem } from \"./MenuItem\";\nimport { StyledMenu } from \"./StyledMenu\";\n\nexport interface MenuProps<T>\n  extends Omit<\n    AriaMenuProps<T>,\n    // selection is not properly supported for nested menus. Plus, it's not even that meaningful for a nested menu\n    // at least the way it's implemented now.\n    \"onSelectionChange\" | \"defaultSelection\" | \"selectionMode\"\n  > {\n  /**\n   * Indicates currently expanded menu item (controlled).\n   */\n  expandedKey?: Key;\n  /**\n   * Called when expanded menu item is changed by user interaction, which can be either hovering over the menu item\n   * if `expandOn` is \"focus\", or clicking on the menu item (when `expandOn` is \"press\").\n   */\n  onExpandedKeyChange?: (expandedKey: Key) => void;\n  defaultExpandedKey?: Key;\n  expandOn?: \"hover\" | \"press\"; // hover delay doesn't seem to be needed as an option\n}\n\n/**\n * UI for menus which are normally shown in a popover. Being rendered as an overlay is not handled here.\n * Also there is no coupling with any higher level entity like \"Action\", since this is just for the UI layer.\n * Something like ActionMenu which creates a menu out of a list of actions can be implemented on top of this.\n *\n * @example\n *  <Menu>\n *    <Item>Item one</Item>\n *    <Item>\n *      <MenuItemLayout\n *        icon={<PlatformIcon icon={\"actions/copy\"} />}\n *        content=\"Copy\"\n *        shortcut={\"C\"} />\n *    </Item>\n *  </Menu>\n *\n *  Current issues and limitations:\n *  - Divider in sub-menu's is not supported. because of a constraint in @react-stately/collections, which results in\n *    this error: Unsupported type <Divider> in <Item>. Only <Item> is supported. Maybe supporting section would\n *    be a workaround for it.\n *  - when a parent menu item which has an open submenu is hovered, it gets focus.\n *\n *  TODO:\n *  - [Least important] pass aria props to icon, keyboard shortcut, and content part of menu item. Maybe a context\n *    can be provided for it from menu item, which also exposes state like selected.\n */\nexport function Menu<T extends object>({\n  expandOn = \"hover\",\n  ...props\n}: MenuProps<T>) {\n  if (expandOn === \"press\") {\n    // The only discovered use case so far is in \"Branches\" menu. Perhaps it's not even implemented as a Menu\n    // in Intellij Platform, but it seems it very well can be, by supporting expand on press.\n    throw new Error(\"expanding menu items only on press is not supported yet.\");\n  }\n  // Create state based on the incoming props\n  let state = useTreeState({\n    ...props,\n    expandedKeys: props.expandedKey ? [props.expandedKey] : undefined,\n    onExpandedChange: ([firstKey]) => props?.onExpandedKeyChange?.(firstKey),\n    defaultExpandedKeys: props.defaultExpandedKey\n      ? [props.defaultExpandedKey]\n      : undefined,\n  });\n\n  // Get props for the menu element\n  let ref = React.useRef<HTMLUListElement>(null);\n  let { menuProps } = useMenu(props, state, ref);\n\n  useEffect(() => {\n    if (props.autoFocus) {\n      setTimeout(() => {\n        // we need this hack until the nested menu is properly supported. That's because when the element is hovered\n        // it sets the focus key, which will move focus to that item.\n        ref.current?.focus();\n      });\n    }\n  }, [props.autoFocus]);\n  return (\n    <StyledMenu {...menuProps} ref={ref}>\n      {[...state.collection].map((item: Node<T>) => {\n        switch (item.type) {\n          case \"item\":\n            return (\n              <MenuItem\n                key={item.key}\n                item={item}\n                state={state}\n                expandOn={expandOn}\n                onAction={props.onAction}\n              />\n            );\n          case \"section\":\n            // Maybe something like \"Branches\" menu needs titled sections.\n            throw new Error(\n              \"Section in menu is not supported yet. You can use Divider though.\"\n            );\n          case \"divider\":\n            return <ListDivider key={item.key} />;\n        }\n      })}\n    </StyledMenu>\n  );\n}\n","import React from \"react\";\nimport { ItemStateContext } from \"../Collections/ItemStateContext\";\nimport { styled } from \"../styled\";\nimport { UnknownThemeProp } from \"../Theme/Theme\";\nimport { useContextOrThrow } from \"../utils/useContextOrThrow\";\n\ninterface MenuItemLayoutProps {\n  icon?: React.ReactNode;\n  content: React.ReactNode;\n  shortcut?: React.ReactNode;\n}\n\nconst StyledMenuItemLayout = styled.div`\n  display: flex;\n  align-items: center;\n  flex: 1; // to make sure it takes as much space as available in the menu item row, so that the suffix (shortcut) is pushed to the right\n`;\nconst Content = styled.span`\n  flex: 1;\n`;\n\nconst Icon = styled.span`\n  display: inline-flex; // prevents unwanted increased height\n  min-width: 16px;\n  margin-right: 5px;\n  margin-left: -21px;\n`;\n\nconst Shortcut = styled.kbd<{ selected: boolean }>`\n  font-family: system-ui, sans-serif;\n  margin-left: 30px;\n  color: ${({ theme, selected }) =>\n    selected\n      ? theme.color(\"MenuItem.selectionForeground\" as UnknownThemeProp)\n      : theme.color(\"MenuItem.acceleratorForeground\")};\n`;\n\nexport const MenuItemLayout = ({\n  content,\n  shortcut,\n  icon,\n}: MenuItemLayoutProps) => {\n  const { isFocused, isSelected } = useContextOrThrow(\n    ItemStateContext,\n    \"MenuItemLayout is meant to be rendered in Item component in Menus\"\n  );\n  return (\n    <StyledMenuItemLayout>\n      <Icon>{!isSelected && icon}</Icon>\n      <Content>{content}</Content>\n      {shortcut && <Shortcut selected={isFocused}>{shortcut}</Shortcut>}\n    </StyledMenuItemLayout>\n  );\n};\n","import { useButton } from \"@react-aria/button\";\nimport { useMenuTrigger } from \"@react-aria/menu\";\nimport {\n  OverlayContainer,\n  useOverlay,\n  useOverlayPosition,\n} from \"@react-aria/overlays\";\nimport { mergeProps } from \"@react-aria/utils\";\nimport { useMenuTriggerState } from \"@react-stately/menu\";\nimport { MenuTriggerProps } from \"@react-types/menu\";\nimport React, { HTMLProps, RefObject } from \"react\";\nimport { FocusScope } from \"../ToolWindow/FocusScope\";\n\ninterface Props extends MenuTriggerProps {\n  restoreFocus?: boolean;\n  children: (\n    props: HTMLProps<HTMLElement>,\n    ref: RefObject<any> // Using a generic didn't seem to work for some reason\n  ) => React.ReactNode;\n  renderMenu: (props: {\n    close: () => void;\n    menuProps: React.HTMLAttributes<HTMLElement>;\n  }) => React.ReactNode;\n}\n\n// FIXME: closeOnSelect should either work or be removed\n// FIXME: Escape doesn't close the menu\n// FIXME: Focus is not restored if nested menu are opened. It may be solved by using useOverlay and closing submenu in click outside.\n// TODO: introduce a more generic Overlay component and use it here too.\nexport const MenuTrigger: React.FC<Props> = ({\n  children,\n  renderMenu,\n  direction = \"bottom\",\n  align = \"start\",\n  shouldFlip = true,\n  restoreFocus = false,\n  ...otherProps\n}) => {\n  const menuTriggerProps: MenuTriggerProps = {\n    ...otherProps,\n    direction,\n    align,\n    shouldFlip,\n  };\n  let state = useMenuTriggerState(menuTriggerProps);\n  let triggerRef = React.useRef(null);\n  let overlayRef = React.useRef(null);\n  // FIXME: Menu props is not used, but it's just about labelBy and id. Only needed for accessibility, but it would\n  //  require a `renderMenu` prop, instead of `menu`.\n  let { menuTriggerProps: triggerProps, menuProps } = useMenuTrigger(\n    { type: \"menu\" },\n    state,\n    triggerRef\n  );\n  let { buttonProps } = useButton(triggerProps, triggerRef);\n  let { overlayProps } = useOverlay(\n    {\n      onClose: () => {\n        return state.close();\n      },\n      shouldCloseOnBlur: false,\n      isOpen: state.isOpen,\n      isKeyboardDismissDisabled: false,\n      isDismissable: true,\n      shouldCloseOnInteractOutside: (element) => {\n        // FIXME: this is kind of hacky and should be removed when nested menu is properly supported\n        return !element.matches(\"[role=menu] *\");\n      },\n    },\n    overlayRef\n  );\n\n  let { overlayProps: positionProps } = useOverlayPosition({\n    targetRef: triggerRef,\n    overlayRef,\n    placement: getPlacement(direction, align),\n    shouldFlip,\n    offset: 0,\n    containerPadding: 0,\n    isOpen: state.isOpen,\n  });\n\n  return (\n    <>\n      {children(buttonProps, triggerRef)}\n      {state.isOpen && (\n        <OverlayContainer>\n          <FocusScope\n            restoreFocus={restoreFocus}\n            forceRestoreFocus={restoreFocus}\n            autoFocus\n          >\n            <div {...mergeProps(overlayProps, positionProps)} ref={overlayRef}>\n              {renderMenu({ menuProps, close: () => state.close() })}\n            </div>\n          </FocusScope>\n        </OverlayContainer>\n      )}\n    </>\n  );\n};\n\nfunction getPlacement(\n  direction: Required<MenuTriggerProps>[\"direction\"],\n  align: Required<MenuTriggerProps>[\"align\"]\n) {\n  switch (direction) {\n    case \"left\":\n    case \"right\":\n    case \"start\":\n    case \"end\":\n      return `${direction} ${align === \"end\" ? \"bottom\" : \"top\"}` as const;\n    case \"bottom\":\n    case \"top\":\n    default:\n      return `${direction} ${align}` as const;\n  }\n}\n","import React from \"react\";\nimport { styled } from \"./styled\";\n\ntype SeparatorUI = {\n  STRIPE_INDENT: number;\n  STRIPE_WIDTH: number;\n};\n\n// based on implementation in com.intellij.ide.ui.laf.darcula.ui.DarculaSeparatorUI, which seems to be used for all themes\nconst DarculaSeparatorUI: SeparatorUI = {\n  STRIPE_INDENT: 1,\n  STRIPE_WIDTH: 1,\n};\n\nconst defaultSize =\n  2 * DarculaSeparatorUI.STRIPE_INDENT + DarculaSeparatorUI.STRIPE_WIDTH;\n\nconst StyledSeparator = styled.hr(({ theme }) => ({\n  backgroundColor: theme.color(\n    \"Separator.separatorColor\",\n    theme.dark ? \"#cdcdcd\" : \"#515151\"\n  ),\n  backgroundClip: \"content-box\",\n  boxSizing: \"border-box\",\n  margin: 0,\n  border: \"none\",\n}));\n\nexport const StyledHorizontalSeparator = styled(StyledSeparator)`\n  height: inherit; // should it be auto?\n  padding: 0 ${DarculaSeparatorUI.STRIPE_INDENT}px;\n  width: ${defaultSize}px;\n`;\nexport const StyledVerticalSeparator = styled(StyledSeparator)`\n  width: auto;\n  padding: ${DarculaSeparatorUI.STRIPE_INDENT}px 0;\n  height: ${defaultSize}px;\n`;\n","import {\n  FocusManager,\n  focusSafely,\n  FocusScope as WrappedFocusScope,\n  FocusScopeProps,\n  useFocusManager,\n} from \"@react-aria/focus\";\nimport React, {\n  ForwardedRef,\n  useImperativeHandle,\n  useLayoutEffect,\n  useRef,\n} from \"react\";\n\ntype BetterFocusScopeProps = FocusScopeProps & {\n  /**\n   *\n   */\n  forceRestoreFocus?: boolean;\n};\n/**\n * A version of FocusScope which also allows for imperatively moving focus to the scope.\n * and has tiny patches/improvements\n * It's useful for\n */\nexport const FocusScope = React.forwardRef(function BetterFocusScope(\n  { children, forceRestoreFocus, ...otherProps }: BetterFocusScopeProps,\n  ref: ForwardedRef<{ focus: () => void }>\n) {\n  const directChildRef = useRef<HTMLSpanElement>(null);\n  const focusManagerRef = useRef<FocusManager>(null);\n  useForceRestoreFocus(forceRestoreFocus);\n  useImperativeHandle(\n    ref,\n    () => ({\n      focus: () => {\n        const focusManager = focusManagerRef.current;\n        const containerElement = directChildRef.current?.parentElement;\n        if (!focusManager) {\n          throw new Error(\"focus manager not found!\");\n        }\n        if (!containerElement) {\n          throw new Error(\"container element not found\");\n        }\n        const alreadyHasFocused =\n          document.activeElement &&\n          document.activeElement !== containerElement &&\n          containerElement.contains(document.activeElement);\n        if (!alreadyHasFocused) {\n          focusManager.focusNext({ tabbable: true });\n        }\n      },\n    }),\n    []\n  );\n\n  return (\n    <WrappedFocusScope {...otherProps}>\n      <GetFocusManager ref={focusManagerRef} />\n      <span data-focus-root-direct-child=\"\" hidden ref={directChildRef} />\n      {children}\n    </WrappedFocusScope>\n  );\n});\nconst GetFocusManager = React.forwardRef(function FocusScopeHandle(\n  props: {},\n  ref: ForwardedRef<FocusManager>\n) {\n  const focusManager = useFocusManager();\n  useImperativeHandle(ref, () => focusManager, [focusManager]);\n  return null;\n});\n\n/**\n * Kind of a patchy solution for focus restoration when currently focused element is in a different focus scope, but\n * we still want focus restoration to work. So far the only use case is in nested menu, which is rendered as a separate\n * overlay with a focus scope. If focus is within that submenu, when the menu is closed, the default `restoreFocus`\n * doesn't work because there is a check in useRestoreFocus, which requires the currently focused element to be in\n * the focus scope, to do the focus restoration:\n * https://github.com/adobe/react-spectrum/blob/e14523fedd93ac1a4ede355aed70988af572ae74/packages/%40react-aria/focus/src/FocusScope.tsx#L460\n */\nfunction useForceRestoreFocus(restoreFocus?: boolean) {\n  useLayoutEffect(() => {\n    let nodeToRestore = document.activeElement as HTMLElement;\n\n    return () => {\n      if (restoreFocus && nodeToRestore) {\n        requestAnimationFrame(() => {\n          if (document.body.contains(nodeToRestore)) {\n            focusSafely(nodeToRestore);\n          }\n        });\n      }\n    };\n  }, [restoreFocus]);\n}\n","/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n//@ts-nocheck\n\n/**\n * IMPORTANT: this is coppied from react spectrum, temporarily until,\n * https://github.com/adobe/react-spectrum/issues/1525 is fixed. Any version above 3.1.3 should be\n * sufficient to remove this copy and use the one from @react-stately/tree\n */\n\nimport {\n  Collection,\n  CollectionBase,\n  Expandable,\n  MultipleSelection,\n  Node,\n} from \"@react-types/shared\";\nimport { TreeRef, useTreeRef } from \"@intellij-platform/core/Tree/useTreeRef\";\nimport { ForwardedRef, Key, useEffect, useMemo } from \"react\";\nimport {\n  SelectionManager,\n  useMultipleSelectionState,\n} from \"@react-stately/selection\";\nimport { useCollection } from \"@react-stately/collections\";\nimport { useControlledState } from \"@react-stately/utils\";\n\nexport class TreeCollection<T> implements Collection<Node<T>> {\n  private keyMap: Map<Key, Node<T>> = new Map();\n  private iterable: Iterable<Node<T>>;\n  private firstKey: Key;\n  private lastKey: Key;\n\n  constructor(\n    nodes: Iterable<Node<T>>,\n    { expandedKeys }: { expandedKeys?: Set<Key> } = {}\n  ) {\n    this.iterable = nodes;\n    expandedKeys = expandedKeys || new Set();\n\n    let visit = (node: Node<T>) => {\n      this.keyMap.set(node.key, node);\n\n      if (\n        node.childNodes &&\n        (node.type === \"section\" || expandedKeys.has(node.key))\n      ) {\n        for (let child of node.childNodes) {\n          visit(child);\n        }\n      }\n    };\n\n    for (let node of nodes) {\n      visit(node);\n    }\n\n    let last: Node<T>;\n    let index = 0;\n    for (let [key, node] of this.keyMap) {\n      if (last) {\n        last.nextKey = key;\n        node.prevKey = last.key;\n      } else {\n        this.firstKey = key;\n        node.prevKey = undefined;\n      }\n\n      if (node.type === \"item\") {\n        node.index = index++;\n      }\n\n      last = node;\n\n      // Set nextKey as undefined since this might be the last node\n      // If it isn't the last node, last.nextKey will properly set at start of new loop\n      last.nextKey = undefined;\n    }\n\n    this.lastKey = last?.key;\n  }\n\n  *[Symbol.iterator]() {\n    yield* this.iterable;\n  }\n\n  get size() {\n    return this.keyMap.size;\n  }\n\n  getKeys() {\n    return this.keyMap.keys();\n  }\n\n  getKeyBefore(key: Key) {\n    let node = this.keyMap.get(key);\n    return node ? node.prevKey : null;\n  }\n\n  getKeyAfter(key: Key) {\n    let node = this.keyMap.get(key);\n    return node ? node.nextKey : null;\n  }\n\n  getFirstKey() {\n    return this.firstKey;\n  }\n\n  getLastKey() {\n    return this.lastKey;\n  }\n\n  getItem(key: Key) {\n    return this.keyMap.get(key);\n  }\n}\n\nexport interface TreeProps<T>\n  extends CollectionBase<T>,\n    Expandable,\n    MultipleSelection {}\nexport interface TreeState<T> {\n  /** A collection of items in the tree. */\n  readonly collection: Collection<Node<T>>;\n\n  /** A set of keys for items that are disabled. */\n  readonly disabledKeys: Set<Key>;\n\n  /** A set of keys for items that are expanded. */\n  readonly expandedKeys: Set<Key>;\n\n  /** Toggles the expanded state for an item by its key. */\n  toggleKey(key: Key): void;\n\n  /** A selection manager to read and update multiple selection state. */\n  readonly selectionManager: SelectionManager;\n}\n\n/**\n * Provides state management for tree-like components. Handles building a collection\n * of items from props, item expanded state, and manages multiple selection state.\n */\nexport function useTreeState<T extends object>(\n  props: TreeProps<T>,\n  treeRef?: ForwardedRef<TreeRef>\n): TreeState<T> {\n  let [expandedKeys, setExpandedKeys] = useControlledState(\n    props.expandedKeys ? props.expandedKeys : undefined,\n    props.defaultExpandedKeys ? new Set(props.defaultExpandedKeys) : new Set(),\n    props.onExpandedChange\n  );\n\n  let selectionState = useMultipleSelectionState(props);\n  let disabledKeys = useMemo(\n    () => (props.disabledKeys ? new Set(props.disabledKeys) : new Set<Key>()),\n    [props.disabledKeys]\n  );\n\n  let tree = useCollection(\n    props,\n    (nodes) => new TreeCollection(nodes, { expandedKeys }),\n    null,\n    [expandedKeys]\n  );\n\n  // Reset focused key if that item is deleted from the collection.\n  useEffect(() => {\n    if (\n      selectionState.focusedKey != null &&\n      !tree.getItem(selectionState.focusedKey)\n    ) {\n      selectionState.setFocusedKey(null);\n    }\n  }, [tree, selectionState.focusedKey]);\n\n  const onToggle = (key: Key) => {\n    setExpandedKeys((expandedKeys) => toggleKey(expandedKeys, key));\n  };\n\n  const selectionManager = new SelectionManager(tree, selectionState);\n\n  useTreeRef({ selectionManager }, treeRef);\n\n  return {\n    collection: tree,\n    expandedKeys,\n    disabledKeys,\n    toggleKey: onToggle,\n    selectionManager,\n  };\n}\n\nfunction toggleKey(set: Set<Key>, key: Key): Set<Key> {\n  let res = new Set(set);\n  if (res.has(key)) {\n    res.delete(key);\n  } else {\n    res.add(key);\n  }\n\n  return res;\n}\n","import { SelectableTreeProps } from \"./useSelectableTree\";\nimport { useLatest } from \"@intellij-platform/core/utils/useLatest\";\nimport { ForwardedRef, Key, useImperativeHandle } from \"react\";\n\nexport interface TreeRef {\n  focus(key: Key): void;\n  replaceSelection(key: Key): void;\n}\n\n/**\n * Sets up a tree ref for imperatively working with tree from outside. For imperatively focusing, expanding to\n * specific key, etc.\n */\nexport function useTreeRef(\n  props: Pick<SelectableTreeProps<unknown>, \"selectionManager\">,\n  forwardedRef?: ForwardedRef<TreeRef>\n) {\n  const latestState = useLatest(props);\n\n  useImperativeHandle(\n    forwardedRef,\n    () => {\n      return {\n        replaceSelection: (key: Key) => {\n          latestState.current.selectionManager.replaceSelection(key);\n        },\n        focus: (key: Key) => {\n          const selectionManager = latestState.current.selectionManager;\n          selectionManager.setFocused(true);\n          /**\n           * NOTE: we set focus key to null and set it to key again, to make sure scroll into view works even when\n           * the key is currently focused but not in view. It wouldn't be needed if there was an imperative handle\n           * for scrolling an item into view, but it's only implemented in way that is reactive to changes to the\n           * focused key. {@see useCollectionAutoScroll}\n           */\n          // @ts-expect-error: setFocusedKey typing mistakenly doesn't accept null, while it should\n          selectionManager.setFocusedKey(null);\n          setTimeout(() => {\n            selectionManager.setFocusedKey(key);\n          });\n        },\n      };\n    },\n    []\n  );\n}\n","/**\n * IMPORTANT: this is a copy of a non-exported file from @react-aria/interactions\n */\n/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport { runAfterTransition } from \"@react-aria/utils\";\n\n// Safari on iOS starts selecting text on long press. The only way to avoid this, it seems,\n// is to add user-select: none to the entire page. Adding it to the pressable element prevents\n// that element from being selected, but nearby elements may still receive selection. We add\n// user-select: none on touch start, and remove it again on touch end to prevent this.\n// This must be implemented using global state to avoid race conditions between multiple elements.\n\n// There are three possible states due to the delay before removing user-select: none after\n// pointer up. The 'default' state always transitions to the 'disabled' state, which transitions\n// to 'restoring'. The 'restoring' state can either transition back to 'disabled' or 'default'.\ntype State = \"default\" | \"disabled\" | \"restoring\";\n\nlet state: State = \"default\";\nlet savedUserSelect = \"\";\n\nexport function disableTextSelection() {\n  if (state === \"default\") {\n    savedUserSelect = document.documentElement.style.webkitUserSelect;\n    document.documentElement.style.webkitUserSelect = \"none\";\n  }\n\n  state = \"disabled\";\n}\n\nexport function restoreTextSelection() {\n  // If the state is already default, there's nothing to do.\n  // If it is restoring, then there's no need to queue a second restore.\n  if (state !== \"disabled\") {\n    return;\n  }\n\n  state = \"restoring\";\n\n  // There appears to be a delay on iOS where selection still might occur\n  // after pointer up, so wait a bit before removing user-select.\n  setTimeout(() => {\n    // Wait for any CSS transitions to complete so we don't recompute style\n    // for the whole page in the middle of the animation and cause jank.\n    runAfterTransition(() => {\n      // Avoid race conditions\n      if (state === \"restoring\") {\n        if (document.documentElement.style.webkitUserSelect === \"none\") {\n          document.documentElement.style.webkitUserSelect =\n            savedUserSelect || \"\";\n        }\n\n        savedUserSelect = \"\";\n        state = \"default\";\n      }\n    });\n  }, 300);\n}\n","import React, { MouseEventHandler } from \"react\";\nimport {\n  disableTextSelection,\n  restoreTextSelection,\n} from \"../utils/interaction-utils/textSelection\";\nimport { useLatest } from \"../utils/useLatest\";\n\nexport type XY = { x: number; y: number };\nexport type UseMoveOptions<S> = {\n  /**\n   * the amount of movement (in pixels) after which the move should start. It prevents interference\n   * with simple click (or more generally, press) events, and provides better UX.\n   * @default 0\n   */\n  dragThreshold?: number;\n  disabled?: boolean;\n  onMoveStart: (args: { from: XY }) => S;\n  onMove: (args: { from: XY; to: XY; movement: XY; startState: S }) => void;\n  onMoveEnd: (args: { startState: S }) => void;\n};\n\n// TODO: cleanup if unmount happens during drag.\n// TODO: Better even handling for touch devices?\n//  wrapping `useMove` from react-aria to just add support for movement threshold should be the\n//  way to go, but there are a few problems:\n//    - it seemed a little buggy in the example here: https://react-spectrum.adobe.com/react-aria/useMove.html\n//    - the API is not great in a sense that it only gives the diff in last movement.\n//      Also onMoveStart doesn't give the initial position, so it's not possible to even calculate\n//\n// TODO: move should be finished by pressing Escape. onMoveCancel maybe?\n/**\n * Similar to https://react-spectrum.adobe.com/react-aria/useMove.html, with slightly different\n * features and API.\n * NOTE: initially the API was designed in a way that onMove and onMove end callbacks were\n * returned from onMoveStart, instead of being directly passed in the options.\n * This would enabled capturing the initial state of each move transaction, by defining whatever\n * variable in onMoveStart and closing over them by onMove and onMoveEnd.\n * The problem with this approach was that although you could capture the initial state of the\n * movement, by closure, any other variable in the outer scopes was also closed over, and you were\n * stuck with the values from the particular render in which the movement was started.\n * Of course you could workaround it by using refs, but it would be non-intuitive.\n * So because of that issue, it's redesigned to have onMoveStart, onMove, and onMoveEnd all\n * directly passed as options, but you can return anything from `onMoveStart` which will be passed\n * to onMove and onMoveEnd as `startState`.\n */\nexport function useMove<S>({\n  dragThreshold = 0,\n  disabled,\n  onMoveStart,\n  onMove,\n  onMoveEnd,\n}: UseMoveOptions<S>): { onMouseDown?: MouseEventHandler } {\n  const handlersRef = useLatest({ onMove, onMoveEnd });\n\n  const onMouseDown = (event: React.MouseEvent) => {\n    disableTextSelection();\n    const from = { x: event.pageX, y: event.pageY };\n    let dragStarted = false;\n    let startState: S;\n\n    const onMouseMove = (event: MouseEvent) => {\n      const { pageX: x, pageY: y } = event;\n      const movement = { x: x - from.x, y: y - from.y };\n      const isDraggedEnough =\n        Math.abs(movement.x) >= dragThreshold ||\n        Math.abs(movement.y) >= dragThreshold;\n      if (isDraggedEnough && !dragStarted) {\n        dragStarted = true;\n        startState = onMoveStart({ from });\n      }\n      if (dragStarted) {\n        handlersRef.current.onMove({\n          from,\n          to: { x: from.x + movement.x, y: from.y + movement.y },\n          movement,\n          startState,\n        });\n      }\n    };\n    document.addEventListener(\"mousemove\", onMouseMove);\n\n    document.addEventListener(\n      \"mouseup\",\n      () => {\n        restoreTextSelection();\n        if (dragStarted) {\n          handlersRef.current.onMoveEnd({ startState });\n        }\n        document.removeEventListener(\"mousemove\", onMouseMove);\n      },\n      { once: true }\n    );\n  };\n  return disabled ? {} : { onMouseDown };\n}\n","import { useMove } from \"../ToolWindow/useMove\";\nimport { ResizerProps } from \"./ResizerProps\";\n\ntype UseResizerProps = Pick<\n  ResizerProps,\n  \"onResize\" | \"onResizeEnd\" | \"onResizeStarted\"\n>;\n\nexport type ResizerViewProps<O = \"horizontal\" | \"vertical\"> = Omit<\n  ResizerProps<O>,\n  \"onResize\" | \"onResizeEnd\" | \"onResizeStarted\"\n> &\n  ReturnType<typeof useResizer>;\n\nconst useResizer = (\n  orientation: \"horizontal\" | \"vertical\",\n  invert: boolean,\n  { onResizeStarted, onResize, onResizeEnd }: UseResizerProps\n) => {\n  const props = useMove({\n    dragThreshold: 0,\n    onMoveStart: () => onResizeStarted() || 0,\n    onMoveEnd: () => onResizeEnd?.(),\n    onMove: ({ movement, startState }) =>\n      onResize(\n        startState +\n          (invert ? -1 : +1) *\n            movement[orientation === \"horizontal\" ? \"x\" : \"y\"]\n      ),\n  });\n  return {\n    resizerProps: props,\n  };\n};\n\nexport const useLeftResizer = (props: UseResizerProps) => {\n  return useResizer(\"horizontal\", true, props);\n};\n\nexport const useRightResizer = (props: UseResizerProps) => {\n  return useResizer(\"horizontal\", false, props);\n};\n\nexport const useTopResizer = (props: UseResizerProps) => {\n  return useResizer(\"vertical\", true, props);\n};\n\nexport const useBottomResizer = (props: UseResizerProps) => {\n  return useResizer(\"vertical\", false, props);\n};\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ResizerViewProps } from \"./useResizer\";\n\ntype VerticalResizerViewProps = ResizerViewProps<\"vertical\">;\n\nconst StyledVerticalResizer = styled.div`\n  width: 100%;\n  height: 0;\n  position: relative;\n  z-index: 1; // to keep resizer on top of sibling views, in case they are non-static\n`;\n\nconst StyledVerticalResizerArea = styled.div<{\n  handleSize: number;\n  cursor: VerticalResizerViewProps[\"cursor\"];\n}>`\n  position: absolute;\n  cursor: ${({ cursor }) => `${cursor}-resize`};\n  height: ${({ handleSize }) => `calc(100% + ${handleSize}px)`};\n  width: 100%;\n  top: ${({ handleSize }) => `-${handleSize / 2}px`};\n`;\n\n/**\n * Handle for resizing views in a vertical layout. It just handles the\n * movement event and calls onResize with the new size. It has nothing to do\n * with actually applying the size.\n */\nexport const VerticalResizer: React.FC<VerticalResizerViewProps> = ({\n  outerPadding = 10,\n  background,\n  size = 0,\n  cursor = \"row\",\n  resizerProps,\n  children,\n  style = {},\n}) => (\n  <StyledVerticalResizer\n    {...resizerProps}\n    style={{ ...style, background, height: size }}\n  >\n    {children}\n    <StyledVerticalResizerArea handleSize={outerPadding} cursor={cursor} />\n  </StyledVerticalResizer>\n);\n","import React from \"react\";\nimport { ResizerProps } from \"./ResizerProps\";\nimport { useTopResizer } from \"./useResizer\";\nimport { VerticalResizer } from \"./VerticalResizer\";\n\n/**\n * Handle for resizing views in a vertical layout, where the resizer is at the top side of the resizable view. i.e.\n * moving mouse to bottom/top will decrease/increase the height\n */\nexport const TopResizer: React.FC<ResizerProps<\"vertical\">> = ({\n  onResize,\n  onResizeEnd,\n  onResizeStarted,\n  ...props\n}) => {\n  const { resizerProps } = useTopResizer({\n    onResize,\n    onResizeEnd,\n    onResizeStarted,\n  });\n  return <VerticalResizer resizerProps={resizerProps} {...props} />;\n};\n","import React from \"react\";\nimport { ResizerProps } from \"./ResizerProps\";\nimport { useBottomResizer } from \"./useResizer\";\nimport { VerticalResizer } from \"./VerticalResizer\";\n\n/**\n * Handle for resizing views in a vertical layout, where the resizer is at the top side of the resizable view. i.e.\n * moving mouse to bottom/top will increase/decrease the height\n */\nexport const BottomResizer: React.FC<ResizerProps<\"vertical\">> = ({\n  onResize,\n  onResizeEnd,\n  onResizeStarted,\n  ...props\n}) => {\n  const { resizerProps } = useBottomResizer({\n    onResize,\n    onResizeEnd,\n    onResizeStarted,\n  });\n  return <VerticalResizer resizerProps={resizerProps} {...props} />;\n};\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ResizerViewProps } from \"./useResizer\";\n\ntype HorizontalResizerViewProps = ResizerViewProps<\"horizontal\">;\n\nconst StyledHorizontalResizer = styled.div`\n  height: 100%;\n  width: 0;\n  position: relative;\n  z-index: 1; // to keep resizer on top of sibling views, in case they are non-static\n`;\n\nconst StyledHorizontalResizerArea = styled.div<{\n  handleSize: number;\n  cursor: HorizontalResizerViewProps[\"cursor\"];\n}>`\n  position: absolute;\n  cursor: ${({ cursor }) => `${cursor}-resize`};\n  width: ${({ handleSize }) => `calc(100% + ${handleSize}px)`};\n  height: 100%;\n  left: ${({ handleSize }) => `-${handleSize / 2}px`};\n`;\n\n/**\n * Handle for resizing views in a horizontal layout. It just handles the\n * movement event and calls onResize with the new size. It has nothing to do\n * with actually applying the size.\n */\nexport const HorizontalResizer: React.FC<HorizontalResizerViewProps> = ({\n  outerPadding = 10,\n  background,\n  size = 0,\n  cursor = \"col\",\n  children,\n  style = {},\n  resizerProps,\n}) => {\n  return (\n    <StyledHorizontalResizer\n      {...resizerProps}\n      style={{ ...style, background, width: size }}\n    >\n      {children}\n      <StyledHorizontalResizerArea handleSize={outerPadding} cursor={cursor} />\n    </StyledHorizontalResizer>\n  );\n};\n","import React from \"react\";\nimport { HorizontalResizer } from \"./HorizontalResizer\";\nimport { ResizerProps } from \"./ResizerProps\";\nimport { useRightResizer } from \"./useResizer\";\n\n/**\n * Handle for resizing views in a horizontal layout, where the resizer is at the right side of the resizable view. i.e.\n * moving mouse to right/left will increase/decrease the width\n */\nexport const RightResizer: React.FC<ResizerProps<\"horizontal\">> = ({\n  onResize,\n  onResizeEnd,\n  onResizeStarted,\n  ...props\n}) => {\n  const { resizerProps } = useRightResizer({\n    onResize,\n    onResizeEnd,\n    onResizeStarted,\n  });\n  return <HorizontalResizer resizerProps={resizerProps} {...props} />;\n};\n","import React from \"react\";\nimport { HorizontalResizer } from \"./HorizontalResizer\";\nimport { ResizerProps } from \"./ResizerProps\";\nimport { useLeftResizer } from \"./useResizer\";\n\n/**\n * Handle for resizing views in a horizontal layout, where the resizer is at the left side of the resizable view. i.e.\n * moving mouse to right/left will decrease/increase the width\n */\nexport const LeftResizer: React.FC<ResizerProps<\"horizontal\">> = ({\n  onResize,\n  onResizeEnd,\n  onResizeStarted,\n  ...props\n}) => {\n  const { resizerProps } = useLeftResizer({\n    onResize,\n    onResizeEnd,\n    onResizeStarted,\n  });\n  return <HorizontalResizer resizerProps={resizerProps} {...props} />;\n};\n","import React, { CSSProperties, useRef, useState } from \"react\";\nimport styled, { useTheme } from \"styled-components\";\nimport {\n  BottomResizer,\n  LeftResizer,\n  RightResizer,\n  TopResizer,\n} from \"../Resizer\";\nimport { ResizerProps } from \"../Resizer/ResizerProps\";\nimport { Theme } from \"../Theme/Theme\";\n\n/**\n * Props are named mostly based on ThreeComponentsSplitter in Intellij Platform.\n */\nexport interface ThreeViewSplitterProps {\n  orientation?: \"horizontal\" | \"vertical\";\n  resizerProps?: Partial<\n    Omit<ResizerProps, \"onResize\" | \"onResizeStarted\" | \"onResizeEnd\">\n  >;\n  innerView?: React.ReactNode;\n  innerViewMinSize?: number;\n  firstView?: React.ReactNode;\n  firstSize?: number | null;\n  lastView?: React.ReactNode;\n  lastSize?: number | null;\n  onFirstResize?: (size: number) => void;\n  onLastResize?: (size: number) => void;\n  style?: CSSProperties;\n  className?: string;\n}\n\nconst StyledSplitterContainer = styled.div<{\n  orientation: \"horizontal\" | \"vertical\";\n}>`\n  display: flex;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  flex-direction: ${({ orientation }) =>\n    orientation === \"vertical\" ? \"column\" : \"row\"};\n`;\n\nconst StyledSplitterInnerView = styled.div`\n  // The default overflow visible should be changed obviously. Not sure if there is any layout implication\n  // in using 'auto' instead of hidden, to provide scroll behaviour by default, but even if we realize later\n  // that we need to set overflow to hidden here, we can have scrollable content inside the inner view via an\n  // intermediate element inside the inner view, with overflow set to auto and width set to 100%.\n  overflow: auto;\n  flex: 1;\n`;\n/**\n * Corresponding to\n * [ThreeComponentsSplitter](https://github.com/JetBrains/intellij-community/blob/58dbd93e9ea527987466072fa0bfbf70864cd35f/platform/platform-api/src/com/intellij/openapi/ui/ThreeComponentsSplitter.java#L40-L40)\n * `firstView` and `lastView` are optional, and if not provided, the corresponding resizer is not rendered.\n * innerView is supposed to fill the remaining space, while firstView and lastView have specific sizes.\n * size changes in a resize interaction is not reported and is handled by local state in the component. That's\n * to prevent frequent state updates in a higher level which can be expensive. It's also based on this assumption\n * that in the usage side there is no need for any control over resizing or even knowing the intermediate state.\n * Maybe a minSize and maxSize would be the extent of the required control over resizing. But anyway, this model\n * of keeping the size as a local state during a resize session is something that can be changed if needed.\n *\n * Features:\n * - Relative sizing (fraction of the container)\n * - Default size by content\n * - Change handling only when resize is done.\n *\n * TODO: max and min size not implemented\n */\nexport const ThreeViewSplitter: React.FC<ThreeViewSplitterProps> = ({\n  orientation = \"horizontal\",\n  firstView,\n  firstSize,\n  lastView,\n  lastSize,\n  onFirstResize,\n  onLastResize,\n  resizerProps: resizerPropsOverrides = {},\n  innerView,\n  innerViewMinSize,\n  ...containerProps\n}: ThreeViewSplitterProps): React.ReactElement => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const firstViewRef = useRef<HTMLDivElement>(null);\n  const lastViewRef = useRef<HTMLDivElement>(null);\n  const [firstSizeState, setFirstSizeState] = useState<number | null>(null);\n  const [lastSizeState, setLastSizeState] = useState<number | null>(null);\n  const theme = useTheme() as Theme;\n\n  const value = <T1, T2>(horizontalValue: T1, verticalValue: T2) =>\n    orientation === \"horizontal\" ? horizontalValue : verticalValue;\n\n  const FirstResizer: React.ComponentType<ResizerProps> = value(\n    RightResizer,\n    BottomResizer\n  );\n  const SecondResizer: React.ComponentType<ResizerProps> = value(\n    LeftResizer,\n    TopResizer\n  );\n  const sizeStyleProp = value(\"width\", \"height\");\n  const minSizeStyleProp = value(\"minWidth\", \"minHeight\");\n\n  const resizerProps: ThreeViewSplitterProps[\"resizerProps\"] = {\n    background: theme.commonColors.contrastBorder,\n    size: 1,\n    ...resizerPropsOverrides,\n  };\n\n  const isFractionSize = (size: number) => size < 1;\n\n  const normalizeSize = (\n    size: number | undefined | null\n  ): CSSProperties[\"width\" | \"height\"] =>\n    size != null && isFractionSize(size) ? `${size * 100}%` : size ?? undefined;\n\n  const getSize = (elem: HTMLElement): number =>\n    value(elem.offsetWidth, elem.offsetHeight);\n\n  const getNewSize = (currentSize: number, newSize: number) => {\n    if (currentSize != null && isFractionSize(currentSize)) {\n      if (!containerRef.current) {\n        throw new Error(\n          \"ThreeViewSplitter: Could not locate container to calculate fraction size\"\n        );\n      }\n      const containerSize = value(\n        containerRef.current.offsetWidth,\n        containerRef.current.offsetHeight\n      );\n      const newFractionSize = newSize / containerSize;\n      return newFractionSize < 1 ? newFractionSize : currentSize;\n    } else {\n      return Math.max(newSize, 1);\n    }\n  };\n\n  const getActualSize = (viewElem: HTMLElement | null): number | null => {\n    if (!containerRef.current || !viewElem) {\n      return null;\n    }\n    const actualSize = getSize(viewElem);\n    if (viewElem.style[sizeStyleProp]?.includes(\"%\")) {\n      return actualSize / getSize(containerRef.current);\n    }\n    return actualSize;\n  };\n\n  const currentLastSize = normalizeSize(lastSizeState ?? lastSize);\n  const currentFirstSize = normalizeSize(firstSizeState ?? firstSize);\n  return (\n    <StyledSplitterContainer\n      ref={containerRef}\n      orientation={orientation}\n      {...containerProps}\n    >\n      {firstView && (\n        <>\n          <div\n            ref={firstViewRef}\n            style={{\n              [sizeStyleProp]: currentFirstSize,\n              // if other side is resizing, minWidth/minHeight is set so that this side is not get affected.\n              // It may make sense to allow opting out of this behaviour, if it's considered a feature to be able to\n              // \"push\" the other side too when expanding one side.\n              [minSizeStyleProp]:\n                lastSizeState !== null ? currentFirstSize : undefined,\n            }}\n          >\n            {firstView}\n          </div>\n          <FirstResizer\n            onResizeStarted={() => {\n              const size = getSize(firstViewRef.current!);\n              setFirstSizeState(firstSize ?? size);\n              return size;\n            }}\n            onResize={(newSize) => {\n              if (firstSizeState != null) {\n                setFirstSizeState(getNewSize(firstSizeState, newSize));\n              }\n            }}\n            onResizeEnd={() => {\n              const actualSize = getActualSize(firstViewRef.current);\n              if (actualSize !== null) {\n                onFirstResize?.(actualSize);\n              }\n              setFirstSizeState(null);\n            }}\n            {...resizerProps}\n          />\n        </>\n      )}\n      {innerView && (\n        <StyledSplitterInnerView\n          style={{\n            [value(\"minWidth\", \"minHeight\")]: innerViewMinSize,\n          }}\n        >\n          {innerView}\n        </StyledSplitterInnerView>\n      )}\n      {lastView && (\n        <>\n          <SecondResizer\n            onResizeStarted={() => {\n              const size = getSize(lastViewRef.current!);\n              setLastSizeState(lastSize ?? size);\n              return size;\n            }}\n            onResize={(newSize) => {\n              if (lastSizeState != null) {\n                setLastSizeState(getNewSize(lastSizeState, newSize));\n              }\n            }}\n            onResizeEnd={() => {\n              const actualSize = getActualSize(lastViewRef.current);\n              if (actualSize !== null) {\n                onLastResize?.(actualSize);\n              }\n              setLastSizeState(null);\n            }}\n            {...resizerProps}\n          />\n          <div\n            ref={lastViewRef}\n            style={{\n              [sizeStyleProp]: currentLastSize,\n              // if other side is resizing, minWidth/minHeight is set so that this side is not get affected.\n              // It may make sense to allow opting out of this behaviour, if it's considered a feature to be able to\n              // \"push\" the other side too when expanding one side.\n              [minSizeStyleProp]:\n                firstSizeState !== null ? currentLastSize : undefined,\n            }}\n          >\n            {lastView}\n          </div>\n        </>\n      )}\n    </StyledSplitterContainer>\n  );\n};\n","import React from \"react\";\nimport {\n  ThreeViewSplitter,\n  ThreeViewSplitterProps,\n} from \"./ThreeViewSplitter/ThreeViewSplitter\";\n\ntype ResizableViewProps = Omit<\n  ThreeViewSplitterProps,\n  | \"innerView\"\n  | \"firstView\"\n  | \"firstSize\"\n  | \"onFirstResize\"\n  | \"lastView\"\n  | \"lastSize\"\n  | \"onLastResize\"\n> & {\n  children: React.ReactNode;\n  onResize: ThreeViewSplitterProps[\"onFirstResize\"];\n  size: ThreeViewSplitterProps[\"firstSize\"];\n  /**\n   * Whether the resizer should be placed at before or after the resizable view.\n   */\n  resizerPlacement?: \"before\" | \"after\";\n};\n/**\n * A single resizable view, built on top of {@link ThreeViewSplitter}, just to provide better prop interface.\n * Like `ThreeViewSplitter` it supports \"horizontal\" or \"vertical orientations. There is an extra `resizerPlacement`\n * prop which determines where the resizer should be placed in relation with the view. When set to \"before\" the view\n * will be resizable from the start (\"left\" or \"top\"). When set to \"after\" the view will be resizable from end (\"right\"\n * or \"bottom\"). Default is \"after\"\n */\nexport const ResizableView = ({\n  children,\n  size,\n  onResize,\n  resizerPlacement = \"after\",\n  ...props\n}: ResizableViewProps) => (\n  <ThreeViewSplitter\n    {...(resizerPlacement === \"after\"\n      ? { firstView: children, firstSize: size, onFirstResize: onResize }\n      : { lastView: children, lastSize: size, onLastResize: onResize })}\n    {...props}\n  />\n);\n","import React, { useContext, useRef } from \"react\";\nimport {\n  BottomResizer,\n  LeftResizer,\n  RightResizer,\n  TopResizer,\n} from \"../Resizer\";\nimport {\n  HorizontalResizerProps,\n  VerticalResizerProps,\n} from \"../Resizer/ResizerProps\";\nimport { WindowBounds } from \"./ToolWindowsState/ToolWindowsState\";\n\nconst FLOAT_WINDOW_MIN_WIDTH = 100;\nconst FLOAT_WINDOW_MIN_HEIGHT = 40; // in Intellij Platform it's zero but there is window frame which doesn't exist here\n/**\n * NOTE: can be used in other kinds of resizable overlays too, in future.\n */\nexport function WindowResizeHandles() {\n  const windowResizer = useWindowResizer();\n  return (\n    windowResizer && (\n      <>\n        <RightResizer {...windowResizer.getResizerProps(\"right\")} />\n        <LeftResizer {...windowResizer.getResizerProps(\"left\")} />\n        <TopResizer {...windowResizer.getResizerProps(\"top\")} />\n        <BottomResizer {...windowResizer.getResizerProps(\"bottom\")} />\n      </>\n    )\n  );\n}\n\n/**\n * TODO(docs): add a few words about this abstraction and it's use.\n */\nexport type BoundsInteractionHandlerProps = {\n  /**\n   * Signals start of a UI interaction like resize or move, in which window bounds change.\n   */\n  startInteraction: () => WindowBounds;\n  /**\n   * Used to update bounds state during a UI interaction.\n   */\n  updateBounds: (bounds: WindowBounds) => void;\n  /**\n   * Signals end of a UI interaction.\n   */\n  finishInteraction: () => void;\n};\nexport const WindowInteractionHandlerContext = React.createContext<BoundsInteractionHandlerProps | null>(\n  null\n);\nexport const useWindowInteractionHandler = () =>\n  useContext(WindowInteractionHandlerContext);\n\n/**\n * window resizing logic and state. When resizing is in progress, the source of truth is a local state, for performance\n * reasons. When the resize is done (e.g. by mouse being released), `onBoundsChange` is called with the new bounds.\n */\nfunction useWindowResizer() {\n  const initialBoundsRef = useRef<WindowBounds>({\n    top: 0,\n    height: 0,\n    width: 0,\n    left: 0,\n  });\n  const interactionHandler = useWindowInteractionHandler();\n  if (!interactionHandler) {\n    return null;\n  }\n  const {\n    finishInteraction,\n    startInteraction,\n    updateBounds,\n  } = interactionHandler;\n\n  const onResize = {\n    right: (size: number) =>\n      updateBounds({\n        ...initialBoundsRef.current,\n        width: Math.max(\n          FLOAT_WINDOW_MIN_WIDTH,\n          initialBoundsRef.current.width + size\n        ),\n      }),\n    bottom: (size: number) =>\n      updateBounds({\n        ...initialBoundsRef.current,\n        height: Math.max(\n          FLOAT_WINDOW_MIN_HEIGHT,\n          initialBoundsRef.current.height + size\n        ),\n      }),\n    left: (size: number) => {\n      const newWidth = Math.max(\n        FLOAT_WINDOW_MIN_WIDTH,\n        initialBoundsRef.current.width + size\n      );\n      const initialBounds = initialBoundsRef.current;\n      return updateBounds({\n        ...initialBounds,\n        left: initialBounds.left + initialBounds.width - newWidth,\n        width: newWidth,\n      });\n    },\n    top: (size: number) => {\n      const newHeight = Math.max(\n        FLOAT_WINDOW_MIN_WIDTH,\n        initialBoundsRef.current.height + size\n      );\n      const initialBounds = initialBoundsRef.current;\n      return updateBounds({\n        ...initialBounds,\n        top: initialBounds.top + initialBounds.height - newHeight,\n        height: newHeight,\n      });\n    },\n  };\n\n  function getResizerProps(side: \"left\" | \"right\"): HorizontalResizerProps;\n  function getResizerProps(side: \"top\" | \"bottom\"): VerticalResizerProps;\n  function getResizerProps(\n    side: \"left\" | \"right\" | \"top\" | \"bottom\"\n  ): HorizontalResizerProps | VerticalResizerProps {\n    const horizontal = side === \"left\" || side === \"right\";\n    return {\n      size: 1,\n      cursor: horizontal ? \"ew\" : \"ns\",\n      onResizeStarted: () => {\n        initialBoundsRef.current = startInteraction();\n      },\n      onResize: onResize[side],\n      onResizeEnd: finishInteraction,\n      style: { position: \"absolute\", [side]: 0 },\n    };\n  }\n\n  return {\n    getResizerProps,\n  };\n}\n","import { isMac } from \"@react-aria/utils\";\nimport React, { HTMLProps, useState } from \"react\";\nimport { css } from \"styled-components\";\nimport { MAC_WINDOW_SHADOW } from \"../style-constants\";\nimport { styled } from \"../styled\";\nimport { Theme } from \"../Theme/Theme\";\nimport { FloatWindowState } from \"./ToolWindowsState/ToolWindowsLayoutState\";\nimport { WindowBounds } from \"./ToolWindowsState/ToolWindowsState\";\nimport {\n  BoundsInteractionHandlerProps,\n  WindowInteractionHandlerContext,\n  WindowResizeHandles,\n} from \"./WindowResizeHandles\";\n\nconst StyledFloatView = styled.div`\n  position: absolute;\n  background: inherit;\n  // border color doesn't seem to be correct and needs more investigation. might be even os-specific and outside\n  // theme colors.\n  border: ${({ theme }) => `1px solid ${theme.color(\"Component.borderColor\")}`};\n  ${isMac() &&\n  css<{ theme: Theme }>`\n    ${MAC_WINDOW_SHADOW};\n    border-radius: 8px;\n  `}\n  z-index: 2;\n`;\n\n/**\n * Container for tool windows in float view mode. It handles some visual aspects like the border and shadow, as well as\n * UI interactions for changing the floatingBound of the tool window.\n * @param children\n * @param bounds\n * @param onBoundsChange\n * @constructor\n */\nexport const FloatView: React.FC<\n  {\n    state: FloatWindowState;\n    onBoundsChange: (bounds: WindowBounds) => void;\n  } & Omit<HTMLProps<HTMLDivElement>, \"ref\" | \"as\">\n> = ({\n  children,\n  state: { bounds: boundsProp },\n  onBoundsChange,\n  ...otherProps\n}) => {\n  // local state of bounds for when window is in a UI interaction, like movement or resize with mouse.\n  // We don't want to update toolWindowsState repeatedly in such transactions and we just want to trigger one\n  // update when the UI interaction is done.\n  // it's maintained during a UI interaction and then reset to null.\n  const [bounds, setBounds] = useState<null | WindowBounds>(null);\n  const onInteractionEnd = () => {\n    if (bounds) {\n      onBoundsChange(bounds);\n    }\n    setBounds(null);\n  };\n  const effectiveBounds = bounds || boundsProp;\n  const boundsContextValue: BoundsInteractionHandlerProps = {\n    startInteraction: () => {\n      setBounds(boundsProp);\n      return boundsProp;\n    },\n    updateBounds: setBounds,\n    finishInteraction: onInteractionEnd,\n  };\n\n  return (\n    <StyledFloatView\n      {...otherProps}\n      style={{ ...otherProps.style, ...effectiveBounds }}\n    >\n      <WindowInteractionHandlerContext.Provider value={boundsContextValue}>\n        <WindowResizeHandles />\n        {children}\n      </WindowInteractionHandlerContext.Provider>\n    </StyledFloatView>\n  );\n};\n","import { move } from \"ramda\";\nimport React, { HTMLProps, Key, useState } from \"react\";\nimport { FloatView } from \"./FloatView\";\nimport { FloatWindowState } from \"./ToolWindowsState/ToolWindowsLayoutState\";\nimport { WindowBounds } from \"./ToolWindowsState/ToolWindowsState\";\n\n// NOTE: useStackedLayersState and useStackedLayers are generic but kept here since there is no other use case at the\n// moment. They should be moved to their own file(s) when/if other use case came up.\n\ninterface StackedLayersState<T> {\n  /**\n   * Sorted list of items representing layers.\n   */\n  sorted: T[];\n  /**\n   * A function to be used when the layer should be brought to front, typically based on some UI interaction.\n   */\n  bringToFront: (index: number) => void;\n}\n\n/**\n * State management for a stacked list of layers with **bring to front** functionality.\n */\nfunction useStackedLayersState<T, K = React.Key>(\n  /**\n   * A list of arbitrary items representing stacked layers.\n   */\n  items: T[],\n  /**\n   * A function for converting each item into a key which consistently identifies each item, in subsequent renders.\n   * It's used to maintain current sorting state. Although it can be of any type, it's usually a string or number.\n   */\n  getKey: (item: T) => K\n): StackedLayersState<T> {\n  // Local state for now, but can easily change to controllable if needed.\n  const [sortedKeys, setSortedKeys] = useState<K[]>([]);\n  const sorted = items.sort(\n    (a, b) => sortedKeys.indexOf(getKey(a)) - sortedKeys.indexOf(getKey(b))\n  );\n  return {\n    sorted,\n    bringToFront: (index: number) => {\n      setSortedKeys(move(index, -1, sorted).map(getKey));\n    },\n  };\n}\n\n/**\n * Given the state of a stacked list of layers, returns DOM props to be applied to each layer for interaction-based\n * \"bring to front\" behaviour.\n */\nfunction useStackedLayers<T>(\n  state: StackedLayersState<T>\n): { layersProps: Array<HTMLProps<HTMLElement>> } {\n  return {\n    layersProps: state.sorted.map((_, index) => ({\n      onFocus: () => {\n        state.bringToFront(index);\n      },\n    })),\n  };\n}\n\n/**\n * Renders float tool windows.\n * - handles resize and move actions for float windows.\n * - handles layering of float tool windows.\n */\nexport function FloatToolWindows({\n  floatWindows = [],\n  onBoundsChange,\n  renderToolWindow,\n}: {\n  floatWindows: FloatWindowState[] | undefined;\n  onBoundsChange: (key: Key, bounds: WindowBounds) => void;\n  renderToolWindow: (key: Key) => React.ReactNode;\n}) {\n  const stackedFloatWindows = useStackedLayersState(\n    floatWindows,\n    ({ key }) => key\n  );\n  const { layersProps } = useStackedLayers(stackedFloatWindows);\n  // sorted list is used to render layers. We could as well use z-index and always render with the same order, but\n  // it doesn't really matter as long as key is set.\n  return (\n    <>\n      {stackedFloatWindows.sorted.map((toolWindow, index) => (\n        <FloatView\n          key={toolWindow.key}\n          state={toolWindow}\n          {...layersProps[index]}\n          onBoundsChange={(bounds) => onBoundsChange(toolWindow.key, bounds)}\n        >\n          {renderToolWindow(toolWindow.key)}\n        </FloatView>\n      ))}\n    </>\n  );\n}\n","import React, {\n  Key,\n  MutableRefObject,\n  RefObject,\n  useContext,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport { useLatest } from \"../utils/useLatest\";\nimport { DropPosition } from \"./createGetDropPosition\";\nimport { UseElementMoveOptions } from \"./useElementMove\";\nimport { Anchor } from \"./utils\";\n\ntype Rect = Omit<ClientRect, \"toJSON\" | \"x\" | \"y\">;\n\ntype StripeLocation<T extends unknown> = {\n  index: number;\n  anchor: Anchor;\n  isSplit: boolean;\n};\ntype MovableStripeProps<T> = {\n  stripeElRef: React.RefObject<HTMLElement>;\n  getKey: (item: T) => Key;\n  anchor: Anchor;\n  mainItems: T[];\n  splitItems: T[];\n  createGetDropPosition: (\n    key: Key\n  ) => (draggedRect: Rect) => DropPosition | null;\n};\n\ntype MovableToolWindowStripeContextType<T> = {\n  addStripe: <T>(\n    id: string,\n    propsRef: MutableRefObject<MovableStripeProps<T>>\n  ) => () => void;\n  startMove: (id: string, args: { from: Rect; key: Key }) => void;\n  move: (args: { to: Rect }) => void;\n  endMove: () => void;\n  dropPosition: null | { id: string; dropPosition: DropPosition };\n  draggingKey: Key | null;\n  draggingRect: Rect | null;\n};\n\nexport type MovableToolWindowStripeProviderProps<T = unknown> = {\n  children: React.ReactNode;\n  onMove: (args: { from: StripeLocation<T>; to: StripeLocation<T> }) => void;\n};\n\nconst MovableToolWindowStripeContext = React.createContext<MovableToolWindowStripeContextType<any> | null>(\n  null\n);\n\n/**\n * A wrapper component to render around `ToolWindowStripe`s to make their button movable. Stripe buttons then become\n * draggable and can be moved either within the same `ToolWindowStripe` or across different ones.\n * @param onMove: called when a stripe button is moved from one anchor to another.\n * @param children: child element tree, containing one or more ToolWindowStripe elements. No need to be direct children.\n */\nexport const MovableToolWindowStripeProvider = <T extends unknown>({\n  onMove,\n  children,\n}: MovableToolWindowStripeProviderProps<T>) => {\n  const stripes = useRef<{\n    [id: string]: RefObject<MovableStripeProps<T>>;\n  }>({});\n  const [draggingRect, setDraggingRect] = useState<Rect | null>(null);\n  const [draggingKey, setDraggingKey] = useState<Key | null>(null);\n  const [dropPosition, setDropPosition] = useState<{\n    id: string;\n    dropPosition: DropPosition;\n  } | null>(null);\n  const getDropPositionRef = useRef<\n    (\n      to: Rect\n    ) => {\n      id: string;\n      dropPosition: DropPosition;\n    } | null\n  >(() => null);\n  const moveStartLocationRef = useRef<null | {\n    id: string;\n    index: number;\n    anchor: Anchor;\n    isSplit: boolean;\n  }>(null);\n\n  const contextValue = useMemo(\n    (): MovableToolWindowStripeContextType<T> => ({\n      addStripe: (id, propsRef) => {\n        if (stripes.current[id]) {\n          console.error(`multiple stripes with the same id \"${id}`);\n        }\n        // @ts-expect-error\n        stripes.current[id] = propsRef;\n        return () => {\n          delete stripes.current[id];\n        };\n      },\n      startMove: (id, { from, key }) => {\n        const stripe = stripes.current[id]?.current;\n        if (!stripe) {\n          return;\n        }\n        const { stripeElRef } = stripe;\n        const stripeElement = stripeElRef.current!;\n        const getItemRect = (key: Key) =>\n          stripeElement\n            .querySelector(`[data-key=\"${key}\"]`)! // FIXME\n            .getBoundingClientRect();\n\n        // Running the following two state setters immediately affect the layout\n        // in a way that is necessary for drop position calculation, so the order\n        // is important\n        setDraggingRect(getItemRect(key).toJSON());\n        setDraggingKey(key);\n\n        const indexInMain = stripe.mainItems.findIndex(\n          (item) => stripe.getKey(item) === key\n        );\n        const indexInSplit = stripe.splitItems.findIndex(\n          (item) => stripe.getKey(item) === key\n        );\n        moveStartLocationRef.current = {\n          id,\n          anchor: stripe.anchor,\n          index: indexInMain > -1 ? indexInMain : indexInSplit,\n          isSplit: indexInSplit > -1,\n        };\n\n        const dropPositionGetters = Object.entries(stripes.current).map(\n          ([id, stripe]) =>\n            [id, stripe.current!.createGetDropPosition(key)] as const\n        );\n        const getDropPosition = (draggedRect: Rect) => {\n          for (const [id, getDropPosition] of dropPositionGetters) {\n            const dropPosition = getDropPosition(draggedRect);\n            if (dropPosition) {\n              return {\n                id,\n                dropPosition,\n              };\n            }\n          }\n          return null;\n        };\n\n        setDropPosition(getDropPosition(from));\n\n        getDropPositionRef.current = getDropPosition;\n      },\n      move: ({ to }) => {\n        setDropPosition(getDropPositionRef.current(to));\n      },\n      endMove: () => {\n        if (dropPosition && draggingKey) {\n          onMove({\n            from: moveStartLocationRef.current!,\n            to: {\n              anchor: dropPosition.id as Anchor /*FIXME*/,\n              index: dropPosition.dropPosition.index,\n              isSplit: dropPosition.dropPosition.split,\n            },\n          });\n        }\n        setDraggingKey(null);\n        setDropPosition(null);\n        setDraggingRect(null);\n      },\n      dropPosition,\n      draggingRect,\n      draggingKey,\n    }),\n    [dropPosition, draggingKey, draggingRect]\n  );\n\n  return (\n    <MovableToolWindowStripeContext.Provider value={contextValue}>\n      {children}\n    </MovableToolWindowStripeContext.Provider>\n  );\n};\n\nexport function useMovableStripeButtons<T>(props: MovableStripeProps<T>) {\n  // Seems reasonable to assume anchor is unique. Also current onMove signature is coupled with anchor, not a more generic id.\n  const id = props.anchor;\n  const context = useContext(MovableToolWindowStripeContext);\n  const latestPropsRef = useLatest(props);\n  useEffect(() => {\n    if (context) {\n      return context.addStripe(id, latestPropsRef);\n    }\n  }, [context, id]);\n\n  const getProps = (\n    key: Key\n  ): Pick<\n    UseElementMoveOptions<unknown>,\n    \"onMoveStart\" | \"onMove\" | \"onMoveEnd\"\n  > & { moveDisabled: boolean } => ({\n    moveDisabled: !context,\n    onMoveStart: ({ from }) => {\n      context?.startMove?.(id, { from, key });\n    },\n    onMove: ({ to }) => {\n      context?.move({ to });\n    },\n    onMoveEnd: () => {\n      context?.endMove();\n    },\n  });\n  return {\n    getProps,\n    draggingRect: context?.draggingRect ?? null,\n    dropPosition:\n      context?.dropPosition?.id === id\n        ? context?.dropPosition.dropPosition\n        : null,\n    draggingKey: context?.draggingKey ?? null,\n  };\n}\n","import { styled } from \"../styled\";\nimport { css } from \"styled-components\";\n\nconst TopStripe = styled.div`\n  display: flex; // default display, which is block causes an unwanted minimum height\n  grid-area: ts;\n`;\nconst BottomStripe = styled.div`\n  display: flex; // default display, which is block causes an unwanted minimum height\n  grid-area: bs;\n`;\nconst LeftStripe = styled.div`\n  grid-area: ls;\n`;\nconst RightStripe = styled.div`\n  grid-area: rs;\n`;\nconst MainView = styled.div`\n  grid-area: main;\n  min-height: 0; // necessary to prevent overflow;\n  position: relative; // necessary for undock views which are absolute positioned\n  background: inherit;\n  min-width: 0; // very important for layout. If not set, resizing tool windows can cause weird scrollbar inside tool windows pane.\n`;\n\n/**\n * The container which renders top,bottom,left and right stripes with a centered content.\n * responsible only for the layout of the stripes and the centered content. layout doesn't\n * include the opened tool windows on different sides and is just about the stripes around\n * the center area.\n * It also supports toggling stripes visibility.\n */\nconst Shell = styled.div<{ hideStripes: boolean }>`\n  display: grid;\n  grid-template-columns: min-content auto min-content;\n  grid-template-rows: min-content auto min-content;\n  grid-template-areas:\n    \".   ts   .\"\n    \"ls main rs\"\n    \".   bs   .\";\n\n  background: ${({ theme }) => theme.commonColors.panelBackground};\n  color: ${({ theme }) => theme.color(\"*.foreground\")};\n  ${({ hideStripes }) =>\n    hideStripes &&\n    css`\n      ${TopStripe},\n      ${BottomStripe}, \n      ${LeftStripe}, \n      ${RightStripe} {\n        display: none;\n      }\n    `}\n`;\n\nexport const StyledToolWindowOuterLayout = {\n  Shell,\n  TopStripe,\n  BottomStripe,\n  LeftStripe,\n  RightStripe,\n  MainView,\n};\n","export type Anchor = \"left\" | \"right\" | \"top\" | \"bottom\";\n\nexport const isHorizontal = (anchor: Anchor) =>\n  anchor === \"top\" || anchor === \"bottom\";\n\nexport const theOtherSide = (anchor: Anchor) =>\n  ({\n    left: \"right\" as const,\n    right: \"left\" as const,\n    top: \"bottom\" as const,\n    bottom: \"top\" as const,\n  }[anchor]);\n","import { compose, filter, groupBy, map, pipe, prop, sortBy } from \"ramda\";\nimport { Key } from \"react\";\nimport { Anchor, isHorizontal } from \"../utils\";\nimport {\n  ToolWindowsState,\n  ToolWindowState,\n  ViewMode,\n} from \"./ToolWindowsState\";\n\ntype ToolWindowStateWithKey = { key: Key } & ToolWindowState;\n\nexport interface StripesState {\n  main: Key[];\n  split: Key[];\n  activeKeys: Key[];\n}\n\n/**\n * Represents UI state of the split view (aka secondary or side view) within a docked view at one of the four sides.\n */\ntype SideDockedSplitState = {\n  key: Key;\n  /**\n   * relative size of the split view inside a docked view. Note that this is intentionally a fraction size (0size<1),\n   * based on the expected behaviour. split views inside a docked view are not fixed sized and resizing the window\n   * affect their size. This is not the case for the docked views themselves inside the main layout, which have fixed\n   * size which is not affected by window resizing.\n   */\n  sizeFraction: number;\n};\n\n// A potential improvement for this and similar nullable types like SideDockedState.split might be to avoid null type\n// and have it like { open: false} | {open: true, ...relevantProps}\n// Not sure if it's really preferred in terms of usage in the react component.\nexport type SideDockedState = null | {\n  size: number;\n  mainKey: Key;\n  split: SideDockedSplitState | null;\n};\n\nexport type SideUnDockedState = null | {\n  size: number;\n  key: Key;\n};\n\nexport interface SideState {\n  docked: SideDockedState;\n  undocked: SideUnDockedState;\n  stripes: StripesState;\n}\n\nexport interface FloatWindowState {\n  key: Key;\n  bounds: Exclude<ToolWindowState[\"floatingBounds\"], undefined>;\n}\n\n/**\n * Derived from ToolWindowsState, it represents the same information in a away that is suitable for ToolWindows\n * component to render the layout.\n */\nexport interface ToolWindowsLayoutState {\n  left: SideState;\n  top: SideState;\n  right: SideState;\n  bottom: SideState;\n  floatWindows: Array<FloatWindowState>;\n  windows: Array<FloatWindowState>;\n}\n\ninterface ContainerSize {\n  width: number;\n  height: number;\n}\n\nconst getSizeInAnchor = (containerSize: ContainerSize, anchor: Anchor) =>\n  containerSize[isHorizontal(anchor) ? \"height\" : \"width\"];\n\nconst mapToKey = map<ToolWindowStateWithKey, Key>(prop(\"key\"));\nconst sortAndMapToKey = compose(\n  mapToKey,\n  sortBy(({ order }: ToolWindowStateWithKey) => order)\n);\nconst filterMains = filter<ToolWindowStateWithKey, \"array\">(\n  ({ isSplit }: ToolWindowStateWithKey) => !isSplit\n);\nconst getMains = compose(sortAndMapToKey, filterMains);\nconst filterSplits = filter<ToolWindowStateWithKey, \"array\">(\n  ({ isSplit }: ToolWindowStateWithKey) => isSplit\n);\nconst filterVisible = (expectedViewMode: ViewMode | ViewMode[] = []) =>\n  filter<ToolWindowStateWithKey, \"array\">(\n    ({ viewMode, isVisible }: ToolWindowStateWithKey) =>\n      isVisible &&\n      ([] as ViewMode[]).concat(expectedViewMode).includes(viewMode)\n  );\nconst getSplits = compose(sortAndMapToKey, filterSplits);\n\nconst filterVisibleDocked = filterVisible([\"docked_unpinned\", \"docked_pinned\"]);\nconst filterVisibleUnDocked = filterVisible(\"undock\");\n\nconst getDocked = (\n  anchor: Anchor,\n  containerSize: ContainerSize,\n  toolWindows: ToolWindowStateWithKey[]\n): SideDockedState => {\n  const docks = filterVisibleDocked(toolWindows);\n  const mains = filterMains(docks);\n  const splits = filterSplits(docks);\n  if (mains.length > 1 || splits.length > 1) {\n    throw new Error(\n      \"More than one visible docked window in a side is not possible\"\n    );\n  }\n  if (mains[0] || splits[0]) {\n    const weight = mains[0]?.weight || splits[0]?.weight;\n    return {\n      mainKey: mains[0]?.key || splits[0]?.key,\n      split:\n        mains[0]?.key && splits[0]?.key\n          ? {\n              key: splits[0].key,\n              sizeFraction: mains[0].weight\n                ? 1 - mains[0].sideWeight\n                : splits[0].sideWeight,\n            }\n          : null,\n      size: weight * getSizeInAnchor(containerSize, anchor),\n    };\n  }\n  return null;\n};\n\nconst getUnDocked = (\n  anchor: Anchor,\n  containerSize: ContainerSize,\n  toolWindows: ToolWindowStateWithKey[]\n): SideUnDockedState => {\n  const windows = filterVisibleUnDocked(toolWindows);\n  if (windows.length === 1) {\n    return {\n      key: windows[0].key,\n      size: windows[0].weight * getSizeInAnchor(containerSize, anchor),\n    };\n  }\n  if (windows.length === 0) {\n    return null;\n  }\n  throw new Error(\n    \"More than one visible undocked window in a side is not possible\"\n  );\n};\n\nconst getSideState = (\n  anchor: Anchor,\n  containerSize: ContainerSize,\n  toolWindows: ToolWindowStateWithKey[]\n): SideState => ({\n  stripes: {\n    main: getMains(toolWindows),\n    split: getSplits(toolWindows),\n    activeKeys: mapToKey(toolWindows.filter(({ isVisible }) => isVisible)),\n  },\n  undocked: getUnDocked(anchor, containerSize, toolWindows),\n  docked: getDocked(anchor, containerSize, toolWindows),\n});\n\nconst DEFAULT_HEIGHT = 300;\nconst DEFAULT_WIDTH = 400;\nconst getFloatWindowState = (containerSize: ContainerSize) => ({\n  floatingBounds: bounds = {\n    top: containerSize.height / 2 - DEFAULT_HEIGHT / 2,\n    left: containerSize.width / 2 - DEFAULT_WIDTH / 2,\n    height: DEFAULT_HEIGHT,\n    width: DEFAULT_WIDTH,\n  },\n  key,\n}: ToolWindowStateWithKey): FloatWindowState => ({ bounds, key });\n\nconst getFloatWindowsState = (\n  viewMode: \"float\" | \"window\",\n  containerSize: ContainerSize,\n  toolWindows: ToolWindowStateWithKey[]\n) =>\n  pipe(\n    filterVisible(viewMode),\n    map<ToolWindowStateWithKey, FloatWindowState>(\n      getFloatWindowState(containerSize)\n    )\n  )(toolWindows);\n\nexport function getToolWindowsLayoutState(\n  state: Readonly<ToolWindowsState>,\n  containerSize: ContainerSize\n): ToolWindowsLayoutState {\n  const toolWindows = Object.keys(state.windows).map((key) => ({\n    ...state.windows[key],\n    key,\n  }));\n  const { top = [], bottom = [], left = [], right = [] } = groupBy(\n    ({ anchor }) => anchor,\n    toolWindows\n  );\n  return {\n    left: getSideState(\"left\", containerSize, left),\n    top: getSideState(\"top\", containerSize, top),\n    right: getSideState(\"right\", containerSize, right),\n    bottom: getSideState(\"bottom\", containerSize, bottom),\n    windows: getFloatWindowsState(\"window\", containerSize, toolWindows),\n    floatWindows: getFloatWindowsState(\"float\", containerSize, toolWindows),\n  };\n}\n","import React, { Key, RefObject, useContext, useMemo } from \"react\";\nimport { ToolWindowsProps } from \"../ToolWindows\";\nimport { ToolWindowState, ViewMode, WindowBounds } from \"./ToolWindowsState\";\nimport { Anchor } from \"../utils\";\n\ntype ToolWindowStateContextValue = {\n  state: Readonly<ToolWindowState>;\n  hide: () => void;\n  blur: () => void;\n  moveToSide: (args: { anchor: Anchor; isSplit: boolean }) => void;\n  changeViewMode: (viewMode: ViewMode) => void;\n  stretchWidth: (value: number) => void;\n  stretchHeight: (value: number) => void;\n  setFloatingBounds: (bounds: WindowBounds) => void;\n};\nconst ToolWindowStateContext = React.createContext<ToolWindowStateContextValue | null>(\n  null\n);\n\n/**\n * Used in a tool window's UI tree, to get access to the tool window state and actions for changing it.\n */\nexport const useToolWindowState = () => {\n  const context = useContext(ToolWindowStateContext);\n  if (!context) {\n    throw new Error(\n      \"useToolWindowContext is meant to be used inside a tool window.\"\n    );\n  }\n  return context;\n};\n\n/**\n * Used in ToolWindows to provide tool window state and necessary actions as a context, which will be accessible\n * within the tool window content tree, via {@link useToolWindowState}\n */\nexport const ToolWindowStateProvider: React.FC<\n  { id: Key; containerRef: RefObject<HTMLElement> } & Pick<\n    ToolWindowsProps,\n    \"toolWindowsState\" | \"onToolWindowStateChange\"\n  >\n> = ({\n  toolWindowsState,\n  containerRef,\n  onToolWindowStateChange,\n  id,\n  children,\n}) => {\n  const contextValue = useMemo((): ToolWindowStateContextValue => {\n    const state = toolWindowsState.windows[id];\n    return {\n      state,\n      hide: () => {\n        onToolWindowStateChange(toolWindowsState.hide(id));\n      },\n      blur: () => {\n        onToolWindowStateChange(toolWindowsState.blur(id));\n      },\n      moveToSide: (side) => {\n        onToolWindowStateChange(toolWindowsState.move(id, side));\n      },\n      changeViewMode: (viewMode: ViewMode) => {\n        onToolWindowStateChange(toolWindowsState.changeViewMode(id, viewMode));\n      },\n      stretchWidth: (value: number) => {\n        const container = containerRef.current;\n        if (!container) {\n          throw new Error(\"Couldn't resize since the container is not present\");\n        }\n        onToolWindowStateChange(\n          toolWindowsState.stretchWidth(\n            id,\n            value,\n            container.getBoundingClientRect()\n          )\n        );\n      },\n      stretchHeight: (value: number) => {\n        const container = containerRef.current;\n        if (!container) {\n          throw new Error(\"Couldn't resize since the container is not present\");\n        }\n        onToolWindowStateChange(\n          toolWindowsState.stretchHeight(\n            id,\n            value,\n            container.getBoundingClientRect()\n          )\n        );\n      },\n      setFloatingBounds: (bounds: WindowBounds) => {\n        onToolWindowStateChange(toolWindowsState.setFloatingBound(id, bounds));\n      },\n    };\n  }, [toolWindowsState, id]);\n  return (\n    <ToolWindowStateContext.Provider value={contextValue}>\n      {children}\n    </ToolWindowStateContext.Provider>\n  );\n};\n","import { Anchor, isHorizontal } from \"./utils\";\nimport { Key } from \"react\";\ntype Rect = Omit<ClientRect, \"toJSON\" | \"x\" | \"y\">;\n\nexport interface DropPosition {\n  index: number;\n  split: boolean;\n\n  relative?: {\n    placement: \"before\" | \"after\";\n    key: Key;\n  };\n}\n\n/**\n * TODO: Add a few words about what this function do.\n */\nexport const createGetDropPosition = <T extends any>({\n  anchor,\n  stripeElement,\n  splitItems,\n  mainItems,\n  getItemRect,\n  getKey,\n}: {\n  stripeElement: HTMLElement;\n  anchor: Anchor;\n  getItemRect: (key: Key) => Rect;\n  getKey: (key: T) => Key;\n  mainItems: T[];\n  splitItems: T[];\n}): ((draggedRect: Rect) => DropPosition | null) => {\n  // Note: It may be tempting to calculate stripe element boundaries just once\n  // here, since it's not supposed to change during a drag session, but it\n  // can change due to getting empty when the only button is being dragged out.\n  const getStripeRect = () => stripeElement.getBoundingClientRect();\n\n  const getCanDrop = (draggingRect: Rect) => {\n    const stripeRect = getStripeRect();\n    return (\n      draggingRect.right > stripeRect.left - stripeRect.width &&\n      draggingRect.left < stripeRect.right &&\n      draggingRect.bottom > stripeRect.top - stripeRect.height &&\n      draggingRect.top < stripeRect.bottom\n    );\n  };\n\n  const start = (rect: Rect) => (isHorizontal(anchor) ? rect.left : rect.top);\n  const end = (rect: Rect) => (isHorizontal(anchor) ? rect.right : rect.bottom);\n\n  const getKeyToOffsets = (items: T[]) => {\n    const keyToOffsets: Record<Key, { start: number; end: number }> = {};\n    items.forEach((item) => {\n      const key = getKey(item);\n      const boundingRect = getItemRect(key);\n      keyToOffsets[key] = {\n        start: start(boundingRect),\n        end: end(boundingRect),\n      };\n    });\n    return keyToOffsets;\n  };\n\n  const getDropPositions = (\n    items: T[],\n    split = false\n    // FIXME: score is a bad name. it's quite the opposite! the less means the higher score.\n  ): Array<DropPosition & { score: (rect: Rect) => number }> => {\n    const getRef = split ? end : start;\n    if (items.length === 0) {\n      // if the section is empty, we should still allow adding to it.\n      return [\n        {\n          index: 0,\n          split,\n          score: (draggingRect: Rect) =>\n            Math.abs(getRef(draggingRect) - getRef(getStripeRect())),\n        },\n      ];\n    }\n    return items.flatMap((item, index) => {\n      const key = getKey(item);\n      return [\n        {\n          index,\n          split,\n          relative: { key, placement: \"before\" },\n          score: (draggingRect: Rect) =>\n            Math.abs(getRef(draggingRect) - keyToOffsets[key].start),\n        },\n        {\n          index: index + 1,\n          split,\n          relative: { key, placement: \"after\" },\n          score: (draggingRect: Rect) =>\n            Math.abs(getRef(draggingRect) - keyToOffsets[key].end),\n        },\n      ];\n    });\n  };\n\n  const keyToOffsets = getKeyToOffsets([...mainItems, ...splitItems]);\n\n  const dropPositions = [\n    ...getDropPositions(mainItems),\n    ...getDropPositions(splitItems, true),\n  ];\n\n  let lastDropPosition: DropPosition | null = null;\n  return (draggingRect: Rect) => {\n    if (!getCanDrop(draggingRect)) {\n      return null;\n    }\n    const result = dropPositions.reduce(\n      (bestMatch, candidate) => {\n        const score = candidate.score(draggingRect);\n        if (!bestMatch || score < bestMatch.score) {\n          return {\n            ...candidate,\n            score,\n          };\n        }\n        return bestMatch;\n      },\n      null as\n        | null\n        | (DropPosition & {\n            score: number;\n          })\n    );\n\n    if (!result) {\n      return null;\n    }\n    if (\n      result.split !== lastDropPosition?.split ||\n      result.index !== lastDropPosition?.index\n    ) {\n      lastDropPosition = result;\n    }\n    return lastDropPosition;\n  };\n};\n","import { StyledIconWrapper } from \"../Icon/StyledIconWrapper\";\nimport { styled } from \"../styled\";\nimport React from \"react\";\nimport { css } from \"styled-components\";\nimport { Anchor } from \"./utils\";\n\nexport interface StyledToolWindowStripeButtonProps {\n  anchor: Anchor;\n  active?: boolean;\n}\n\nexport const STRIPE_BUTTON_CROSS_PADDING = 2.5;\nexport const STRIPE_BUTTON_LINE_HEIGHT = \"1rem\";\n\nconst anchorStyles = ({ anchor }: { anchor: Anchor }) => {\n  const orientation =\n    anchor === \"left\" || anchor === \"right\" ? \"vertical\" : \"horizontal\";\n\n  return orientation === \"horizontal\"\n    ? css`\n        padding: ${STRIPE_BUTTON_CROSS_PADDING}px 10px;\n      `\n    : css`\n        padding: 10px ${STRIPE_BUTTON_CROSS_PADDING}px;\n        writing-mode: vertical-lr;\n        // writing-mode: sideways-lr is not supported anywhere other than FF, so, we need to rotate\n        transform: ${anchor === \"left\" ? \"rotateZ(180deg)\" : undefined};\n\n        // icons are not rotated like text in Intellij Platform implementation. It kind of makes sense.\n        ${StyledIconWrapper} {\n          transform: rotate(180deg);\n        }\n      `;\n};\n\nexport const StyledToolWindowStripeButton = styled.span<StyledToolWindowStripeButtonProps>`\n  box-sizing: border-box;\n  display: flex; // to allow icon and text alignment by default;\n  align-items: center;\n  cursor: default;\n  user-select: none;\n  overflow: hidden;\n  direction: ltr;\n  flex-shrink: 0;\n  font-size: 0.7rem;\n  line-height: ${STRIPE_BUTTON_LINE_HEIGHT}; // absolute value seems to be problematic when the base font size is changed\n  white-space: nowrap;\n  color: ${({ theme, active }) =>\n    active\n      ? theme.color(\n          \"ToolWindow.Button.selectedForeground\",\n          theme.dark ? \"rgb(255,255,255)\" : \"rgb(0,0,0)\"\n        )\n      : theme.color(\"*.foreground\")};\n  background: ${({ theme, active }) =>\n    active\n      ? theme.color(\n          \"ToolWindow.Button.selectedBackground\",\n          theme.dark ? \"rgba(15,15,15,.332)\" : \"rgba(85,85,85,.332)\"\n        )\n      : undefined};\n\n  ${anchorStyles}\n  ${({ active }) =>\n    !active &&\n    css`\n      &:hover {\n        background: ${({ theme }) =>\n          theme.color(\n            \"ToolWindow.Button.hoverBackground\",\n            theme.dark ? \"rgba(15,15,15,.156)\" : \"rgba(85,85,85,.156)\"\n          )};\n      }\n    `};\n`;\n","// language=JSRegexp\nconst numberPattern = \"[0-9]{0,3}.?[0-9]*\";\n\nconst parseComponent = (componentStr: string, index: number) =>\n  componentStr\n    ? index < 3\n      ? parseInt(componentStr)\n      : Math.round(Math.min(parseFloat(componentStr), 1) * 255)\n    : undefined;\n\nconst parseHexRgba = (str: string) =>\n  str\n    .match(/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?$/i)\n    ?.slice(1, 5)\n    .map((i) => (i ? parseInt(i, 16) : undefined));\nconst parseShorthandHex = (str: string) =>\n  str\n    .match(/^#?([0-9A-F])([0-9A-F])([0-9A-F])$/i)\n    ?.slice(1, 4)\n    .map((i) => (i ? parseInt(i + i, 16) : undefined));\nconst parseRgb = (str: string) =>\n  str\n    .match(\n      new RegExp(\n        `^rgb\\\\(\\\\s*(${numberPattern})\\\\s*,\\\\s*(${numberPattern})\\\\s*,\\\\s*(${numberPattern}\\\\s*)\\\\)$`\n      )\n    )\n    ?.slice(1, 5)\n    .map(parseComponent);\nconst parseRgba = (str: string) =>\n  str\n    .match(\n      new RegExp(\n        `^rgba\\\\(\\\\s*(${numberPattern})\\\\s*,\\\\s*(${numberPattern})\\\\s*,\\\\s*(${numberPattern})\\\\s*,\\\\s*(${numberPattern}\\\\s*)\\\\)$`\n      )\n    )\n    ?.slice(1, 5)\n    .map(parseComponent);\n\n/**\n * parses a color string into rgba components.\n * @param str\n */\nexport const parseColorString = (\n  str: string\n): [number, number, number, number?] | null => {\n  const result = [parseHexRgba, parseShorthandHex, parseRgb, parseRgba].reduce<\n    (number | undefined)[] | undefined\n  >((result, parse) => result || parse(str), undefined);\n  return Array.isArray(result) &&\n    result.slice(0, 3).every((c) => Number.isInteger(c))\n    ? (result as [number, number, number, number?])\n    : null;\n};\n","import { parseColorString } from \"./parseColorString\";\n\n/**\n * A Color class resembling AWT Color\n */\nexport class Color {\n  public readonly r: number;\n  public readonly g: number;\n  public readonly b: number;\n  public readonly a: number;\n\n  private static readonly FACTOR = 0.7;\n\n  constructor(r: number, g: number, b: number, a?: number);\n  constructor(rgba: string);\n  constructor(rgba: Color);\n  constructor(\n    rgba: string | number | Color,\n    g?: number,\n    b?: number,\n    a: number = 255\n  ) {\n    let r: number;\n    if (typeof rgba === \"string\") {\n      [r = NaN, g = NaN, b = NaN, a = 255] = parseColorString(rgba) || [];\n    } else if (rgba instanceof Color) {\n      [r, g, b, a] = [rgba.r, rgba.g, rgba.b, rgba.a];\n    } else {\n      r = rgba;\n    }\n    this.r = r;\n    this.g = g!;\n    this.b = b!;\n    this.a = a < 1 ? Math.round(a * 255) : a;\n  }\n\n  isValid() {\n    return (\n      Number.isInteger(this.r) &&\n      Number.isInteger(this.g) &&\n      Number.isInteger(this.b) &&\n      Number.isInteger(this.a)\n    );\n  }\n\n  brighter() {\n    let { r, g, b, a: alpha } = this;\n    const int = Math.floor,\n      FACTOR = Color.FACTOR;\n    // The rest is copy paste of java.awt.Color (only `int i` is changed to `let i` :D)\n    let i = int(1.0 / (1.0 - FACTOR));\n    if (r == 0 && g == 0 && b == 0) {\n      return new Color(i, i, i, alpha);\n    }\n    if (r > 0 && r < i) r = i;\n    if (g > 0 && g < i) g = i;\n    if (b > 0 && b < i) b = i;\n\n    return new Color(\n      Math.min(int(r / FACTOR), 255),\n      Math.min(int(g / FACTOR), 255),\n      Math.min(int(b / FACTOR), 255),\n      alpha\n    );\n  }\n\n  static brighter(color: string): string {\n    // note: we can't type args simply with ConstructorParameters<typeof Color>.\n    // see more: https://github.com/microsoft/TypeScript/issues/37079\n    return new Color(color).brighter().toString();\n  }\n\n  blend(color: Color) {\n    const getBlendedValue = (component: \"r\" | \"g\" | \"b\") =>\n      Math.round(\n        (color.a / 255) * color[component] +\n          (this.a / 255) * (1 - color.a / 255) * this[component]\n      );\n    return new Color(\n      getBlendedValue(\"r\"),\n      getBlendedValue(\"g\"),\n      getBlendedValue(\"b\")\n    );\n  }\n\n  toString() {\n    const toString = (component: number) =>\n      Number.isNaN(component) ? \"\" : component.toString(16).padStart(2, \"0\");\n    const r = toString(this.r);\n    const g = toString(this.g);\n    const b = toString(this.b);\n    const a = this.a === 255 ? \"\" : toString(this.a);\n    return `#${r}${g}${b}${a}`;\n  }\n}\n","import {\n  STRIPE_BUTTON_CROSS_PADDING,\n  STRIPE_BUTTON_LINE_HEIGHT,\n} from \"./StyledToolWindowStripeButton\";\nimport { Anchor, isHorizontal, theOtherSide } from \"./utils\";\nimport { css } from \"styled-components\";\nimport { Theme } from \"../Theme/Theme\";\nimport { styled } from \"../styled\";\nimport { Color } from \"../Theme/Color\";\n\nconst minHeight = `calc(${STRIPE_BUTTON_LINE_HEIGHT} + ${\n  2 * STRIPE_BUTTON_CROSS_PADDING + 1 /*border*/\n}px)`;\n\nconst anchorStyles = ({\n  anchor,\n  preventCollapse,\n}: StyledToolWindowStripeProps) =>\n  isHorizontal(anchor)\n    ? css`\n        flex-direction: row;\n        width: 100%;\n        min-height: ${preventCollapse ? minHeight : \"fit-content\"};\n      `\n    : css`\n        flex-direction: column;\n        height: 100%;\n        min-width: ${preventCollapse ? minHeight : \"fit-content\"};\n      `;\nconst borderStyle = ({ anchor, theme }: { anchor: Anchor; theme: Theme }) =>\n  css`border-${theOtherSide(anchor)}: 1px solid ${\n    theme.commonColors.contrastBorder\n  }`;\n\nexport interface StyledToolWindowStripeProps {\n  anchor: Anchor;\n  highlighted?: boolean;\n  preventCollapse?: boolean;\n}\n\nexport const StyledToolWindowStripe = styled.div<StyledToolWindowStripeProps>`\n  box-sizing: border-box;\n  background: ${({ theme, highlighted }) =>\n    highlighted\n      ? Color.brighter(theme.commonColors.panelBackground)\n      : theme.commonColors.panelBackground};\n  display: inline-flex;\n  overflow: hidden;\n  ${borderStyle};\n  ${anchorStyles}\n`;\n\nexport const StyledSpacer = styled.div`\n  flex: 1;\n`;\n","import { useMove, UseMoveOptions, XY } from \"./useMove\";\nimport { RefObject } from \"react\";\nimport { findEffectiveBackgroundColor } from \"./findEffectiveBackgroundColor\";\n\ntype Rect = Omit<ClientRect, \"toJSON\" | \"x\" | \"y\">;\n\nexport interface UseElementMoveOptions<S>\n  extends Omit<UseMoveOptions<S>, \"onMoveStart\" | \"onMove\"> {\n  ref: RefObject<HTMLElement>;\n  /**\n   * if true a clone of the element is created and used as ghost.\n   * A function can be passed to customize the default ghost element or return a completely\n   * different one.\n   */\n  ghost?: boolean | ((defaultGhost: HTMLElement) => HTMLElement);\n\n  onMoveStart: (args: { from: Rect }) => S;\n  onMove: (args: { from: Rect; to: Rect; movement: XY; startState: S }) => void;\n}\n\n/**\n * Provides necessary event handling props to be applied on an element to make it movable.\n * It's implemented on top of {@link useMove}. The differences are:\n * - The signature of `onMoveStart`, `onMove` and `onMoveEnd` are changed to pass\n *   {@link Rect} instead of {@link XY}.\n * - rendering a ghost element.\n *\n * ## A note about ghost:\n * There is no easy way to create a snapshot image of an html element. Native drag and drop API\n * supports [setting drag\n * image](https://developer.mozilla.org/en-US/docs/Web/API/DataTransfer/setDragImage) but we are\n * not using drag events mainly because of not being able to customize the offset after which drag\n * should start. See {@link UseMoveOptions#dragThreshold dragThreshold} for more details. There are\n * some libraries like html2canvas for creating an image from an html element, but they are very\n * big and using them doesn't make sense at all from a value/cost ratio perspective. There might be\n * some ways of implementing custom move threshold on top of native drag events. For example by\n * delaying the call to setDragImage, but it needs more investigation. Also, not sure if opacity of\n * the ghost is something you can control when using setDragImage.\n **/\nexport function useElementMove<S>({\n  ref,\n  onMoveStart,\n  onMove,\n  onMoveEnd,\n  ghost: ghostOption,\n  ...otherOptions\n}: UseElementMoveOptions<S>) {\n  return useMove({\n    ...otherOptions,\n    onMoveStart: () => {\n      const element = ref.current;\n      let ghost: HTMLElement | null = null;\n      if (!element) {\n        throw new Error(\n          \"Movement started but ref value is null. Make sure the passed ref is applied on the same element that other props are.\"\n        );\n      }\n      const updateGhostPosition = (rect: Rect) => {\n        if (ghost) {\n          ghost.style.left = `${rect.left}px`;\n          ghost.style.top = `${rect.top}px`;\n        }\n      };\n      const from: Rect = element.getBoundingClientRect();\n      if (ghostOption) {\n        const defaultGhost = createDefaultGhost(element);\n        ghost =\n          typeof ghostOption === \"function\"\n            ? ghostOption(defaultGhost) || defaultGhost\n            : defaultGhost;\n        ghost.style.position = \"absolute\";\n        document.body.append(ghost);\n        updateGhostPosition(from);\n      }\n      return {\n        ghost,\n        from,\n        updateGhostPosition,\n        startState: onMoveStart({ from }),\n      };\n    },\n    onMove: ({\n      movement,\n      startState: { from, updateGhostPosition, startState },\n    }) => {\n      const to: Rect = {\n        left: from.left + movement.x,\n        right: from.right + movement.x,\n        top: from.top + movement.y,\n        bottom: from.bottom + movement.y,\n        height: from.height,\n        width: from.width,\n      };\n      updateGhostPosition(to);\n      onMove({ from, to, movement, startState });\n    },\n    onMoveEnd: ({ startState: { ghost, startState } }) => {\n      ghost?.remove();\n      onMoveEnd({ startState });\n    },\n  });\n}\n\nfunction createDefaultGhost(element: HTMLElement) {\n  const ghost = element.cloneNode(true) as HTMLElement;\n  ghost.style.backgroundColor = findEffectiveBackgroundColor(element);\n  return ghost;\n}\n","import { Color } from \"../Theme/Color\";\n\n/**\n * Computes the effective background color of the element by blending translucent backgrounds of\n * the elements ancestors. It traverses up the parents, until reaches a solid background color.\n * all translucent backgrounds in between are blended with that solid color, with respect to their\n * transparency. It's meant to be used only for the simple cases where an element doesn't overflow\n * the parents. Obviously, in other cases there won't be one single effective background color\n * for the element.\n */\nexport function findEffectiveBackgroundColor(element: HTMLElement): string {\n  let elem: HTMLElement | null = element;\n  let colors: Color[] = [];\n  while (elem != null) {\n    const computedBackground = getComputedStyle(elem).backgroundColor;\n    if (computedBackground) {\n      const color = new Color(computedBackground);\n      colors.unshift(color);\n      if (color.a === 255) {\n        // if we've reached a solid color, we don't need to continue traversing ancestors\n        break;\n      }\n    }\n    elem = elem.parentElement;\n  }\n  return (\n    colors\n      .reduce<Color | null>((resultColor, nextColor) => {\n        return resultColor ? resultColor.blend(nextColor) : nextColor;\n      }, null)\n      ?.toString() || \"\"\n  );\n}\n","import { mergeProps } from \"@react-aria/utils\";\nimport React, { CSSProperties, Key, useRef } from \"react\";\nimport { createGetDropPosition, DropPosition } from \"./createGetDropPosition\";\nimport { useMovableStripeButtons } from \"./MovableToolWindowStripeProvider\";\nimport { StyledSpacer, StyledToolWindowStripe } from \"./StyledToolWindowStripe\";\nimport { StyledToolWindowStripeButton } from \"./StyledToolWindowStripeButton\";\nimport { useElementMove, UseElementMoveOptions } from \"./useElementMove\";\nimport { Anchor, isHorizontal } from \"./utils\";\n\ninterface ToolWindowStripeProps<T> {\n  anchor: Anchor;\n  items: T[];\n  splitItems?: T[];\n  getKey: (item: T) => Key;\n  renderItem: (item: T) => React.ReactNode;\n  selectedKeys?: Key[];\n  onItemPress?: (key: Key) => void;\n}\n\n/**\n * TODO: refactor to remove the key based interface.\n */\nexport function ToolWindowStripe<T>({\n  anchor,\n  items: mainItems,\n  renderItem: render,\n  splitItems = [],\n  selectedKeys = [],\n  onItemPress,\n  getKey,\n}: ToolWindowStripeProps<T>) {\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const {\n    getProps,\n    draggingRect,\n    draggingKey,\n    dropPosition,\n  } = useMovableStripeButtons({\n    stripeElRef: containerRef,\n    getKey,\n    anchor,\n    mainItems,\n    splitItems,\n    createGetDropPosition: (key: Key) => {\n      const isNotCurrentItem = (anItem: T) => getKey(anItem) !== key;\n      const stripeElement = containerRef.current!;\n      const getItemRect = (key: Key) =>\n        stripeElement\n          .querySelector(`[data-key=\"${key}\"]`)! // FIXME\n          .getBoundingClientRect();\n      return createGetDropPosition({\n        stripeElement: stripeElement,\n        mainItems: mainItems.filter(isNotCurrentItem),\n        splitItems: splitItems.filter(isNotCurrentItem),\n        getKey,\n        anchor,\n        getItemRect,\n      });\n    },\n  });\n\n  const highlighted =\n    dropPosition != null &&\n    draggingKey != null &&\n    [...mainItems, ...splitItems].every((item) => getKey(item) !== draggingKey);\n\n  const renderItem = (item: T) => {\n    const key = getKey(item);\n\n    return (\n      <ToolWindowStripeButton\n        anchor={anchor}\n        key={key}\n        data-key={key}\n        style={{\n          ...getStripeButtonStyles({\n            key,\n            dropPosition,\n            anchor,\n            draggingRect,\n            draggingKey,\n          }),\n        }}\n        {...getProps(key)}\n        active={selectedKeys.includes(key)}\n        onPress={() => onItemPress?.(key)}\n      >\n        {render(item)}\n      </ToolWindowStripeButton>\n    );\n  };\n  return (\n    <>\n      <StyledToolWindowStripe\n        anchor={anchor}\n        preventCollapse={Boolean(dropPosition)}\n        highlighted={highlighted}\n        ref={containerRef}\n      >\n        {mainItems.map(renderItem)}\n        <StyledSpacer />\n        {splitItems.map(renderItem)}\n      </StyledToolWindowStripe>\n    </>\n  );\n}\ntype Rect = Omit<ClientRect, \"toJSON\" | \"x\" | \"y\">;\n\nfunction getStripeButtonStyles({\n  anchor,\n  key,\n  dropPosition,\n  draggingRect,\n  draggingKey,\n}: {\n  anchor: Anchor;\n  key: Key;\n  draggingKey: Key | null;\n  draggingRect: Rect | null;\n  dropPosition: DropPosition | null;\n}) {\n  const styles: CSSProperties = {\n    // transition: \"margin 100ms\", // maybe only when drag is in progress, if unwanted transition at drop\n  };\n  if (dropPosition?.relative?.key === key && draggingRect) {\n    const marginValue = isHorizontal(anchor)\n      ? draggingRect.width\n      : draggingRect.height;\n\n    if (isHorizontal(anchor)) {\n      styles[\n        dropPosition.relative.placement === \"before\"\n          ? \"marginLeft\"\n          : \"marginRight\"\n      ] = marginValue;\n    } else {\n      styles[\n        dropPosition.relative.placement === \"before\"\n          ? \"marginTop\"\n          : \"marginBottom\"\n      ] = marginValue;\n    }\n  }\n  if (key === draggingKey) {\n    styles.display = \"none\";\n  }\n  return styles;\n}\n\nfunction ToolWindowStripeButton<T, S>({\n  children,\n  anchor,\n  onMoveStart,\n  onMove,\n  onMoveEnd,\n  onPress,\n  moveDisabled,\n  ...otherProps\n}: {\n  children: React.ReactNode;\n  anchor: Anchor;\n  style: CSSProperties;\n  active: boolean;\n  onPress: () => void;\n  moveDisabled?: boolean;\n  onMoveStart: UseElementMoveOptions<S>[\"onMoveStart\"];\n  onMove: UseElementMoveOptions<S>[\"onMove\"];\n  onMoveEnd: UseElementMoveOptions<S>[\"onMoveEnd\"];\n}) {\n  const ref = useRef<HTMLElement>(null);\n\n  // for some reason, usePress and useMove (used in useElementMove) are not compatible.\n  // it seems onMouseDown in useMove is not called, even when handlers are merged by mergeProps.\n  // FIXME: fix compatibility of useMove and usePress, and switch to usePress({ onPress })\n  const { pressProps } = { pressProps: { onClick: onPress } }; //usePress({ onPress });\n  const props = useElementMove({\n    ref,\n    disabled: moveDisabled,\n    dragThreshold: 7,\n    ghost: true,\n    onMoveStart,\n    onMove,\n    onMoveEnd,\n  });\n\n  return (\n    <StyledToolWindowStripeButton\n      anchor={anchor}\n      {...mergeProps(otherProps, pressProps, props)}\n      ref={ref}\n    >\n      {children}\n    </StyledToolWindowStripeButton>\n  );\n}\n","import React from \"react\";\nimport { css } from \"styled-components\";\nimport { ResizableView } from \"../ResizableView\";\nimport { styled } from \"../styled\";\nimport { SideUnDockedState } from \"./ToolWindowsState/ToolWindowsLayoutState\";\nimport { Anchor, isHorizontal } from \"./utils\";\n\nexport const StyledUndockSide = styled.div<{ anchor: Anchor }>`\n  position: absolute;\n  background: inherit;\n  z-index: 1;\n  ${({ anchor }) =>\n    isHorizontal(anchor)\n      ? css`\n          left: 0;\n          right: 0;\n        `\n      : css`\n          top: 0;\n          bottom: 0;\n        `};\n  ${({ anchor }) =>\n    css`\n      ${anchor}: 0;\n    `};\n`;\n\nexport function UndockSide({\n  state,\n  anchor,\n  children,\n  onResize,\n}: {\n  state: Exclude<SideUnDockedState, null>;\n  anchor: Anchor;\n  children: React.ReactNode;\n  onResize: (size: number) => void;\n}) {\n  return (\n    state && (\n      <StyledUndockSide anchor={anchor}>\n        <ResizableView\n          orientation={isHorizontal(anchor) ? \"vertical\" : \"horizontal\"}\n          resizerPlacement={\n            anchor === \"left\" || anchor === \"top\" ? \"after\" : \"before\"\n          }\n          size={state.size}\n          onResize={onResize}\n        >\n          {children}\n        </ResizableView>\n      </StyledUndockSide>\n    )\n  );\n}\n","import { FocusScope } from \"@react-aria/focus\";\nimport React, {\n  CSSProperties,\n  Key,\n  useLayoutEffect,\n  useRef,\n  useState,\n} from \"react\";\nimport { ThreeViewSplitter } from \"../ThreeViewSplitter/ThreeViewSplitter\";\nimport { FloatToolWindows } from \"./FloatToolWindows\";\nimport { MovableToolWindowStripeProvider } from \"./MovableToolWindowStripeProvider\";\nimport { StyledToolWindowOuterLayout } from \"./StyledToolWindowOuterLayout\";\nimport {\n  getToolWindowsLayoutState,\n  SideDockedState,\n  StripesState,\n  ToolWindowsLayoutState,\n} from \"./ToolWindowsState/ToolWindowsLayoutState\";\nimport { ToolWindowsState } from \"./ToolWindowsState/ToolWindowsState\";\nimport { ToolWindowStateProvider } from \"./ToolWindowsState/ToolWindowStateProvider\";\nimport { ToolWindowStripe } from \"./ToolWindowStripe\";\nimport { UndockSide } from \"./UndockSide\";\nimport { Anchor, isHorizontal } from \"./utils\";\n\nexport interface ToolWindowsProps {\n  toolWindowsState: Readonly<ToolWindowsState>;\n  onToolWindowStateChange: (newState: ToolWindowsState) => void;\n\n  renderToolbarButton: (id: Key) => React.ReactNode;\n  renderWindow: (id: Key) => React.ReactNode;\n  /**\n   * Whether stripe buttons should be hidden or not.\n   * `hideToolStripes` UISettings in Intellij Platform\n   */\n  hideToolWindowBars?: boolean;\n\n  /**\n   *\n   * `wideScreenSupport` in UISettings in Intellij Platform\n   */\n  useWidescreenLayout?: boolean;\n\n  /**\n   * min width applied to the main content (children).\n   * @default 50\n   */\n  mainContentMinWidth?: number;\n\n  height?: CSSProperties[\"height\"];\n}\n\n/**\n * @constructor\n *\n * Corresponding to ToolWindowPane in Intellij Platform\n *\n * Known issues:\n * - in Firefox and Safari, left and right toolbars are not properly shown. Seems like a nasty bug, since adding and\n * then removing some min-width: fit-content style fixes it.\n * - in the dock view of a side, open only a window from the split ones. then open a window from main ones.\n *   focus is not moved to the just opened window. The reason is we rely on auto focusing and because the react tree\n *   changes for both windows, even the split one which was open will be unmounted and mounted again, and since it's\n *   placed after the main one, and hence mounted later, it will get the focus again. This becomes a bigger issue\n *   if the main one is unpinned, because it immediately gets closed after opening.\n *   Possible solutions:\n *   - make sure the split one won't unmount and mount again in such scenario.\n *   - decouple focusing logic from mounting logic, and only focus windows somehow, when the `isVisible` is changed\n *     from false to true, not when mounted.\n * - related to previous issue: open a tool window in split section of a side. set view mode for a tool window in main\n *   section of the same side to docked_unpinned. try to open the unpinned one while the split one is open. it doesn't\n *   work.\n */\nexport const ToolWindows: React.FC<ToolWindowsProps> = ({\n  hideToolWindowBars = false,\n  useWidescreenLayout = false,\n  height = \"100%\",\n  toolWindowsState,\n  onToolWindowStateChange,\n  renderToolbarButton,\n  renderWindow,\n  children,\n  mainContentMinWidth = 50,\n}): React.ReactElement => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [layoutState, setLayoutState] = useState<ToolWindowsLayoutState>();\n  useLayoutEffect(() => {\n    setLayoutState(\n      getToolWindowsLayoutState(\n        toolWindowsState,\n        containerRef.current!.getBoundingClientRect()\n      )\n    );\n  }, [toolWindowsState]);\n\n  // TODO: extract component candidate\n  const renderStripe = ({\n    anchor,\n    state,\n  }: {\n    anchor: Anchor;\n    state: StripesState;\n  }) => (\n    <ToolWindowStripe\n      anchor={anchor}\n      items={state.main}\n      splitItems={state.split}\n      getKey={(item) => item}\n      renderItem={(item) => renderToolbarButton(item)}\n      onItemPress={(key) =>\n        onToolWindowStateChange(toolWindowsState.toggle(key))\n      }\n      selectedKeys={state.activeKeys}\n    />\n  );\n\n  const renderToolWindow = (key: Key) => (\n    <ToolWindowStateProvider\n      id={key}\n      containerRef={containerRef}\n      toolWindowsState={toolWindowsState}\n      onToolWindowStateChange={onToolWindowStateChange}\n    >\n      {renderWindow(key)}\n    </ToolWindowStateProvider>\n  );\n  // TODO: extract component candidate\n  const renderSideDockedView = ({\n    anchor,\n    state,\n  }: {\n    anchor: Anchor;\n    state: SideDockedState;\n  }) => {\n    if (!state) {\n      return null;\n    }\n    return (\n      <ThreeViewSplitter\n        innerView={renderToolWindow(state.mainKey)}\n        innerViewMinSize={50}\n        lastView={state.split && renderToolWindow(state.split.key)}\n        lastSize={state.split?.sizeFraction}\n        onLastResize={(newSize) => {\n          onToolWindowStateChange(\n            toolWindowsState.resizeDockSplitView(anchor, newSize)\n          );\n        }}\n        orientation={isHorizontal(anchor) ? \"horizontal\" : \"vertical\"}\n      />\n    );\n  };\n  const onDockResize = (anchor: Anchor) => (size: number) => {\n    const containerBounds = containerRef.current?.getBoundingClientRect();\n    // containerBounds should have value in normal course of events\n    if (containerBounds) {\n      onToolWindowStateChange(\n        toolWindowsState.resizeDock(anchor, size, containerBounds)\n      );\n    }\n  };\n  const getSplitViewProps = (\n    layoutState: ToolWindowsLayoutState,\n    orientation: \"horizontal\" | \"vertical\"\n  ) => {\n    const firstAnchor = orientation === \"horizontal\" ? \"left\" : \"top\";\n    const secondAnchor = orientation === \"horizontal\" ? \"right\" : \"bottom\";\n    return {\n      orientation,\n      firstView: renderSideDockedView({\n        anchor: firstAnchor,\n        state: layoutState[firstAnchor].docked,\n      }),\n      firstSize: layoutState[firstAnchor].docked?.size,\n      onFirstResize: onDockResize(firstAnchor),\n      lastView: renderSideDockedView({\n        anchor: secondAnchor,\n        state: layoutState[secondAnchor].docked,\n      }),\n      lastSize: layoutState[secondAnchor].docked?.size,\n      onLastResize: onDockResize(secondAnchor),\n    };\n  };\n  const renderInnerLayout = (layoutState: ToolWindowsLayoutState) => {\n    const horizontalSplitterProps = getSplitViewProps(\n      layoutState,\n      \"horizontal\"\n    );\n    const verticalSplitterProps = getSplitViewProps(layoutState, \"vertical\");\n\n    const [outerSplitterProps, innerSplitterProps] = useWidescreenLayout\n      ? [horizontalSplitterProps, verticalSplitterProps]\n      : [verticalSplitterProps, horizontalSplitterProps];\n\n    const undockLayers = ([\"left\", \"top\", \"right\", \"bottom\"] as const).map(\n      (anchor) => {\n        const state = layoutState[anchor].undocked;\n        return (\n          state && (\n            <UndockSide\n              key={anchor}\n              anchor={anchor}\n              state={state}\n              onResize={(size) => {\n                containerRef.current &&\n                  onToolWindowStateChange(\n                    toolWindowsState.resizeUndock(\n                      anchor,\n                      size,\n                      containerRef.current.getBoundingClientRect()\n                    )\n                  );\n              }}\n            >\n              {renderToolWindow(state.key)}\n            </UndockSide>\n          )\n        );\n      }\n    );\n\n    return (\n      <>\n        <MovableToolWindowStripeProvider\n          onMove={({ to, from }) => {\n            onToolWindowStateChange(\n              toolWindowsState.move(\n                layoutState[from.anchor].stripes[\n                  from.isSplit ? \"split\" : \"main\"\n                ][from.index],\n                { anchor: to.anchor, isSplit: to.isSplit },\n                to.index\n              )\n            );\n          }}\n        >\n          {/**\n           * ToolWindow bars, aka Stripes. Order of stripes is irrelevant for layout but relevant for\n           * priority when stripe buttons are moved across stripes.\n           * layout is handled by `StyledToolWindowOuterLayout`.\n           */}\n          <StyledToolWindowOuterLayout.LeftStripe>\n            {renderStripe({\n              anchor: \"left\",\n              state: layoutState[\"left\"].stripes,\n            })}\n          </StyledToolWindowOuterLayout.LeftStripe>\n          <StyledToolWindowOuterLayout.TopStripe>\n            {renderStripe({\n              anchor: \"top\",\n              state: layoutState[\"top\"].stripes,\n            })}\n          </StyledToolWindowOuterLayout.TopStripe>\n          <StyledToolWindowOuterLayout.RightStripe>\n            {renderStripe({\n              anchor: \"right\",\n              state: layoutState[\"right\"].stripes,\n            })}\n          </StyledToolWindowOuterLayout.RightStripe>\n          <StyledToolWindowOuterLayout.BottomStripe>\n            {renderStripe({\n              anchor: \"bottom\",\n              state: layoutState[\"bottom\"].stripes,\n            })}\n          </StyledToolWindowOuterLayout.BottomStripe>\n        </MovableToolWindowStripeProvider>\n        {/**\n         * The inner layout of the ToolWindow, including four tool windows and\n         * a main content in the center.\n         */}\n        <StyledToolWindowOuterLayout.MainView>\n          <ThreeViewSplitter\n            {...outerSplitterProps}\n            innerView={\n              <ThreeViewSplitter\n                innerViewMinSize={mainContentMinWidth}\n                innerView={<FocusScope>{children}</FocusScope>}\n                {...innerSplitterProps}\n              />\n            }\n          />\n          {undockLayers}\n          {\n            <FloatToolWindows\n              floatWindows={layoutState?.floatWindows}\n              renderToolWindow={renderToolWindow}\n              onBoundsChange={(key, bounds) =>\n                onToolWindowStateChange(\n                  toolWindowsState.setFloatingBound(key, bounds)\n                )\n              }\n            />\n          }\n        </StyledToolWindowOuterLayout.MainView>\n      </>\n    );\n  };\n  return (\n    /**\n     * Potential refactoring: hideStripes can also be handled by conditionally\n     * rendering tool window bars, instead of considering it as a feature of\n     * StyledToolWindowOuterLayout\n     **/\n    <StyledToolWindowOuterLayout.Shell\n      ref={containerRef}\n      hideStripes={hideToolWindowBars}\n      style={{ height }}\n    >\n      {layoutState && renderInnerLayout(layoutState)}\n    </StyledToolWindowOuterLayout.Shell>\n  );\n};\n","import React, { ReactNode } from \"react\";\nimport { Divider, DividerItem } from \"../Collections/Divider\";\nimport { PlatformIcon } from \"../Icon\";\nimport { Item, Menu, MenuItemLayout } from \"../Menu\";\nimport { useToolWindowState } from \"./ToolWindowsState/ToolWindowStateProvider\";\nimport { ViewMode } from \"./ToolWindowsState/ToolWindowsState\";\nimport { Anchor, isHorizontal } from \"./utils\";\n\nconst viewModes: ViewMode[] = [\n  \"docked_pinned\",\n  \"docked_unpinned\",\n  \"undock\",\n  \"float\",\n  \"window\",\n];\nexport const anchors: Array<{\n  anchor: Anchor;\n  isSplit: boolean;\n  id: string;\n}> = [\n  { id: \"moveToLeftTop\", anchor: \"left\", isSplit: false },\n  { id: \"moveToLeftBottom\", anchor: \"left\", isSplit: true },\n  { id: \"moveToBottomLeft\", anchor: \"bottom\", isSplit: false },\n  { id: \"moveToBottomRight\", anchor: \"bottom\", isSplit: true },\n  { id: \"moveToRightTop\", anchor: \"right\", isSplit: true },\n  { id: \"moveToRightBottom\", anchor: \"right\", isSplit: false },\n  { id: \"moveToTopRight\", anchor: \"top\", isSplit: true },\n  { id: \"moveToTopLeft\", anchor: \"top\", isSplit: false },\n];\n\nconst getAnchorName = ({\n  anchor,\n  isSplit,\n}: {\n  anchor: Anchor;\n  isSplit: boolean;\n}) =>\n  `${anchor[0].toUpperCase()}${anchor.slice(1)} ${\n    isHorizontal(anchor)\n      ? isSplit\n        ? \"Right\"\n        : \"Left\"\n      : isSplit\n      ? \"Bottom\"\n      : \"Top\"\n  }`;\nconst viewModeToString: Record<ViewMode, string> = {\n  undock: \"Undock\",\n  docked_pinned: \"Dock Pinned\",\n  docked_unpinned: \"Dock Unpinned\",\n  float: \"Float\",\n  window: \"Window\",\n};\n\n// TODO: replace these temporary action types with the real ones when action system is implemented.\n//  action would be an entity with association to:\n//  - some presentation (title and icon)\n//  - a set of shortcuts\n//  right now those pieces of information are just mixed in one simple object\ntype ActionBase = {\n  id: string;\n  title: string;\n  shortcut?: string;\n  icon?: ReactNode;\n};\ntype Action = ActionBase & {\n  perform: () => void;\n};\ntype ActionGroup = ActionBase & {\n  actions?: Action[];\n};\ntype ActionItem = ActionGroup | Action;\n\n// Resize steps in Intellij Platform is calculated based on the size of a \"W\" character and some\n// configuration (ide.windowSystem.hScrollChars). Although it's technically feasible, it seems not necessary\nconst HEIGHT_RESIZE_STEP = 16 * 5;\nconst WIDTH_RESIZE_STEP = 13 * 5;\n\n/**\n * Tool window gear icon menu, with a set of default actions and some extra ones.\n * TODO: add support for extra actions when action system is progressed a little.\n */\nexport function ToolWindowSettingsIconMenu({\n  close,\n  menuProps,\n}: {\n  close: () => void;\n  menuProps: React.HTMLAttributes<HTMLElement>;\n}) {\n  const {\n    state,\n    changeViewMode,\n    moveToSide,\n    stretchWidth,\n    stretchHeight,\n  } = useToolWindowState();\n\n  const viewModeActions: Action[] = viewModes.map((viewMode) => ({\n    id: `viewMode ${viewModeToString[viewMode]}`,\n    title: viewModeToString[viewMode],\n    perform: () => {\n      changeViewMode(viewMode);\n    },\n  }));\n  const moveToActions: Action[] = anchors.map((anchor) => ({\n    id: `anchor ${getAnchorName(anchor)}`,\n    title: getAnchorName(anchor),\n    icon: <PlatformIcon icon={`actions/${anchor.id}`} />,\n    perform: () => {\n      moveToSide(anchor);\n    },\n  }));\n\n  const resizeActions: Action[] = [];\n  if (state.viewMode !== \"float\" && state.viewMode !== \"window\") {\n    if (isHorizontal(state.anchor)) {\n      resizeActions.push(\n        {\n          id: \"ResizeToolWindowTop\",\n          title: \"Stretch to top\",\n          shortcut: \"\",\n          perform: () => {\n            stretchHeight(\n              state.anchor === \"top\" ? -HEIGHT_RESIZE_STEP : HEIGHT_RESIZE_STEP\n            );\n          },\n        },\n        {\n          id: \"ResizeToolWindowBottom\",\n          title: \"Stretch to bottom\",\n          shortcut: \"\",\n          perform: () => {\n            stretchHeight(\n              state.anchor === \"bottom\"\n                ? -HEIGHT_RESIZE_STEP\n                : HEIGHT_RESIZE_STEP\n            );\n          },\n        }\n      );\n    } else {\n      resizeActions.push(\n        {\n          id: \"ResizeToolWindowLeft\",\n          title: \"Stretch to left\",\n          shortcut: \"\",\n          perform: () => {\n            stretchWidth(\n              state.anchor === \"left\" ? -WIDTH_RESIZE_STEP : WIDTH_RESIZE_STEP\n            );\n          },\n        },\n        {\n          id: \"ResizeToolWindowRight\",\n          title: \"Stretch to right\",\n          shortcut: \"\",\n          perform: () => {\n            stretchWidth(\n              state.anchor === \"right\" ? -WIDTH_RESIZE_STEP : WIDTH_RESIZE_STEP\n            );\n          },\n        }\n      );\n    }\n  }\n  resizeActions.push({\n    id: \"MaximizeToolWindow\",\n    title: \"Maximize Tool Window\",\n    shortcut: \"'\",\n    perform: () => {},\n  });\n  const removeFromSideBarAction: ActionItem = {\n    id: \"removeFromSidebar\",\n    title: \"Remove from Sidebar\",\n    perform: () => {\n      alert(\"Not implemented\");\n    },\n  };\n  const gearIconActions: Array<ActionItem | DividerItem> = [\n    {\n      id: \"viewMode\",\n      title: \"View Mode\",\n      actions: viewModeActions,\n    },\n    {\n      id: \"moveTo\",\n      title: \"Move to\",\n      actions: moveToActions,\n    },\n    { id: \"resize\", title: \"Resize\", actions: resizeActions },\n    new DividerItem(),\n    removeFromSideBarAction,\n  ];\n  return (\n    <Menu\n      {...menuProps}\n      onAction={(key) => {\n        const allActions = [\n          ...moveToActions,\n          ...viewModeActions,\n          ...resizeActions,\n          removeFromSideBarAction,\n        ];\n        const action = allActions.find(({ id }) => id === key);\n        action?.perform();\n        close();\n      }}\n      selectedKeys={[`viewMode ${viewModeToString[state.viewMode]}`]}\n      disabledKeys={[`anchor ${getAnchorName(state)}`]}\n      items={gearIconActions}\n      autoFocus\n    >\n      {(action) => {\n        if (action instanceof DividerItem) {\n          return <Divider />;\n        }\n        return (\n          <Item\n            key={action.id}\n            textValue={action.title}\n            childItems={\"actions\" in action ? action.actions : undefined}\n          >\n            <MenuItemLayout\n              content={action.title}\n              icon={action.icon}\n              shortcut={action.shortcut}\n            />\n          </Item>\n        );\n      }}\n    </Menu>\n  );\n}\n","import React, { HTMLProps } from \"react\";\nimport { ActionButton } from \"../ActionButton/ActionButton\";\nimport { ActionToolbar } from \"../ActionToolbar/ActionToolbar\";\nimport { PlatformIcon } from \"../Icon\";\nimport { MenuTrigger } from \"../Menu/MenuTrigger\";\nimport { styled } from \"../styled\";\nimport { StyledHorizontalSeparator } from \"../StyledSeparator\";\nimport { UnknownThemeProp } from \"../Theme/Theme\";\nimport { useToolWindowState } from \"./ToolWindowsState/ToolWindowStateProvider\";\nimport {\n  anchors,\n  ToolWindowSettingsIconMenu,\n} from \"./ToolWindowSettingsIconMenu\";\n\nexport interface ToolWindowHeaderProps\n  extends Omit<HTMLProps<HTMLDivElement>, \"ref\" | \"as\"> {\n  contentHasFocus?: boolean;\n  additionalActions?: React.ReactNode;\n}\n\nconst StyledToolWindowHeader = styled.div<{ active: boolean }>`\n  display: flex;\n  align-items: center;\n  padding: 0 2px 0 7px;\n  border-bottom: 1px solid\n    ${({ theme }) =>\n      theme.color(\"ToolWindow.Header.borderColor\" as UnknownThemeProp) ||\n      theme.color(\"DefaultTabs.borderColor\" as UnknownThemeProp) ||\n      theme.commonColors.contrastBorder};\n  background: ${({ theme, active }) =>\n    active\n      ? theme.color(\"ToolWindow.Header.background\") ||\n        theme.color(\n          \"ToolWindow.header.active.background\" as UnknownThemeProp\n        ) ||\n        \"#E2E6EC\"\n      : theme.color(\"ToolWindow.Header.inactiveBackground\") ||\n        theme.color(\"ToolWindow.Header.background\") ||\n        \"#ECECEC\"};\n`;\nconst StyledToolWindowHeaderActions = styled.div``;\nconst StyledToolWindowHeaderContent = styled.div`\n  flex: 1;\n  display: flex;\n  align-items: center;\n`;\n\nexport const ToolWindowHeader: React.FC<ToolWindowHeaderProps> = ({\n  children,\n  additionalActions,\n  contentHasFocus = false,\n  ...otherProps\n}) => {\n  const { hide, state, changeViewMode } = useToolWindowState();\n  return (\n    <StyledToolWindowHeader active={contentHasFocus} {...otherProps}>\n      <StyledToolWindowHeaderContent>{children}</StyledToolWindowHeaderContent>\n      <StyledToolWindowHeaderActions>\n        <ActionToolbar>\n          {additionalActions && (\n            <>\n              {additionalActions}\n              <StyledHorizontalSeparator />\n            </>\n          )}\n          {state.viewMode === \"float\" && (\n            <ActionButton onPress={() => changeViewMode(\"docked_pinned\")}>\n              <PlatformIcon\n                icon={`actions/${\n                  anchors.find(\n                    ({ anchor, isSplit }) =>\n                      anchor === state.anchor && isSplit === state.isSplit\n                  )?.id\n                }`}\n              />\n            </ActionButton>\n          )}\n          <MenuTrigger\n            renderMenu={({ close, menuProps }) => {\n              return (\n                <ToolWindowSettingsIconMenu\n                  close={close}\n                  menuProps={menuProps}\n                />\n              );\n            }}\n          >\n            {(props, ref) => (\n              <ActionButton {...props} ref={ref}>\n                <PlatformIcon icon=\"general/gearPlain\" />\n              </ActionButton>\n            )}\n          </MenuTrigger>\n          <ActionButton onPress={hide}>\n            <PlatformIcon icon=\"general/hideToolWindow\" />\n          </ActionButton>\n        </ActionToolbar>\n      </StyledToolWindowHeaderActions>\n    </StyledToolWindowHeader>\n  );\n};\n","import { useFocusWithin } from \"@react-aria/interactions\";\nimport { mergeProps } from \"@react-aria/utils\";\nimport React, {\n  FocusEventHandler,\n  RefObject,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\";\nimport { useToolWindowState } from \"./ToolWindowsState/ToolWindowStateProvider\";\nimport { useToolWindowMoveHandle } from \"./useToolWindowMoveHandle\";\n\nexport function useToolWindow(\n  {\n    containerRef,\n    contentRef,\n    focusableContentRef,\n  }: {\n    containerRef: RefObject<HTMLElement>;\n    contentRef: RefObject<Element>;\n    focusableContentRef: RefObject<{ focus: () => void }>;\n  },\n  { onFocusChange }: { onFocusChange?: (focused: boolean) => void } = {}\n) {\n  const [contentHasFocus, setContentHasFocus] = useState(false);\n  /**\n   * NOTE: useFocusWithin form @react-aria/interactions (at least until 3.5.1) has a couple of problem, because of which\n   * we may need to implement our own version of it.\n   * - It doesn't play nice with FocusScope with `contain` set to true. When something is blurred, FocusScope prevents\n   *   that by restoring focus back immediately. but the blur event is already caught by useFocusWithin. One solution\n   *   would be to change useFocusWithin implementation to ignore these blur events that are immediately followed\n   *   by a focus event that keeps the focus in.\n   * - useFocusWithin has an inconsistent behaviour when it comes to Portals. Since it uses react props for handling\n   *   focus and blur, the [react tree determines event bubbling](https://reactjs.org/docs/portals.html#event-bubbling-through-portals),\n   *   which can be a very nice feature, when an overlay (rendered in a portal) grabs the focus, which should still\n   *   be seen as \"within\". But the problems is that the current implementation uses DOM `.contains(e.relatedTarget)`\n   *   method to determine if focus is no longer within. First of all, using react tree or dom tree to determine \"within\"\n   *   can be seen as an option perhaps. Secondly, it should be consistent on focus and blur.\n   *\n   *   Right now these problems are no big deal. but it may become an issue when portals are used within the content\n   *   of the tool window.\n   *\n   * NOTE: In the original implementation, when a heading toolbar button opens a menu, and focus goes to menu, the\n   * header loses the focus appearance, ant it relies only on content having the focus.\n   */\n  const { focusWithinProps: contentFocusWithinProps } = useFocusWithin({\n    onFocusWithinChange: setContentHasFocus,\n  });\n\n  const { focusWithinProps } = useFocusWithin({\n    onFocusWithinChange: onFocusChange,\n  });\n\n  const { toolWindowProps: autoHideProps } = useAutoHide();\n\n  const { focusDelegatorProps } = useFocusDelegator(\n    focusableContentRef,\n    contentRef\n  );\n\n  // If there is no focusable content rendered in the tool window, nothing will be autofocused. In that case\n  // we will focus the tool window container itself as a fallback.\n  useEffect(() => {\n    if (\n      !document.activeElement ||\n      !containerRef.current?.contains(document.activeElement)\n    ) {\n      containerRef.current?.focus();\n    }\n  }, []);\n\n  const { moveHandleProps } = useToolWindowMoveHandle();\n\n  return {\n    contentHasFocus,\n    toolWindowProps: mergeProps(\n      focusDelegatorProps,\n      focusWithinProps,\n      autoHideProps,\n      {\n        tabIndex: -1,\n      }\n    ),\n    toolWindowContentProps: contentFocusWithinProps,\n    toolWindowHeaderProps: moveHandleProps,\n  };\n}\n\n/**\n * Applies the auto hide behaviour of tool window based on view mode information and by handling focus and blur events,\n * on the root tool window element. Returns the necessary props that should be applied to the root tool window element.\n * The implementation is not perfect and may not 100% match the original Intellij Platform implementation.\n * If this focus based implementation for auto hide proves to be fragile and not good enough in future,\n * an alternative approach would be to move auto hide logic to the state management logic as much as possible,\n * and limit the focus based auto-hiding to only when the focus goes within the main content area. That should have\n * less focus-related edge cases.\n */\nfunction useAutoHide() {\n  const { blur } = useToolWindowState();\n  const hideTimeoutId = useRef<number | null>(null);\n  const { focusWithinProps: windowFocusWithinProps } = useFocusWithin({\n    onBlurWithin: (e) => {\n      // setTimeout and windowHasFocusRef is to work around the problem with useFocusWithin, described above.\n      hideTimeoutId.current = window.setTimeout(() => {\n        // Sometimes when the element is blurred, the subsequent focus that is triggered by FocusScope to keep the focus\n        // is a little delayed and therefore after the timeout reaches. It seem to happen only when a non-focusable\n        // area is clicked. We mitigate it by ignoring blur events where nothing is focused. It's not a problem\n        // at least with `DefaultToolWindow` implementation that uses a FocusScope.\n        const isSomethingElseFocused = e.relatedTarget;\n        if (isSomethingElseFocused) {\n          blur();\n        }\n      });\n    },\n    onFocusWithin: () => {\n      if (hideTimeoutId.current !== null) {\n        clearTimeout(hideTimeoutId.current);\n        hideTimeoutId.current = null;\n      }\n    },\n  });\n  return {\n    toolWindowProps: windowFocusWithinProps,\n  };\n}\n\n/**\n * Allows for having a focus scope (or simply a focusable element) get focused in a broader container,\n * by handling the focus element on the container, and forwarding the focus onto the target focus scope or element,\n * if currently focused element is not within that boundary.\n * Ensuring the container element is focusable is not something this hook does.\n */\nfunction useFocusDelegator(\n  focusableContentRef: RefObject<{ focus: () => void }>,\n  contentRef: RefObject<Element>\n) {\n  const onFocus: FocusEventHandler = (event) => {\n    if (event.target !== event.currentTarget) {\n      // only when this container is focused. not when anything inside is focused.\n      return;\n    }\n    const possiblyBlurredElement = event.relatedTarget;\n    if (\n      possiblyBlurredElement instanceof Element &&\n      contentRef.current?.contains(possiblyBlurredElement)\n    ) {\n      // if anything inside the content is being blurred while the container is getting focused, don't do anything\n      // let the focus stay where it is.\n      return;\n    }\n    focusableContentRef.current?.focus();\n  };\n  return { focusDelegatorProps: { onFocus } };\n}\n","import { useWindowInteractionHandler } from \"@intellij-platform/core/ToolWindow/WindowResizeHandles\";\nimport { useMove } from \"./useMove\";\n\nexport function useToolWindowMoveHandle() {\n  const interactionHandler = useWindowInteractionHandler();\n  if (!interactionHandler) {\n    return {};\n  }\n  const {\n    finishInteraction,\n    startInteraction,\n    updateBounds,\n  } = interactionHandler;\n\n  const moveProps = useMove({\n    onMoveStart: () => {\n      return startInteraction();\n    },\n    onMove: ({ startState, movement }) => {\n      updateBounds({\n        ...startState,\n        top: startState.top + movement.y,\n        left: startState.left + movement.x,\n      });\n    },\n    onMoveEnd: () => {\n      finishInteraction();\n    },\n  });\n  return { moveHandleProps: moveProps };\n}\n","import React, { useRef } from \"react\";\nimport { styled } from \"../styled\";\nimport { FocusScope } from \"./FocusScope\";\nimport { ToolWindowHeader } from \"./ToolWindowHeader\";\nimport { useToolWindow } from \"./useToolWindow\";\n\nexport interface DefaultToolWindowProps {\n  /**\n   * title to be shown on the left side of the tool window header.\n   */\n  headerContent?: React.ReactNode;\n  additionalActions?: React.ReactNode;\n  onFocusChange?: (focused: boolean) => void;\n}\n\nconst StyledToolWindowContainer = styled.div`\n  outline: none;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100%;\n  flex: 1;\n`;\nconst StyledToolWindowContent = styled.div`\n  flex: 1;\n  overflow: auto;\n`;\n\n/**\n * Default component for rendering the content of a tool window. It supports a header and a scrollable area.\n * The header supports showing a content, and some default+custom actions on the right.\n *\n * @see MultiContentToolWindow\n *\n * Remaining features:\n * - Additional gear menu actions.\n *\n */\nexport const DefaultToolWindow: React.FC<DefaultToolWindowProps> = ({\n  headerContent,\n  children,\n  additionalActions,\n  onFocusChange,\n}) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const contentRef = useRef<HTMLDivElement>(null);\n  const focusableContentRef = useRef<{ focus: () => void }>(null);\n  const {\n    // NOTE: we might as well use :focus-within and target StyledToolWindowHeader to set the background, but it's not\n    // a clear improvement.\n    contentHasFocus,\n    toolWindowProps,\n    toolWindowContentProps,\n    toolWindowHeaderProps,\n  } = useToolWindow(\n    { containerRef, contentRef, focusableContentRef },\n    {\n      onFocusChange,\n    }\n  );\n\n  return (\n    <StyledToolWindowContainer {...toolWindowProps} ref={containerRef}>\n      <ToolWindowHeader\n        additionalActions={additionalActions}\n        contentHasFocus={contentHasFocus}\n        {...toolWindowHeaderProps}\n      >\n        {headerContent}\n      </ToolWindowHeader>\n      <StyledToolWindowContent ref={contentRef} {...toolWindowContentProps}>\n        {/**\n         * FIXME: adding `contain` prevents focus from moving to another focus scope both with mouse and keyboard.\n         * If we want to follow the Intellij Platform behaviour exactly, we need a kind of focus containment, where\n         * focus is trapped only for keyboard interaction, and user can still move focus by clicking another scope.\n         * Maybe a custom useFocusContainment hook and a separate option for activating it on our own FocusScope.\n         */}\n        <FocusScope ref={focusableContentRef} autoFocus>\n          {children}\n        </FocusScope>\n      </StyledToolWindowContent>\n    </StyledToolWindowContainer>\n  );\n};\n","import { curry, fromPairs, insert, map, mapObjIndexed, move } from \"ramda\";\nimport { Key } from \"react\";\nimport { Anchor, isHorizontal } from \"../utils\";\n\nexport type ViewMode =\n  | \"docked_pinned\"\n  | \"docked_unpinned\"\n  | \"undock\"\n  | \"float\"\n  | \"window\";\n\nexport type WindowBounds = {\n  top: number;\n  left: number;\n  width: number;\n  height: number;\n};\n\n/**\n * Data structure for keeping the state of a single tool window. very similar to WindowInfo in Intellij Platform\n *\n * A note about about the data structure:\n * Some fields like `isSplit`, `weight`, `floatingBound` are meaningful only\n * for a subset of viewModes. So it may be tempting to introduce a `viewMode`\n * type which minimally and more accurately describes the information\n * relevant for each viewMode. But it's not structured like that, and it's\n * orthogonal to viewMode, since we want to preserve the relevant information\n * for each viewMode, to be used when the viewMode is changed back.\n *\n * NOTE: consider renaming to `WindowState` to avoid confusion with `ToolWindowsState`\n */\nexport interface ToolWindowState {\n  order: number;\n  /**\n   * Whether the tool window is visible (open) or not.\n   */\n  isVisible: boolean;\n  weight: number;\n  sideWeight: number;\n  anchor: Anchor;\n  /**\n   * if the tool window should be shown in the split view, when rendered not in\n   * \"float\", or \"window\" mode.\n   */\n  isSplit: boolean;\n  /**\n   * NOTE: in Intellij Platform, there is a window `type` and also `docked` and\n   * `autoHide`.\n   * keeping one viewMode makes more sense and prevents invalid combinations\n   * like { type: \"window, \"docked\": true}, that would be unnecessarily allowed.\n   */\n  viewMode: ViewMode;\n  /**\n   * Boundaries of the tool window, when rendered in \"float\" or \"window\" modes.\n   */\n  floatingBounds?: WindowBounds;\n}\n\nconst isDocked = (toolWindow: ToolWindowState) =>\n  toolWindow.viewMode === \"docked_unpinned\" ||\n  toolWindow.viewMode === \"docked_pinned\";\n\n/**\n * Determines whether the tool window should hide on focus. In the java implementation, it's a field on window\n * info instead of being a calculated field. We changed that to match viewMode with the 5 view modes that are possible\n * to choose from the UI, eliminating the combinations that are never allowed. If from UX perspective, having window\n * or float mode with autoHide feature is considered valid at some point, we may need to change the implementation\n * to something similar to the original implementation where isAutoHide and viewMode are separate.\n */\nconst isAutoHide = (toolWindow: ToolWindowState) =>\n  toolWindow.viewMode === \"docked_unpinned\" || toolWindow.viewMode === \"undock\";\n\nexport type SideInfo = Pick<ToolWindowState, \"anchor\" | \"isSplit\">;\nexport const areInSameSection = curry(\n  (window1: SideInfo, window2: SideInfo) =>\n    window1.anchor === window2.anchor && window1.isSplit === window2.isSplit\n);\n\nconst getViewModeType = (viewMode: ViewMode) => {\n  if (viewMode === \"docked_pinned\" || viewMode === \"docked_unpinned\") {\n    return \"docked\";\n  }\n  if (viewMode === \"window\" || viewMode === \"float\") {\n    return \"float\";\n  }\n  return viewMode;\n};\n/**\n * Represents UI state of a bunch of tool windows. What is rendered inside each window or toolbar button is irrelevant.\n *\n * TODO: document pros and cons of these two approaches\n * - Having a class for ToolWindowsState which keeps a readonly mapping of keys to window states.\n * - Having ToolWindowsState as an interface (a mapping from keys to window states), and a bunch of action functions\n *   which accept a window state and some arguments, and return a new window state.\n */\nexport class ToolWindowsState {\n  constructor(\n    public readonly windows: Readonly<{\n      [key: string]: Readonly<ToolWindowState>;\n    }>\n  ) {}\n\n  hide(targetKey: Key): ToolWindowsState {\n    return new ToolWindowsState(\n      mapObjIndexed(\n        (toolWindow, key) =>\n          key === targetKey\n            ? {\n                ...toolWindow,\n                isVisible: false,\n              }\n            : toolWindow,\n        this.windows\n      )\n    );\n  }\n\n  show(targetKey: Key): ToolWindowsState {\n    const target = this.windows[targetKey];\n    if (!target) {\n      return this;\n    }\n    const closableViewModes: ViewMode[] = [];\n    if (target.viewMode === \"undock\") {\n      closableViewModes.push(\"undock\");\n    } else if (isDocked(target)) {\n      closableViewModes.push(\"docked_unpinned\", \"docked_pinned\", \"undock\");\n    }\n    return new ToolWindowsState(\n      mapObjIndexed((toolWindow, key) => {\n        if (key === targetKey) {\n          return {\n            ...toolWindow,\n            isVisible: true,\n          };\n        }\n        if (\n          toolWindow.isVisible &&\n          areInSameSection(target, toolWindow) &&\n          closableViewModes.includes(toolWindow.viewMode)\n        ) {\n          return { ...toolWindow, isVisible: false };\n        }\n        return toolWindow;\n      }, this.windows)\n    );\n  }\n\n  toggle(targetKey: Key): ToolWindowsState {\n    return this.windows[targetKey]?.isVisible\n      ? this.hide(targetKey)\n      : this.show(targetKey);\n  }\n\n  blur(targetKey: Key): ToolWindowsState {\n    const target = this.windows[targetKey];\n    if (!target || !isAutoHide(target)) {\n      return this;\n    }\n    return new ToolWindowsState(\n      map((toolWindow) => {\n        if (toolWindow === target) {\n          return {\n            ...toolWindow,\n            isVisible: false,\n          };\n        }\n        return toolWindow;\n      }, this.windows)\n    );\n  }\n\n  // TODO: initiate floatingBound when changing viewMode to float or window and there is no previous floatingBound\n  changeViewMode(targetKey: Key, viewMode: ViewMode): ToolWindowsState {\n    const target = this.windows[targetKey];\n    if (!target) {\n      return this;\n    }\n    return new ToolWindowsState(\n      map((toolWindow) => {\n        if (toolWindow === target) {\n          return {\n            ...toolWindow,\n            viewMode,\n          };\n        }\n        const viewModeType = getViewModeType(toolWindow.viewMode);\n        if (\n          toolWindow.isVisible &&\n          viewModeType !== \"float\" &&\n          areInSameSection(toolWindow, target) &&\n          viewModeType === getViewModeType(viewMode)\n        ) {\n          return {\n            ...toolWindow,\n            isVisible: false,\n          };\n        }\n        return toolWindow;\n      }, this.windows)\n    );\n  }\n\n  move(targetKey: Key, index: number): ToolWindowsState;\n  move(targetKey: Key, side: SideInfo, index?: number): ToolWindowsState;\n  move(\n    targetKey: Key,\n    sideOrIndex: SideInfo | number,\n    index?: number\n  ): ToolWindowsState {\n    const target = this.windows[targetKey];\n    if (!target) {\n      return this;\n    }\n    const targetSide = typeof sideOrIndex === \"object\" ? sideOrIndex : target;\n    const targetIndex = typeof sideOrIndex === \"number\" ? sideOrIndex : index;\n    const targetSideWindows = Object.entries(this.windows).filter(([, value]) =>\n      areInSameSection(targetSide, value)\n    );\n    const indexInTargetSide = targetSideWindows.findIndex(\n      ([, window]) => window === target\n    );\n    const sortedTargetWindows: Array<[Key, ToolWindowState]> =\n      indexInTargetSide < 0\n        ? insert(\n            targetIndex ?? -1,\n            [targetKey, { ...target, ...targetSide }],\n            targetSideWindows\n          )\n        : move(\n            indexInTargetSide,\n            targetIndex ?? indexInTargetSide,\n            targetSideWindows\n          );\n    const newTargetSideWindows = fromPairs(\n      sortedTargetWindows.map(([key, value], index) => {\n        let newValue = value;\n        if (value.order !== index) {\n          newValue = { ...value, order: index };\n        }\n        const targetViewMode = getViewModeType(target.viewMode);\n        if (\n          key !== targetKey &&\n          target.isVisible &&\n          value.isVisible &&\n          targetViewMode !== \"float\" &&\n          getViewModeType(value.viewMode) === targetViewMode\n        ) {\n          newValue = { ...value, isVisible: false };\n        }\n        return [`${key}`, newValue];\n      })\n    );\n    return new ToolWindowsState(\n      mapObjIndexed(\n        (value, key) => newTargetSideWindows[key] || value,\n        this.windows\n      )\n    );\n  }\n\n  stretchWidth(\n    targetKey: Key,\n    value: number,\n    containerBounds: { width: number; height: number }\n  ): ToolWindowsState {\n    return this.stretch(targetKey, value, containerBounds, \"width\");\n  }\n\n  stretchHeight(\n    targetKey: Key,\n    value: number,\n    containerBounds: { width: number; height: number }\n  ): ToolWindowsState {\n    return this.stretch(targetKey, value, containerBounds, \"height\");\n  }\n\n  setFloatingBound(targetKey: Key, floatingBounds: WindowBounds) {\n    return this.update(targetKey, \"floatingBounds\", floatingBounds);\n  }\n\n  private update<K extends keyof ToolWindowState>(\n    targetKey: Key,\n    key: K,\n    value: ToolWindowState[K]\n  ) {\n    const target = this.windows[targetKey];\n    if (!target) {\n      return this;\n    }\n    return new ToolWindowsState(\n      map((window) => {\n        if (window === target) {\n          return {\n            ...window,\n            [key]: value,\n          };\n        }\n        return window;\n      }, this.windows)\n    );\n  }\n\n  private stretch(\n    targetKey: Key,\n    value: number,\n    containerBounds: { width: number; height: number },\n    property: \"width\" | \"height\"\n  ): ToolWindowsState {\n    const target = this.windows[targetKey];\n    if (!target) {\n      return this;\n    }\n    const viewModeType = getViewModeType(target.viewMode);\n    if (viewModeType === \"float\") {\n      return new ToolWindowsState(\n        map((window) => {\n          if (window === target) {\n            const currentFloatingBound = window.floatingBounds!;\n            return {\n              ...window,\n              floatingBounds: {\n                ...currentFloatingBound,\n                [property]: currentFloatingBound[property] + value,\n              },\n            };\n          }\n          return window;\n        }, this.windows)\n      );\n    }\n    const expectedProperty = isHorizontal(target.anchor) ? \"height\" : \"width\";\n    if (expectedProperty !== property) {\n      return this;\n    }\n    const containerSize = containerBounds[property];\n    const newValue = containerSize * target.weight + value;\n    if (viewModeType === \"docked\") {\n      return this.resizeDock(target.anchor, newValue, containerBounds);\n    } else {\n      return this.resizeUndock(target.anchor, newValue, containerBounds);\n    }\n  }\n\n  resizeDock(\n    anchor: Anchor,\n    size: number,\n    containerBounds: { width: number; height: number }\n  ): ToolWindowsState {\n    return this.resizeSide(true, anchor, size, containerBounds);\n  }\n\n  resizeUndock(\n    anchor: Anchor,\n    size: number,\n    containerBounds: { width: number; height: number }\n  ): ToolWindowsState {\n    return this.resizeSide(false, anchor, size, containerBounds);\n  }\n\n  resizeDockSplitView(anchor: Anchor, weight: number): ToolWindowsState {\n    return new ToolWindowsState(\n      map((window) => {\n        if (window.anchor === anchor && window.isVisible && isDocked(window)) {\n          return {\n            ...window,\n            sideWeight: window.isSplit ? weight : 1 - weight,\n          };\n        }\n        return window;\n      }, this.windows)\n    );\n  }\n\n  private resizeSide(\n    dock: boolean,\n    anchor: Anchor,\n    size: number,\n    containerBounds: { width: number; height: number }\n  ): ToolWindowsState {\n    return new ToolWindowsState(\n      map((window) => {\n        const isInResizingView = dock\n          ? isDocked(window)\n          : window.viewMode === \"undock\";\n        if (window.anchor === anchor && isInResizingView && window.isVisible) {\n          const containerSize = !isHorizontal(anchor)\n            ? containerBounds.width\n            : containerBounds.height;\n          return {\n            ...window,\n            weight: size / containerSize,\n          };\n        }\n        return window;\n      }, this.windows)\n    );\n  }\n}\n\nexport const toolWindowState = ({\n  viewMode = \"docked_pinned\",\n  ...inputs\n}: Partial<ToolWindowState> = {}): ToolWindowState => ({\n  anchor: \"left\",\n  isSplit: false,\n  viewMode: viewMode,\n  order: 1,\n  weight: 0.2,\n  sideWeight: 0.5,\n  isVisible: false,\n  floatingBounds:\n    getViewModeType(viewMode) === \"float\"\n      ? {\n          left: 300,\n          top: 300,\n          width: 600,\n          height: 300,\n        }\n      : undefined,\n  ...inputs,\n});\n","import React from \"react\";\nimport { getAllRanges, TextRange } from \"../TextRange\";\nimport { styled } from \"../styled\";\n\nconst HighlightedMatch = styled.span`\n  background: ${({ theme }) =>\n    `linear-gradient(${theme.color(\n      \"SearchMatch.startBackground\",\n      \"#ffeaa2b3\"\n    )}, ${theme.color(\"SearchMatch.endBackground\", \"#ffd042b3\")})`};\n  color: #000;\n  border-radius: 3px;\n`;\n\nexport function TextWithHighlights({\n  children,\n  highlights,\n}: {\n  children: string;\n  highlights: TextRange[] | null;\n}): React.ReactElement {\n  const parts: Array<[TextRange, boolean]> = highlights\n    ? getAllRanges(highlights, children.length)\n    : [[{ from: 0, to: children.length }, false]];\n  return (\n    <>\n      {parts.map(([{ from, to }, highlighted]) => {\n        const text = children.slice(from, to + 1);\n        return (\n          // TODO: key\n          <React.Fragment key={`${from}_${to}`}>\n            {highlighted ? <HighlightedMatch>{text}</HighlightedMatch> : text}\n          </React.Fragment>\n        );\n      })}\n    </>\n  );\n}\n","export type TextRange = { from: number; to: number };\n\nexport function isEmptyRange(range: TextRange) {\n  return range.from > range.to;\n}\n\nexport function getAllRanges(\n  ranges: TextRange[],\n  length: number\n): Array<[TextRange, boolean]> {\n  const result: Array<[TextRange, boolean]> = [];\n  if (!ranges?.length) {\n    return [[{ from: 0, to: length - 1 }, false]];\n  }\n  if (ranges[0].from > 0) {\n    result.push([{ from: 0, to: ranges[0].from - 1 }, false]);\n  }\n  ranges.forEach(({ from, to }, index) => {\n    result.push([{ from, to }, true]);\n    const gapRange: TextRange = ranges[index + 1]\n      ? { from: to + 1, to: ranges[index + 1].from - 1 }\n      : { from: to + 1, to: length - 1 };\n    if (!isEmptyRange(gapRange)) {\n      result.push([gapRange, false]);\n    }\n  });\n  return result;\n}\n\nexport function createRangesFromIndices(indices: number[]): TextRange[] {\n  return indices.reduce((ranges, index) => {\n    const lastRange = ranges.slice(-1)[0];\n    if (lastRange?.to === index - 1) {\n      return [...ranges.slice(0, -1), { from: lastRange.from, to: index }];\n    }\n    return [...ranges, { from: index, to: index }];\n  }, [] as TextRange[]);\n}\n","import React from \"react\";\nimport { CollectionSpeedSearchMatches } from \"@intellij-platform/core/CollectionSpeedSearch/useCollectionSpeedSearchResult\";\nimport { Collection, Node } from \"@react-types/shared\";\n\nexport type CollectionSpeedSearchContextValue = {\n  matches: CollectionSpeedSearchMatches;\n  collection: Collection<Node<unknown>>;\n};\n\nexport const CollectionSpeedSearchContext = React.createContext<CollectionSpeedSearchContextValue | null>(\n  null\n);\n","import React, { Key, useContext } from \"react\";\nimport { TextWithHighlights } from \"@intellij-platform/core/TextWithHighlights/TextWithHighlights\";\nimport { TextRange } from \"@intellij-platform/core/TextRange\";\nimport { CollectionSpeedSearchContext } from \"@intellij-platform/core/CollectionSpeedSearch/CollectionSpeedSearchContext\";\n\ntype CollectionSpeedSearchItemContextValue = {\n  text: string;\n  highlightedRanges: null | TextRange[];\n};\n\nconst CollectionSpeedSearchItemContext = React.createContext<null | CollectionSpeedSearchItemContextValue>(\n  null\n);\n\nexport const SpeedSearchItemHighlightsProvider: React.FC<{ itemKey: Key }> = ({\n  children,\n  itemKey,\n}) => {\n  const context = useContext(CollectionSpeedSearchContext);\n  if (!context) {\n    throw new Error(\n      `SpeedSearchItemProvider is only meant to be rendered by collection components with speed search. \n      CollectionSpeedSearchContext is expected to be rendered as a wrapper around all items.`\n    );\n  }\n  const item = context.collection.getItem(itemKey);\n  const text = item?.textValue;\n  if (!text && item?.props.textValue === undefined) {\n    console.warn(\n      \"no textValue specified on Item. When using SpeedSearch, you need to specify textValue for item, which will be the basis for search\"\n    );\n  }\n  return (\n    <CollectionSpeedSearchItemContext.Provider\n      value={{\n        highlightedRanges: context.matches.get(itemKey) || null,\n        text: text,\n      }}\n    >\n      {children}\n    </CollectionSpeedSearchItemContext.Provider>\n  );\n};\n\n/**\n * Used inside Item content, to render the textValue of the Item, potentially with highlighted ranges if it's a match\n * in current search.\n */\nexport const HighlightedTextValue = function () {\n  const speedSearchContext = React.useContext(CollectionSpeedSearchItemContext);\n  if (!speedSearchContext) {\n    throw new Error(\n      \"HighlightedTextValue should be rendered only in items of a speed search enabled collection component\"\n    );\n  }\n  const { highlightedRanges, text } = speedSearchContext;\n  return highlightedRanges ? (\n    <TextWithHighlights highlights={highlightedRanges}>\n      {text}\n    </TextWithHighlights>\n  ) : (\n    <>{text}</>\n  );\n};\n","import React, { ComponentProps } from \"react\";\nimport { useTheme } from \"styled-components\";\nimport { Theme } from \"./Theme/Theme\";\n\ninterface Props extends ComponentProps<\"img\"> {\n  /**\n   * src for when a dark theme is active. if `darkSrc` doesn't have a non-empty string value, src will be used both\n   * for dark and light themes.\n   */\n  darkSrc?: string;\n}\n/**\n * Same as default `img`, but theme aware. Meaning that you can specify different sources for normal and dark mode.\n */\nexport const Img: React.FC<Props> = ({ darkSrc, ...props }) => {\n  const theme = useTheme() as Theme;\n  if (theme.dark) {\n    return <img {...props} src={darkSrc || props.src} />;\n  }\n  return <img {...props} />;\n};\n","import { styled } from \"../styled\";\n\nexport const StyledList = styled.ul<{ fillAvailableSpace?: boolean }>`\n  padding: 0;\n  margin: 0;\n  list-style: none;\n  max-height: 100%;\n  overflow: auto;\n  color: ${({ theme }) => theme.color(\"*.textForeground\")};\n  outline: none;\n  flex: ${({ fillAvailableSpace }) => (fillAvailableSpace ? \"1\" : undefined)};\n  background: ${({ theme }) =>\n    theme.color(\n      \"Panel.background\"\n    )}; // FIXME: not correct for all themes. Maybe no background for list at all.\n`;\n","import { isMac } from \"@react-aria/utils\";\n\nexport function isCtrlKeyPressed(\n  e: { metaKey: boolean; ctrlKey: boolean } | undefined\n) {\n  if (isMac()) {\n    return e?.metaKey;\n  }\n\n  return e?.ctrlKey;\n}\n","import {\n  MultipleSelectionState,\n  SelectionManager as OriginalSelectionManager,\n} from \"@react-stately/selection\";\nimport { Collection, Node, PressEvent } from \"@react-types/shared\";\nimport { Key } from \"react\";\nimport { isCtrlKeyPressed } from \"../utils/keyboard-utils\";\n\nexport class SelectionManager extends OriginalSelectionManager {\n  constructor(\n    collection: Collection<Node<unknown>>,\n    state: MultipleSelectionState\n  ) {\n    super(collection, state);\n  }\n  select(key: Key, e?: PressEvent | PointerEvent) {\n    if (this.selectionMode === \"none\") {\n      return;\n    }\n\n    if (this.selectionMode === \"single\") {\n      if (this.isSelected(key) && !this.disallowEmptySelection) {\n        this.toggleSelection(key);\n      } else {\n        this.replaceSelection(key);\n      }\n    } else {\n      if (e?.shiftKey) {\n        this.extendSelection(key);\n      } else if (\n        isCtrlKeyPressed(e) &&\n        (this.selectedKeys.size > 1 || !this.isSelected(key))\n      ) {\n        this.toggleSelection(key);\n      } else {\n        this.replaceSelection(key);\n      }\n    }\n  }\n}\n","import { PlatformIcon } from \"@intellij-platform/core/Icon\";\nimport React from \"react\";\nimport { styled } from \"../styled\";\n\nexport interface SpeedSearchPopupProps {\n  children: string | undefined;\n  match?: boolean;\n  active: boolean | undefined;\n}\n\nconst StyledSearchIcon = styled(PlatformIcon)`\n  margin-right: 10px;\n  vertical-align: middle;\n`;\n\n/**\n * The little popup view shown at the top left corner of list, tree, etc., which shows the search\n * query.\n */\nexport const SpeedSearchPopup = React.forwardRef<\n  HTMLElement,\n  SpeedSearchPopupProps\n>(({ active, match, children }, ref) =>\n  active ? (\n    <StyledSpeedSearchPopup ref={ref} match={match}>\n      <StyledSearchIcon icon={\"actions/search\"} />\n      {(children || \"\").replace(/ /g, \"\\u00A0\")}\n    </StyledSpeedSearchPopup>\n  ) : null\n);\n\nconst StyledSpeedSearchPopup = styled.span<{ match?: boolean }>`\n  // ref: https://github.com/JetBrains/intellij-community/blob/e3c7d96daba1d5d84d5650bde6c220aed225bfda/platform/platform-impl/src/com/intellij/ui/SpeedSearchBase.java#L53-L53\n  box-sizing: border-box;\n  position: absolute;\n  background: ${({ theme }) =>\n    theme.color(\n      \"SpeedSearch.background\",\n      theme.dark ? \"rgb(111,111,111)\" : \"#fff\"\n    )};\n  border: 1px solid\n    ${({ theme }) =>\n      theme.color(\n        \"SpeedSearch.borderColor\",\n        theme.dark ? \"rgb(64, 64, 64)\" : \"rgb(192, 192, 192)\"\n      )};\n  color: ${({ match, theme }) =>\n    match\n      ? theme.color(\n          \"SpeedSearch.foreground\",\n          theme.commonColors.tooltipForeground\n        )\n      : theme.color(\"SpeedSearch.errorForeground\", theme.commonColors.red)};\n  z-index: 1;\n  padding: 3px 7px;\n  height: 25px;\n  line-height: 1.2;\n  transform: translateY(-100%);\n`;\n","import { TreeState } from \"@intellij-platform/core/Tree/__tmp__useTreeState\";\nimport React, { HTMLAttributes, useMemo } from \"react\";\nimport { LayoutNode, ListLayout } from \"@react-stately/layout\";\nimport { Node } from \"@react-types/shared\";\nimport { VirtualizerProps } from \"@react-aria/virtualizer\";\nimport { LayoutInfo, Rect } from \"@react-stately/virtualizer\";\n\nclass FlattenedTreeLayout<T> extends ListLayout<T> {\n  buildChild(node: Node<T>, x: number, y: number): LayoutNode {\n    const layoutNode = super.buildChild(node, x, y);\n    if (\n      node.parentKey &&\n      this.collection.getItem(node.parentKey)?.type === \"item\"\n    ) {\n      layoutNode.layoutInfo.parentKey = null;\n    }\n    return layoutNode;\n  }\n\n  getVisibleLayoutInfos(rect: Rect): LayoutInfo[] {\n    return super\n      .getVisibleLayoutInfos(rect)\n      .filter((layoutInfo) => this.collection.getItem(layoutInfo.key) != null);\n  }\n}\n\nexport const useTreeVirtualizer = <T extends object>({\n  state,\n}: {\n  state: TreeState<T>;\n}): {\n  virtualizerProps: Omit<\n    VirtualizerProps<any, unknown>,\n    \"children\" | keyof HTMLAttributes<HTMLElement>\n  >;\n} => {\n  const layout = useMemo(\n    () =>\n      new FlattenedTreeLayout({\n        /**\n         * there is currently no documentation available for these fields, but setting `rowHeight` enforces it, which\n         * wouldn't be good for custom tree UI with a different row height.\n         * wrong estimatedRowHeight seems to only affect small scrollbar position inaccuracy, which is a minor issue\n         * and not even noticeable in most cases. Also, it seems it slightly improves the performance if it exactly\n         * matches the real row height. But not even sure.\n         */\n        estimatedRowHeight: 20,\n      }),\n    []\n  );\n  layout.collection = state.collection;\n  layout.disabledKeys = state.disabledKeys;\n\n  return {\n    virtualizerProps: {\n      focusedKey: state.selectionManager.focusedKey,\n      collection: state.collection,\n      layout,\n      sizeToFit: \"height\",\n      scrollDirection: \"vertical\",\n    },\n  };\n};\n","import { styled } from \"../styled\";\n\nexport type StyledListItemProps = {\n  containerFocused: boolean;\n  selected: boolean;\n  disabled: boolean;\n};\n\nexport const StyledListItem = styled.li<StyledListItemProps>(\n  ({ containerFocused, selected, disabled, theme }) => {\n    let backgroundColor;\n    let color = disabled\n      ? theme.color(\"*.disabledForeground\")\n      : theme.color(\"*.textForeground\", theme.color(\"*.foreground\"));\n    if (selected) {\n      if (containerFocused) {\n        color = theme.color(\n          \"*.selectionForeground\",\n          theme.color(\"*.acceleratorSelectionForeground\")\n        );\n        backgroundColor = theme.color(\"*.selectionBackground\");\n      } else {\n        backgroundColor = theme.color(\"*.selectionBackgroundInactive\");\n      }\n    }\n    return {\n      backgroundColor,\n      color,\n      position: \"relative\",\n      display: \"flex\",\n      whiteSpace: \"nowrap\",\n      paddingLeft: 8, // themed?\n      lineHeight: \"20px\",\n      outline: \"none\",\n      cursor: \"default\",\n    };\n  }\n);\n","import { LafIcon } from \"../Icon\";\nimport React, { ComponentProps, useMemo } from \"react\";\nimport { styled } from \"../styled\";\n\nexport const TREE_ICON_SIZE = 16;\nconst StyledTreeNodeIcon = styled(LafIcon)`\n  margin-left: -20px;\n  margin-right: 4px;\n  margin-top: -1px; // the svg path seems to have uneven vertical padding. This is to compensate for that.\n  flex-shrink: 0;\n  align-self: center;\n`;\n\ntype TreeNodeIconProps = ComponentProps<typeof StyledTreeNodeIcon> & {\n  selected: boolean;\n  expanded: boolean;\n};\nconst getIcon = (selected: boolean, expanded: boolean) => {\n  const modifiers = { Selected: selected };\n  if (expanded) {\n    return {\n      themePath: selected ? \"Tree.expandedSelectedIcon\" : \"Tree.expandedIcon\",\n      iconPath: { name: \"treeExpanded\", modifiers },\n    };\n  }\n  if (!expanded) {\n    return {\n      themePath: selected ? \"Tree.collapsedSelectedIcon\" : \"Tree.collapsedIcon\",\n      iconPath: { name: \"treeCollapsed\", modifiers },\n    };\n  }\n};\n\nexport function TreeNodeIcon({\n  selected,\n  expanded,\n  ...props\n}: TreeNodeIconProps) {\n  const icon = useMemo(() => getIcon(selected, expanded), [selected, expanded]);\n  return (\n    <StyledTreeNodeIcon\n      icon={icon?.iconPath}\n      themePath={icon?.themePath}\n      size={TREE_ICON_SIZE}\n      {...props}\n    />\n  );\n}\n","import { Key } from \"react\";\nimport { TreeState } from \"@react-stately/tree\";\nimport { PressProps } from \"@react-aria/interactions\";\n\nexport function useTreeNodeToggleButton<T>({\n  collection,\n  toggleKey,\n  selectionManager,\n  key,\n}: { key: Key } & Pick<\n  TreeState<T>,\n  \"collection\" | \"toggleKey\" | \"selectionManager\"\n>): { treeNodeToggleButtonProps: PressProps } {\n  return {\n    treeNodeToggleButtonProps: {\n      preventFocusOnPress: true,\n      onPress: () => {\n        toggleKey(key);\n\n        // The rest is for deselecting selected descendants and selecting the toggled node, if there\n        // is at least one of such currently selected descendants. This is the exact behavior\n        // of Tree in Intellij Platform, and hence implemented here.\n        const selectedDescendantKeys = [\n          ...selectionManager.selectedKeys,\n        ].filter((key: Key) => {\n          let parentKey = collection.getItem(key)?.parentKey;\n          while (parentKey) {\n            if (parentKey === key) {\n              return true;\n            }\n            parentKey = collection.getItem(parentKey)?.parentKey;\n          }\n          return false;\n        });\n        selectedDescendantKeys.forEach((key) =>\n          selectionManager.toggleSelection(key)\n        );\n        // if any of the descendants are selected\n        if (\n          !selectionManager.isSelected(key) &&\n          selectedDescendantKeys.length > 0\n        ) {\n          selectionManager.toggleSelection(key);\n        }\n      },\n    },\n  };\n}\n","import { TreeState } from \"@intellij-platform/core/Tree/__tmp__useTreeState\";\nimport React, { Key, MutableRefObject } from \"react\";\n\nexport type TreeContextType<T> = {\n  state: TreeState<T>;\n  focused: boolean;\n  onActionRef: MutableRefObject<((key: Key) => void) | undefined>;\n};\n\nexport const TreeContext = React.createContext<TreeContextType<any> | null>(\n  null\n);\n","import { usePress } from \"@react-aria/interactions\";\nimport { Node } from \"@react-types/shared\";\nimport React, { useContext, useRef } from \"react\";\nimport { ItemStateContext } from \"../Collections/ItemStateContext\";\nimport { StyledListItem } from \"../List/StyledListItem\";\nimport { styled } from \"../styled\";\nimport { TREE_ICON_SIZE, TreeNodeIcon } from \"./TreeNodeIcon\";\nimport { useTreeNode } from \"./useTreeNode\";\nimport { useTreeNodeToggleButton } from \"./useTreeNodeToggleButton\";\nimport { TreeContext } from \"./TreeContext\";\n\ntype TreeNodeProps<T> = {\n  item: Node<T>;\n};\nconst StyledTreeNode = styled(StyledListItem).attrs({ as: \"div\" })<{\n  level: number;\n}>`\n  // There are some theme properties for tree node padding (theme.ui.Tree.leftChildIndent and\n  // theme.ui.Tree.leftChildIndent), but they doesn't seem to be applicable.\n  padding-left: ${({ level }) => `${(level + 1) * TREE_ICON_SIZE + 8}px`};\n`;\n\nexport function TreeNode<T>({ item }: TreeNodeProps<T>) {\n  const ref = useRef(null);\n  const {\n    state: {\n      collection,\n      selectionManager,\n      expandedKeys,\n      disabledKeys,\n      toggleKey,\n    },\n    focused: containerFocused,\n    onActionRef: { current: onAction },\n  } = useContext(TreeContext)!;\n\n  const isSelected = selectionManager.isSelected(item.key);\n  const expanded = expandedKeys.has(item.key);\n  const isDisabled = disabledKeys.has(item.key);\n\n  const { pressProps: togglePressProps } = usePress({\n    ...useTreeNodeToggleButton({\n      key: item.key,\n      collection,\n      selectionManager,\n      toggleKey,\n    }).treeNodeToggleButtonProps,\n    isDisabled,\n  });\n\n  const { treeNodeProps } = useTreeNode({\n    item,\n    ref,\n    toggleKey,\n    onAction,\n    selectionManager,\n    disabled: isDisabled,\n  });\n\n  /**\n   * NOTE: TreeNode intentionally is not designed in a recursive way for two main reasons:\n   * - Performance\n   * - Better support for virtualization\n   * So instead of rendering TreeNode for childNodes, if the node is expanded, we expect parent\n   * to render children. It's not a layout issue since we don't need any nesting in terms of\n   * layout of nested items. In terms of layout, a tree will be rendered similar to a flat list,\n   * but with more indentation for nested nodes.\n   */\n  return (\n    <>\n      <StyledTreeNode\n        ref={ref}\n        {...treeNodeProps}\n        containerFocused={containerFocused}\n        disabled={isDisabled}\n        selected={isSelected}\n        aria-disabled={isDisabled}\n        aria-selected={isSelected}\n        level={item.level}\n      >\n        {[...item.childNodes].length > 0 && (\n          <TreeNodeIcon\n            selected={isSelected}\n            expanded={expanded}\n            {...togglePressProps}\n          />\n        )}\n        <ItemStateContext.Provider\n          value={{ isDisabled, isSelected, isFocused: containerFocused }}\n        >\n          {item.rendered}\n        </ItemStateContext.Provider>\n      </StyledTreeNode>\n    </>\n  );\n}\n","import { usePress } from \"@react-aria/interactions\";\nimport { useSelectableItem } from \"@react-aria/selection\";\nimport { mergeProps } from \"@react-aria/utils\";\nimport { SelectionManager } from \"@react-stately/selection\";\nimport { Node } from \"@react-types/shared\";\nimport { Key, RefObject } from \"react\";\n\nexport function useTreeNode<T>({\n  item,\n  ref,\n  selectionManager,\n  disabled,\n  toggleKey,\n  onAction,\n}: {\n  item: Node<T>;\n  ref: RefObject<HTMLElement>;\n  disabled: boolean;\n  toggleKey: (key: Key) => void;\n  onAction?: (key: Key) => void;\n  selectionManager: SelectionManager;\n}) {\n  const {\n    pressProps: { onKeyDown, ...pressProps },\n  } = usePress({\n    ...useSelectableItem({\n      key: item.key,\n      ref,\n      selectionManager,\n      isVirtualized: false,\n    }).itemProps,\n    isDisabled: disabled,\n    preventFocusOnPress: false,\n  });\n\n  const onDoubleClick = () => {\n    if ([...item.childNodes].length > 0) {\n      toggleKey(item.key);\n    } else {\n      onAction?.(item.key);\n    }\n  };\n\n  return {\n    treeNodeProps: mergeProps(pressProps, { onDoubleClick }),\n  };\n}\n","import React, { useRef } from \"react\";\n\nfunction isTypeableElement(elem: HTMLElement): boolean {\n  const nonTypeableInputTypes: Array<HTMLInputElement[\"type\"]> = [\n    \"checkbox\",\n    \"radio\",\n    \"button\",\n  ];\n  return (\n    elem.isContentEditable ||\n    (elem instanceof HTMLInputElement &&\n      !nonTypeableInputTypes.includes(elem.type)) ||\n    elem instanceof HTMLTextAreaElement\n  );\n}\n\n/**\n * Main use case is for a list of item, which can have keyboard focus, be filterable and capture\n * typing if the corresponding keyboard events are not happening on an inner element (like an input)\n * that already handles typing.\n * @param value\n * @param onChange\n * TODO: add support for removing word by word by alt+backspace like native text fields.\n * TODO: add support for removing the whole content by command/ctrl+backspace.\n */\nexport function useGhostInput({\n  value,\n  onChange,\n}: {\n  value: string;\n  onChange: (value: string) => void;\n}) {\n  const valueRef = useRef(value);\n  valueRef.current = value;\n  const onKeyDown = (event: React.KeyboardEvent | KeyboardEvent) => {\n    if (\n      !event.ctrlKey &&\n      !event.altKey &&\n      !event.metaKey &&\n      (!(event.target instanceof HTMLElement) ||\n        !isTypeableElement(event.target))\n    ) {\n      if (event.key.length === 1) {\n        return onChange(`${valueRef.current}${event.key}`);\n      }\n      if (event.key === \"Backspace\") {\n        const sliceEnd = event.metaKey ? 0 : -1;\n        onChange(valueRef.current.slice(0, sliceEnd));\n      }\n    }\n  };\n  return { onKeyDown } as const;\n}\n","export function isWordSeparator(c: string) {\n  return (\n    isWhitespace(c) || c == \"_\" || c == \"-\" || c == \":\" || c == \"+\" || c == \".\"\n  );\n}\n\nexport function isWhitespace(char: string): boolean {\n  return /^\\s*$/.test(char);\n}\n\nexport function isUpperCase(str: string) {\n  return str.toUpperCase() === str && str.toLowerCase() !== str;\n}\n","import { createRangesFromIndices, TextRange } from \"./TextRange\";\nimport {\n  isUpperCase,\n  isWhitespace,\n  isWordSeparator,\n} from \"./utils/string-utils\";\n\nfunction isMeaningfulChar(ch: string) {\n  return !isWordSeparator(ch) && !isWhitespace(ch);\n}\n\n// Simplified version of https://github.com/JetBrains/intellij-community/blob/master/platform/util/text-matching/src/com/intellij/psi/codeStyle/MinusculeMatcherImpl.java\nexport const minusculeMatch = (\n  input: string,\n  rawPattern: string\n): Array<TextRange> | null => {\n  const isStarts = input.split(\"\").map(isStart);\n  const pattern = rawPattern.split(\"\").filter(isMeaningfulChar).join(\"\");\n  const matches: Array<{ patternIndex: number; inputIndex: number }> = [];\n  let continuous = false;\n  let inputIndex = 0,\n    patternIndex = 0;\n  while (true) {\n    if (matches.length === pattern.length) {\n      return createRangesFromIndices(matches.map(({ inputIndex: i }) => i));\n    }\n    if (inputIndex > input.length - 1) {\n      if (matches.length > 0) {\n        // TODO: the same character match can be popped out and in several times, if something\n        //  is popped out, it should never be added back again, since it's already examined without\n        //  a full match.\n        const lastMatch = matches.pop()!;\n        inputIndex = lastMatch.inputIndex + 1;\n        patternIndex = lastMatch.patternIndex;\n        continue;\n      }\n      break;\n    }\n    if (!isMeaningfulChar(input[inputIndex])) {\n      inputIndex++;\n      continue;\n    }\n    if (\n      pattern[patternIndex].toLowerCase() === input[inputIndex].toLowerCase() &&\n      (continuous || isStarts[inputIndex] || matches.length === 0)\n    ) {\n      matches.push({ patternIndex, inputIndex });\n      continuous = true;\n      patternIndex++;\n      inputIndex++;\n    } else {\n      continuous = false;\n      inputIndex++;\n    }\n  }\n  return null;\n};\n\nfunction isStart(char: string, index: number, chars: string[]): boolean {\n  const previousChar = chars[index - 1];\n  return (\n    index === 0 ||\n    (isWordSeparator(previousChar) && !isWordSeparator(char)) ||\n    (isUpperCase(char) && !isUpperCase(previousChar))\n  );\n}\n","import { Key } from \"react\";\nimport { SelectionManager } from \"../selection/SelectionManager\";\n\nexport function createSpeedSearchSelectionManager(\n  wrappedSelectionManager: SelectionManager,\n  matches: Map<Key, unknown /* We don't care what a match is here */> | null\n): SelectionManager {\n  return Object.create(wrappedSelectionManager, {\n    selectAll: {\n      value: () => {\n        if (matches) {\n          // @ts-expect-error: state is private and there is no API on SelectionManager for bulk\n          // setting selected keys (which would ideally check for not selecting disabled keys internally).\n          const state = wrappedSelectionManager.state;\n          state.setSelectedKeys(\n            new Set(\n              [...matches.keys()].filter((key) => !state.disabledKeys.has(key))\n            )\n          );\n        } else {\n          wrappedSelectionManager.selectAll();\n        }\n      },\n    },\n  });\n}\n","import { Key, useMemo } from \"react\";\nimport { minusculeMatch } from \"../minusculeMatch\";\nimport { SpeedSearchState } from \"../SpeedSearch/useSpeedSearch\";\nimport { Collection, Node } from \"@react-types/shared\";\nimport { SelectionManager } from \"@react-stately/selection\";\nimport { createSpeedSearchSelectionManager } from \"./createSpeedSearchSelectionManager\";\nimport { TextRange } from \"@intellij-platform/core/TextRange\";\n\nexport type CollectionSpeedSearchMatches = Map<Key, TextRange[]>;\n\nexport function useCollectionSpeedSearchResult<T>({\n  collection,\n  selectionManager,\n  speedSearch,\n}: {\n  collection: Collection<Node<T>>;\n  selectionManager: SelectionManager;\n  speedSearch: SpeedSearchState;\n}) {\n  const { searchTerm, active } = speedSearch;\n  return useMemo(() => {\n    const matches: CollectionSpeedSearchMatches = new Map(); // maybe make it nullable makes more sense\n    if (speedSearch.active) {\n      // it's important not to iterate on items, since they can be nested.\n      [...collection.getKeys()]\n        .map((key) => collection.getItem(key))\n        .filter(({ type }) => type === \"item\")\n        .forEach((item) => {\n          const matchedRanges = minusculeMatch(item.textValue, searchTerm);\n          if (matchedRanges) {\n            matches.set(item.key, matchedRanges);\n          }\n        });\n      const matchedKeys = [...matches.keys()];\n\n      const noneOfTheMatchesAreSelected = !matchedKeys.some((matchedKey) =>\n        selectionManager.isSelected(matchedKey)\n      );\n\n      if (matchedKeys.length > 0 && noneOfTheMatchesAreSelected) {\n        // TODO: the first match AFTER the first key in current selection should be selected.\n        selectionManager.setFocusedKey(matchedKeys[0]);\n        selectionManager.replaceSelection(matchedKeys[0]);\n      }\n    }\n\n    return {\n      matches,\n      selectionManager: createSpeedSearchSelectionManager(\n        selectionManager,\n        active ? matches : null\n      ),\n    };\n  }, [searchTerm, collection, active]);\n}\n","import { Collection, KeyboardDelegate, Node } from \"@react-types/shared\";\nimport { SelectionManager } from \"@react-stately/selection\";\nimport {\n  SpeedSearchStateProps,\n  useSpeedSearch,\n  useSpeedSearchState,\n} from \"../SpeedSearch/useSpeedSearch\";\nimport { useCollectionSpeedSearchResult } from \"./useCollectionSpeedSearchResult\";\nimport { useMemo } from \"react\";\nimport { createSpeedSearchKeyboardDelegate } from \"./createSpeedSearchKeyboardDelegate\";\n\n/**\n * Given a `collection`, a `selectionManager` and a `keyboardDelegate`, it returns:\n * - `speedSearch`: search term, if speed search is active or not, and the matched keys\n * - `matches`: A Set of matched keys, or `null` if speed search is not active\n * - `containerProps`: The props you need to pass to the collection container element to enable\n * speedSearch on it.\n * - `selectionManager`: a selection manager in which select all is overridden to only select\n * matched items if speed search is active.\n * - `keyboardDelegate`: a keyboard delegate in which limits navigation to matched items, when\n * speed search is active.\n *\n * Speed search options, including the ones for optionally controlling the state of the speed search\n * are also accepted in inputs.\n *\n * FIXME: speed search on collections should not move selection to the first match, it should move it\n *  to the first match AFTER the focused key (or focused key itself if it's a match)\n */\nexport function useCollectionSpeedSearch<T>({\n  collection,\n  selectionManager,\n  stickySearch,\n  keyboardDelegate,\n  ...speedSearchStateProps\n}: {\n  collection: Collection<Node<T>>;\n  selectionManager: SelectionManager;\n  keyboardDelegate: KeyboardDelegate;\n  stickySearch?: boolean;\n} & SpeedSearchStateProps) {\n  const speedSearch = useSpeedSearchState(speedSearchStateProps); // maybe allow control over state\n  // via props?\n\n  const {\n    matches,\n    selectionManager: speedSearchSelectionManager,\n  } = useCollectionSpeedSearchResult({\n    collection,\n    selectionManager,\n    speedSearch,\n  });\n  const { containerProps } = useSpeedSearch({ stickySearch }, speedSearch);\n  const speedSearchKeyboardDelegate = useMemo(\n    () =>\n      createSpeedSearchKeyboardDelegate(\n        keyboardDelegate,\n        speedSearch.active ? matches : null\n      ),\n    [speedSearch.active, keyboardDelegate, matches]\n  );\n\n  // Doesn't seem necessary to wrap with useMemo, but can be rethink-ed\n  const speedSearchContextValue = { matches, collection };\n\n  return {\n    containerProps,\n    selectionManager: speedSearchSelectionManager,\n    keyboardDelegate: speedSearchKeyboardDelegate,\n    speedSearch: {\n      ...speedSearch,\n      matches,\n    },\n    searchPopupProps: {\n      active: speedSearch.active,\n      match: matches.size > 0,\n      children: speedSearch.searchTerm,\n    },\n    speedSearchContextValue,\n  };\n}\n","import { useGhostInput } from \"./useGhostInput\";\nimport { useFocusWithin, useKeyboard } from \"@react-aria/interactions\";\nimport { useControlledState } from \"@react-stately/utils\";\nimport { ControlledStateProps } from \"../type-utils\";\n\nexport interface SpeedSearchState {\n  active: boolean;\n  setActive: (value: boolean) => void;\n  searchTerm: string;\n  setSearchTerm: (value: string) => void;\n}\n\nexport interface SpeedSearchStateProps\n  extends ControlledStateProps<{\n    searchTerm: string;\n    active: boolean;\n  }> {}\n\nexport function useSpeedSearchState(\n  props: SpeedSearchStateProps\n): SpeedSearchState {\n  const [active, setActive] = useControlledState(\n    props.active!,\n    props.active || false,\n    props.onActiveChange!\n  );\n  const [searchTerm, setSearchTerm] = useControlledState(\n    props.searchTerm!,\n    props.defaultSearchTerm || \"\",\n    props.onSearchTermChange!\n  );\n\n  return {\n    active: active,\n    searchTerm,\n    setActive,\n    setSearchTerm,\n  };\n}\n\nexport interface SpeedSearchProps {\n  stickySearch?: boolean;\n}\n\n/**\n * TODO: description\n * IMPORTANT: making the container element focusable is not a part of this hook. But it's a prerequisite for it to work.\n * Previously, a tabIndex:-1 was passed as a container prop, but it turns out it's not that simple. For collections for\n * example we usually want tab index to be 0 once it's not focused and then when an item is focused, we want it to be\n * -1, and such kind of logics are handled in their respective hooks. So, making the container focusable and how to do\n * it is NOT this hook's responsibility anymore.\n */\nexport function useSpeedSearch(\n  { stickySearch }: SpeedSearchProps,\n  { searchTerm, setActive, setSearchTerm }: SpeedSearchState\n) {\n  const { onKeyDown: ghostInputKeydown } = useGhostInput({\n    value: searchTerm,\n    onChange: (value) => {\n      setSearchTerm(value);\n      setActive(true);\n    },\n  });\n  const clear = () => {\n    setSearchTerm(\"\");\n    setActive(false);\n  };\n\n  const {\n    keyboardProps: { onKeyDown, onKeyUp },\n  } = useKeyboard({\n    onKeyDown: (e) => {\n      // intellij UI implementation removes the searchTerm by left/right arrows. Maybe do the same?\n      if (e.key === \"Escape\") {\n        clear();\n      } else {\n        ghostInputKeydown(e);\n      }\n    },\n  });\n\n  const {\n    focusWithinProps: { onFocus, onBlur },\n  } = useFocusWithin({\n    onFocusWithinChange: (focused) => {\n      if (!focused && !stickySearch) {\n        clear();\n      }\n    },\n  });\n\n  return {\n    containerProps: {\n      onFocus,\n      onBlur,\n      onKeyDown,\n      onKeyUp,\n    },\n  };\n}\n","import React, { Key } from \"react\";\nimport { KeyboardDelegate } from \"@react-types/shared\";\n\n/**\n * Creates a new KeyboardDelegate in which keyKeyBelow and getKeyAbove are overridden in a way that\n * navigation is limited to matched items.\n * Note: select all action is not handled in KeyboardDelegate.\n * Note: when virtualization is added, this probably need to change, like how it's handled\n * in `useListBoxLayout` in react spectrum.\n */\nexport function createSpeedSearchKeyboardDelegate(\n  wrappedKeyboardDelegate: KeyboardDelegate,\n  matches: Map<Key, unknown /*We don't care what a match is, here*/> | null\n): KeyboardDelegate {\n  // TODO: page up and down deactivate speed search. If we want that, we can pass the speedSearch\n  //  object too. but doesn't seem like the best way to do it, even it the same behavior is expected\n  return Object.create(wrappedKeyboardDelegate, {\n    getKeyBelow: {\n      value: (key: React.Key): React.Key | undefined => {\n        let keyBelow = wrappedKeyboardDelegate.getKeyBelow?.(key);\n        while (keyBelow != null) {\n          if (!matches || matches.has(keyBelow)) {\n            return keyBelow;\n          }\n          keyBelow = wrappedKeyboardDelegate.getKeyBelow?.(keyBelow);\n        }\n        return keyBelow;\n      },\n    },\n    getKeyAbove: {\n      value: (key: React.Key): React.Key | undefined => {\n        let keyAfter = wrappedKeyboardDelegate.getKeyAbove?.(key);\n        while (keyAfter != null) {\n          if (!matches || matches.has(keyAfter)) {\n            return keyAfter;\n          }\n          keyAfter = wrappedKeyboardDelegate.getKeyAbove?.(keyAfter);\n        }\n        return keyAfter;\n      },\n    },\n  });\n}\n","import { ListKeyboardDelegate } from \"@react-aria/selection\";\nimport { Collection, Node } from \"@react-types/shared\";\nimport React, { Key, RefObject } from \"react\";\n\nexport class TreeKeyboardDelegate<T> extends ListKeyboardDelegate<T> {\n  constructor(\n    private collection: Collection<Node<T>>,\n    private disabledKeys: Set<Key>,\n    ref: RefObject<HTMLElement>,\n    collator?: Intl.Collator\n  ) {\n    super(collection, disabledKeys, ref, collator);\n  }\n\n  getKeyLeftOf(key: React.Key): React.Key {\n    const item = this.collection.getItem(key);\n    return item.parentKey ?? this.getKeyAbove(key);\n  }\n\n  getKeyRightOf(key: React.Key): React.Key {\n    return this.getKeyBelow(key);\n  }\n}\n","import React, { Key, RefObject, useMemo, useState } from \"react\";\nimport { useSelectableCollection } from \"../selection/useSelectableCollection\";\nimport { TreeKeyboardDelegate } from \"./TreeKeyboardDelegate\";\nimport { KeyboardDelegate, KeyboardEvent } from \"@react-types/shared\";\nimport { useFocusWithin, useKeyboard } from \"@react-aria/interactions\";\nimport { mergeProps } from \"@react-aria/utils\";\nimport { useCollator } from \"@react-aria/i18n\";\nimport { useCollectionAutoScroll } from \"../Collections/useCollectionAutoScroll\";\nimport { TreeState } from \"./__tmp__useTreeState\";\nimport { useLatest } from \"@intellij-platform/core/utils/useLatest\";\nimport { TreeContextType } from \"./TreeContext\";\n\nexport type SelectableTreeProps<T> = TreeState<T> & {\n  isVirtualized?: boolean;\n  keyboardDelegate?: KeyboardDelegate;\n  onAction: undefined | ((key: Key) => void);\n};\n\nexport function useSelectableTree<T>(\n  { onAction, ...props }: SelectableTreeProps<T>,\n  ref: RefObject<HTMLElement>\n) {\n  const collator = useCollator({ usage: \"search\", sensitivity: \"base\" });\n\n  const [focused, setFocused] = useState(false);\n  const {\n    collectionProps: {\n      // preventDefault in onMouseDown prevents collection from getting focused.\n      // Maybe it should be removed from useSelectableCollection, now that it lives here\n      onMouseDown,\n      onKeyDown: selectionKeyDown,\n      ...collectionProps\n    },\n  } = useSelectableCollection({\n    ref,\n    selectionManager: props.selectionManager,\n    selectOnFocus: true,\n    keyboardDelegate: useMemo(\n      () =>\n        props.keyboardDelegate ||\n        new TreeKeyboardDelegate(\n          props.collection,\n          props.disabledKeys,\n          ref,\n          collator\n        ),\n      [props.collection, props.disabledKeys, props.keyboardDelegate]\n    ),\n  });\n  const { focusWithinProps } = useFocusWithin({\n    onFocusWithinChange: setFocused,\n  });\n\n  useCollectionAutoScroll(\n    {\n      isVirtualized: props.isVirtualized,\n      selectionManager: props.selectionManager,\n    },\n    ref\n  );\n\n  const onKeyDown = (event: KeyboardEvent) => {\n    const focusedKey = props.selectionManager.focusedKey;\n    const isExpandable =\n      focusedKey != null && props.collection.getItem(focusedKey).hasChildNodes;\n    const expanded = focusedKey != null && props.expandedKeys.has(focusedKey);\n    const isDisabled = props.disabledKeys.has(focusedKey);\n    if (isDisabled) {\n      return;\n    }\n    const shouldToggle =\n      event.key === \"Enter\" ||\n      (event.key === \"ArrowLeft\" && expanded) ||\n      (event.key === \"ArrowRight\" && !expanded);\n\n    if (isExpandable && shouldToggle) {\n      event.preventDefault();\n      props.toggleKey(focusedKey);\n    } else if (event.key === \"Enter\") {\n      onAction?.(focusedKey);\n    } else {\n      selectionKeyDown?.(event);\n    }\n  };\n  const { keyboardProps } = useKeyboard({\n    onKeyDown,\n  });\n\n  //////////////////////////////// providing context value ////////////////////////////////\n  const onActionRef = useLatest(onAction);\n\n  const {\n    selectionManager,\n    collection,\n    expandedKeys,\n    disabledKeys,\n    toggleKey,\n  } = props;\n  const treeContext = useMemo<TreeContextType<T>>(\n    () => ({\n      state: {\n        collection,\n        selectionManager,\n        expandedKeys,\n        disabledKeys,\n        toggleKey,\n      },\n      focused,\n      onActionRef,\n    }),\n    [\n      selectionManager,\n      collection,\n      expandedKeys,\n      disabledKeys,\n      toggleKey,\n      focused,\n      onActionRef,\n    ]\n  );\n  ////////////////////////////////////////////////////////////////////////////////////////\n\n  return {\n    // order of merging here is important. navigation handling should precede selection handling\n    treeProps: mergeProps(focusWithinProps, collectionProps, keyboardProps),\n    treeContext,\n    focused,\n  };\n}\n","/*\n * Copyright 2020 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport React, {\n  FocusEvent,\n  HTMLAttributes,\n  Key,\n  KeyboardEvent,\n  RefObject,\n  useEffect,\n} from \"react\";\nimport { focusSafely, getFocusableTreeWalker } from \"@react-aria/focus\";\nimport { FocusStrategy, KeyboardDelegate } from \"@react-types/shared\";\nimport { mergeProps } from \"@react-aria/utils\";\nimport { MultipleSelectionManager } from \"@react-stately/selection\";\nimport { useLocale } from \"@react-aria/i18n\";\nimport { useTypeSelect } from \"@react-aria/selection\";\nimport { isCtrlKeyPressed } from \"../utils/keyboard-utils\";\n\ninterface SelectableCollectionOptions {\n  /**\n   * An interface for reading and updating multiple selection state.\n   */\n  selectionManager: MultipleSelectionManager;\n  /**\n   * A delegate object that implements behavior for keyboard focus movement.\n   */\n  keyboardDelegate: KeyboardDelegate;\n  /**\n   * The ref attached to the element representing the collection.\n   */\n  ref: RefObject<HTMLElement>;\n  /**\n   * Whether the collection or one of its items should be automatically focused upon render.\n   * @default false\n   */\n  autoFocus?: boolean | FocusStrategy;\n  /**\n   * Whether focus should wrap around when the end/start is reached.\n   * @default false\n   */\n  shouldFocusWrap?: boolean;\n  /**\n   * Whether the collection allows empty selection.\n   * @default false\n   */\n  disallowEmptySelection?: boolean;\n  /**\n   * Whether the collection allows the user to select all items via keyboard shortcut.\n   * @default false\n   */\n  disallowSelectAll?: boolean;\n  /**\n   * Whether selection should occur automatically on focus.\n   * @default false\n   */\n  selectOnFocus?: boolean;\n  /**\n   * Whether typeahead is disabled.\n   * @default false\n   */\n  disallowTypeAhead?: boolean;\n  /**\n   * Whether the collection items should use virtual focus instead of being focused directly.\n   */\n  shouldUseVirtualFocus?: boolean;\n  /**\n   * Whether navigation through tab key is enabled.\n   */\n  allowsTabNavigation?: boolean;\n}\n\ninterface SelectableCollectionAria {\n  /** Props for the collection element. */\n  collectionProps: HTMLAttributes<HTMLElement>;\n}\n\n/**\n * Handles interactions with selectable collections.\n */\nexport function useSelectableCollection(\n  options: SelectableCollectionOptions\n): SelectableCollectionAria {\n  let {\n    selectionManager: manager,\n    keyboardDelegate: delegate,\n    ref,\n    autoFocus = false,\n    shouldFocusWrap = false,\n    disallowEmptySelection = false,\n    disallowSelectAll = false,\n    selectOnFocus = false,\n    disallowTypeAhead = false,\n    shouldUseVirtualFocus,\n    allowsTabNavigation = false,\n  } = options;\n  let { direction } = useLocale();\n\n  let onKeyDown = (e: KeyboardEvent) => {\n    // Let child element (e.g. menu button) handle the event if the Alt key is pressed.\n    // Keyboard events bubble through portals. Don't handle keyboard events\n    // for elements outside the collection (e.g. menus).\n    if (e.altKey || !ref.current?.contains(e.target as HTMLElement)) {\n      return;\n    }\n\n    const navigateToKey = (\n      key: Key | undefined,\n      childFocus?: FocusStrategy\n    ) => {\n      if (key != null) {\n        manager.setFocusedKey(key, childFocus);\n\n        if (e.shiftKey && manager.selectionMode === \"multiple\") {\n          manager.extendSelection(key);\n        } else if (selectOnFocus) {\n          manager.replaceSelection(key);\n        }\n      }\n    };\n\n    switch (e.key) {\n      case \"ArrowDown\": {\n        if (delegate.getKeyBelow) {\n          e.preventDefault();\n          let nextKey =\n            manager.focusedKey != null\n              ? delegate.getKeyBelow(manager.focusedKey)\n              : delegate.getFirstKey?.();\n          if (nextKey == null && shouldFocusWrap) {\n            nextKey = delegate.getFirstKey?.(manager.focusedKey);\n          }\n          navigateToKey(nextKey);\n        }\n        break;\n      }\n      case \"ArrowUp\": {\n        if (delegate.getKeyAbove) {\n          e.preventDefault();\n          let nextKey =\n            manager.focusedKey != null\n              ? delegate.getKeyAbove(manager.focusedKey)\n              : delegate.getLastKey?.();\n          if (nextKey == null && shouldFocusWrap) {\n            nextKey = delegate.getLastKey?.(manager.focusedKey);\n          }\n          navigateToKey(nextKey);\n        }\n        break;\n      }\n      case \"ArrowLeft\": {\n        if (delegate.getKeyLeftOf) {\n          e.preventDefault();\n          let nextKey = delegate.getKeyLeftOf(manager.focusedKey);\n          navigateToKey(nextKey, direction === \"rtl\" ? \"first\" : \"last\");\n        }\n        break;\n      }\n      case \"ArrowRight\": {\n        if (delegate.getKeyRightOf) {\n          e.preventDefault();\n          let nextKey = delegate.getKeyRightOf(manager.focusedKey);\n          navigateToKey(nextKey, direction === \"rtl\" ? \"last\" : \"first\");\n        }\n        break;\n      }\n      case \"Home\":\n        if (delegate.getFirstKey) {\n          e.preventDefault();\n          let firstKey = delegate.getFirstKey(\n            manager.focusedKey,\n            isCtrlKeyPressed(e)\n          );\n          manager.setFocusedKey(firstKey);\n          if (\n            isCtrlKeyPressed(e) &&\n            e.shiftKey &&\n            manager.selectionMode === \"multiple\"\n          ) {\n            manager.extendSelection(firstKey);\n          } else if (selectOnFocus) {\n            manager.replaceSelection(firstKey);\n          }\n        }\n        break;\n      case \"End\":\n        if (delegate.getLastKey) {\n          e.preventDefault();\n          let lastKey = delegate.getLastKey(\n            manager.focusedKey,\n            isCtrlKeyPressed(e)\n          );\n          manager.setFocusedKey(lastKey);\n          if (\n            isCtrlKeyPressed(e) &&\n            e.shiftKey &&\n            manager.selectionMode === \"multiple\"\n          ) {\n            manager.extendSelection(lastKey);\n          } else if (selectOnFocus) {\n            manager.replaceSelection(lastKey);\n          }\n        }\n        break;\n      case \"PageDown\":\n        if (delegate.getKeyPageBelow) {\n          e.preventDefault();\n          let nextKey = delegate.getKeyPageBelow(manager.focusedKey);\n          navigateToKey(nextKey);\n        }\n        break;\n      case \"PageUp\":\n        if (delegate.getKeyPageAbove) {\n          e.preventDefault();\n          let nextKey = delegate.getKeyPageAbove(manager.focusedKey);\n          navigateToKey(nextKey);\n        }\n        break;\n      case \"a\":\n        if (\n          isCtrlKeyPressed(e) &&\n          manager.selectionMode === \"multiple\" &&\n          disallowSelectAll !== true\n        ) {\n          e.preventDefault();\n          manager.selectAll();\n        }\n        break;\n      case \"Escape\":\n        e.preventDefault();\n        if (!disallowEmptySelection) {\n          manager.clearSelection();\n        }\n        break;\n      case \"Tab\": {\n        if (!allowsTabNavigation) {\n          // There may be elements that are \"tabbable\" inside a collection (e.g. in a grid cell).\n          // However, collections should be treated as a single tab stop, with arrow key navigation internally.\n          // We don't control the rendering of these, so we can't override the tabIndex to prevent tabbing.\n          // Instead, we handle the Tab key, and move focus manually to the first/last tabbable element\n          // in the collection, so that the browser default behavior will apply starting from that element\n          // rather than the currently focused one.\n          if (e.shiftKey) {\n            ref.current.focus();\n          } else {\n            let walker = getFocusableTreeWalker(ref.current, {\n              tabbable: true,\n            });\n            let next: HTMLElement | undefined;\n            let last: HTMLElement;\n            do {\n              last = walker.lastChild() as HTMLElement;\n              if (last) {\n                next = last;\n              }\n            } while (last);\n\n            if (next && !next.contains(document.activeElement)) {\n              next.focus();\n            }\n          }\n          break;\n        }\n      }\n    }\n  };\n\n  let onFocus = (e: FocusEvent) => {\n    if (manager.isFocused) {\n      // If a focus event bubbled through a portal, reset focus state.\n      if (!e.currentTarget.contains(e.target)) {\n        manager.setFocused(false);\n      }\n\n      return;\n    }\n\n    // Focus events can bubble through portals. Ignore these events.\n    if (!e.currentTarget.contains(e.target)) {\n      return;\n    }\n\n    manager.setFocused(true);\n\n    if (manager.focusedKey == null) {\n      // If the user hasn't yet interacted with the collection, there will be no focusedKey set.\n      // Attempt to detect whether the user is tabbing forward or backward into the collection\n      // and either focus the first or last item accordingly.\n      let relatedTarget = e.relatedTarget as Element;\n      let key: Key | undefined;\n      if (\n        relatedTarget &&\n        e.currentTarget.compareDocumentPosition(relatedTarget) &\n          Node.DOCUMENT_POSITION_FOLLOWING\n      ) {\n        key = manager.lastSelectedKey ?? delegate.getLastKey?.();\n      } else {\n        key = manager.firstSelectedKey ?? delegate.getFirstKey?.();\n      }\n      if (key != null) {\n        manager.setFocusedKey(key);\n      }\n    }\n  };\n\n  let onBlur = (e: FocusEvent) => {\n    // Don't set blurred and then focused again if moving focus within the collection.\n    if (!e.currentTarget.contains(e.relatedTarget as HTMLElement)) {\n      manager.setFocused(false);\n    }\n  };\n\n  useEffect(() => {\n    if (autoFocus) {\n      let focusedKey = null;\n\n      // Check focus strategy to determine which item to focus\n      if (autoFocus === \"first\") {\n        focusedKey = delegate.getFirstKey?.();\n      }\n      if (autoFocus === \"last\") {\n        focusedKey = delegate.getLastKey?.();\n      }\n\n      // If there are any selected keys, make the first one the new focus target\n      let selectedKeys = manager.selectedKeys;\n      if (selectedKeys.size) {\n        focusedKey = selectedKeys.values().next().value;\n      }\n\n      manager.setFocused(true);\n      manager.setFocusedKey(focusedKey);\n\n      // If no default focus key is selected, focus the collection itself.\n      if (focusedKey == null && !shouldUseVirtualFocus && ref.current) {\n        focusSafely(ref.current);\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  let handlers = {\n    onKeyDown,\n    onFocus,\n    onBlur,\n    onMouseDown(e: React.MouseEvent) {\n      // Prevent focus going to the collection when clicking on the scrollbar.\n      e.preventDefault();\n    },\n  };\n\n  let { typeSelectProps } = useTypeSelect({\n    keyboardDelegate: delegate,\n    selectionManager: manager,\n    onTypeSelect: selectOnFocus\n      ? (key) => {\n          manager.replaceSelection(key);\n        }\n      : undefined,\n  });\n\n  if (!disallowTypeAhead) {\n    handlers = mergeProps(typeSelectProps, handlers);\n  }\n\n  // If nothing is focused within the collection, make the collection itself tabbable.\n  // This will be marshalled to either the first or last item depending on where focus came from.\n  // If using virtual focus, don't set a tabIndex at all so that VoiceOver on iOS 14 doesn't try\n  // to move real DOM focus to the element anyway.\n  let tabIndex: number | undefined;\n  if (!shouldUseVirtualFocus) {\n    tabIndex = manager.focusedKey == null ? 0 : -1;\n  }\n\n  return {\n    collectionProps: {\n      ...handlers,\n      tabIndex,\n    },\n  };\n}\n","import { SelectionManager } from \"@react-stately/selection\";\nimport { RefObject, useEffect } from \"react\";\n\ntype CollectionAutoScrollProps = {\n  isVirtualized?: boolean;\n  selectionManager: SelectionManager;\n};\n\nexport function useCollectionAutoScroll(\n  { isVirtualized, selectionManager }: CollectionAutoScrollProps,\n  ref: RefObject<HTMLElement>\n) {\n  // If not virtualized, scroll the focused element into view when the focusedKey changes.\n  // When virtualized, Virtualizer handles this internally.\n  useEffect(() => {\n    if (!isVirtualized && selectionManager.focusedKey && ref?.current) {\n      let element = ref.current.querySelector(\n        `[data-key=\"${selectionManager.focusedKey}\"]`\n      ) as HTMLElement;\n      if (element) {\n        scrollIntoView(ref.current, element);\n      }\n    }\n  }, [isVirtualized, ref, selectionManager.focusedKey]);\n}\n\n/**\n * Scrolls `scrollView` so that `element` is visible.\n * Similar to `element.scrollIntoView({block: 'nearest'})` (not supported in Edge),\n * but doesn't affect parents above `scrollView`.\n */\nfunction scrollIntoView(scrollView: HTMLElement, element: HTMLElement) {\n  let offsetX = element.offsetLeft - scrollView.offsetLeft;\n  let offsetY = element.offsetTop - scrollView.offsetTop;\n  let width = element.offsetWidth;\n  let height = element.offsetHeight;\n  let x = scrollView.scrollLeft;\n  let y = scrollView.scrollTop;\n  let maxX = x + scrollView.offsetWidth;\n  let maxY = y + scrollView.offsetHeight;\n\n  if (offsetX <= x) {\n    x = offsetX;\n  } else if (offsetX + width > maxX) {\n    x += offsetX + width - maxX;\n  }\n  if (offsetY <= y) {\n    y = offsetY;\n  } else if (offsetY + height > maxY) {\n    y += offsetY + height - maxY;\n  }\n\n  scrollView.scrollLeft = x;\n  scrollView.scrollTop = y;\n}\n","import { TreeRef } from \"@intellij-platform/core/Tree\";\nimport { Node } from \"@react-types/shared\";\nimport { Virtualizer } from \"@react-aria/virtualizer\";\nimport React, { ForwardedRef, useRef } from \"react\";\nimport { StyledList } from \"../../List/StyledList\";\nimport { replaceSelectionManager } from \"../../selection/replaceSelectionManager\";\nimport { SpeedSearchPopup } from \"../../SpeedSearch/SpeedSearchPopup\";\nimport { useTreeState } from \"../__tmp__useTreeState\";\nimport { TreeProps } from \"../Tree\";\nimport { useTreeVirtualizer } from \"../useTreeVirtualizer\";\nimport { TreeNode } from \"../TreeNode\";\nimport { TreeContext } from \"../TreeContext\";\nimport { useSpeedSearchTree } from \"./useSpeedSearchTree\";\nimport {\n  SpeedSearchItemHighlightsProvider,\n  CollectionSpeedSearchContext,\n} from \"@intellij-platform/core/CollectionSpeedSearch\";\n\nexport const SpeedSearchTree = React.forwardRef(\n  <T extends object>(\n    { fillAvailableSpace = false, onAction, ...props }: TreeProps<T>,\n    forwardedRef: ForwardedRef<TreeRef>\n  ) => {\n    const state = replaceSelectionManager(useTreeState(props, forwardedRef));\n    const ref = useRef<HTMLDivElement>(null);\n\n    const {\n      treeProps,\n      treeContext,\n      speedSearchContextValue,\n      searchPopupProps,\n    } = useSpeedSearchTree({ ...state, onAction, isVirtualized: true }, ref);\n\n    const { virtualizerProps } = useTreeVirtualizer({ state });\n\n    const renderNode = (item: Node<T>) => (\n      <SpeedSearchItemHighlightsProvider itemKey={item.key}>\n        <TreeNode key={item.key} item={item} />\n      </SpeedSearchItemHighlightsProvider>\n    );\n    // NOTE: SpeedSearchPopup can be rendered as a portal with proper positioning (useOverlayPosition), if overflow\n    // issues required it.\n    return (\n      <TreeContext.Provider value={treeContext}>\n        <CollectionSpeedSearchContext.Provider value={speedSearchContextValue}>\n          <SpeedSearchPopup {...searchPopupProps} />\n          <StyledList\n            as={Virtualizer}\n            ref={ref}\n            fillAvailableSpace={fillAvailableSpace}\n            {...virtualizerProps}\n            {...treeProps}\n          >\n            {(type: string, item: unknown) => renderNode(item as Node<T>)}\n          </StyledList>\n        </CollectionSpeedSearchContext.Provider>\n      </TreeContext.Provider>\n    );\n  }\n);\n","import { SelectionManager } from \"./SelectionManager\";\nimport { Collection, Node } from \"@react-types/shared\";\n\n/**\n * collection state hooks like `useList`, `useTree`, etc, don't have an option to pass an\n * alternative `SelectionManager` implementation (which is required to achieve the desired\n * multi-select behavior). So this simple utility is kind of a hacky patch to replace selection\n * manager in the return value of those state hooks\n */\nexport function replaceSelectionManager<\n  T,\n  S extends {\n    selectionManager: SelectionManager;\n    collection: Collection<Node<T>>;\n  }\n>(state: S) {\n  state.selectionManager = new SelectionManager(\n    state.collection,\n    // @ts-expect-error state is private. There might be better ways of creating a custom selection manager\n    state.selectionManager.state\n  );\n  return state;\n}\n","import { useKeyboard } from \"@react-aria/interactions\";\nimport { mergeProps } from \"@react-aria/utils\";\nimport { RefObject } from \"react\";\nimport { useCollectionSpeedSearch } from \"../../CollectionSpeedSearch/useCollectionSpeedSearch\";\nimport { SpeedSearchProps } from \"../../SpeedSearch/useSpeedSearch\";\nimport { TreeKeyboardDelegate } from \"../TreeKeyboardDelegate\";\nimport { SelectableTreeProps, useSelectableTree } from \"../useSelectableTree\";\n\ninterface Props<T> extends SpeedSearchProps, SelectableTreeProps<T> {}\n\nexport function useSpeedSearchTree<T>(\n  props: Props<T>,\n  ref: RefObject<HTMLElement>\n) {\n  const {\n    containerProps,\n    keyboardDelegate,\n    selectionManager,\n    speedSearch,\n    ...collectionSpeedSearch\n  } = useCollectionSpeedSearch({\n    collection: props.collection,\n    selectionManager: props.selectionManager,\n    stickySearch: props.stickySearch,\n    keyboardDelegate: new TreeKeyboardDelegate(\n      props.collection,\n      props.disabledKeys,\n      ref\n    ),\n    // TODO: maybe allow control over speed search via other props\n  });\n\n  // Speed search is cleared on \"Enter\" key. Alternatively we could wrap onAction and onToggle props\n  // but this seemed more reasonable\n  // NOTE: It may make sense for this behaviour to be pulled up to useCollectionSpeedSearch.\n  const { keyboardProps: speedSearchKeyboardProps } = useKeyboard({\n    onKeyDown: (e) => {\n      if ([\"Enter\", \"ArrowLeft\", \"ArrowRight\"].includes(e.key)) {\n        speedSearch.setSearchTerm(\"\");\n        speedSearch.setActive(false);\n      }\n    },\n  });\n\n  const { treeProps, ...selectableTree } = useSelectableTree(\n    { ...props, keyboardDelegate: keyboardDelegate, selectionManager },\n    ref\n  );\n\n  return {\n    treeProps: mergeProps(treeProps, containerProps, speedSearchKeyboardProps),\n    ...collectionSpeedSearch,\n    ...selectableTree,\n  };\n}\n","import { IconResolver } from \"./types\";\n\nexport class GithubIconResolver implements IconResolver {\n  async resolve(iconPath: string) {\n    return resolve(\n      `https://raw.githubusercontent.com/JetBrains/intellij-community/master/${iconPath}`\n    );\n  }\n}\nasync function resolve(url: string): Promise<string> {\n  const response = await fetch(url);\n  if (!response.ok) {\n    throw new Error(`failed to fetch icon from url: ${url}`);\n  }\n  return response.text();\n}\n","/**\n * A very simple cache decorator without any option, to be used for caching theme property values.\n * If more improved caching is required, a proper library can be used.\n */\nexport const cache: TypedMethodDecorator = function (\n  target,\n  propertyName,\n  descriptor\n) {\n  const method = descriptor.value!;\n\n  descriptor.value = function (this: any, ...args: any[]) {\n    const cacheKey = `__cache__${String(propertyName)}`;\n    this[cacheKey] = this[cacheKey] || {};\n    const cacheObj: Record<string, any> = this[cacheKey];\n\n    const allArgsAreString = args.every((arg) => typeof arg === \"string\");\n    if (allArgsAreString) {\n      const key = args.join(\"_\");\n      if (!cacheObj[key]) {\n        cacheObj[key] = method.apply(this, args);\n\n        // if returned value is a promise, we will clear cache in case it fails\n        if (cacheObj[key] instanceof Promise) {\n          cacheObj[key].catch(() => {\n            delete cacheObj[key];\n          });\n        }\n      }\n      return cacheObj[key];\n    } else {\n      console.warn(\n        `could not cache or use cached value for ${method.name}. not all arguments are string:`,\n        ...args\n      );\n      return method.apply(this, args);\n    }\n  } as any;\n};\ntype TypedMethodDecorator = <T extends Function>(\n  target: Object,\n  propertyKey: string | symbol,\n  descriptor: TypedPropertyDescriptor<T>\n) => TypedPropertyDescriptor<T> | void;\n","import {\n  IconResolver,\n  KnownThemePropertyPath,\n  OS,\n  OsDependentValue,\n  OsDependentValueKey,\n  ThemeJson,\n  ThemePropertyValue,\n} from \"./types\";\nimport { GithubIconResolver } from \"./GithubIconResolver\";\nimport { isMac } from \"@react-aria/utils\";\nimport { cache } from \"./cache.decorator\";\n\n/**\n * Just to able locate all keys that are not yet typed and maybe fix them later at some point.\n */\nexport type UnknownThemeProp = any;\n\nconst defaultValues: { [key in KnownThemePropertyPath]?: string } = {\n  \"*.disabledForeground\": \"#8C8C8C\",\n};\n/**\n * TODO: flattening the map once seems like a reasonable refactoring.\n */\nexport class Theme<P extends string = string> {\n  // using property initializer causes an error. the property initialization is run before\n  // constructor, and therefore this.themeJson is undefined. Could be a babel misconfiguration, but\n  // this workaround is used for now\n  commonColors: ReturnType<Theme<P>[\"getCommonColors\"]>;\n\n  constructor(\n    public readonly themeJson: ThemeJson,\n    protected readonly os: OS | null = detectOs(),\n    protected readonly iconResolver: IconResolver = new GithubIconResolver()\n  ) {\n    this.commonColors = this.getCommonColors();\n    Object.entries(defaultValues).forEach(([key, value]) => {\n      if (value) {\n        this.setDefault(key as P, value);\n      }\n    });\n  }\n\n  get dark(): boolean {\n    return Boolean(this.themeJson.dark);\n  }\n\n  get name(): string {\n    return this.themeJson.name;\n  }\n\n  private setDefault(path: P, value: string) {\n    if (this.value(path) !== value) {\n      this.themeJson.ui[path] = value;\n    }\n  }\n\n  isUnderDarcula() {\n    return this.themeJson.name.includes(\"Darcula\");\n  }\n\n  /**\n   * - Resolves values that are references to theme.colors\n   */\n  color<T extends string | undefined>(\n    path: P,\n    fallback?: T\n  ): undefined extends T ? string | undefined : string {\n    // There is a fallback mechanism that uses *.prop key if some key that ends with .prop\n    // doesn't exist in the theme. In Intellij Platform implementation, all such fallback keys\n    // are generated in the theme initialization and added to the theme default lookup table.\n    // here we read it on the fly with `getFallbackFromStar`.\n    // More info: https://github.com/JetBrains/intellij-community/blob/58dbd93e9ea527987466072fa0bfbf70864cd35f/platform/platform-impl/src/com/intellij/ide/ui/UITheme.java#L371-L371\n    // NOTE: Maybe this fallback to *.{prop} is something we should have for any type of property, not\n    // only colors. Can be refactored if it turned out to be the case.\n    const dereference = (maybeReferencedValue: string | null) =>\n      maybeReferencedValue &&\n      (this.themeJson.colors?.[maybeReferencedValue] || maybeReferencedValue);\n\n    // we could return Color object and it works because of overridden toString. but there\n    // will be ts type errors because color css properties expect the value to be string.\n    // Of course we can call .toString() on each usage but doesn't seem nice.\n    return (\n      dereference(this.value<string>(path)) ||\n      (fallback as any) ||\n      dereference(this.getFallbackFromStar(path) as string)\n    );\n  }\n\n  /**\n   * Resolves platform icon path to svg.\n   * by default it fetches the svg icon from Github, but there are other Theme implementations\n   */\n  @cache\n  async getSvgIcon(path: string): Promise<string> {\n    return this.iconResolver.resolve(\n      !path.endsWith(\".svg\") ? `${path}.svg` : path\n    );\n  }\n\n  /**\n   * Given a dot separated path, returns the theme property value.\n   * - Resolves OS-dependent values, which are objects with fields like \"os.default\", \"os.mac\"\n   * - Supports both of these forms: {\"x.y\": \"value\"} and {x: {y: \"value\"}}\n   * @example `theme.value(\"Menu.borderColor\")`\n   */\n  @cache\n  value<T extends ThemePropertyValue>(path: P): T {\n    return resolveOsDependentValue(\n      resolvePath(path, this.themeJson.ui),\n      this.os\n    ) as T;\n  }\n\n  private getFallbackFromStar(path: P) {\n    // FIXME: after refactoring about flattening themeJson.ui properties are done, this should also\n    //  be changed.\n    const fallbackKey = Object.keys(this.themeJson.ui[\"*\"] || {}).find((key) =>\n      path.endsWith(`.${key}` /* strip first star*/)\n    );\n    return fallbackKey ? this.value(`*.${fallbackKey}` as P) : null;\n  }\n\n  private getCommonColors() {\n    // Rooms for improvement. e.g. common colors creator can be an input to theme constructor\n    const theme = this as Theme<KnownThemePropertyPath>;\n    return {\n      tooltipForeground: theme.color(\n        \"ToolTip.foreground\",\n        theme.dark ? \"#bfbfbf\" : \"#000000\"\n      ),\n      inactiveTextColor: theme.color(\n        \"Component.infoForeground\",\n        theme.dark ? \"#787878\" : \"#999999\"\n      ),\n      panelBackground: theme.color(\"Panel.background\") || \"#fff\",\n      red: theme.dark ? \"rgb(255,100,100)\" : \"rgb(255,0,0)\",\n      contrastBorder: theme.color(\n        \"Borders.ContrastBorderColor\",\n        theme.dark ? \"#323232\" : \"#c9c9c9\"\n      ),\n    };\n  }\n}\n\nexport function detectOs(): OS | null {\n  return isMac() ? \"mac\" : null;\n}\n\nfunction resolveOsDependentValue(\n  value: OsDependentValue | ThemePropertyValue,\n  os: OS | null\n): ThemePropertyValue {\n  if (isOsDependentValue(value)) {\n    return (\n      value[`os.${os || \"default\"}` as const] ??\n      value[\"os.default\"] ??\n      (value[\n        Object.keys(value)[0] as OsDependentValueKey // the order is not spec-wise guaranteed, but not a biggie\n      ] /* because at least one key is required*/ as ThemePropertyValue)\n    );\n  }\n  return value;\n}\nfunction isOsDependentValue(value: any): value is OsDependentValue {\n  return (\n    typeof value === \"object\" &&\n    (value[\"os.mac\"] || value[\"os.linux\"] || value[\"os.windows\"])\n  );\n}\n\nfunction resolvePath<T extends { [key: string]: any }>(\n  path: string,\n  obj: T\n): any | undefined {\n  if (!obj || !path) {\n    return undefined;\n  }\n  if (obj[path]) {\n    return obj[path];\n  }\n  const [firstPathPart, ...otherPathParts] = path.split(\".\");\n  return resolvePath(otherPathParts.join(\".\"), obj[firstPathPart]);\n}\n","/**\n * drop shadow of windows and other overlays in Mac OS X. The current value is not accurate and needs to be revisited.\n */\nexport const MAC_WINDOW_SHADOW = \"box-shadow: 0 5px 15px rgb(0 0 0 / 30%)\";\n","import baseStyled, {\n  css as baseCss,\n  ThemedCssFunction,\n  ThemedStyledInterface,\n} from \"styled-components\";\nimport { Theme } from \"./Theme\";\nimport { KnownThemePropertyPath } from \"./Theme/types\";\n\nexport const styled = baseStyled as ThemedStyledInterface<\n  Theme<KnownThemePropertyPath>\n>;\n\nexport const css = baseCss as ThemedCssFunction<Theme<KnownThemePropertyPath>>;\n","import { styled } from \"@intellij-platform/core/styled\";\nimport { Theme, UnknownThemeProp } from \"@intellij-platform/core/Theme\";\nimport { StyledDefaultTab } from \"@intellij-platform/core/tabs/StyledDefaultTab\";\nimport {\n  getTabThemeStyles,\n  TabTheme,\n} from \"@intellij-platform/core/tabs/TabTheme\";\n\nexport const editorTabTheme = ({ theme }: { theme: Theme }): TabTheme => ({\n  borderColor: theme.color(\"EditorTabs.borderColor\"),\n  underlineHeight: theme.value<number>(\"EditorTabs.underlineHeight\"),\n  background: theme.color(\"EditorTabs.background\" as UnknownThemeProp),\n  underlinedTabInactiveBackground: theme.color(\n    \"EditorTabs.underlinedTabBackground\" as UnknownThemeProp // that's correctly not underlinedTabInactiveBackground!\n  ), // TODO: use EditorColorsScheme when available\n  underlinedTabBackground: theme.color(\"EditorTabs.underlinedTabBackground\"), // TODO: use EditorColorsScheme when available\n  hoverInactiveBackground: theme.color(\n    \"EditorTabs.hoverInactiveBackground\" as UnknownThemeProp\n  ),\n  hoverBackground: theme.color(\n    \"EditorTabs.hoverBackground\" as UnknownThemeProp\n  ),\n  inactiveUnderlineColor: theme.color(\n    \"EditorTabs.inactiveUnderlineColor\" as UnknownThemeProp\n  ), // TODO: use EditorColorsScheme when available\n  underlineColor: theme.color(\"EditorTabs.underlineColor\"), // TODO: use EditorColorsScheme when available\n\n  underlinedTabInactiveForeground: theme.color(\n    \"EditorTabs.underlinedTabForeground\" as UnknownThemeProp // that's correctly not underlinedTabInactiveForeground!\n  ), // TODO: use EditorColorsScheme when available\n  underlinedTabForeground: theme.color(\n    \"EditorTabs.underlinedTabForeground\" as UnknownThemeProp\n  ), // TODO: use EditorColorsScheme when available\n});\nexport const StyledEditorTab = styled(StyledDefaultTab)`\n  ${({ theme }) => getTabThemeStyles(editorTabTheme({ theme }))};\n`;\n","import { styled } from \"@intellij-platform/core/styled\";\nimport { getTabsThemeStyles } from \"@intellij-platform/core/tabs/TabTheme\";\nimport { StyledDefaultTabs } from \"@intellij-platform/core/tabs/StyledDefaultTabs\";\nimport { editorTabTheme } from \"./StyledEditorTab\";\n\nexport const StyledEditorTabs = styled(StyledDefaultTabs)`\n  ${({ theme }) => getTabsThemeStyles(editorTabTheme({ theme }))};\n`;\n","import { Tabs, TabsProps } from \"@intellij-platform/core/tabs/Tabs\";\nimport { StyledEditorTab } from \"./StyledEditorTab\";\nimport { StyledEditorTabs } from \"./StyledEditorTabs\";\nimport React from \"react\";\n\nexport type EditorTabsProps<T extends object> = Omit<\n  TabsProps<T>,\n  \"TabComponent\" | \"TabsComponent\" | \"focusable\"\n>;\n\nexport const EditorTabs = <T extends object>(props: EditorTabsProps<T>) => (\n  <Tabs\n    {...props}\n    TabComponent={StyledEditorTab}\n    TabsComponent={StyledEditorTabs}\n    focusable={false}\n  />\n);\n","import React from \"react\";\nimport { Pressable } from \"@react-aria/interactions\";\nimport { PlatformIcon } from \"@intellij-platform/core/Icon\";\nimport { TabCloseButton } from \"@intellij-platform/core/tabs/TabCloseButton\";\nimport {\n  TabContentLayout,\n  TabItemLayoutProps,\n} from \"@intellij-platform/core/tabs/TabContentLayout\";\n\n/**\n * For rendering the content of Editor tabs. supports for file icon which is shown on the left and close or unpin\n * button shown on the right.\n */\nexport const EditorTabContent = ({\n  icon,\n  title,\n  onClose,\n  onUnpin,\n  pinned,\n  containerProps,\n}: {\n  icon: React.ReactNode;\n  title: React.ReactNode;\n  onClose?: () => void;\n  onUnpin?: () => void;\n  pinned?: boolean;\n  containerProps?: TabItemLayoutProps[\"containerProps\"];\n}) => {\n  // TODO: Tooltip for unpin and close buttons\n  return (\n    <TabContentLayout\n      startIcon={icon}\n      title={title}\n      containerProps={containerProps}\n      endIcon={\n        pinned ? (\n          <Pressable onPress={onUnpin}>\n            <PlatformIcon icon=\"actions/pinTab\" />\n          </Pressable>\n        ) : (\n          onClose && <TabCloseButton onPress={onClose} />\n        )\n      }\n    />\n  );\n};\n","import { getTabThemeStyles } from \"./TabTheme\";\nimport { styled } from \"../styled\";\nimport { Theme, UnknownThemeProp } from \"../Theme\";\n\nexport type StyledTabProps = {\n  selected?: boolean;\n  disabled?: boolean;\n  active?: boolean;\n};\n\nconst defaultTabTheme = ({ theme }: { theme: Theme }) =>\n  getTabThemeStyles({\n    underlineHeight: theme.value<number>(\"DefaultTabs.underlineHeight\") ?? 3,\n    inactiveUnderlineColor: theme.color(\n      \"DefaultTabs.inactiveUnderlineColor\",\n      theme.dark ? \"#747a80\" : \"#9ca7b8\"\n    ),\n    underlineColor: theme.color(\n      \"DefaultTabs.underlineColor\",\n      theme.dark ? \"#4A88C7\" : \"#4083C9\"\n    ),\n\n    underlinedTabInactiveForeground: theme.color(\n      \"DefaultTabs.underlinedTabInactiveForeground\" as UnknownThemeProp\n    ),\n    underlinedTabForeground: theme.color(\n      \"DefaultTabs.underlinedTabForeground\" as UnknownThemeProp\n    ),\n\n    background: theme.color(\n      \"DefaultTabs.background\",\n      theme.dark ? \"#3C3F41\" : \"#ECECEC\"\n    ),\n    underlinedTabInactiveBackground: theme.color(\n      \"DefaultTabs.underlinedTabInactiveBackground\" as UnknownThemeProp\n    ),\n    underlinedTabBackground: theme.color(\n      \"DefaultTabs.underlinedTabBackground\" as UnknownThemeProp\n    ),\n    hoverInactiveBackground: theme.color(\n      \"DefaultTabs.hoverInactiveBackground\" as UnknownThemeProp,\n      theme.dark ? \"rgba(0,0,0,.35)\" : \"rgba(0,0,0,.1)\"\n    ),\n    hoverBackground: theme.color(\n      \"DefaultTabs.hoverBackground\",\n      theme.dark ? \"rgba(0,0,0,.35)\" : \"rgba(0,0,0,.1)\"\n    ),\n  });\n\nexport const StyledDefaultTab = styled.div<StyledTabProps>`\n  box-sizing: border-box;\n  display: inline-flex;\n  font-size: 0.7rem;\n  cursor: default;\n  white-space: nowrap;\n\n  // spacing\n  padding: 0 0.5rem;\n  line-height: 1.7rem; // vertical spacing handled by line-height\n\n  // disabled state doesn't seem to be supported in Intellij Platform at all.\n  opacity: ${({ disabled }) => (disabled ? \".5\" : \"1\")};\n  color: ${({ theme }) =>\n    theme.color(\"DefaultTabs.foreground\" as UnknownThemeProp)};\n\n  position: relative;\n  &::after {\n    content: \"\";\n    position: absolute;\n    width: 100%;\n    left: 0;\n    bottom: 0;\n  }\n\n  ${defaultTabTheme};\n`;\n","import { Theme, UnknownThemeProp } from \"../Theme\";\nimport { styled } from \"@intellij-platform/core/styled\";\nimport { getTabsThemeStyles } from \"./TabTheme\";\n\nconst defaultTabsTheme = ({ theme }: { theme: Theme }) =>\n  getTabsThemeStyles({\n    borderColor: theme.color(\n      \"DefaultTabs.borderColor\" as UnknownThemeProp,\n      theme.commonColors.contrastBorder\n    ),\n    background: theme.color(\"DefaultTabs.background\"),\n  });\n\nexport const StyledDefaultTabs = styled.div<{ noBorders?: boolean }>`\n  display: flex;\n  align-items: center;\n  box-sizing: border-box;\n  border-style: solid;\n  border-width: ${({ noBorders }) => (noBorders ? \"0\" : \"1px 0\")};\n\n  ${defaultTabsTheme};\n`;\n","import { Pressable, PressProps } from \"@react-aria/interactions\";\n\nimport React from \"react\";\nimport { PlatformIcon } from \"../Icon\";\nimport { styled } from \"../styled\";\n\nconst StyledIconWrapper = styled.span`\n  display: inherit;\n  .icon.hover {\n    display: none;\n  }\n  &:hover {\n    .icon {\n      display: none;\n    }\n    .icon.hover {\n      display: unset;\n    }\n  }\n`;\n/**\n * Close button for Tab\n */\nexport const TabCloseButton = (props: PressProps) => {\n  // using useHover proved to be unstable.\n  return (\n    <Pressable {...props}>\n      <StyledIconWrapper>\n        <PlatformIcon icon={\"actions/closeHovered\"} className=\"icon hover\" />\n        <PlatformIcon icon={\"actions/close\"} className=\"icon\" />\n      </StyledIconWrapper>\n    </Pressable>\n  );\n};\n","import React, { ForwardedRef, HTMLProps } from \"react\";\nimport { css, styled } from \"../styled\";\n\nconst StyledTabItemLayout = styled.div`\n  display: inline-flex;\n  align-items: center;\n`;\n\nconst iconStyle = css`\n  display: inline-flex; // without this, the wrapper takes the full height, causing icon to be placed on top\n  margin-top: -0.1rem; // seems necessary for pixel perfect match with the original impl\n`;\n\nconst StyledStartIconWrapper = styled.span`\n  ${iconStyle};\n  margin-right: 0.25rem;\n`;\n\nconst StyledEndIconWrapper = styled.span`\n  ${iconStyle};\n  margin-left: 0.25rem;\n  margin-right: -0.25rem; // default padding of the tab should be a little reduced when close icon is there.\n  border-radius: 16px;\n`;\n\nexport interface TabItemLayoutProps {\n  /**\n   * the icon placed before the text.\n   */\n  startIcon?: React.ReactNode;\n  /**\n   * title of the tab. Normally just a string\n   */\n  title?: React.ReactNode;\n  /**\n   * the icon placed after the text. Typical use cases: close or pin icon.\n   */\n  endIcon?: React.ReactNode;\n\n  /**\n   * Generic HTML props passed to the container div.\n   */\n  containerProps?: Omit<HTMLProps<HTMLDivElement>, \"ref\" | \"as\">;\n}\n\n/**\n * Helper component for rendering the common layout of tab content.\n */\nexport const TabContentLayout = React.forwardRef(\n  (\n    { startIcon, title, endIcon, containerProps }: TabItemLayoutProps,\n    ref: ForwardedRef<HTMLDivElement>\n  ) => {\n    return (\n      <StyledTabItemLayout {...containerProps} ref={ref}>\n        {startIcon && (\n          <StyledStartIconWrapper>{startIcon}</StyledStartIconWrapper>\n        )}\n        {title}\n        {endIcon && <StyledEndIconWrapper>{endIcon}</StyledEndIconWrapper>}\n      </StyledTabItemLayout>\n    );\n  }\n);\n","import { css } from \"@intellij-platform/core/styled\";\nimport { StyledTabProps } from \"./StyledDefaultTab\";\n\n/**\n * Describes theme-able properties of a tab, which can then be passed to {@link getTabThemeStyles}\n */\nexport interface TabTheme {\n  underlineHeight?: number;\n\n  borderColor?: string;\n\n  inactiveUnderlineColor?: string;\n  underlineColor?: string;\n\n  underlinedTabInactiveForeground?: string;\n  underlinedTabForeground?: string;\n\n  background?: string;\n  underlinedTabBackground?: string;\n  underlinedTabInactiveBackground?: string;\n  hoverInactiveBackground?: string;\n  hoverBackground?: string;\n  inactiveColoredTabBackground?: string; // not used for now\n}\n\nexport const getTabsThemeStyles = ({\n  background,\n  borderColor,\n}: Pick<TabTheme, \"background\" | \"borderColor\">) => css`\n  border-color: ${borderColor};\n  background: ${background};\n`;\n\n/**\n * Converts tab theme properties to a chunk of style that can be dropped in a styled version of StyledDefaultTab\n *\n * @example\n * ```ts\n * const StyledCustomTab = styled(StyledDefaultTab)`\n *   ${getTabThemeStyles({background: 'red'})}\n * `\n * ```\n */\nexport const getTabThemeStyles = ({\n  underlineHeight,\n\n  background,\n  underlinedTabBackground,\n  underlinedTabInactiveBackground,\n  hoverInactiveBackground,\n  hoverBackground,\n\n  underlinedTabForeground,\n  underlinedTabInactiveForeground,\n\n  inactiveUnderlineColor,\n  underlineColor,\n}: TabTheme) =>\n  css<StyledTabProps>`\n    // active indicator\n    &::after {\n      height: ${underlineHeight != null ? `${underlineHeight}px` : undefined};\n      background-color: ${({ selected }) => selected && inactiveUnderlineColor};\n      background-color: ${({ selected, active }) =>\n        selected && active && underlineColor};\n    }\n\n    // foreground rules\n    color: ${({ selected }) => selected && underlinedTabInactiveForeground};\n    color: ${({ selected, active }) =>\n      selected && active && underlinedTabForeground};\n\n    //  background rules\n    background: ${background};\n    background: ${({ selected }) =>\n      selected && underlinedTabInactiveBackground};\n    background: ${({ selected, active }) =>\n      selected && active && underlinedTabBackground};\n\n    ${({ disabled, active }) =>\n      !disabled &&\n      css`\n      &:hover {\n        background: ${hoverInactiveBackground};\n        background: ${active && hoverBackground}\n    `}\n  `;\n","import { css, styled } from \"@intellij-platform/core/styled\";\n\ninterface Props {\n  hasOverflowAtStart: boolean;\n  hasOverflowAtEnd: boolean;\n}\n\nconst horizontalOverflowIndicatorStyles = css`\n  content: \"\";\n  pointer-events: none;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  width: 10px;\n  z-index: 1;\n`;\nexport const StyledHorizontalOverflowShadows = styled.div<Props>`\n  position: relative; // for overflow indicator (pseudo-)elements to be positioned absolute\n\n  /* FIXME: find out what color, width and gradient parameters are used in the original implementation */\n  ${({ hasOverflowAtStart }) =>\n    hasOverflowAtStart &&\n    css`\n      ::before {\n        ${horizontalOverflowIndicatorStyles};\n        background: linear-gradient(\n          90deg,\n          ${({ theme }) => theme.commonColors.panelBackground} 0%,\n          transparent 100%\n        );\n        left: 0;\n      }\n    `};\n  ${({ hasOverflowAtEnd }) =>\n    hasOverflowAtEnd &&\n    css`\n      ::after {\n        ${horizontalOverflowIndicatorStyles};\n        background: linear-gradient(\n          -90deg,\n          ${({ theme }) => theme.commonColors.panelBackground} 0%,\n          transparent 100%\n        );\n        right: 0;\n      }\n    `};\n`;\n","import { useTab } from \"@react-aria/tabs\";\nimport { TabListState } from \"@react-stately/tabs\";\nimport { Node } from \"@react-types/shared\";\nimport { StyledDefaultTab } from \"./StyledDefaultTab\";\nimport React, { useEffect } from \"react\";\n\ntype TabProps<T extends object> = {\n  state: TabListState<object>;\n  item: Node<T>;\n  intersectionObserver: IntersectionObserver | null;\n  /**\n   * {@see TabsProps#focusable}\n   */\n  focusable?: boolean;\n  /**\n   * {@see TabsProps#active}\n   */\n  active?: boolean;\n  Component?: typeof StyledDefaultTab;\n};\n\nexport const Tab = <T extends object>({\n  state,\n  item,\n  focusable,\n  active,\n  Component = StyledDefaultTab,\n  intersectionObserver,\n}: TabProps<T>): React.ReactElement => {\n  const { key, rendered } = item;\n  const ref = React.useRef(null);\n  const {\n    tabProps: {\n      /**\n       * by extracting out tabIndex, all keyboard support of the tabs is disabled, since we prevent the tab from being\n       * focusable.\n       */\n      tabIndex,\n      ...tabProps\n    },\n  } = useTab({ key }, state, ref);\n  const isSelected = state.selectedKey === key;\n  const isDisabled = state.disabledKeys.has(key);\n  useIntersectionObserver(ref, intersectionObserver);\n\n  return (\n    <Component\n      {...tabProps}\n      tabIndex={focusable ? tabIndex : undefined}\n      ref={ref}\n      active={active}\n      selected={isSelected}\n      disabled={isDisabled}\n    >\n      {rendered}\n    </Component>\n  );\n};\n\nfunction useIntersectionObserver(\n  ref: React.MutableRefObject<null>,\n  intersectionObserver: IntersectionObserver | null\n) {\n  useEffect(() => {\n    const element = ref.current;\n    if (element) {\n      intersectionObserver?.observe(element);\n      return () => {\n        intersectionObserver?.unobserve(element);\n      };\n    }\n  }, [intersectionObserver]);\n}\n","import React, { Key, useEffect } from \"react\";\nimport { useTabList } from \"@react-aria/tabs\";\nimport { mergeProps } from \"@react-aria/utils\";\nimport { useTabListState } from \"@react-stately/tabs\";\nimport { AriaTabListProps } from \"@react-types/tabs\";\nimport { StyledHorizontalOverflowShadows } from \"./StyledHorizontalOverflowShadows\";\nimport { TabsOverflowMenu } from \"./TabsOverflowMenu\";\nimport { useCollectionOverflowObserver } from \"./useCollectionOverflowObserver\";\nimport { useIsScrolled } from \"./useIsScrolled\";\nimport { styled, css } from \"@intellij-platform/core/styled\";\nimport { StyledDefaultTab } from \"./StyledDefaultTab\";\nimport { StyledDefaultTabs } from \"./StyledDefaultTabs\";\nimport { Tab } from \"./Tab\";\n\nexport type TabsProps<T> = Omit<\n  AriaTabListProps<T>,\n  \"orientation\" | \"isDisabled\" | \"\"\n> & {\n  /**\n   * Whether tabs should be focusable or not. By default, following the Intellij Platform implementation, tabs are\n   * not focusable and therefore lack the keyboard accessibility support specified in WAI-ARIA.\n   * You can change this default behaviour and make the tabs keyboard accessible by passing `focusable`.\n   * focus styles are not perfect at the moment, since it's not considered an important feature.\n   * @default false\n   */\n  focusable?: boolean;\n\n  /**\n   * Enables \"active\" style on tabs. Is usually related to a container having focus.\n   */\n  active?: boolean;\n\n  /**\n   * If set to true, tabs will be wrapped into multiple rows if needed.\n   * NOTE: In the original implementation, in multi row mode, rows are separated by a border. It's not easy to achieve\n   * this when we are implementing this feature with a simple `flex-wrap: wrap` css rule. It doesn't seem that\n   * important, but we can achieve something similar by some css tricks like the ones suggested here:\n   * https://stackoverflow.com/questions/36128333/row-lines-for-flex-container-css\n   * @default false\n   */\n  multiRow?: boolean;\n\n  /**\n   * Only effective when {@link multiRow} is not true.\n   * If set to true and multiRow is not true, it will prevent horizontal scroll of tabs. Depending on the value of\n   * In this case:\n   * - if {@link noOverflowMenu} is not set to true, tabs that can't be fitted into the available space will be\n   *   accessible via an overflow menu.\n   * - if {@link noOverflowMenu} is set to true, the tabs will be fitted into the available space, and they will\n   *   be shrunk when needed.\n   *\n   * @todo: not implemented yet.\n   * @default false\n   */\n  noScroll?: boolean;\n\n  /**\n   * Only effective when {@link multiRow} is not true.\n   * When set to true, tabs that couldn't be fitted into the available space, are either shrunk (if {@link noScroll}\n   * is set to true), or are just accessible by scroll.\n   */\n  noOverflowMenu?: boolean;\n\n  /**\n   * Removes the top and bottom border when passed.\n   * It's still not clear whether such option makes sense or not, but\n   * at least in common use cases like in tool windows, it seems borders are already there and there should be a way\n   * of removing tab borders. On the other hand, when Tabs is used without any assumption about the surrounding UI,\n   * it kind of makes sense to have the top and bottom borders by default. So that's why this is made an option for\n   * now, maybe until things are clearer.\n   *\n   * @default false\n   */\n  noBorders?: boolean;\n\n  TabsComponent?: typeof StyledDefaultTabs;\n  /**\n   *\n   */\n  TabComponent?: typeof StyledDefaultTab;\n};\n\nconst scrollBarDisabledStyle = css`\n  -ms-overflow-style: none; /* for Internet Explorer, Edge */\n  scrollbar-width: none; /* for Firefox */\n  &::-webkit-scrollbar {\n    /* for Chrome/Safari/Webkit */\n    display: none;\n  }\n`;\n\nconst StyledTabList = styled.div<{ multiRow?: boolean }>`\n  display: flex;\n  flex-wrap: ${({ multiRow }) => (multiRow ? \"wrap\" : \"nowrap\")};\n  overflow: auto;\n\n  ${scrollBarDisabledStyle};\n`;\n\n/**\n *\n * TODO: add support for overflow:\n *  - have vertical scroll also scroll tabs\n *  - add support for re-reordering tabs.\n */\nexport const Tabs = <T extends object>({\n  focusable,\n  active,\n  TabComponent,\n  TabsComponent = StyledDefaultTabs,\n  multiRow,\n  noOverflowMenu,\n  noScroll,\n  noBorders,\n  ...props\n}: TabsProps<T>): React.ReactElement => {\n  const state = useTabListState(props);\n  const ref = React.useRef<HTMLDivElement>(null);\n  const { tabListProps } = useTabList(props, state, ref);\n\n  const { scrolledIndicatorProps, isScrolled } = useIsScrolled({ ref });\n  const {\n    overflowedKeys,\n    intersectionObserver,\n  } = useCollectionOverflowObserver(ref);\n\n  useEffect(() => {\n    if (!noScroll) {\n      if (ref.current) {\n        ref.current\n          .querySelector(`[data-key=\"${state.selectedKey}\"]`)\n          ?.scrollIntoView?.();\n      }\n    } else {\n      // TODO maybe? sample use case: project tool window tabs, when not grouped.\n    }\n  }, [state.selectedKey]);\n  const onOverflowMenuItemSelected = (key: Key) => {\n    state.setSelectedKey(key);\n  };\n  if (noScroll) {\n    throw new Error(\"noScroll is not supported yet.\");\n  }\n  return (\n    <TabsComponent noBorders={noBorders}>\n      <StyledHorizontalOverflowShadows\n        hasOverflowAtStart={isScrolled.left}\n        hasOverflowAtEnd={isScrolled.right}\n        style={{ minWidth: 0 }}\n      >\n        <StyledTabList\n          {...mergeProps(tabListProps, scrolledIndicatorProps)}\n          multiRow={multiRow}\n          ref={ref}\n        >\n          {[...state.collection].map((item) => (\n            <Tab\n              key={item.key}\n              item={item}\n              state={state}\n              focusable={focusable}\n              active={active}\n              Component={TabComponent}\n              intersectionObserver={intersectionObserver}\n            />\n          ))}\n        </StyledTabList>\n      </StyledHorizontalOverflowShadows>\n      {!noOverflowMenu && (\n        <TabsOverflowMenu\n          collection={state.collection}\n          overflowedKeys={overflowedKeys}\n          onSelect={onOverflowMenuItemSelected}\n        />\n      )}\n    </TabsComponent>\n  );\n};\n","import { RefObject, UIEventHandler, useEffect, useState } from \"react\";\n\nexport function useIsScrolled<T extends HTMLElement>({\n  threshold = 5,\n  ref,\n}: {\n  threshold?: number;\n  ref: RefObject<T>;\n}) {\n  const [isScrolled, setIsScrolled] = useState({\n    left: false,\n    right: false,\n    top: false,\n    bottom: false,\n  });\n\n  const update = () => {\n    const element = ref.current;\n    if (element) {\n      const offsetLeft = element.scrollLeft;\n      const offsetRight =\n        element.scrollWidth - (element.offsetWidth + element.scrollLeft);\n      const offsetTop = element.scrollTop;\n      const offsetBottom =\n        element.scrollHeight - (element.offsetHeight + element.scrollTop);\n      const newIsScrolled = {\n        top: offsetTop >= threshold,\n        bottom: offsetBottom >= threshold,\n        left: offsetLeft >= threshold,\n        right: offsetRight >= threshold,\n      };\n      if (\n        isScrolled.top !== isScrolled.top ||\n        isScrolled.bottom !== newIsScrolled.bottom ||\n        isScrolled.left !== newIsScrolled.left ||\n        isScrolled.right !== newIsScrolled.right\n      ) {\n        setIsScrolled(newIsScrolled);\n      }\n    }\n  };\n  useEffect(update);\n\n  return {\n    scrolledIndicatorProps: {\n      onScroll: update as UIEventHandler<T>,\n    },\n    isScrolled,\n  };\n}\n","import { Key, RefObject, useEffect, useState } from \"react\";\n\n/**\n * Given a ref to a scrollable container of collection items, returns the keys that are not completely visible and\n * are off view because of scroll. It relies on data-key property of observed elements.\n * @param scrollableItemsContainerRef\n * @param threshold\n */\nexport function useCollectionOverflowObserver(\n  scrollableItemsContainerRef: RefObject<HTMLElement>,\n  { threshold = 0.9 }: { threshold?: number } = {}\n) {\n  const [\n    intersectionObserver,\n    setIntersectionObserver,\n  ] = useState<IntersectionObserver | null>(null);\n  const [overflowedKeys, setOverflowedKeys] = useState<Set<Key>>(new Set());\n\n  useEffect(() => {\n    const observer = new IntersectionObserver(\n      (entries) => {\n        const newHiddenKeys = entries\n          .map((entry) =>\n            !entry.isIntersecting && entry.target instanceof HTMLElement\n              ? entry.target.dataset.key\n              : undefined\n          )\n          .filter<string>((val): val is string => Boolean(val));\n        const newVisibleKeys = entries\n          .map((entry) =>\n            entry.isIntersecting && entry.target instanceof HTMLElement\n              ? entry.target.dataset.key\n              : null\n          )\n          .filter<string>((val): val is string => Boolean(val));\n\n        setOverflowedKeys(\n          (currentOverflowMenuKeys) =>\n            new Set(\n              [...currentOverflowMenuKeys]\n                .filter((key) => !newVisibleKeys.includes(`${key}`))\n                .concat(newHiddenKeys)\n            )\n        );\n      },\n      {\n        root: scrollableItemsContainerRef.current,\n        rootMargin: \"0px\",\n        threshold,\n      }\n    );\n    setIntersectionObserver(observer);\n    return () => {\n      observer.disconnect();\n    };\n  }, []);\n\n  return {\n    intersectionObserver,\n    overflowedKeys,\n  };\n}\n","import { Collection, Node } from \"@react-types/shared\";\nimport { Item } from \"@react-stately/collections\";\nimport { Menu, MenuTrigger } from \"@intellij-platform/core/Menu\";\nimport { ActionButton } from \"@intellij-platform/core/ActionButton/ActionButton\";\nimport { PlatformIcon } from \"@intellij-platform/core/Icon\";\nimport React, { Key } from \"react\";\n\nexport const TabsOverflowMenu = <T extends unknown>({\n  collection,\n  overflowedKeys,\n  onSelect,\n}: {\n  collection: Collection<Node<T>>;\n  overflowedKeys: Set<Key>;\n  onSelect: (key: Key) => void;\n}) => (\n  <>\n    {overflowedKeys.size > 0 && (\n      <MenuTrigger\n        align=\"end\"\n        renderMenu={({ menuProps, close }) => {\n          const items: Iterable<Node<unknown>> = [\n            ...collection,\n          ].filter((menuItem) => overflowedKeys.has(menuItem.key));\n          return (\n            <Menu\n              {...menuProps}\n              onAction={(key) => {\n                close();\n                onSelect(key);\n              }}\n              items={items}\n            >\n              {(item) => (\n                <Item key={item.key} textValue={item.textValue}>\n                  {item.props.inOverflowMenu || item.textValue}\n                </Item>\n              )}\n            </Menu>\n          );\n        }}\n      >\n        {(props, ref) => (\n          <ActionButton {...props} ref={ref}>\n            <PlatformIcon icon=\"actions/findAndShowNextMatches\" />\n          </ActionButton>\n        )}\n      </MenuTrigger>\n    )}\n  </>\n);\n","import { styled } from \"@intellij-platform/core/styled\";\nimport { Theme } from \"@intellij-platform/core/Theme\";\nimport { StyledDefaultTab } from \"@intellij-platform/core/tabs/StyledDefaultTab\";\nimport {\n  getTabThemeStyles,\n  TabTheme,\n} from \"@intellij-platform/core/tabs/TabTheme\";\n\nexport const toolWindowTabTheme = ({ theme }: { theme: Theme }): TabTheme => ({\n  borderColor: theme.color(\"ToolWindow.HeaderTab.borderColor\"),\n  underlineHeight: theme.value<number>(\"ToolWindow.HeaderTab.underlineHeight\"),\n  background: \"transparent\",\n  underlinedTabInactiveBackground: theme.color(\n    \"ToolWindow.HeaderTab.underlinedTabInactiveBackground\"\n  ),\n  underlinedTabBackground: theme.color(\n    \"ToolWindow.HeaderTab.underlinedTabBackground\"\n  ),\n  hoverInactiveBackground:\n    theme.color(\"ToolWindow.HeaderTab.hoverInactiveBackground\") ??\n    theme.color(\"ToolWindow.HeaderTab.hoverBackground\"),\n  hoverBackground: theme.color(\"ToolWindow.HeaderTab.hoverBackground\"),\n  inactiveUnderlineColor: theme.color(\n    \"ToolWindow.HeaderTab.inactiveUnderlineColor\"\n  ),\n  underlineColor: theme.color(\"ToolWindow.HeaderTab.underlineColor\"),\n\n  underlinedTabInactiveForeground:\n    theme.color(\"ToolWindow.HeaderTab.underlinedTabInactiveForeground\") ??\n    theme.color(\"ToolWindow.HeaderTab.underlinedTabForeground\"),\n  underlinedTabForeground: theme.color(\n    \"ToolWindow.HeaderTab.underlinedTabForeground\"\n  ),\n});\nexport const StyledToolWindowTab = styled(StyledDefaultTab)`\n  ${({ theme }) => getTabThemeStyles(toolWindowTabTheme({ theme }))};\n`;\n","import { styled } from \"@intellij-platform/core/styled\";\nimport { getTabsThemeStyles } from \"@intellij-platform/core/tabs/TabTheme\";\nimport { StyledDefaultTabs } from \"@intellij-platform/core/tabs/StyledDefaultTabs\";\nimport { toolWindowTabTheme } from \"./StyledToolWindowTab\";\n\nexport const StyledToolWindowTabs = styled(StyledDefaultTabs)`\n  ${({ theme }) => getTabsThemeStyles(toolWindowTabTheme({ theme }))};\n`;\n","import { ItemProps } from \"@react-types/shared\";\nimport { Item } from \"@react-stately/collections\";\nimport React from \"react\";\n\nexport interface TabItemProps extends ItemProps<never> {\n  /**\n   * Determines how the tab item should look when rendered as a menu item in overflow menu.\n   * If not passed, `textValue` will be used.\n   * @example\n   * <TabItem\n   *   key={tab.id}\n   *   textValue={tab.title}\n   *   inOverflowMenu={\n   *     <MenuItemLayout content={tab.title} icon={icon} />\n   *   }\n   *  >\n   *   <TabContentLayout startIcon={icon} title={tab.title} />\n   * </TabItem>\n   */\n  inOverflowMenu?: React.ReactNode;\n}\n\n/**\n * Same as {@link Item}, but allows for specifying the tab content for when it's rendered in the overflow menu item.\n */\nexport const TabItem: (props: TabItemProps) => React.ReactElement = Item;\n","import { Theme } from \"@intellij-platform/core/Theme\";\nimport { styled } from \"@intellij-platform/core/styled\";\n\nimport { StyledDefaultTab } from \"@intellij-platform/core/tabs/StyledDefaultTab\";\nimport {\n  getTabThemeStyles,\n  TabTheme,\n} from \"@intellij-platform/core/tabs/TabTheme\";\n\nexport const debuggerTabTheme = ({ theme }: { theme: Theme }): TabTheme => ({\n  underlineHeight: theme.value<number>(\"DebuggerTabs.underlineHeight\") ?? 2,\n  underlinedTabBackground: theme.color(\"DebuggerTabs.underlinedTabBackground\"),\n});\nexport const StyledDebuggerTab = styled(StyledDefaultTab)`\n  ${({ theme }) => getTabThemeStyles(debuggerTabTheme({ theme }))};\n`;\n","import React, { useContext } from \"react\";\n\nexport const useContextOrThrow = <ContextType extends unknown>(\n  Context: React.Context<ContextType | null>,\n  nullErrorMessage: string\n) => {\n  const context = useContext<ContextType | null>(Context);\n\n  if (context == null) {\n    throw new Error(nullErrorMessage);\n  }\n\n  return context;\n};\n","import { useRef } from \"react\";\n\nexport function useLatest<T>(value: T) {\n  const ref = useRef(value);\n  ref.current = value;\n  return ref;\n}\n","import React from \"react\";\nimport { ThemeProvider } from \"styled-components\";\nimport { SSRProvider } from \"@react-aria/ssr\";\nimport themeJson from \"../../../jui/themes/darcula.theme.json\";\nimport { Theme } from \"../../../jui/src\";\n\nexport const ExampleContext: React.FC = ({ children }) => (\n  <SSRProvider>\n    <ThemeProvider theme={new Theme(themeJson)}>{children}</ThemeProvider>\n  </SSRProvider>\n);\n","import React from \"react\";\n\n/**\n * To make relation between things in jui and original reference impl in Intellij Platform\n */\nexport const RefToIntellijPlatform = ({\n  path,\n  name,\n}: {\n  path: string;\n  name?: string;\n}) => {\n  return (\n    // TODO: make it some nice box with an icon and a hint text which says something like \"Intellij Platform\" or\n    //  \"Reference\" or something better :D\n    <a\n      href={`https://github.com/JetBrains/intellij-community/blob/master/${path}`}\n      target=\"_blank\"\n    >\n      {name || path.split(\"/\").pop()}\n    </a>\n  );\n};\n","import { Item } from \"@react-stately/collections\";\nimport { Meta } from \"@storybook/react\";\nimport React from \"react\";\nimport { ActionButton } from \"../ActionButton/ActionButton\";\nimport { ActionToolbar } from \"../ActionToolbar/ActionToolbar\";\nimport { Divider, DividerItem } from \"../Collections/Divider\";\nimport { PlatformIcon } from \"../Icon\";\nimport { styledComponentsControlsExclude } from \"../story-helpers\";\nimport { Menu } from \"./Menu\";\nimport { MenuItemLayout } from \"./MenuItemLayout\";\nimport { MenuTrigger } from \"./MenuTrigger\";\n\nexport default {\n  title: \"Components/Menu\",\n  parameters: {\n    controls: { exclude: styledComponentsControlsExclude },\n    component: Menu, // doesn't work for some reason.\n  },\n} as Meta;\n\nexport const Static = () => {\n  return (\n    <Menu disabledKeys={[\"jumpToExternalEditor\"]}>\n      <Item textValue=\"Cut\">\n        <MenuItemLayout\n          icon={<PlatformIcon icon={\"actions/menu-cut\"} />}\n          content=\"Cut\"\n          shortcut={\"X\"}\n        />\n      </Item>\n      <Item textValue=\"Copy\">\n        <MenuItemLayout\n          icon={<PlatformIcon icon={\"actions/copy\"} />}\n          content=\"Copy\"\n          shortcut={\"C\"}\n        />\n      </Item>\n      <Item textValue=\"Paste\">\n        <MenuItemLayout\n          icon={<PlatformIcon icon={\"actions/menu-paste\"} />}\n          content=\"Paste\"\n          shortcut={\"V\"}\n        />\n      </Item>\n      <Divider />\n      <Item>Reformat Code</Item>\n      <Item textValue=\"Optimize Imports\">\n        <MenuItemLayout content=\"Optimize Imports\" shortcut={\"O\"} />\n      </Item>\n      <Item textValue=\"Delete\">\n        <MenuItemLayout content=\"Delete\" shortcut={\"\"} />\n      </Item>\n      <Divider />\n      <Item textValue=\"Compare with...\">\n        <MenuItemLayout\n          icon={<PlatformIcon icon={\"actions/diff\"} />}\n          content=\"Compare with...\"\n        />\n      </Item>\n      <Divider />\n      <Item key=\"jumpToExternalEditor\" textValue=\"Jump to external editor\">\n        <MenuItemLayout content=\"Jump to external editor\" shortcut={\"F4\"} />\n      </Item>\n    </Menu>\n  );\n};\n\ntype MenuItem =\n  | {\n      title: string;\n      icon?: string;\n      shortcut?: string;\n      subItems?: MenuItem[];\n    }\n  | DividerItem;\nconst viewModeItems: Array<MenuItem> = [\n  {\n    title: \"Undock\",\n  },\n  {\n    title: \"Docked\",\n    subItems: [\n      {\n        title: \"Pinned\",\n      },\n      {\n        title: \"UnPinned\",\n      },\n    ],\n  },\n\n  {\n    title: \"Float\",\n  },\n  {\n    title: \"Window\",\n  },\n];\nconst items: Array<MenuItem> = [\n  {\n    title: \"View Mode\",\n    subItems: viewModeItems,\n  },\n  new DividerItem(),\n  {\n    title: \"Group tabs\",\n    icon: \"toolwindows/documentation\",\n  },\n];\n\nexport const Nested = () => {\n  return (\n    <Menu items={items} selectedKeys={[\"Pinned\"]} autoFocus>\n      {renderItem}\n    </Menu>\n  );\n};\n\nexport const Position = ({ offsetRight = 230 }: { offsetRight: number }) => {\n  return (\n    <div style={{ paddingLeft: `calc(100% - ${offsetRight}px)` }}>\n      <Menu items={items}>{renderItem}</Menu>\n    </div>\n  );\n};\n\nexport const MenuWithTrigger = ({\n  offsetRight,\n  offsetBottom,\n  restoreFocus,\n}: {\n  offsetRight?: number;\n  offsetBottom?: number;\n  restoreFocus?: boolean;\n}) => {\n  return (\n    <div\n      style={{\n        paddingLeft:\n          offsetRight != undefined\n            ? `calc(100% - ${offsetRight + 24}px)`\n            : undefined,\n        paddingTop:\n          offsetBottom != undefined\n            ? `calc(100% - ${offsetBottom + 24}px)`\n            : undefined,\n      }}\n    >\n      <ActionToolbar>\n        <MenuTrigger\n          restoreFocus={restoreFocus}\n          renderMenu={({ menuProps, close }) => (\n            <Menu\n              items={items}\n              {...menuProps}\n              onAction={(key) => {\n                console.log(key);\n                close();\n              }}\n            >\n              {renderItem}\n            </Menu>\n          )}\n        >\n          {(props, ref) => (\n            <ActionButton {...props} ref={ref}>\n              <PlatformIcon icon={\"general/gearPlain\"} />\n            </ActionButton>\n          )}\n        </MenuTrigger>\n      </ActionToolbar>\n    </div>\n  );\n};\n\nconst renderItem = (item: MenuItem) => {\n  if (item instanceof DividerItem) {\n    return <Divider key={item.key} />;\n  }\n  return (\n    <Item key={item.title} childItems={item.subItems}>\n      <MenuItemLayout\n        icon={item.icon && <PlatformIcon icon={item.icon} />}\n        content={item.title}\n        shortcut={item.shortcut}\n      />\n    </Item>\n  );\n};\n","\nimport React from 'react';\nimport { mdx } from '@mdx-js/react';\n\n\nexport const frontMatter = {};\nexport const contentTitle = 'Menu';\nexport const metadata = {\n  \"unversionedId\": \"components/menu\",\n  \"id\": \"components/menu\",\n  \"isDocsHomePage\": false,\n  \"title\": \"Menu\",\n  \"description\": \"\",\n  \"source\": \"@site/docs/components/2-menu.mdx\",\n  \"sourceDirName\": \"components\",\n  \"slug\": \"/components/menu\",\n  \"permalink\": \"/docs/components/menu\",\n  \"editUrl\": \"https://github.com/alirezamirian/jui/edit/master/packages/website/docs/components/2-menu.mdx\",\n  \"tags\": [],\n  \"version\": \"current\",\n  \"sidebarPosition\": 2,\n  \"frontMatter\": {},\n  \"sidebar\": \"tutorialSidebar\",\n  \"previous\": {\n    \"title\": \"ToolWindows\",\n    \"permalink\": \"/docs/components/tool-window\"\n  }\n};\n\n\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport { RefToIntellijPlatform } from \"../../src/components/RefToIntellijPlatform.tsx\";\nimport { Static } from \"@intellij-platform/core/Menu/Menu.stories\";\nimport { ExampleContext } from \"../../src/components/ExampleContext\";\nexport const toc = [];\n\nconst layoutProps = {\n  toc\n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"menu\"\n    }}>{`Menu`}</h1>\n    <ExampleContext mdxType=\"ExampleContext\">\n  <Static mdxType=\"Static\" />\n    </ExampleContext>\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;\n"],"names":["DEFAULT_MINIMUM_BUTTON_SIZE","StyledActionButton","styled","minSize","theme","color","ActionButton","React","ref","otherProps","pressProps","isPressed","usePress","className","disabled","isDisabled","StyledActionToolbar","getBorder","hasBorder","dark","StyledHorizontalActionToolbar","StyledHorizontalSeparator","StyledVerticalActionToolbar","StyledVerticalSeparator","ActionToolbar","orientation","children","Divider","getCollectionNode","props","type","element","rendered","hasChildNodes","DividerItem","key","seq","ItemStateContext","DEFAULT_ICON_SIZE","StyledIconWrapper","size","useForwardedRef","forwardedRef","innerRef","useRef","current","useSvgIcon","path","fallbackPath","useTheme","useEffect","unmounted","async","console","error","svg","getSvgIcon","catch","e","querySelector","remove","svgElement","document","createElement","appendChild","outerHTML","fetchIcon","LafIcon","themePath","icon","resolvedIconPath","iconDescriptor","resolvedValue","value","modifiers","name","isUnderDarcula","reduce","soFar","modifier","findIconPath","useIconPath","getPlatformIconPath","relativePath","PlatformIcon","darkIcon","iconName","darkPath","ext","split","getDarkPath","ListDivider","as","useSeparator","StyledMenu","isMac","css","MAC_WINDOW_SHADOW","undefined","StyledMenuItem","isActive","StyledNestedArrow","StyledSelectedMark","MenuItem","item","state","onAction","expandOn","nestedMenuRef","disabledKeys","has","isExpanded","expandedKeys","isSelected","selectionManager","selectedKeys","isFocused","focusedKey","menuItemProps","useMenuItem","maybeOpenSubmenu","forEach","toggleKey","hoverProps","useHover","onHoverStart","keyboardProps","useKeyboard","onKeyDown","includes","continuePropagation","overlayProps","positionProps","useOverlayPosition","targetRef","overlayRef","placement","shouldFlip","onClose","log","offset","crossOffset","isOpen","subMenuProps","useSubmenu","focus","mergeProps","Selected","FocusScope","Menu","textValue","items","childNodes","autoFocus","childItem","childItems","hasChildItems","Error","useTreeState","expandedKey","onExpandedChange","firstKey","onExpandedKeyChange","defaultExpandedKeys","defaultExpandedKey","menuProps","useMenu","setTimeout","collection","map","StyledMenuItemLayout","Content","Icon","Shortcut","selected","MenuItemLayout","content","shortcut","useContextOrThrow","MenuTrigger","renderMenu","direction","align","restoreFocus","menuTriggerProps","useMenuTriggerState","triggerRef","triggerProps","useMenuTrigger","buttonProps","useButton","useOverlay","close","shouldCloseOnBlur","isKeyboardDismissDisabled","isDismissable","shouldCloseOnInteractOutside","matches","getPlacement","containerPadding","forceRestoreFocus","DarculaSeparatorUI","defaultSize","StyledSeparator","backgroundColor","backgroundClip","boxSizing","margin","border","directChildRef","focusManagerRef","useLayoutEffect","nodeToRestore","activeElement","requestAnimationFrame","body","contains","focusSafely","useImperativeHandle","focusManager","containerElement","parentElement","focusNext","tabbable","GetFocusManager","hidden","useFocusManager","Symbol","iterator","TreeCollection","constructor","nodes","keyMap","Map","this","iterable","Set","last","visit","node","set","child","index","nextKey","prevKey","lastKey","getKeys","keys","getKeyBefore","get","getKeyAfter","getFirstKey","getLastKey","getItem","treeRef","setExpandedKeys","useControlledState","selectionState","useMultipleSelectionState","useMemo","tree","useCollection","setFocusedKey","SelectionManager","useTreeRef","res","delete","add","latestState","useLatest","replaceSelection","setFocused","savedUserSelect","useMove","dragThreshold","onMoveStart","onMove","onMoveEnd","handlersRef","onMouseDown","event","documentElement","style","webkitUserSelect","from","x","pageX","y","pageY","startState","dragStarted","onMouseMove","movement","Math","abs","to","addEventListener","runAfterTransition","removeEventListener","once","useResizer","invert","onResizeStarted","onResize","onResizeEnd","resizerProps","StyledVerticalResizer","StyledVerticalResizerArea","cursor","handleSize","VerticalResizer","outerPadding","background","height","TopResizer","useTopResizer","BottomResizer","useBottomResizer","StyledHorizontalResizer","StyledHorizontalResizerArea","HorizontalResizer","width","RightResizer","useRightResizer","LeftResizer","useLeftResizer","StyledSplitterContainer","StyledSplitterInnerView","ThreeViewSplitter","firstView","firstSize","lastView","lastSize","onFirstResize","onLastResize","resizerPropsOverrides","innerView","innerViewMinSize","containerProps","containerRef","firstViewRef","lastViewRef","firstSizeState","setFirstSizeState","useState","lastSizeState","setLastSizeState","horizontalValue","verticalValue","FirstResizer","SecondResizer","sizeStyleProp","minSizeStyleProp","commonColors","contrastBorder","isFractionSize","normalizeSize","getSize","elem","offsetWidth","offsetHeight","getNewSize","currentSize","newSize","newFractionSize","max","getActualSize","viewElem","actualSize","currentLastSize","currentFirstSize","ResizableView","resizerPlacement","FLOAT_WINDOW_MIN_WIDTH","WindowResizeHandles","windowResizer","initialBoundsRef","top","left","interactionHandler","useWindowInteractionHandler","finishInteraction","startInteraction","updateBounds","right","bottom","newWidth","initialBounds","newHeight","getResizerProps","side","position","useWindowResizer","WindowInteractionHandlerContext","useContext","StyledFloatView","FloatView","bounds","boundsProp","onBoundsChange","setBounds","effectiveBounds","boundsContextValue","Provider","FloatToolWindows","floatWindows","renderToolWindow","stackedFloatWindows","getKey","sortedKeys","setSortedKeys","sorted","sort","a","b","indexOf","bringToFront","move","useStackedLayersState","layersProps","_","onFocus","useStackedLayers","toolWindow","MovableToolWindowStripeContext","MovableToolWindowStripeProvider","stripes","draggingRect","setDraggingRect","draggingKey","setDraggingKey","dropPosition","setDropPosition","getDropPositionRef","moveStartLocationRef","contextValue","addStripe","id","propsRef","startMove","stripe","stripeElRef","stripeElement","getBoundingClientRect","getItemRect","toJSON","indexInMain","mainItems","findIndex","indexInSplit","splitItems","anchor","isSplit","dropPositionGetters","Object","entries","createGetDropPosition","getDropPosition","draggedRect","endMove","TopStripe","BottomStripe","LeftStripe","RightStripe","MainView","StyledToolWindowOuterLayout","Shell","panelBackground","hideStripes","isHorizontal","getSizeInAnchor","containerSize","mapToKey","prop","sortAndMapToKey","compose","sortBy","order","filterMains","filter","getMains","filterSplits","filterVisible","expectedViewMode","viewMode","isVisible","concat","getSplits","filterVisibleDocked","filterVisibleUnDocked","getDocked","toolWindows","docks","mains","splits","length","weight","mainKey","sizeFraction","sideWeight","getUnDocked","windows","getSideState","main","activeKeys","undocked","docked","DEFAULT_HEIGHT","DEFAULT_WIDTH","getFloatWindowsState","pipe","floatingBounds","getFloatWindowState","ToolWindowStateContext","useToolWindowState","context","ToolWindowStateProvider","toolWindowsState","onToolWindowStateChange","hide","blur","moveToSide","changeViewMode","stretchWidth","container","stretchHeight","setFloatingBounds","setFloatingBound","getStripeRect","start","rect","end","getDropPositions","getRef","score","flatMap","relative","keyToOffsets","boundingRect","getKeyToOffsets","dropPositions","lastDropPosition","stripeRect","getCanDrop","result","bestMatch","candidate","STRIPE_BUTTON_LINE_HEIGHT","StyledToolWindowStripeButton","active","numberPattern","parseComponent","componentStr","parseInt","round","min","parseFloat","parseHexRgba","str","match","slice","i","parseShorthandHex","parseRgb","RegExp","parseRgba","Color","rgba","g","r","NaN","parse","Array","isArray","every","c","Number","isInteger","parseColorString","isValid","brighter","alpha","int","floor","FACTOR","toString","blend","getBlendedValue","component","isNaN","padStart","minHeight","StyledToolWindowStripe","highlighted","theOtherSide","preventCollapse","StyledSpacer","useElementMove","ghost","ghostOption","otherOptions","updateGhostPosition","defaultGhost","cloneNode","colors","computedBackground","getComputedStyle","unshift","resultColor","nextColor","findEffectiveBackgroundColor","createDefaultGhost","append","ToolWindowStripe","renderItem","render","onItemPress","getProps","latestPropsRef","moveDisabled","useMovableStripeButtons","isNotCurrentItem","anItem","ToolWindowStripeButton","getStripeButtonStyles","onPress","Boolean","styles","marginValue","display","onClick","StyledUndockSide","UndockSide","ToolWindows","hideToolWindowBars","useWidescreenLayout","renderToolbarButton","renderWindow","mainContentMinWidth","layoutState","setLayoutState","groupBy","getToolWindowsLayoutState","renderStripe","toggle","renderSideDockedView","resizeDockSplitView","onDockResize","containerBounds","resizeDock","getSplitViewProps","firstAnchor","secondAnchor","horizontalSplitterProps","verticalSplitterProps","outerSplitterProps","innerSplitterProps","undockLayers","resizeUndock","renderInnerLayout","viewModes","anchors","getAnchorName","toUpperCase","viewModeToString","undock","docked_pinned","docked_unpinned","float","window","ToolWindowSettingsIconMenu","viewModeActions","title","perform","moveToActions","resizeActions","push","removeFromSideBarAction","alert","gearIconActions","actions","action","find","StyledToolWindowHeader","StyledToolWindowHeaderActions","StyledToolWindowHeaderContent","ToolWindowHeader","additionalActions","contentHasFocus","useToolWindow","contentRef","focusableContentRef","onFocusChange","setContentHasFocus","focusWithinProps","contentFocusWithinProps","useFocusWithin","onFocusWithinChange","toolWindowProps","autoHideProps","hideTimeoutId","windowFocusWithinProps","onBlurWithin","relatedTarget","onFocusWithin","clearTimeout","useAutoHide","focusDelegatorProps","target","currentTarget","possiblyBlurredElement","Element","useFocusDelegator","moveHandleProps","useToolWindowMoveHandle","tabIndex","toolWindowContentProps","toolWindowHeaderProps","StyledToolWindowContainer","StyledToolWindowContent","DefaultToolWindow","headerContent","isDocked","areInSameSection","curry","window1","window2","getViewModeType","ToolWindowsState","targetKey","mapObjIndexed","show","closableViewModes","viewModeType","sideOrIndex","targetSide","targetIndex","targetSideWindows","indexInTargetSide","sortedTargetWindows","insert","newTargetSideWindows","fromPairs","newValue","targetViewMode","stretch","update","property","currentFloatingBound","resizeSide","dock","isInResizingView","toolWindowState","inputs","HighlightedMatch","TextWithHighlights","highlights","parts","ranges","gapRange","range","getAllRanges","text","CollectionSpeedSearchContext","CollectionSpeedSearchItemContext","SpeedSearchItemHighlightsProvider","itemKey","warn","highlightedRanges","HighlightedTextValue","speedSearchContext","Img","darkSrc","src","StyledList","fillAvailableSpace","isCtrlKeyPressed","metaKey","ctrlKey","OriginalSelectionManager","super","select","selectionMode","disallowEmptySelection","toggleSelection","shiftKey","extendSelection","StyledSearchIcon","SpeedSearchPopup","StyledSpeedSearchPopup","replace","tooltipForeground","red","FlattenedTreeLayout","ListLayout","buildChild","layoutNode","parentKey","layoutInfo","getVisibleLayoutInfos","StyledListItem","containerFocused","whiteSpace","paddingLeft","lineHeight","outline","StyledTreeNodeIcon","TreeNodeIcon","expanded","iconPath","getIcon","useTreeNodeToggleButton","treeNodeToggleButtonProps","preventFocusOnPress","selectedDescendantKeys","TreeContext","StyledTreeNode","attrs","level","TreeNode","focused","onActionRef","togglePressProps","treeNodeProps","useSelectableItem","isVirtualized","itemProps","onDoubleClick","useTreeNode","useGhostInput","onChange","valueRef","altKey","HTMLElement","isContentEditable","HTMLInputElement","HTMLTextAreaElement","sliceEnd","isWordSeparator","isWhitespace","char","test","isUpperCase","toLowerCase","isMeaningfulChar","ch","isStart","chars","previousChar","createSpeedSearchSelectionManager","wrappedSelectionManager","create","selectAll","setSelectedKeys","useCollectionSpeedSearchResult","speedSearch","searchTerm","matchedRanges","input","rawPattern","isStarts","pattern","join","continuous","inputIndex","patternIndex","lastRange","lastMatch","pop","minusculeMatch","matchedKeys","noneOfTheMatchesAreSelected","some","matchedKey","useCollectionSpeedSearch","stickySearch","keyboardDelegate","speedSearchStateProps","setActive","onActiveChange","setSearchTerm","defaultSearchTerm","onSearchTermChange","useSpeedSearchState","speedSearchSelectionManager","ghostInputKeydown","clear","onKeyUp","onBlur","useSpeedSearch","speedSearchKeyboardDelegate","wrappedKeyboardDelegate","getKeyBelow","keyBelow","getKeyAbove","keyAfter","createSpeedSearchKeyboardDelegate","speedSearchContextValue","searchPopupProps","TreeKeyboardDelegate","ListKeyboardDelegate","collator","getKeyLeftOf","getKeyRightOf","useSelectableTree","useCollator","usage","sensitivity","collectionProps","selectionKeyDown","options","manager","delegate","shouldFocusWrap","disallowSelectAll","selectOnFocus","disallowTypeAhead","shouldUseVirtualFocus","allowsTabNavigation","useLocale","values","next","handlers","navigateToKey","childFocus","preventDefault","getKeyPageBelow","getKeyPageAbove","clearSelection","walker","getFocusableTreeWalker","lastChild","compareDocumentPosition","Node","DOCUMENT_POSITION_FOLLOWING","lastSelectedKey","firstSelectedKey","typeSelectProps","useTypeSelect","onTypeSelect","useSelectableCollection","scrollView","offsetX","offsetLeft","offsetY","offsetTop","scrollLeft","scrollTop","maxX","maxY","scrollIntoView","useCollectionAutoScroll","isExpandable","shouldToggle","treeContext","treeProps","SpeedSearchTree","replaceSelectionManager","collectionSpeedSearch","speedSearchKeyboardProps","selectableTree","useSpeedSearchTree","virtualizerProps","layout","estimatedRowHeight","sizeToFit","scrollDirection","useTreeVirtualizer","Virtualizer","renderNode","GithubIconResolver","url","response","fetch","ok","resolve","cache","propertyName","descriptor","method","cacheKey","String","cacheObj","args","allArgsAreString","arg","apply","Promise","defaultValues","Theme","themeJson","os","iconResolver","getCommonColors","setDefault","ui","fallback","dereference","maybeReferencedValue","getFallbackFromStar","endsWith","isOsDependentValue","resolveOsDependentValue","resolvePath","fallbackKey","inactiveTextColor","obj","firstPathPart","otherPathParts","baseStyled","baseCss","editorTabTheme","borderColor","underlineHeight","underlinedTabInactiveBackground","underlinedTabBackground","hoverInactiveBackground","hoverBackground","inactiveUnderlineColor","underlineColor","underlinedTabInactiveForeground","underlinedTabForeground","StyledEditorTab","StyledDefaultTab","getTabThemeStyles","StyledEditorTabs","StyledDefaultTabs","getTabsThemeStyles","EditorTabs","Tabs","TabComponent","TabsComponent","focusable","EditorTabContent","onUnpin","pinned","TabContentLayout","startIcon","endIcon","TabCloseButton","noBorders","StyledTabItemLayout","iconStyle","StyledStartIconWrapper","StyledEndIconWrapper","horizontalOverflowIndicatorStyles","StyledHorizontalOverflowShadows","hasOverflowAtStart","hasOverflowAtEnd","Tab","Component","intersectionObserver","tabProps","useTab","selectedKey","observe","unobserve","useIntersectionObserver","scrollBarDisabledStyle","StyledTabList","multiRow","noOverflowMenu","noScroll","useTabListState","tabListProps","useTabList","scrolledIndicatorProps","isScrolled","threshold","setIsScrolled","offsetRight","scrollWidth","offsetBottom","scrollHeight","newIsScrolled","onScroll","useIsScrolled","overflowedKeys","scrollableItemsContainerRef","setIntersectionObserver","setOverflowedKeys","observer","IntersectionObserver","newHiddenKeys","entry","isIntersecting","dataset","val","newVisibleKeys","currentOverflowMenuKeys","root","rootMargin","disconnect","useCollectionOverflowObserver","minWidth","TabsOverflowMenu","onSelect","setSelectedKey","menuItem","inOverflowMenu","toolWindowTabTheme","TabItem","Item","debuggerTabTheme","Context","nullErrorMessage","ExampleContext","RefToIntellijPlatform","href","Static","frontMatter","contentTitle","metadata","toc","layoutProps","MDXContent","components","mdxType","isMDXComponent"],"sourceRoot":""}