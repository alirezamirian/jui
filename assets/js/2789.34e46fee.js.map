{"version":3,"file":"assets/js/2789.34e46fee.js","mappings":"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","sources":["webpack://website/../example-app/src/resources/loading.gif","webpack://website/../example-app/src/LoadingGif.tsx","webpack://website/../example-app/src/resources/loading_dark.gif","webpack://website/../example-app/src/DefaultSuspense.tsx","webpack://website/../example-app/src/file-utils.tsx","webpack://website/../example-app/src/Editor/useEditorTheme.ts","webpack://website/../example-app/src/Editor/Editor.tsx","webpack://website/../example-app/src/fs/browser-fs.tsx","webpack://website/../example-app/src/fs/fs-utils.ts","webpack://website/../example-app/src/fs/fs.tsx","webpack://website/../example-app/src/fs/fs.state.ts","webpack://website/../example-app/src/Project/project-utils.ts","webpack://website/../example-app/src/recoil-utils.ts","webpack://website/../example-app/src/Project/project.state.ts","webpack://website/../example-app/src/Editor/editor.state.ts","webpack://website/../example-app/src/VersionControl/file-status.ts","webpack://website/../example-app/src/VersionControl/file-status.state.ts","webpack://website/../example-app/src/VersionControl/FileStatusColor.tsx","webpack://website/../example-app/src/Editor/FileEditor.tsx","webpack://website/../example-app/src/Terminal/Terminal.tsx","webpack://website/../example-app/src/VersionControl/Changes/change-lists.state.ts","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/changesGroupings.ts","webpack://website/../example-app/src/VersionControl/Changes/Rollback/rollbackView.state.ts","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ChangesView.state.ts","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ChangesViewTreeContextMenu.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/StyledRepoColorSquare.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/StyledCurrentBranchTag.tsx","webpack://website/../example-app/src/VersionControl/CurrentBranchName.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/changesTreeNodeRenderers.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ChangeViewTree.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ActionButtons/ChangeListsActionButton.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ActionButtons/GroupByActionButton.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ActionButtons/ViewOptionsActionButton.tsx","webpack://website/../example-app/src/VersionControl/Changes/useChangesViewActions.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ChangesViewToolbar.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesSummary.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ChangesViewSplitter.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ChangesViewPane.tsx","webpack://website/../example-app/src/ProjectView/ProjectView.state.ts","webpack://website/../example-app/src/ProjectView/ProjectViewPane.tsx","webpack://website/../example-app/src/ProjectView/ProjectViewActionIds.ts","webpack://website/../example-app/src/ProjectView/ProjectToolWindow.tsx","webpack://website/../example-app/src/Project/toolWindows.tsx","webpack://website/../example-app/src/usePersistenceFsNotification.tsx","webpack://website/../example-app/src/VersionControl/branches.state.ts","webpack://website/../example-app/src/VersionControl/Branches/BranchesPopupContent.tsx","webpack://website/../example-app/src/VersionControl/active-file.state.ts","webpack://website/../example-app/src/StatusBar/IdeStatusBar.tsx","webpack://website/../example-app/src/VersionControl/Changes/Rollback/RollbackTreeContextMenu.tsx","webpack://website/../example-app/src/VersionControl/Changes/Rollback/RollbackWindow.tsx","webpack://website/../example-app/src/Project/toolWindows.state.ts","webpack://website/../example-app/src/SearchEverywhere/useTips.tsx","webpack://website/../example-app/src/SearchEverywhere/Input.tsx","webpack://website/../example-app/src/SearchEverywhere/searchEverywhere.state.tsx","webpack://website/../example-app/src/SearchEverywhere/ContentAwarePopup.tsx","webpack://website/../example-app/src/SearchEverywhere/contributors/ItemHelpers.tsx","webpack://website/../example-app/src/SearchEverywhere/contributors/action/ActionItem.tsx","webpack://website/../example-app/src/SearchEverywhere/contributors/action/actionsSearchContributor.tsx","webpack://website/../example-app/src/SearchEverywhere/contributors/file/FileItem.tsx","webpack://website/../example-app/src/SearchEverywhere/contributors/file/filesSearchContributor.tsx","webpack://website/../example-app/src/SearchEverywhere/SearchEverywhereActionIds.ts","webpack://website/../example-app/src/SearchEverywhere/SearchEverywherePopup.tsx","webpack://website/../example-app/src/Project/useProjectActions.tsx","webpack://website/../example-app/src/Project/Project.tsx","webpack://website/../example-app/src/SampleRepoInitializer.tsx","webpack://website/../example-app/src/exampleAppKeymap.ts","webpack://website/../example-app/src/App.tsx"],"sourcesContent":["export default \"data:image/gif;base64,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\"","import { Img } from \"@intellij-platform/core\";\nimport React, { ComponentProps } from \"react\";\nimport loadingGif from \"./resources/loading.gif\";\nimport loadingDarkGif from \"./resources/loading_dark.gif\";\n\nexport const LoadingGif: React.FC = (\n  props: Omit<ComponentProps<typeof Img>, \"src\" | \"darkSrc\" | \"srcSet\">\n) => <Img {...props} src={loadingGif} darkSrc={loadingDarkGif} />;\n","export default \"data:image/gif;base64,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\"","import React, { SuspenseProps } from \"react\";\nimport styled from \"styled-components\";\nimport { LoadingGif } from \"./LoadingGif\";\n\nconst Loading = styled(LoadingGif)`\n  width: fit-content;\n  margin: auto;\n`;\nexport const DefaultSuspense: React.FC<Partial<SuspenseProps>> = ({\n  fallback = <Loading />,\n  children,\n}) => <React.Suspense fallback={fallback}>{children}</React.Suspense>;\n","import path from \"path\";\n\nexport const FILE_ICON = \"fileTypes/text\";\nexport const DIR_ICON = \"nodes/folder\";\n\nconst extensionIconMap: Record<string, string> = {\n  editorconfig: \"nodes/editorconfig\",\n  js: \"fileTypes/javaScript\",\n  gitignore: \"vcs/ignore_file\",\n  archive: \"fileTypes/archive\",\n  as: \"fileTypes/as\",\n  config: \"fileTypes/config\",\n  css: \"fileTypes/css\",\n  dtd: \"fileTypes/dtd\",\n  hpr: \"fileTypes/hprof\",\n  htaccess: \"fileTypes/htaccess\",\n  html: \"fileTypes/html\",\n  idl: \"fileTypes/idl\",\n  java: \"fileTypes/java\",\n  jfr: \"fileTypes/jfr\",\n  json: \"fileTypes/json\",\n  jsp: \"fileTypes/jsp\",\n  jspx: \"fileTypes/jspx\",\n  manifest: \"fileTypes/manifest\",\n  properties: \"fileTypes/properties\",\n  txt: \"fileTypes/text\",\n  wsdl: \"fileTypes/wsdlFile\",\n  xhtml: \"fileTypes/xhtml\",\n  xml: \"fileTypes/xml\",\n  xsd: \"fileTypes/xsdFile\",\n  yaml: \"fileTypes/yaml\",\n};\n\nexport const getIconForFile = (filepath: string) => {\n  const extension = getExtension(filepath);\n  return extensionIconMap[extension] || FILE_ICON;\n};\n\n/**\n * A little different from path.extname(). For \".gitignore\" path.extname returns \"\" while this returns \"gitignore\".\n */\nconst getExtension = (filepath: string): string =>\n  filepath.split(\".\").pop() || \"\";\n\n/**\n * @example\n * \"/a/b/c.ext\" => [\"/a/b\", \"/a\"]\n */\nexport function getParentPaths(\n  filepath: string,\n  upperLimit: string = path.sep\n): string[] {\n  return getParentPathsRecursive(filepath, upperLimit);\n}\n\nfunction getParentPathsRecursive(\n  filepath: string,\n  upperLimit: string,\n  previousPaths: string[] = []\n): string[] {\n  const dirname = path.dirname(filepath);\n  if (dirname !== upperLimit) {\n    return [dirname].concat(\n      getParentPathsRecursive(dirname, upperLimit, previousPaths)\n    );\n  }\n  return previousPaths;\n}\n","import { EditorProps, useMonaco } from \"@monaco-editor/react\";\nimport { Theme } from \"@intellij-platform/core\";\nimport { editor } from \"monaco-editor\";\nimport { useLayoutEffect, useState } from \"react\";\nimport { useTheme } from \"styled-components\";\n\nimport vsCodeTheme from \"../resources/dracula-color-theme.json\"; // FIXME: don't read a fixed color scheme\n\nconst darculaColorSchemeTokenRules: editor.ITokenThemeRule[] =\n  vsCodeTheme.tokenColors.flatMap(({ scope, settings }) =>\n    ([] as string[])\n      .concat(scope)\n      .flatMap((scope) => scope.split(\" \"))\n      .map((token) => {\n        const values: editor.ITokenThemeRule = {\n          token,\n        };\n        Object.keys(settings).forEach((key) => {\n          const value = settings[key as keyof typeof settings];\n          if (value) {\n            values[key as keyof typeof settings] = value;\n          }\n        });\n        return values;\n      })\n  );\n\nexport const useEditorTheme = () => {\n  const monaco = useMonaco();\n  const theme = useTheme() as Theme;\n  const [themeName, setThemeName] = useState<EditorProps[\"theme\"]>(\n    theme.dark ? \"vs-dark\" : \"light\"\n  );\n  useLayoutEffect(() => {\n    if (monaco) {\n      const name = `jui-theme-${theme.name.replace(\" \", \"\")}`;\n      monaco.editor.defineTheme(name, {\n        base: theme.dark ? \"vs-dark\" : \"vs\",\n        inherit: true,\n        // colors and rules should come from color scheme xml files.\n        // see platform/platform-resources/src/DefaultColorSchemesManager.xml\n        colors: theme.dark\n          ? {\n              // FIXME: read from color scheme files. List of available keys: https://github.com/microsoft/monaco-editor/issues/1631\n              \"editor.background\": \"#2B2B2B\",\n              \"editor.lineHighlightBackground\": \"#323232\",\n              \"editor.lineHighlightBorder\": \"none\",\n              \"editorLineNumber.foreground\": \"#606366\", // LINE_NUMBERS_COLOR\n              \"editorActiveLineNumber.foreground\": \"#a4a3a3\", // LINE_NUMBER_ON_CARET_ROW_COLOR\n              \"editorIndentGuide.background\": \"#373737\", // INDENT_GUIDE\n              \"editorIndentGuide.activeBackground\": \"#505050\", // SELECTED_INDENT_GUIDE\n              \"editorGutter.background\": theme.dark ? \"#313335\" : \"#f0f0f0\",\n            }\n          : {},\n        // token rules for syntax highlighting\n        rules: darculaColorSchemeTokenRules,\n      });\n      setThemeName(name);\n    }\n  }, [monaco, theme]);\n\n  return themeName;\n};\n","import MonacoEditor, { EditorProps } from \"@monaco-editor/react\";\nimport { styled } from \"@intellij-platform/core\";\nimport React from \"react\";\nimport { useEditorTheme } from \"./useEditorTheme\";\n\nexport const StyledEditor = styled(MonacoEditor)`\n  .monaco-editor {\n    .margin-view-overlays .line-numbers {\n      text-align: left;\n      padding-left: 7px;\n    }\n\n    .scrollbar .slider {\n      border-radius: 0.25rem;\n    }\n  }\n`;\n/**\n * Monaco Editor styled to look like Intellij Platform's editor.\n * TODO:\n *  - folding controls appearance is different and should be changed\n *  - highlighting pairs of parens, brackets, etc. is different.\n *  - context menu look different.\n *  - selection look different.\n *  - BUG: height is more than necessary. Needs investigation first.\n */\nexport const Editor = (props: Omit<EditorProps, \"theme\">) => {\n  const editorTheme = useEditorTheme();\n  return (\n    <StyledEditor\n      {...props}\n      options={{\n        minimap: { enabled: false },\n        lineHeight: 20,\n        showFoldingControls: \"always\",\n        renderIndentGuides: true,\n        overviewRulerBorder: false,\n        scrollbar: {\n          verticalScrollbarSize: 14,\n          horizontalScrollbarSize: 8,\n          verticalSliderSize: 8,\n          horizontalSliderSize: 8,\n          horizontal: \"auto\",\n          vertical: \"visible\",\n          alwaysConsumeMouseWheel: false, // to let example-app be rendered as a part of a page.\n        },\n        ...props.options,\n      }}\n      theme={editorTheme as any} // FIXME\n    />\n  );\n};\n","// FIXME?: We are importing everything from browserFS, which might be too much, considering many backends it supports\nimport * as BrowserFS from \"browserfs\";\n// @ts-expect-error: https://github.com/sindresorhus/pify/issues/74\nimport pify from \"pify\";\nimport LightningFS from \"@isomorphic-git/lightning-fs\";\nimport { BFSCallback } from \"browserfs/src/core/file_system\";\nimport FS, { FSModule } from \"browserfs/dist/node/core/FS\";\n\nwindow.BrowserFS = BrowserFS;\n// importing the type didn't work as expected\ntype FileSystem = Parameters<typeof BrowserFS[\"initialize\"]>[0];\n\n// not so accurate type.\nexport type PromisifiedFS = Omit<\n  LightningFS.PromisifedFS, // borrowed from LightningFS\n  \"init\" | \"activate\" | \"deactivate\"\n> & { exists: (path: string) => Promise<boolean> };\n\nexport type FSModuleWithPromises = FSModule & {\n  promises: PromisifiedFS;\n};\n\nexport async function createInMemoryFS() {\n  return await createFsBackend((cb) => {\n    BrowserFS.FileSystem.InMemory.Create({}, cb);\n  });\n}\n\nexport async function createIndexedDBFS(storeName = \"bfs-local-fs\") {\n  const idbfs = await createFsBackend((cb) => {\n    BrowserFS.FileSystem.IndexedDB.Create({ storeName }, cb);\n  });\n  // @ts-expect-error wasted several hours on the following f*** line! The reason it's needed is a huge f*** blunder\n  // in browserfs@2.0.0, in which IndexedDBFileSystem doesn't call the init function in Create function.\n  // several things made this issue extremely hard to find and fix:\n  // 1. the latest code on github is actually correct, but unpublished\n  // 2. If browserfs@1.x is used even once, it will initialize the indexedDB correctly, which hides the v2 error.\n  //    it exactly happened when trying to reproduce the issue on codesandbox: https://codesandbox.io/s/browser-fs-2-0-0-indexed-db-bug-5vuecr\n  await new Promise((resolve) => idbfs.init(idbfs.store, resolve));\n  return idbfs;\n}\n\nexport function initializeFS(fsBackend: FileSystem): FSModuleWithPromises {\n  BrowserFS.initialize(fsBackend);\n  const fsm = BrowserFS.BFSRequire(\"fs\");\n\n  // @ts-expect-error\n  fsm.promises = pify(fsm);\n  return fsm as FSModuleWithPromises;\n}\n\nexport const createFs = (backend: FileSystem): FS => {\n  const fs = new (BrowserFS.BFSRequire(\"fs\").FS)();\n  fs.initialize(backend);\n  return fs;\n};\n\nfunction createFsBackend(\n  fn: (cb: BFSCallback<FileSystem>) => void\n): Promise<FileSystem> {\n  return new Promise((resolve, reject) => {\n    fn((err, fs) => {\n      if (err || !fs) {\n        return reject(err);\n      }\n      resolve(fs);\n    });\n  });\n}\n","// @ts-expect-error: https://github.com/sindresorhus/pify/issues/74\nimport pify from \"pify\";\nimport path from \"path\";\nimport FS from \"browserfs/dist/node/core/FS\";\nimport { PromisifiedFS } from \"./browser-fs\";\n// @ts-expect-error caf doesn't have typing :/\nimport { CAF } from \"caf\";\n\ntype CopyFsParams = {\n  source: FS;\n  target: FS;\n  /**\n   * called when a file is being copied\n   */\n  onCopy?: (filepath: string) => void;\n  /**\n   * force copy, even if file already exists in the target fs\n   * @default false\n   */\n  force?: boolean;\n\n  cancelSignal: unknown;\n};\n\nexport async function copyFs({\n  source,\n  target,\n  cancelSignal,\n  ...rest\n}: CopyFsParams) {\n  await copyFsRecursively(cancelSignal, {\n    ...rest,\n    source: pify(source),\n    target: pify(target),\n    rootDir: \"/\",\n  });\n}\n\nconst copyFsRecursively = CAF(function* (\n  cancelSignal: unknown,\n  params: {\n    source: PromisifiedFS;\n    target: PromisifiedFS;\n    onCopy?: (filepath: string) => void;\n    force?: boolean;\n    rootDir: string;\n  }\n): unknown {\n  const { source, target, rootDir, onCopy, force } = params;\n  const items = yield source.readdir(rootDir);\n\n  // While we could parallelize copying files of a given directory, it didn't prove to be much faster. Plus, supporting\n  // cancellation via CAF seems more straightforward if we don't do that.\n  for (const name of items) {\n    const fullPath = path.join(rootDir, name);\n    const stat = yield source.stat(fullPath);\n    if (stat.isFile() || stat.isSymbolicLink()) {\n      if (!force && (yield fileExists(target, fullPath))) {\n        return;\n      }\n      onCopy?.(fullPath);\n      const content = yield source.readFile(fullPath); // is it ok for symlink too?\n      yield ensureDir(target, path.dirname(fullPath));\n      yield target.writeFile(fullPath, content);\n    } else if (stat.isDirectory()) {\n      yield copyFsRecursively(cancelSignal, {\n        ...params,\n        rootDir: path.join(rootDir, name),\n      });\n    } else {\n      console.warn(\"unsupported file system item skipped, when copying:\", stat);\n    }\n  }\n});\nconst fileExists = async (fs: PromisifiedFS, filepath: string) => {\n  const exists = await fs\n    .exists(filepath)\n    // sometimes it throws boolean instead of returning :|\n    .catch((e) => (typeof e === \"boolean\" ? e : Promise.reject(e)));\n\n  return exists && !(await fs.stat(filepath)).isDirectory();\n};\n\nexport async function ensureDir(fs: PromisifiedFS, dirPath: string) {\n  const stat = await fs\n    .stat(dirPath)\n    .catch((e) => (e.code === \"ENOENT\" ? false : Promise.reject(e)));\n  if (stat === false) {\n    // path doesn't exist\n    const dirname = path.dirname(dirPath);\n    if (dirname !== path.dirname(dirname)) {\n      // not root path\n      await ensureDir(fs, dirname);\n    }\n    await fs\n      .mkdir(dirPath)\n      // it can happen that due to async nature of this function, between calling stat and this line, the folder is already created.\n      .catch((e) =>\n        e.code === \"EEXIST\" ? Promise.resolve() : Promise.reject(e)\n      );\n  } else if (!stat.isDirectory()) {\n    throw new Error(`path is not a directory, but already exists: ${dirPath}`);\n  }\n}\n","import * as BrowserFS from \"browserfs\";\nimport React from \"react\";\nimport {\n  createFs,\n  createIndexedDBFS,\n  createInMemoryFS,\n  FSModuleWithPromises,\n  initializeFS,\n} from \"./browser-fs\";\nimport { copyFs } from \"./fs-utils\";\n\n/**\n * local fs, for when used in browser. Most of the things here would be a noop in node environment.\n */\nexport let fs: FSModuleWithPromises;\n\nconst localStorageSetting = <Enum extends string>(key: string) => ({\n  get: () => localStorage.getItem(key) as Enum | undefined,\n  set: (value: Enum) => localStorage.setItem(key, value),\n});\n/**\n * Global fs preferences for which the file system itself can't be used as storage.\n */\nexport const persistentFsPreference = localStorageSetting<\"yes\" | \"no\">(\n  \"demo_app_use_persistent_fs\"\n);\n\n// NOTE: Maybe we can make this module side-effect free by lazy initializing fsPromise, in WaitForFs, if it's enough\n// to assume any code requiring FS is executed via components rendered inside WaitForFs.\n// Also, we can gather exports of this file into an interface to make it easier to provide two implementations, for\n// browser and node.\nconst fsPromise: Promise<FSModuleWithPromises> = (persistentFsPreference.get() ===\n\"yes\"\n  ? createIndexedDBFS()\n  : createInMemoryFS()\n)\n  .then(initializeFS)\n  .then((theFs) => {\n    (window as any).fs = theFs;\n    return (fs = theFs);\n  })\n  .catch((e) => {\n    console.log(\"could not initialize FS:\", e);\n    throw e;\n  });\n\nexport function isFsInMemory() {\n  return fs.getRootFS() instanceof BrowserFS.FileSystem.InMemory;\n}\n\nexport async function switchToPersistentFS({\n  onCopy = console.log,\n  cancelSignal,\n}: {\n  onCopy?: (filepath: string) => void;\n  cancelSignal?: unknown;\n} = {}) {\n  if (!isFsInMemory()) {\n    console.log(\"Already on persistent fs. Nothing to do.\");\n    return;\n  }\n  console.log(\"Creating IndexedDB FS\");\n  console.time(\"creating db\");\n  const indexedDbFsBackend = await createIndexedDBFS();\n\n  await copyFs({\n    source: fs,\n    target: await createFs(indexedDbFsBackend),\n    cancelSignal,\n    force: true,\n    onCopy,\n  });\n  console.timeEnd(\"creating db\");\n\n  initializeFS(indexedDbFsBackend);\n  // persistentFsPreference.set(\"yes\");\n  console.log(\"FS switched to IndexedDB backend\", indexedDbFsBackend);\n}\n\nconst fsResource = wrapPromise(fsPromise);\n\n/**\n * Suspense aware wrapper for waiting for FS to be initialized. initialization API in some fs backends such as\n * BrowserFs, is async. That's why it's safe to use this on a high level.\n */\nexport const WaitForFs: React.FC = ({ children }) => {\n  fsResource.read();\n  return children as React.ReactElement;\n};\n\n/**\n * wrapPromise util for suspense for arbitrary async operation, represented as a promise.\n */\nfunction wrapPromise<T>(promise: Promise<T>) {\n  let status = \"pending\";\n  let response: T;\n\n  const suspender = promise.then(\n    (res) => {\n      status = \"success\";\n      response = res;\n    },\n    (err) => {\n      status = \"error\";\n      response = err;\n    }\n  );\n  const read = () => {\n    switch (status) {\n      case \"pending\":\n        throw suspender;\n      case \"error\":\n        throw response;\n      default:\n        return response;\n    }\n  };\n\n  return { read };\n}\n","import {\n  atomFamily,\n  CallbackInterface,\n  selectorFamily,\n  useRecoilRefresher_UNSTABLE,\n} from \"recoil\";\nimport { fs } from \"./fs\";\n\nexport interface FsItem {\n  type: \"dir\" | \"file\";\n  path: string;\n  size: number;\n}\n\n/**\n * recoil atoms and selectors for keeping list and content of files in recoil state, for components that need on such\n * state.\n * NOTE: still not clear if we should be using atomFamily or selectorFamily for this. changing the current\n * implementation to atomFamily however is easy and side effect free.\n */\nexport const dirContentState = selectorFamily({\n  key: \"dirContents\",\n  get: (path: string) => async (): Promise<null | FsItem[]> => {\n    let fileNames: string[];\n    try {\n      fileNames = await fs.promises.readdir(path);\n    } catch (e) {\n      return null;\n    }\n    const stats = await Promise.all(\n      fileNames.map((fileName) => {\n        const filePath = `${path}/${fileName}`;\n        return fs.promises.stat(filePath).then((stat) => ({\n          ...stat,\n          type: stat.isDirectory() ? (\"dir\" as const) : (\"file\" as const),\n          filePath,\n        }));\n      })\n    );\n    return stats.map((stat) => ({\n      type: stat.type,\n      path: stat.filePath,\n      size: stat.size,\n    }));\n  },\n});\n\nexport const reloadFileFromDiskCallback =\n  ({ set }: CallbackInterface) =>\n  async (path: string) =>\n    set(fileContent(path), await fetchFileContent(path));\n\nconst fetchFileContent = async (filepath: string | undefined) => {\n  if (!filepath) {\n    return \"\";\n  }\n  // @ts-expect-error return type is wrong\n  return fs.promises.readFile(filepath, {\n    encoding: \"utf8\",\n  }) as Promise<string>;\n};\n\n/**\n * **Note**: Still not quite clear if we should use atom and [synchronize with source of truth (FS)][recoil-atom-effects],\n * or if we should use selector and refresh it when needed. We probably need a proper [VFS][vfs] implementation at\n * some point, which would be capable of tracking modifications, and setting up listeners for it, and then atoms, can\n * hold the states like directory content, with effects which uses the listener API.\n * A few things to consider in that regard:\n * - if modifications to files are not directly synchronized to fs, using isomorphic-git for updating the file status\n *   can be tricky, unless an FS implementation is provided which uses the file content that is not yet synced with\n *   the actual local FS. Maybe something like Intellij's VFS, can be implemented as a BrowserFS backend impl.\n *\n * **Note**: currently, only text file is supported, for simplicity.\n *\n * [recoil-atom-effects]: https://recoiljs.org/docs/guides/atom-effects#write-through-cache-example\n * [vfs]: https://plugins.jetbrains.com/docs/intellij/virtual-file-system.html\n **/\nexport const fileContent = atomFamily<string, string | undefined>({\n  key: \"fileContent\",\n  default: fetchFileContent,\n  effects: (filepath) => [\n    ({ onSet }) => {\n      onSet((content) => {\n        if (filepath) {\n          // Should a sync API be used here?\n          fs.promises\n            .writeFile(\n              filepath,\n              // @ts-expect-error: string should also be acceptable. Seems like bad typing\n              content,\n              { encoding: \"utf8\" }\n            )\n            .catch((e) => {\n              console.error(\"failed to sync the file back to the fs\", e);\n            });\n        }\n      });\n    },\n  ],\n});\n\nexport const useReloadFromDisk = (path: string) => {\n  return useRecoilRefresher_UNSTABLE(dirContentState(path));\n};\n","import { FsItem } from \"../fs/fs.state\";\n\nexport const filterPath = ({ path }: FsItem) =>\n  !path.split(\"/\").includes(\".git\");\n","import {\n  RecoilState,\n  RecoilValue,\n  useRecoilCallback,\n  useRecoilRefresher_UNSTABLE,\n  useRecoilValueLoadable,\n  useSetRecoilState,\n} from \"recoil\";\nimport { useEffect, useRef, useState } from \"react\";\n\nexport const createFocusBasedSetterHook =\n  <T extends unknown, N extends T = T>(state: RecoilState<T>, nullValue: N) =>\n  (value: T) => {\n    const setValue = useSetRecoilState(state);\n    const isFocusedRef = useRef(false);\n    useEffect(() => {\n      if (isFocusedRef.current) {\n        setValue(value);\n      }\n    }, [value]);\n    return {\n      activePathsProviderProps: {\n        onFocus: () => {\n          setValue(value);\n          isFocusedRef.current = true;\n        },\n        onBlur: () => {\n          setValue(nullValue);\n          isFocusedRef.current = false;\n        },\n      },\n    };\n  };\n\n/**\n * Returns the latest value of a recoil value, or null, if the value is being loaded for the first time.\n * Useful for when stale data is ok, but may get synced soon.\n */\nexport function useLatestRecoilValue<T>(recoilValue: RecoilValue<T>): T | null {\n  const [state, setState] = useState<T | null>(null);\n  let loadable = useRecoilValueLoadable(recoilValue);\n\n  useEffect(() => {\n    if (loadable.state === \"hasValue\") {\n      setState(loadable.contents);\n    }\n  }, [loadable]);\n\n  return state;\n}\n\n/**\n * Refreshes recoil value on mount\n */\nexport function useRefreshRecoilValueOnMount<T>(value: RecoilValue<T>) {\n  const refresh = useRecoilRefresher_UNSTABLE(value);\n  useEffect(() => {\n    refresh();\n  }, []);\n}\n\nexport function useRecoilInitialValue<T>(recoilState: RecoilState<T>): T;\nexport function useRecoilInitialValue<T>(\n  recoilState: RecoilState<T>,\n  defaultValue?: Exclude<T, undefined | null>\n): Exclude<T, undefined | null>;\nexport function useRecoilInitialValue<T>(\n  recoilState: RecoilState<T>,\n  defaultValue?: T\n) {\n  return useRecoilCallback(\n    ({ snapshot }) =>\n      () =>\n        snapshot.getLoadable(recoilState).getValue() ?? defaultValue,\n    []\n  );\n}\n","import { atom, selector, selectorFamily } from \"recoil\";\nimport { dirContentState, FsItem } from \"../fs/fs.state\";\nimport { filterPath } from \"./project-utils\";\nimport { createFocusBasedSetterHook } from \"../recoil-utils\";\nimport path from \"path\";\n\nexport interface Project {\n  name: string;\n  path: string;\n}\nexport interface ProjectFsItem extends FsItem {\n  relativePath: string;\n}\n\nconst sampleRepos = {\n  JUI: {\n    path: \"/workspace/jui\",\n    url: \"https://github.com/alirezamirian/jui.git\",\n  },\n  \"React Spectrum\": {\n    path: \"/workspace/react-spectrum\",\n    url: \"https://github.com/adobe/react-spectrum.git\",\n  },\n  Recoil: {\n    path: \"/workspace/recoil\",\n    url: \"https://github.com/facebookexperimental/Recoil.git\",\n  },\n};\nconst sampleRepoKey: keyof typeof sampleRepos = \"JUI\";\n\n/**\n * temporary hard coded sample repo, until clone UI is implemented.\n */\nexport const sampleRepo = sampleRepos[sampleRepoKey];\n\nexport const currentProjectState = atom<Project>({\n  key: \"project\",\n  default: {\n    name: sampleRepoKey,\n    path: sampleRepo.path,\n  },\n});\n\nexport const projectFilePath = selectorFamily({\n  key: \"projectFilePath\",\n  get:\n    (projectRelativePath: string) =>\n    ({ get }) =>\n      `${get(currentProjectState).path}/${projectRelativePath}`,\n});\n\nexport const currentProjectFilesState = selector({\n  key: \"projectFiles\",\n  get: async ({ get }): Promise<ProjectFsItem[]> => {\n    const project = get(currentProjectState);\n    const items = get(dirContentState(project.path));\n    const files: ProjectFsItem[] = [];\n    const addItem = (item: FsItem) => {\n      if (item.type === \"dir\" && filterPath(item)) {\n        const childItems = get(dirContentState(item.path));\n        if (childItems) {\n          childItems.map(addItem);\n        }\n      } else {\n        files.push({\n          ...item,\n          relativePath: path.relative(project.path, item.path),\n        });\n      }\n    };\n    (items || []).forEach((item) => addItem(item));\n    return files;\n  },\n});\n\n/**\n * file/dir paths relevant to the currently active (focused) UI part. Different UI components such as Editor,\n * ProjectView or ChangesView set this context when they get focused. The context can then be used in different actions\n * that operate on files/folders.\n * While this allows for contextual actions, without any specific support for \"Action Data\" from the action system,\n * it has some drawbacks, because of which it may make sense to add support for Action Data:\n * - When an action is not triggered by a shortcut, but by clicking an action button, the focused element doesn't\n *   matter. For example, if the editor is focused and \"Rollback\" action is triggered via the shortcut, then the active\n *   path in the editor defines the initially included changes, in the Rollback window. But if the action is triggered\n *   by clicking the rollback button, while the editor is focused, the editor is ignored, and the initially included\n *   changes are set based on selected nodes in ChangesView (which is the default source for initially included changes).\n *   Whether that behaviour is a good thing or not, in order to follow it, having support for Action Data, will help\n *   implementing this behavior, since the action data will be set based on the context, only when the action is\n *   triggered via shortcut.\n *   UPDATE: that's fixed now by introducing the optional `event` argument passed to actionPerformed, which gives us a\n *   chance to know if the action was performed by a shortcut or by clicking an action button.\n * - Action data would allow for lazy evaluation of the required data, only when the action is triggered via a shortcut,\n *   and based on the dom element from which the event is triggered. While in the current approach, the data is\n *   unnecessarily updated as it changes and the data-holder component is focused.\n * - It involves focus/blur event handling to keep track of the current value, for any such focus-based contextual\n *   value. Support for associating event data with elements would not need focus/blur event handling.\n *\n *  @see useActivePathsProvider\n */\nexport const activePathsState = atom<string[]>({\n  key: \"project.activePaths\",\n  default: [],\n});\n\n/**\n * Sets the value of {@link activePathsState} when focused.\n * @returns focus/blur handling props, to be applied on the container which should set the active path state\n */\nexport const useActivePathsProvider = createFocusBasedSetterHook(\n  activePathsState,\n  []\n);\n","import {\n  atom,\n  selector,\n  useRecoilCallback,\n  useRecoilState,\n  useSetRecoilState,\n} from \"recoil\";\nimport { Focusable } from \"../common-types\";\nimport { descend, sortWith } from \"ramda\";\nimport {\n  currentProjectFilesState,\n  projectFilePath,\n} from \"../Project/project.state\";\nimport { Position } from \"monaco-editor\";\n\ninterface TextEditorState {\n  cursorPos: { lineNumber: number; column: number };\n}\ntype EditorState = TextEditorState;\n\nexport interface EditorTabState {\n  editorState: EditorState;\n  filePath: string;\n}\n\n// in order to showcase tabs behaviour when many tabs are open. Later on, it should be based on persisted project\n// settings.\nconst temporaryTabsDefaultValue = selector({\n  key: \"editor.tabs/Default\",\n  get: ({ get }) =>\n    sortWith(\n      [\n        // first README.md, then ts and js files.\n        descend((file) => file.path === get(projectFilePath(\"README.md\"))),\n        descend((file) => file.path.endsWith(\".ts\")),\n        descend((file) => file.path.endsWith(\".js\")),\n      ],\n      get(currentProjectFilesState).filter((item) => item.type === \"file\")\n    )\n      .slice(0, 12)\n      // map project file to editor state object\n      .map((file) => ({\n        filePath: file.path,\n        editorState: { cursorPos: { lineNumber: 0, column: 0 } },\n      })),\n});\n\n// it should become something under \"project\" state later.\nconst editorTabsState = atom<EditorTabState[]>({\n  key: \"editor.tabs\",\n  default: temporaryTabsDefaultValue,\n});\n\nconst activeEditorTabIndexState = atom<number>({\n  key: \"editor.activeTabIndex\",\n  default: 0,\n});\n\nexport const activeEditorTabState = selector<EditorTabState | null>({\n  key: \"editor.activeTab\",\n  get: ({ get }) =>\n    get(editorTabsState)[get(activeEditorTabIndexState)] || null,\n});\n\nexport const editorCursorPositionState = atom<Position>({\n  key: \"editor.cursorPosition\",\n  default: new Position(0, 0),\n});\n\n/**\n * could be a global variable also, since there is no re-rendering need for it. It's kept as an atom, just to avoid\n * global variable and its issues.\n */\nexport const editorRefState = atom<null | Focusable>({\n  key: \"editor.focusHandle\",\n  default: null,\n});\n\nexport interface EditorStateManager {\n  tabs: EditorTabState[];\n  openPath(filePath: string, focus?: boolean): void;\n  closePath(path: string): void;\n  closeOthersTabs(index: number): void;\n  closeTab(index: number): void;\n  select(index: number): void;\n}\n\n/**\n * TODO: refactor this to expose actions in a way that doesn't create dependency to state. A piece of UI that only\n *  needs to open a file in editor in response to some action (e.g. ProjectViewPane or ChangeViewTree) doesn't need to\n *  re-render on editor state changes\n */\nexport const useEditorStateManager = (): EditorStateManager => {\n  const [tabsState, setTabsState] = useRecoilState(editorTabsState);\n  const setActiveTabIndex = useSetRecoilState(activeEditorTabIndexState);\n  const focus = useRecoilCallback(\n    ({ snapshot }) =>\n      () => {\n        snapshot.getLoadable(editorRefState).valueOrThrow()?.focus();\n      },\n    []\n  );\n\n  const select = (index: number) => {\n    setActiveTabIndex(index);\n  };\n  const closePath = (filePath: string) => {\n    const index = tabsState.findIndex((tab) => tab.filePath === filePath);\n    if (index > -1) {\n      closeTab(index);\n      setActiveTabIndex(Math.max(index - 1, 0));\n    }\n  };\n  const openPath = (filePath: string, shouldFocus = true) => {\n    const index = tabsState.findIndex((tab) => tab.filePath === filePath);\n    if (index > -1) {\n      select(index);\n    } else {\n      const newIndex = tabsState.length;\n      setTabsState((currentState) => [\n        ...currentState,\n        {\n          filePath,\n          editorState: { cursorPos: { lineNumber: 0, column: 0 } }, // no persistence of cursor position for now.\n        },\n      ]);\n      select(newIndex);\n    }\n    if (shouldFocus) {\n      // Without setTimeout editor gets focused immediately and \"Enter\" key press (if openPath is called in a keyboard\n      // event handler) is picked up by editor, adding unwanted new line.\n      setTimeout(focus);\n    }\n  };\n  const closeTab = (index: number) => {\n    setTabsState((tabsState) =>\n      tabsState.filter((_, tabIndex) => tabIndex !== index)\n    );\n  };\n  const closeOthersTabs = (index: number) => {\n    setTabsState((tabsState) =>\n      tabsState.filter((_, tabIndex) => tabIndex === index)\n    );\n  };\n  return {\n    tabs: tabsState,\n    // This should become an action. Something like \"open project file\", when action system is implemented.\n    openPath,\n    closePath,\n    closeTab,\n    closeOthersTabs,\n    select,\n  };\n};\n","import { status as getStatus } from \"isomorphic-git\";\nimport { StatusRow } from \"isomorphic-git\";\n\n// platform/editor-ui-api/src/com/intellij/openapi/vcs/FileStatus.java\nexport type FileStatus =\n  | \"UNKNOWN\"\n  | \"ADDED\"\n  | \"NOT_CHANGED\"\n  | \"MODIFIED\"\n  | \"DELETED\";\n\n// platform/vcs-api/src/com/intellij/openapi/vcs/VcsDirectoryMapping.java\nexport interface VcsDirectoryMapping {\n  dir: string;\n  vcs: \"git\"; // only supported vcs for now.\n}\n\n// TODO: remove when upgraded TS to >=4.5\ntype Awaited<T> = T extends PromiseLike<infer U> ? U : T;\n\n/**\n * Converts isomorphic-git status string or StatusRow to FileStatus.\n *\n * for status row:\n *   [\"a.txt\", 0, 2, 0], // new, untracked\n *   [\"b.txt\", 0, 2, 2], // added, staged\n *   [\"c.txt\", 0, 2, 3], // added, staged, with unstaged changes\n *   [\"d.txt\", 1, 1, 1], // unmodified\n *   [\"e.txt\", 1, 2, 1], // modified, unstaged\n *   [\"f.txt\", 1, 2, 2], // modified, staged\n *   [\"g.txt\", 1, 2, 3], // modified, staged, with unstaged changes\n *   [\"h.txt\", 1, 0, 1], // deleted, unstaged\n *   [\"i.txt\", 1, 0, 0], // deleted, staged\n *\n * for status:\n *   | status                | description                                                                           |\n * | --------------------- | ------------------------------------------------------------------------------------- |\n * | `\"ignored\"`           | file ignored by a .gitignore rule                                                     |\n * | `\"unmodified\"`        | file unchanged from HEAD commit                                                       |\n * | `\"*modified\"`         | file has modifications, not yet staged                                                |\n * | `\"*deleted\"`          | file has been removed, but the removal is not yet staged                              |\n * | `\"*added\"`            | file is untracked, not yet staged                                                     |\n * | `\"absent\"`            | file not present in HEAD commit, staging area, or working dir                         |\n * | `\"modified\"`          | file has modifications, staged                                                        |\n * | `\"deleted\"`           | file has been removed, staged                                                         |\n * | `\"added\"`             | previously untracked file, staged                                                     |\n * | `\"*unmodified\"`       | working dir and HEAD commit match, but index differs                                  |\n * | `\"*absent\"`           | file not present in working dir or HEAD commit, but present in the index              |\n * | `\"*undeleted\"`        | file was deleted from the index, but is still in the working dir                      |\n * | `\"*undeletemodified\"` | file was deleted from the index, but is present with modifications in the working dir |\n */\nexport function convertGitStatus(\n  status: Awaited<ReturnType<typeof getStatus>> | StatusRow\n): FileStatus {\n  // TODO: complete and refine this logic.\n  if (Array.isArray(status)) {\n    if (status[1] === 1) {\n      return ([\"DELETED\", \"NOT_CHANGED\", \"MODIFIED\"] as const)[status[2]];\n    }\n    if (status[1] === 0) {\n      if (status[3] === 0) {\n        return \"UNKNOWN\";\n      } else {\n        return \"ADDED\";\n      }\n    }\n    return \"UNKNOWN\";\n  }\n  if (status === \"modified\" || status === \"*modified\") {\n    return \"MODIFIED\";\n  }\n  if (status === \"deleted\" || status === \"*deleted\") {\n    return \"DELETED\";\n  }\n  if (status === \"added\") {\n    return \"ADDED\";\n  }\n  if (status === \"unmodified\") {\n    return \"NOT_CHANGED\";\n  }\n  return \"UNKNOWN\";\n}\n","import {\n  atom,\n  atomFamily,\n  CallbackInterface,\n  GetRecoilValue,\n  selector,\n  selectorFamily,\n  useRecoilCallback,\n} from \"recoil\";\nimport { currentProjectState } from \"../Project/project.state\";\nimport git, { status, statusMatrix } from \"isomorphic-git\";\nimport { fs } from \"../fs/fs\";\nimport {\n  convertGitStatus,\n  FileStatus,\n  VcsDirectoryMapping,\n} from \"./file-status\";\nimport { useEffect } from \"react\";\nimport * as path from \"path\";\n\nconst temporaryVcsMappingsDefault = ({\n  get,\n}: {\n  get: GetRecoilValue;\n}): VcsDirectoryMapping[] => [\n  {\n    dir: get(currentProjectState).path,\n    vcs: \"git\",\n  },\n];\n\n// This should be refactored to have the configuration file(s) as the source of truth.\nexport const vcsRootsState = atom<VcsDirectoryMapping[]>({\n  key: \"vcsRoots\",\n  default: selector({\n    key: \"vcsRoots/temporaryDefault\",\n    get: temporaryVcsMappingsDefault,\n  }),\n});\n\n/**\n * Given the absolute path of a file, returns the relevant VCS root path, if any.\n */\nexport const vcsRootForFile = selectorFamily<string | null, string>({\n  key: \"gitRootForFile\",\n  get:\n    (filepath: string) =>\n    ({ get }) =>\n      get(vcsRootsState).find((root) => filepath.startsWith(root.dir))?.dir ??\n      null,\n});\n/**\n * Given the absolute path of a file, returns the current branch on the repository this file belongs to.\n */\nexport const branchForFile = selectorFamily<string | null, string>({\n  key: \"gitBranchForFile\",\n  get:\n    (filepath: string) =>\n    async ({ get }) => {\n      const root = get(vcsRootForFile(filepath));\n      return root ? get(repoCurrentBranch(root)) : null;\n    },\n});\n\nexport const repoCurrentBranch = selectorFamily({\n  key: \"gitRepoCurrentBranch\",\n  get: (repoRoot: string) => async () => {\n    return (\n      (await git.currentBranch({ fs, dir: repoRoot, fullname: false })) || null\n    );\n  },\n});\n\n/**\n * Keeps FileStatus of files based on their absolute path.\n * NOTE: Should it be an atom or selector?\n * NOTE: updating files status is now not connected to file updates, as there is no proper (V)FS API allowing change\n * listener. `useUpdateFileStatus` and `useUpdateVcsFileStatuses` can be used to update status of a file, or all files\n * in a git root.\n */\nexport const fileStatusState = atomFamily<FileStatus, string>({\n  key: \"fileStatus\",\n  default: \"NOT_CHANGED\",\n});\n\nexport const useUpdateFileStatus = () =>\n  useRecoilCallback(\n    ({ snapshot, set }: CallbackInterface) =>\n      async (filepath: string) => {\n        const repoRoot = await snapshot.getPromise(vcsRootForFile(filepath));\n        if (repoRoot != null) {\n          console.time(`status ${filepath}`);\n          const fileStatus = await status({\n            fs,\n            dir: repoRoot,\n            filepath: path.relative(repoRoot, filepath),\n          });\n          console.timeEnd(`status ${filepath}`);\n          set(fileStatusState(filepath), convertGitStatus(fileStatus));\n        }\n      },\n    []\n  );\n\nexport const useUpdateVcsFileStatuses = () =>\n  useRecoilCallback(\n    ({ snapshot, transact_UNSTABLE }: CallbackInterface) =>\n      async () => {\n        const vcsDirectoryMappings = await snapshot.getPromise(vcsRootsState);\n        return Promise.all(\n          vcsDirectoryMappings\n            .filter(({ vcs }) => vcs === \"git\")\n            .map(async ({ dir }) => {\n              console.time(\"statusMatrix\");\n              const rows = await statusMatrix({ fs, dir });\n              console.timeEnd(\"statusMatrix\");\n              transact_UNSTABLE(({ set }) => {\n                rows.forEach((row) => {\n                  set(\n                    fileStatusState(`${dir}/${row[0]}`),\n                    convertGitStatus(row)\n                  );\n                });\n              });\n            })\n        );\n      },\n    []\n  );\n\nexport const useInitializeVcs = () => {\n  const updateVcsFileStatuses = useUpdateVcsFileStatuses();\n  useEffect(() => {\n    updateVcsFileStatuses().catch((e) => {\n      console.error(\"could not initialize VCS file statuses\", e);\n    });\n  }, []);\n};\n","import { useTheme } from \"styled-components\";\nimport { Theme } from \"@intellij-platform/core\";\nimport { useRecoilValue } from \"recoil\";\nimport { fileStatusState } from \"./file-status.state\";\nimport React from \"react\";\nimport { FileStatus } from \"./file-status\";\n\nexport const useStatusColor = (status: FileStatus) => {\n  const theme = useTheme() as Theme;\n  switch (status) {\n    case \"MODIFIED\":\n      return theme.dark ? \"#6897bb\" : \"#0032a0\"; // FILESTATUS_MODIFIED key from colorScheme\n    case \"ADDED\":\n      return theme.dark ? \"#629755\" : \"#0a7700\"; // FILESTATUS_ADDED key from colorScheme\n    case \"DELETED\":\n      return theme.dark ? \"#6c6c6c\" : \"#616161\"; // FILESTATUS_DELETED key from colorScheme\n    case \"UNKNOWN\":\n      return theme.dark ? \"#d1675a\" : \"#993300\"; // FILESTATUS_UNKNOWN key from colorScheme\n  }\n  return undefined;\n};\nexport const useFileStatusColor = (filepath: string): string | undefined => {\n  const fileStatus = useRecoilValue(fileStatusState(filepath));\n  return useStatusColor(fileStatus);\n};\n\nexport const FileStatusColor: React.FC<{ filepath: string }> = ({\n  children,\n  filepath,\n}) => {\n  const color = useFileStatusColor(filepath);\n  return <span style={{ color }}>{children}</span>;\n};\n\nexport const StatusColor: React.FC<{ status: FileStatus }> = ({\n  children,\n  status,\n}) => {\n  const color = useStatusColor(status);\n  return <span style={{ color }}>{children}</span>;\n};\n","import { Monaco } from \"@monaco-editor/react\";\nimport {\n  ActionTooltip,\n  ContextMenuContainer,\n  EditorTabContent,\n  EditorTabs,\n  HIDE_ALL_WINDOWS_ACTION_ID,\n  Item,\n  Menu,\n  MenuItemLayout,\n  PlatformIcon,\n  styled,\n  TabCloseButton,\n  TabItem,\n  TooltipTrigger,\n  useLatest,\n} from \"@intellij-platform/core\";\nimport { editor, languages } from \"monaco-editor\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport {\n  useRecoilValue,\n  useRecoilValueLoadable,\n  useSetRecoilState,\n} from \"recoil\";\nimport { getIconForFile } from \"../file-utils\";\nimport { LoadingGif } from \"../LoadingGif\";\nimport { Editor } from \"./Editor\";\nimport {\n  activeEditorTabState,\n  editorCursorPositionState,\n  editorRefState,\n  useEditorStateManager,\n} from \"./editor.state\";\nimport { fileContent } from \"../fs/fs.state\";\nimport { useUpdateFileStatus } from \"../VersionControl/file-status.state\";\nimport * as path from \"path\";\nimport { FileStatusColor } from \"../VersionControl/FileStatusColor\";\nimport { useAction } from \"@intellij-platform/core\";\nimport { mergeProps } from \"@react-aria/utils\";\nimport { useActivePathsProvider } from \"../Project/project.state\";\n\n/**\n * Used as main content in the main ToolWindows. Shows currently opened files tabs and the editor.\n *\n * TODO: preserve editor state when switching between tabs\n * TODO: support multiple editors in split view.\n */\nexport const FileEditor = () => {\n  const editorStateManager = useEditorStateManager();\n  const activeTab = useRecoilValue(activeEditorTabState);\n  const editorRef = useRef<editor.IEditor>();\n  const [active, setActive] = useState(false);\n  const hideAllAction = useAction(HIDE_ALL_WINDOWS_ACTION_ID);\n  const setCursorPositionState = useSetRecoilState(editorCursorPositionState);\n\n  // For functions that are needed in tab action callbacks. Because items are cached and referencing anything\n  // other than the collection item (tab) itself has a risk of working with stale data because of the caching\n  // More info: https://react-spectrum.adobe.com/react-stately/collections.html#why-not-array-map\n  // We can alternatively switch to mapping over tabs array, instead of using the Collection's dynamic api (items),\n  // which is subject to this caching.\n  const tabActionsRef = useLatest({\n    closePath: editorStateManager.closePath,\n    closeOthersTabs: editorStateManager.closeOthersTabs,\n  });\n\n  const setEditorRef = useSetRecoilState(editorRefState);\n\n  const fileContentState = fileContent(activeTab?.filePath);\n  const contentLoadable = useRecoilValueLoadable(fileContentState);\n  const setContent = useSetRecoilState(fileContentState);\n  const updateFileStatus = useUpdateFileStatus();\n\n  const updateContent = (newContent: string = \"\") => {\n    setActive(false);\n    setContent(newContent);\n    if (activeTab) {\n      updateFileStatus(activeTab.filePath).catch((e) => {\n        console.error(\"Could not update file status\", e);\n      });\n    }\n  };\n\n  // For now, when the first tab content is changed, we focus the editor.\n  // FIXME when action system is implemented and there is an action like \"open project file\".\n  // Note that it's event currently buggy\n  useEffect(() => {\n    editorRef.current?.focus();\n    if (activeTab?.editorState.cursorPos) {\n      editorRef.current?.setPosition(activeTab?.editorState.cursorPos);\n    }\n  }, [activeTab?.filePath]);\n\n  const { activePathsProviderProps } = useActivePathsProvider(\n    activeTab ? [activeTab.filePath] : []\n  );\n\n  const content = contentLoadable.valueMaybe();\n\n  return (\n    <StyledFileEditorContainer\n      {...mergeProps(activePathsProviderProps, {\n        onFocus: () => {\n          setActive(true);\n          setEditorRef({\n            focus: () => editorRef.current?.focus(),\n          });\n        },\n      })}\n    >\n      {editorStateManager.tabs.length > 0 && (\n        <ContextMenuContainer\n          renderMenu={() => (\n            <Menu\n              onAction={() => {\n                // TODO: detect which tab was triggering context menu and handle the action accordingly\n                //  One idea is to use use the data-key attribute, from the closes parent that has one. Maybe a\n                //  CollectionContextMenuContainer component which implements that, while ContextMenuContainer is\n                //  modified to pass the MouseEvent object, in renderMenu.\n                alert(\"not implemented!\");\n              }}\n            >\n              <Item key=\"close\">Close</Item>\n              <Item key=\"closeOthers\">Close Other tabs</Item>\n              <Item key=\"closeAll\">Close all tabs</Item>\n              <Item key=\"closeLeft\">Close tabs to the left</Item>\n              <Item key=\"closeRight\">Close tabs to the right</Item>\n            </Menu>\n          )}\n        >\n          <EditorTabs\n            items={editorStateManager.tabs}\n            active={active}\n            selectedKey={activeTab?.filePath}\n            onSelectionChange={(key) =>\n              editorStateManager.select(\n                editorStateManager.tabs.findIndex((tab) => tab.filePath === key)\n              )\n            }\n            noBorders\n          >\n            {(tab) => {\n              const filename = path.basename(tab.filePath);\n              const icon = <PlatformIcon icon={getIconForFile(tab.filePath)} />;\n              return (\n                <TabItem\n                  key={tab.filePath}\n                  textValue={filename}\n                  inOverflowMenu={\n                    <MenuItemLayout content={filename} icon={icon} />\n                  }\n                >\n                  <TooltipTrigger\n                    tooltip={<ActionTooltip actionName={tab.filePath} />}\n                  >\n                    <EditorTabContent\n                      icon={icon}\n                      title={\n                        <FileStatusColor filepath={tab.filePath}>\n                          {filename}\n                        </FileStatusColor>\n                      }\n                      closeButton={\n                        <TooltipTrigger\n                          tooltip={\n                            <ActionTooltip actionName=\"Close. Alt-Click to Close Others\" />\n                          }\n                        >\n                          <TabCloseButton\n                            onPress={(e) => {\n                              if (e.altKey) {\n                                tabActionsRef.current.closeOthersTabs(\n                                  editorStateManager.tabs.indexOf(tab)\n                                );\n                              } else {\n                                tabActionsRef.current.closePath(tab.filePath);\n                              }\n                            }}\n                          />\n                        </TooltipTrigger>\n                      }\n                      containerProps={{\n                        onDoubleClick: () => {\n                          hideAllAction?.perform();\n                        },\n                      }}\n                    />\n                  </TooltipTrigger>\n                </TabItem>\n              );\n            }}\n          </EditorTabs>\n        </ContextMenuContainer>\n      )}\n      {activeTab &&\n        (typeof content === \"string\" ? (\n          <Editor\n            height=\"100%\"\n            path={activeTab.filePath}\n            onMount={(monacoEditor, monaco) => {\n              monacoEditor.focus();\n              enableJsx(monaco);\n              editorRef.current = monacoEditor;\n              monacoEditor.onDidChangeCursorPosition((e) => {\n                setCursorPositionState(e.position);\n              });\n              monacoEditor.onDidChangeModel(() => {\n                const position = editorRef.current?.getPosition();\n                if (position) {\n                  setCursorPositionState(position);\n                }\n              });\n            }}\n            onChange={updateContent}\n            value={content}\n          />\n        ) : (\n          content && \"UNSUPPORTED CONTENT\"\n        ))}\n      {contentLoadable.state === \"loading\" && <FileEditorLoading />}\n    </StyledFileEditorContainer>\n  );\n};\n\nconst StyledFileEditorContainer = styled.div`\n  position: relative;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  background: ${({ theme }) =>\n    theme.color(\n      \"Editor.background\",\n      theme.isUnderDarcula()\n        ? \"rgb(40,40,40)\"\n        : theme.commonColors.panelBackground // FIXME: ColorUtil.darker(theme.commonColors.panelBackground, 3)\n    )};\n`;\n\nconst FileEditorLoading = styled(LoadingGif)`\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n`;\n\nfunction enableJsx(monaco: Monaco) {\n  monaco.languages.typescript.typescriptDefaults.setCompilerOptions({\n    jsx: languages.typescript.JsxEmit.React,\n  });\n\n  monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({\n    noSemanticValidation: false,\n    noSyntaxValidation: false,\n  });\n}\n","import React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport styled from \"styled-components\";\nimport * as Xterm from \"xterm\";\nimport { XTerm } from \"xterm-for-react\";\n\nconst useTerminalXtermOptions = (): Xterm.ITerminalOptions => {\n  return useMemo(\n    () => ({\n      theme: {\n        background: \"rgb(43,43,43)\", // CONSOLE_BACKGROUND_KEY from color scheme\n        selection: \"#214283\", // SELECTION_BACKGROUND?\n        // TODO: more colors\n      },\n      fontFamily: \"sans-serif\",\n      letterSpacing: -8,\n      fontSize: 12,\n      lineHeight: 1.3,\n      cursorStyle: \"block\",\n      cursorBlink: true,\n      cursorWidth: 8,\n      rendererType: \"dom\",\n    }),\n    []\n  );\n};\n\nconst StyledXterm = styled(XTerm)`\n  height: 100%;\n  background: rgb(43, 43, 43); // CONSOLE_BACKGROUND_KEY from color scheme\n`;\nexport const Terminal = (): React.ReactElement => {\n  const [input, setInput] = useState(\"\");\n  const xtermRef = useRef<XTerm | null>(null);\n\n  const options = useTerminalXtermOptions();\n  const PROMPT = \"$ \";\n  useEffect(() => {\n    setTimeout(() => {\n      xtermRef.current?.terminal.resize(80, 10);\n      xtermRef.current?.terminal.write(PROMPT);\n    }, 3000);\n  }, []);\n  return (\n    <StyledXterm\n      ref={xtermRef}\n      options={options}\n      onData={(data) => {\n        const code = data.charCodeAt(0);\n        // If the user hits empty and there is something typed echo it.\n        if (code === 13) {\n          if (input.length > 0) {\n            xtermRef.current?.terminal.write(\"\\r\\nYou typed: '\" + input + \"'\");\n          }\n          xtermRef.current?.terminal.write(\"\\r\\n\" + PROMPT);\n          setInput(\"\");\n        } else if (code < 32 || code === 127) {\n          // Disable control Keys such as arrow keys\n          return;\n        } else {\n          // Add general key press characters to the terminal\n          xtermRef.current?.terminal.write(data);\n          setInput(input + data);\n        }\n      }}\n    />\n  );\n};\n","import { atom, CallbackInterface, selector, useRecoilCallback } from \"recoil\";\nimport { checkout, resetIndex, statusMatrix, StatusRow } from \"isomorphic-git\";\nimport { useEffect } from \"react\";\nimport path from \"path\";\nimport { groupBy } from \"ramda\";\n\nimport { fs } from \"../../fs/fs\";\nimport { reloadFileFromDiskCallback } from \"../../fs/fs.state\";\nimport {\n  useUpdateFileStatus,\n  vcsRootForFile,\n  vcsRootsState,\n} from \"../file-status.state\";\n\nexport type Revision = {\n  path: string;\n  isDir: boolean;\n};\n\nexport interface Change {\n  before: Revision;\n  after: Revision;\n}\n\nexport interface ChangeListObj {\n  id: string;\n  name: string;\n  comment: string;\n  active: boolean;\n  changes: Change[];\n}\n\nexport const changeListsState = atom<ChangeListObj[]>({\n  key: \"changelists.lists\",\n  default: [\n    {\n      id: \"some-UUID\",\n      name: \"Changes\",\n      comment: \"last modified commit message\",\n      changes: [],\n      active: true,\n    },\n    {\n      id: \"some-other-UUID\",\n      name: \"Some other changelist\",\n      comment: \"Some empty changelist for testing\",\n      changes: [],\n      active: false,\n    },\n  ],\n});\n\nexport const activeChangeListState = selector<ChangeListObj | null>({\n  key: \"changelists.lists/default\",\n  get: ({ get }) =>\n    get(changeListsState).find((changeList) => changeList.active) ?? null,\n});\n\nexport const allChangesState = selector<ReadonlyArray<Change>>({\n  key: \"changelists.allChanges\",\n  get: ({ get }) =>\n    get(changeListsState)\n      .map((changeLists) => changeLists.changes)\n      .flat(),\n});\n\nconst isAChange = ([, head, workingDir, stage]: StatusRow): boolean =>\n  head !== 1 || workingDir !== 1 || stage !== 1;\n\nconst refreshChanges =\n  ({ snapshot, set }: CallbackInterface) =>\n  async () => {\n    const gitRoots = (await snapshot.getPromise(vcsRootsState)).filter(\n      (root) => root.vcs === \"git\"\n    );\n    const allStatusMatrices = await Promise.all(\n      gitRoots.map(async ({ dir }) => {\n        const rows = await statusMatrix({ fs, dir });\n        return rows\n          .filter(isAChange)\n          .map(\n            ([pathname, ...theRest]) =>\n              [path.join(dir, pathname), ...theRest] as StatusRow\n          );\n      })\n    );\n    const unversionedPaths = []; // FIXME: handle unversioned files\n    const changes = allStatusMatrices\n      .flat()\n      .map(([path, head, workdir, stage]) => ({\n        // FIXME: change object creation doesn't cover all kind of changes.\n        after: { path, isDir: false },\n        before: { path, isDir: false },\n      }));\n\n    // FIXME: changes now all go to default change list on each refresh. fix it.\n    set(changeListsState, (changeLists) =>\n      changeLists.map((changeList) => {\n        if (changeList.active) {\n          console.log(changes);\n          return {\n            ...changeList,\n            changes,\n          };\n        }\n        return {\n          ...changeList,\n          changes: [],\n        };\n      })\n    );\n  };\n\nexport interface ChangeListManager {\n  addChangeList(name: string, comment: string): void;\n  removeChangeList(id: string): void;\n  editChangeList(\n    id: string,\n    edits: { name?: string; comment?: string; active?: boolean }\n  ): void;\n  setActiveChangeList(id: string): void;\n  mergeChangeLists(sourceId: string, targetId: string): void;\n  moveChange(change: Change, toChangeListId: string): void;\n  refresh(): Promise<void>;\n  rollback(changes: readonly Change[]): Promise<void>;\n}\n\n/**\n * react hook that returns a rollback function which accepts a list of changes to rollback.\n */\nexport const useRollbackChanges = () => {\n  const updateFileStatus = useUpdateFileStatus();\n  return useRecoilCallback(\n    (callbackInterface) => async (changes: readonly Change[]) => {\n      const { snapshot, set } = callbackInterface;\n      const reloadFileFromDisk = reloadFileFromDiskCallback(callbackInterface);\n\n      const changesWithRepoRoots = await Promise.all(\n        changes\n          .filter((change) => !change.after.isDir)\n          .map(async (change) => {\n            const repoRoot = (await snapshot.getPromise(\n              vcsRootForFile(change.after.path)\n            ))!; // FIXME: handle null\n            return {\n              repoRoot,\n              fullPath: change.after.path,\n              relativePath: path.relative(repoRoot, change.after.path),\n            };\n          })\n      );\n      const groupedChanges = groupBy(\n        ({ repoRoot }) => repoRoot,\n        changesWithRepoRoots\n      );\n      await Promise.all(\n        Object.entries(groupedChanges).map(async ([repoRoot, items]) => {\n          await checkout({\n            fs,\n            dir: repoRoot,\n            force: true,\n            filepaths: items.map(({ relativePath }) => relativePath),\n          });\n          await Promise.all(\n            items.map(async ({ fullPath, relativePath }) => {\n              await resetIndex({ fs, dir: repoRoot, filepath: relativePath });\n              await reloadFileFromDisk(fullPath); // Since fileContent is an atom, we set the value. Could be a selector that we would refresh\n              return updateFileStatus(fullPath);\n            })\n          );\n        })\n      );\n\n      // Remove all changes from changelists. It's much more efficient than refresh.\n      set(changeListsState, (changeLists) =>\n        changeLists.map((changeList) => {\n          return {\n            ...changeList,\n            changes: changeList.changes.filter(\n              (change) => !changes.includes(change)\n            ),\n          };\n        })\n      );\n    },\n    []\n  );\n};\n\n/**\n * Exposes actions related to managing change lists, such as CRUD on change lists or refreshing the list of changes, etc.\n * NOTE: ChangeListManager is not used to get the list of changes or change lists, etc. that is to prevent unnecessary\n * re-renders when a component only needs to perform actions related to change lists, without caring about the state\n * of change lists. to get the list of change lists or active change list or list of all changes, there are several\n * other recoil values that can be used simply by `useRecoilValue` hook. of course setting those recoil values\n * is not expected to be done directly via recoil API, and can be prevented by not exposing the atoms/selectors\n * directly, and exposing small hooks that would simply call useRecoilValue.\n */\nexport const useChangeListManager = (): ChangeListManager => {\n  const refresh = useRecoilCallback(refreshChanges, []);\n  const rollback = useRollbackChanges();\n\n  const addChangeList = (name: string, comment: string) => {\n    throw new Error(\"Not implemented\");\n  };\n  const editChangeList = (\n    id: string,\n    edits: { name?: string; comment?: string; active?: boolean }\n  ) => {\n    throw new Error(\"Not implemented\");\n  };\n  const mergeChangeLists = (sourceId: string, targetId: string) => {\n    throw new Error(\"Not implemented\");\n  };\n  const moveChange = (change: Change, toChangeListId: string) => {\n    throw new Error(\"Not implemented\");\n  };\n  const removeChangeList = (id: string) => {\n    throw new Error(\"Not implemented\");\n  };\n  const setActiveChangeList = (id: string) => {\n    throw new Error(\"Not implemented\");\n  };\n  return {\n    addChangeList,\n    editChangeList,\n    mergeChangeLists,\n    moveChange,\n    removeChangeList,\n    setActiveChangeList,\n    refresh,\n    rollback,\n  };\n};\n\n// temporary, perhaps\nexport const useInitializeChanges = () => {\n  const { refresh } = useChangeListManager();\n  useEffect(() => {\n    refresh().catch((e) => console.error(\"could not initialize changes\", e));\n  }, [refresh]);\n};\n","import { constSelector, GetRecoilValue, selector } from \"recoil\";\nimport { vcsRootsState } from \"../../file-status.state\";\nimport { uniq } from \"ramda\";\nimport {\n  ChangeGrouping,\n  ChangeNode,\n  DirectoryNode,\n  directoryNode,\n  isDirectoryNode,\n  RepositoryNode,\n  repositoryNode,\n} from \"./ChangesView.state\";\nimport { getParentPaths } from \"../../../file-utils\";\n\nconst repositoryGrouping: ChangeGrouping<RepositoryNode, \"repository\"> = {\n  id: \"repository\",\n  title: \"Repository\",\n  isAvailable: selector({\n    key: \"repositoryGrouping/isAvailable\",\n    get: ({ get }) => get(vcsRootsState).length > 0,\n  }),\n  groupFn: selector({\n    key: \"repositoryGrouping/groupFn\",\n    get:\n      ({ get }: { get: GetRecoilValue }) =>\n      (nodes: ReadonlyArray<ChangeNode>) => {\n        const repos = get(vcsRootsState);\n        return repos.map((repository): RepositoryNode => {\n          return repositoryNode(\n            repository,\n            nodes.filter((node) =>\n              (node.change.after?.path || node.change.before?.path)?.startsWith(\n                repository.dir\n              )\n            )\n          );\n        });\n      },\n  }),\n};\n\nconst directoryGrouping: ChangeGrouping<DirectoryNode, \"directory\"> = {\n  id: \"directory\",\n  title: \"Directory\",\n  isAvailable: constSelector(true),\n  groupFn: (nodes: ReadonlyArray<ChangeNode>) => {\n    const pathToNodeCache: Record<string, DirectoryNode> = {};\n    const rootDirNodes = nodes.map((node) => {\n      if (node.change.after.isDir) {\n        throw new Error(\"isDir=true is not supported for changes ATM!\");\n      }\n      const filepath = node.change.after.path;\n      // noinspection UnnecessaryLocalVariableJS\n      const rootDirNode = getParentPaths(filepath).reduce(\n        (prevNode: DirectoryNode | ChangeNode, dirPath) => {\n          if (!pathToNodeCache[dirPath]) {\n            pathToNodeCache[dirPath] = directoryNode(dirPath, \"\");\n          }\n          if (prevNode.type === \"directory\") {\n            prevNode.parentNodePath = dirPath;\n          }\n          const dirNode = pathToNodeCache[dirPath];\n          dirNode.children = dirNode.children.includes(prevNode)\n            ? dirNode.children\n            : [prevNode, ...dirNode.children];\n          return dirNode;\n        },\n        node\n      ) as DirectoryNode; // This is gonna be true if the array is non-empty, but TS can't recongnize it.\n      // whether the array can be empty might be something to consider and guard against\n      return rootDirNode;\n    });\n    const collapseDirectories = (dirNode: DirectoryNode): DirectoryNode => {\n      let { children, dirPath } = dirNode;\n      if (\n        dirNode.children.length === 1 &&\n        isDirectoryNode(dirNode.children[0])\n      ) {\n        children = dirNode.children[0].children;\n        dirPath = dirNode.children[0].dirPath;\n      }\n      return {\n        ...dirNode,\n        dirPath,\n        children: children.map((child) =>\n          isDirectoryNode(child) ? collapseDirectories(child) : child\n        ),\n      };\n    };\n    return uniq(rootDirNodes).map(collapseDirectories);\n  },\n};\n\nexport const groupings = [repositoryGrouping, directoryGrouping];\n","import { atom, selector } from \"recoil\";\nimport { Change } from \"../change-lists.state\";\nimport {\n  AnyNode,\n  changesTreeNodesState,\n  getNodeKeyForChange,\n  isGroupNode,\n} from \"../ChangesView/ChangesView.state\";\nimport { Key } from \"react\";\nimport {\n  dfsVisit,\n  getExpandAllKeys,\n} from \"@intellij-platform/core/utils/tree-utils\";\nimport { Bounds } from \"@intellij-platform/core/Overlay\";\n\nconst isOpen = atom<boolean>({\n  key: \"rollbackView.isOpen\",\n  default: false,\n});\nconst windowBounds = atom<Partial<Bounds>>({\n  key: \"rollbackView.windowBounds\",\n  default: { height: 500 },\n});\nconst initiallyIncludedChanges = atom<ReadonlyArray<Change>>({\n  key: \"rollbackView.initiallySelectedChanges\",\n  default: [],\n});\nconst rootNodes = selector({\n  key: \"rollbackView.includedRootNodes\",\n  get: ({ get }) => {\n    const selectedChanges = get(initiallyIncludedChanges);\n    const { rootNodes } = get(changesTreeNodesState);\n    return rootNodes.filter(\n      ({ changeList: { changes, active } }) =>\n        (selectedChanges.length === 0 && active) ||\n        selectedChanges.some((change) => changes.includes(change))\n    );\n  },\n});\nconst initiallyExpandedKeys = selector({\n  key: \"rollbackView.initiallyExpandedKeys\",\n  get: ({ get }) => {\n    const includedChanges = get(initiallyIncludedChanges);\n    const nodes = get(rootNodes);\n    const expandedKeys: Key[] = [];\n    dfsVisit<AnyNode, boolean>(\n      (node) => (isGroupNode(node) ? node.children : null),\n      (node, childValues) => {\n        const isExpanded: boolean =\n          childValues?.some((childValue) => childValue) ||\n          includedChanges.map(getNodeKeyForChange).includes(node.key);\n        if (isExpanded && isGroupNode(node)) {\n          expandedKeys.push(node.key);\n        }\n        return isExpanded;\n      },\n      nodes\n    );\n    return new Set(\n      expandedKeys.length\n        ? expandedKeys\n        : getExpandAllKeys<AnyNode>(\n            (node) => (isGroupNode(node) ? node.children : null),\n            (node) => node.key,\n            nodes\n          )\n    );\n  },\n});\n\nexport const rollbackViewState = {\n  isOpen,\n  windowBounds,\n  initiallyExpandedKeys,\n  initiallyIncludedChanges,\n  rootNodes,\n};\n","import { Key } from \"react\";\nimport {\n  atom,\n  atomFamily,\n  CallbackInterface,\n  isRecoilValue,\n  RecoilValue,\n  selector,\n} from \"recoil\";\nimport { Selection } from \"@react-types/shared\";\n\nimport {\n  allChangesState,\n  Change,\n  ChangeListObj,\n  changeListsState,\n} from \"../change-lists.state\";\nimport { groupings } from \"./changesGroupings\";\nimport { VcsDirectoryMapping } from \"../../file-status\";\nimport { dfsVisit } from \"@intellij-platform/core/utils/tree-utils\";\nimport {\n  createSetInterface,\n  NestedSelection,\n  NestedSelectionState,\n} from \"@intellij-platform/core\";\nimport { rollbackViewState } from \"../Rollback/rollbackView.state\";\nimport { activePathsState } from \"../../../Project/project.state\";\nimport { branchForFile } from \"../../file-status.state\";\n\nexport interface ChangeBrowserNode<T extends string> {\n  type: T;\n  key: string;\n}\n\nexport interface GroupNode<T extends string> extends ChangeBrowserNode<T> {\n  children: ReadonlyArray<AnyNode>;\n}\n\nexport interface ChangeNode extends ChangeBrowserNode<\"change\"> {\n  change: Change;\n}\n\nexport interface ChangeListNode extends GroupNode<\"changelist\"> {\n  changeList: ChangeListObj;\n}\n\nexport interface DirectoryNode extends GroupNode<\"directory\"> {\n  dirPath: string;\n  parentNodePath: string;\n}\n\nexport interface RepositoryNode extends GroupNode<\"repo\"> {\n  repository: VcsDirectoryMapping;\n}\n\nexport type AnyGroupNode = ChangeListNode | RepositoryNode | DirectoryNode;\nexport type AnyNode = AnyGroupNode | ChangeNode;\n\ntype MaybeRecoilValue<T> = T | RecoilValue<T>;\n\nexport type GroupFn<T extends AnyGroupNode> = (\n  nodes: ReadonlyArray<ChangeNode>\n) => ReadonlyArray<T>;\n\nexport interface ChangeGrouping<T extends AnyGroupNode, I = string> {\n  id: I;\n  title: string;\n  isAvailable: MaybeRecoilValue<boolean>;\n  groupFn: MaybeRecoilValue<GroupFn<T>>;\n}\n\nexport const currentBranchState = atomFamily<string | null, string>({\n  key: \"vcs/currentBranchName\",\n  default: branchForFile,\n  // TODO: effect for syncing (when toolWindow state changes?)\n});\n\nexport const showIgnoredFilesState = atom({\n  key: \"changesView/showIgnoredFiles\",\n  default: false,\n});\n\nexport const showRelatedFilesState = atom({\n  key: \"changesView/showRelatedFiles\",\n  default: false,\n});\n\n// in a more extensible implementation, the id would be just string. but now that groupings are statically defined,\n// why not have more type safety\nexport type GroupingIds = typeof groupings[number][\"id\"];\n\nexport const changesGroupingState = atomFamily<boolean, GroupingIds>({\n  key: \"changesView/grouping\",\n  default: true, // it's false in IntelliJ\n});\n\n/**\n * Selection state for the changes tree. Selection here means UI selection of tree nodes, not the checkboxes.\n */\nexport const selectedKeysState = atom<Selection>({\n  key: \"changesView.selectedKeys\",\n  default: new Set<Key>([]),\n});\n\nexport const changesUnderSelectedKeys = selector<ReadonlyArray<Change>>({\n  key: \"changesView.selectedKeys.changes\",\n  get: ({ get }) => {\n    const selectedKeys = get(selectedKeysState);\n    const { byKey } = get(changesTreeNodesState);\n    if (selectedKeys === \"all\") {\n      return get(allChangesState);\n    }\n    const allChanges: Change[] = [];\n    const processNode = (node: AnyNode | undefined) => {\n      if (!node) {\n        return;\n      }\n      if (node.type === \"change\") {\n        allChanges.push(node.change);\n      }\n      if (isGroupNode(node)) {\n        node.children.forEach(processNode);\n      }\n    };\n    [...selectedKeys].map((key) => byKey.get(key)).forEach(processNode);\n    return allChanges;\n  },\n});\n\n/**\n * The list of changes that are included for the commit (via checkboxes).\n * TODO: for both this and tree selection state, value should be updated to exclude removed keys, when the tree data\n *  is changed\n */\nexport const includedChangeKeysState = atom<Set<string>>({\n  key: \"changesView.includedChangeKeys\",\n  default: new Set<string>([]),\n});\n\nexport const includedChangesState = selector<ReadonlyArray<Change>>({\n  key: \"changesView.includedChanges\",\n  get: ({ get }) => {\n    const includedChangeKeys = get(includedChangeKeysState);\n    const allChanges = get(allChangesState);\n    return allChanges.filter((change) =>\n      includedChangeKeys.has(getNodeKeyForChange(change))\n    );\n  },\n});\n\n/**\n * A NestedSelection state, inferred based on selected changes. NestedSelection holds the checkmark state of all nodes\n * based on the selected leaf nodes.\n */\nexport const includedChangesNestedSelection = selector<\n  NestedSelectionState<AnyNode>\n>({\n  key: \"changesView.selectedChanges.nestedSelectionState\",\n  get: ({ get, getCallback }) => {\n    const { rootNodes } = get(changesTreeNodesState);\n    const includedChangeKeys = get(includedChangeKeysState);\n    const setSelectedKeys = getCallback(\n      ({ set }) =>\n        (setValue: (currentValue: Set<string>) => Set<string>) =>\n          set(includedChangeKeysState, setValue)\n    );\n    return new NestedSelection(\n      {\n        items: includedChangeKeys,\n        ...createSetInterface(setSelectedKeys),\n      },\n      {\n        rootNodes,\n        getChildren: (item: AnyNode) =>\n          isGroupNode(item) ? item.children : null,\n        getKey: (item) => item.key,\n      }\n    );\n  },\n});\n\nexport const expandedKeysState = atom<Selection>({\n  key: \"changesView.expandedKeys\",\n  default: selector({\n    key: \"changesView.expandedKeys/temporaryDefault\",\n    get: ({ get }) => {\n      return new Set<Key>(\n        get(changesTreeNodesState)\n          .rootNodes.map((node) => [\n            node.key,\n            ...node.children.map((child) => child.key),\n          ])\n          .flat()\n      );\n    },\n  }),\n});\n\nexport const availableGroupingsState = selector({\n  key: \"changes.availableGroupings\",\n  get: ({ get }) =>\n    groupings\n      .filter((grouping) =>\n        isRecoilValue(grouping.isAvailable)\n          ? get(grouping.isAvailable)\n          : grouping.isAvailable\n      )\n      .map((grouping) => ({\n        grouping,\n        isActive: get(changesGroupingState(grouping.id)),\n      })),\n});\n\nconst changeBrowserNodeKey = (type: string, id: string): string =>\n  `${type}_${id}`;\n\nexport const getNodeKeyForChange = (change: Change) =>\n  changeBrowserNodeKey(\"change\", change.after.path);\n\nexport const changeNode = (change: Change): ChangeNode => ({\n  type: \"change\",\n  key: getNodeKeyForChange(change),\n  change,\n});\n\nexport const changeListNode = (\n  changeList: ChangeListObj,\n  groupFn: GroupFn<any> = (i) => i\n): ChangeListNode => ({\n  type: \"changelist\",\n  key: changeBrowserNodeKey(\"changelist\", changeList.id),\n  changeList,\n  children: groupFn(changeList.changes.map((change) => changeNode(change))),\n});\n\nexport const directoryNode = (\n  dirPath: string,\n  parentNodePath: string,\n  children: AnyNode[] = []\n): DirectoryNode => ({\n  type: \"directory\",\n  key: changeBrowserNodeKey(\"directory\", dirPath),\n  dirPath,\n  parentNodePath,\n  children,\n});\n\nexport const repositoryNode = (\n  repository: VcsDirectoryMapping,\n  children: AnyNode[] = []\n): RepositoryNode => ({\n  type: \"repo\",\n  key: changeBrowserNodeKey(\"repo\", repository.dir),\n  repository,\n  children,\n});\n\nexport const isGroupNode = (\n  node: ChangeBrowserNode<any>\n): node is GroupNode<any> => \"children\" in node;\n\nconst isChangeNode = (node: ChangeBrowserNode<any>): node is ChangeNode =>\n  node.type === \"change\";\n\nexport const isDirectoryNode = (node: AnyNode): node is DirectoryNode =>\n  node.type === \"directory\";\n\nconst recursiveGrouping = (\n  groupingFns: Array<GroupFn<AnyGroupNode>>,\n  nodes: ReadonlyArray<ChangeBrowserNode<any>>\n): ReadonlyArray<AnyGroupNode> => {\n  if (groupingFns.length === 0 || nodes.length === 0) {\n    return nodes as ReadonlyArray<AnyGroupNode>; // can we avoid explicit cast?\n  }\n  const nextGroupingFns = groupingFns.slice(1);\n  const changeNodes = nodes.filter(isChangeNode);\n  const groupNodes = nodes.filter(isGroupNode);\n  const groups = groupingFns[0](changeNodes);\n\n  [...groupNodes, ...groups].forEach((groupNode) => {\n    groupNode.children = recursiveGrouping(nextGroupingFns, groupNode.children);\n  });\n  return groups;\n};\n\nconst getChildren = (node: AnyNode) =>\n  isGroupNode(node) ? node.children : null;\n\nexport const changesTreeNodesState = selector<{\n  rootNodes: ChangeListNode[];\n  fileCountsMap: Map<Key, number>;\n  byKey: Map<Key, AnyNode>;\n}>({\n  key: \"changesView.treeNodes\",\n  get: ({ get }) => {\n    const resolve = <T>(value: MaybeRecoilValue<T>): T =>\n      isRecoilValue(value) ? get(value) : value;\n    const changeLists = get(changeListsState);\n    const groupFns = get(availableGroupingsState)\n      .filter(({ isActive }) => isActive)\n      .map(({ grouping }) => {\n        return resolve(grouping.groupFn);\n      });\n\n    const groupChanges = (changes: readonly ChangeNode[]) =>\n      recursiveGrouping(groupFns, changes);\n\n    const rootNodes = changeLists.map((changeList) =>\n      changeListNode(changeList, groupChanges)\n    );\n    const fileCountsMap = new Map();\n    const byKey = new Map();\n    const getFileCount = (node: GroupNode<any>): number => {\n      return node.children.reduce(\n        (totalSum, child) =>\n          totalSum + (isGroupNode(child) ? getFileCount(child) : 1),\n        0\n      );\n    };\n    dfsVisit<AnyNode, number>(\n      getChildren,\n      (node, childrenFileCount) => {\n        byKey.set(node.key, node);\n        if (!childrenFileCount) {\n          return 1;\n        }\n        const fileCount = childrenFileCount.reduce(\n          (total, count) => total + count,\n          0\n        );\n        fileCountsMap.set(node.key, fileCount);\n        return fileCount;\n      },\n      rootNodes\n    );\n    return { rootNodes, fileCountsMap, byKey };\n  },\n});\n\n/**\n * Commit message split width, when the commit tool window is rendered in vertical layout\n */\nexport const commitMessageSizeState = atomFamily<\n  number,\n  \"horizontal\" | \"vertical\"\n>({\n  key: \"changesView/splitter/commitMessageSize\",\n  default: (orientation) => (orientation === \"horizontal\" ? 0.4 : 0.3),\n});\n/**\n * Whether --amend should be used for commit.\n */\nexport const amendCommitState = atom({\n  key: \"changesView/amendCommit\",\n  default: false,\n  // TODO: add a side effect to update message to the one from the last commit, when toggled to true.\n  // it should add a record to the commit message history and switch the message. When toggled to false,\n  // last entry in history should be back again. There is currently no history :D\n});\n/**\n * commit message text bound to the editor.\n */\nexport const commitMessageState = atom({\n  key: \"changesView/commitMessage\",\n  default: \"\",\n});\n\nexport const openRollbackWindowForSelectionCallback = ({\n  set,\n  snapshot,\n}: CallbackInterface) => {\n  /**\n   * If contextual is true, changes related to {@link activePathsState} will be preselected.\n   */\n  return (contextual = true) => {\n    const activePaths = snapshot.getLoadable(activePathsState).getValue();\n    const changesUnderSelection = snapshot\n      .getLoadable(changesUnderSelectedKeys)\n      .getValue();\n    const changesBasedOnActivePaths =\n      contextual && activePaths.length > 0\n        ? snapshot\n            .getLoadable(allChangesState)\n            .getValue()\n            .filter((change) =>\n              activePaths.some((activePath) =>\n                change.after.path.startsWith(activePath)\n              )\n            )\n        : null;\n    set(\n      rollbackViewState.initiallyIncludedChanges,\n      changesBasedOnActivePaths ?? changesUnderSelection\n    );\n    set(rollbackViewState.isOpen, true);\n  };\n};\n","import { useRecoilCallback, useRecoilValue, useSetRecoilState } from \"recoil\";\nimport {\n  changesUnderSelectedKeys,\n  getNodeKeyForChange,\n  includedChangeKeysState,\n  openRollbackWindowForSelectionCallback,\n  selectedKeysState,\n} from \"./ChangesView.state\";\nimport {\n  Item,\n  Menu,\n  MenuItemLayout,\n  PlatformIcon,\n} from \"@intellij-platform/core\";\nimport React from \"react\";\n\nimport { useChangeViewContext } from \"./ChangesViewSplitter\";\nimport { useEditorStateManager } from \"../../../Editor/editor.state\";\n\nexport const ChangesViewTreeContextMenu = () => {\n  const selectedChanges = useRecoilValue(changesUnderSelectedKeys);\n  const setIncludedChangeKeys = useSetRecoilState(includedChangeKeysState);\n  const selectedKeys = useRecoilValue(selectedKeysState);\n  const disabledKeys = [\"moveToChangelist\"];\n  const { focusCommitMessage } = useChangeViewContext();\n  const editorStateManager = useEditorStateManager();\n  const openRollbackWindowForSelection = useRecoilCallback(\n    openRollbackWindowForSelectionCallback,\n    []\n  );\n  if (selectedChanges.length === 0) {\n    disabledKeys.push(\"commit\");\n  }\n\n  if ([...selectedKeys].length === 0) {\n    return null;\n  }\n  return (\n    <Menu\n      disabledKeys={disabledKeys}\n      aria-label=\"Context menu\"\n      onAction={(key) => {\n        switch (key) {\n          case \"commit\":\n            setIncludedChangeKeys(\n              new Set(selectedChanges.map(getNodeKeyForChange))\n            );\n            focusCommitMessage();\n            break;\n          case \"rollback\":\n            openRollbackWindowForSelection();\n            break;\n          case \"jumpToSource\":\n            selectedChanges.forEach((change, index, arr) => {\n              if (!change.after.isDir) {\n                editorStateManager.openPath(\n                  change.after.path,\n                  index === arr.length - 1\n                );\n              }\n            });\n            break;\n        }\n      }}\n    >\n      <Item key=\"commit\" textValue=\"Commit\">\n        Commit file{selectedChanges.length > 1 ? \"s\" : \"\"}...\n      </Item>\n      <Item key=\"rollback\" textValue=\"Rollback\">\n        <MenuItemLayout\n          icon={<PlatformIcon icon={\"actions/rollback.svg\"} />}\n          content=\"Rollback...\"\n        />\n      </Item>\n      <Item key=\"moveToChangelist\">Move to another Changelist...</Item>\n      <Item key=\"jumpToSource\" textValue=\"Jump to source\">\n        <MenuItemLayout\n          icon={<PlatformIcon icon={\"actions/editSource.svg\"} />}\n          content=\"Jump to source\"\n        />\n      </Item>\n    </Menu>\n  );\n};\n","import { styled, Theme } from \"@intellij-platform/core\";\nimport React from \"react\";\nimport { useRecoilValue } from \"recoil\";\nimport { vcsRootsState } from \"../../file-status.state\";\nimport { useTheme } from \"styled-components\";\n\nconst StyledRepoColorSquare = styled.span`\n  width: 14px;\n  height: 14px;\n  align-self: center;\n  margin-right: 0.1rem;\n  position: relative;\n\n  //  after pseudo element is used to create the color mixing implemented here:\n  //  https://github.com/JetBrains/intellij-community/blob/82f201386c3f7a339ff25fc8f3389024c8078a87/platform/vcs-log/impl/src/com/intellij/vcs/log/ui/VcsLogColorManagerImpl.java#L60\n  &&:after {\n    content: \"\";\n    position: absolute;\n    inset: 0;\n    opacity: 0.75;\n    background: ${({ theme }) =>\n      theme.color(\"Table.background\") || (theme.dark ? \"#3C3F41\" : \"#fff\")};\n  }\n`;\n\nconst useRepoRootColor = (rootPath: string) => {\n  const index = useRecoilValue(vcsRootsState).findIndex(\n    (root) => root.dir === rootPath\n  );\n  const theme = useTheme() as Theme;\n  const colors = [theme.commonColors.red, theme.commonColors.blue];\n  return colors[index % colors.length] ?? colors[0];\n};\n\nexport const RepoColorIcon = ({ rootPath }: { rootPath: string }) => (\n  <StyledRepoColorSquare\n    style={{ backgroundColor: useRepoRootColor(rootPath) }}\n  />\n);\n","import React from \"react\";\nimport { Color, styled } from \"@intellij-platform/core\";\n\nexport const StyledCurrentBranchTag = styled.span`\n  display: inline-flex;\n  align-self: center;\n  height: 1.1rem;\n  line-height: 1.1rem;\n  padding: 0 0.25rem;\n\n  background: ${({ theme }) =>\n    new Color(\n      theme.color(\n        \"VersionControl.RefLabel.backgroundBase\",\n        theme.dark ? \"#fff\" : \"#000\"\n      )\n    )\n      .withTransparency(\n        theme.value<number>(\"VersionControl.RefLabel.backgroundBrightness\") ??\n          0.08\n      )\n      .toString()};\n  color: ${({ theme }) =>\n    theme.currentForegroundAware(\n      theme.color(\n        \"VersionControl.RefLabel.foreground\",\n        theme.dark ? \"#909090\" : \"#7a7a7a\"\n      )\n    )};\n`;\n","import React from \"react\";\nimport { VcsDirectoryMapping } from \"./file-status\";\nimport { currentBranchState } from \"./Changes/ChangesView/ChangesView.state\";\nimport { useRecoilValue } from \"recoil\";\n\nexport const CurrentBranchName = ({ repo }: { repo?: VcsDirectoryMapping }) => {\n  const branch = useRecoilValue(currentBranchState(repo?.dir ?? \"\"));\n  return <>{branch}</>;\n};\n","import { IntlMessageFormat } from \"intl-messageformat\";\nimport {\n  AnyNode,\n  ChangeBrowserNode,\n  ChangeListNode,\n  ChangeNode,\n  changesGroupingState,\n  DirectoryNode,\n  isGroupNode,\n  RepositoryNode,\n} from \"./ChangesView.state\";\nimport React, { Key } from \"react\";\nimport { ItemProps } from \"@react-types/shared\";\nimport path from \"path\";\nimport {\n  HighlightedTextValue,\n  ItemLayout,\n  PlatformIcon,\n} from \"@intellij-platform/core\";\nimport { RepoColorIcon } from \"./StyledRepoColorSquare\";\nimport { StyledCurrentBranchTag } from \"./StyledCurrentBranchTag\";\nimport { CurrentBranchName } from \"../../CurrentBranchName\";\nimport { DIR_ICON, getIconForFile } from \"../../../file-utils\";\nimport { useRecoilValue } from \"recoil\";\n\n/**\n * Necessary properties for each node, to be passed to `Item`s rendered in tree.\n * Some properties like `key` or `childItems` are not included, as they are calculated similarly\n * for all types of nodes.\n */\ntype RenderedNode = { textValue: string; rendered: React.ReactNode };\ntype NodeRenderer<T extends ChangeBrowserNode<any>> = (\n  node: T,\n  metadata: { fileCount: number; dirCount: number }\n) => RenderedNode;\nconst fileCountMsg = new IntlMessageFormat(\n  `{fileCount, plural,\n    =0 {No files}\n    =1 {1 file}\n    other {# files}\n  }`,\n  \"en-US\"\n);\nconst repoNodeItemProps: NodeRenderer<RepositoryNode> = (\n  node,\n  { fileCount }\n) => ({\n  textValue: path.basename(node.repository.dir),\n  rendered: (\n    <ItemLayout>\n      <RepoColorIcon rootPath={node.repository.dir} />\n      <HighlightedTextValue />\n      <ItemLayout.Hint>{fileCountMsg.format({ fileCount })}</ItemLayout.Hint>\n      <StyledCurrentBranchTag>\n        <CurrentBranchName repo={node.repository} />\n      </StyledCurrentBranchTag>\n    </ItemLayout>\n  ),\n});\nconst directoryNodeItemProps: NodeRenderer<DirectoryNode> = (\n  node,\n  { fileCount }\n) => ({\n  textValue: node.parentNodePath\n    ? path.relative(node.parentNodePath, node.dirPath)\n    : node.dirPath,\n  rendered: (\n    <ItemLayout>\n      <PlatformIcon icon={DIR_ICON} />\n      <HighlightedTextValue />\n      <ItemLayout.Hint>{fileCountMsg.format({ fileCount })}</ItemLayout.Hint>\n    </ItemLayout>\n  ),\n});\nconst changeListNodeItemProps: NodeRenderer<ChangeListNode> = (\n  node,\n  { fileCount }\n) => ({\n  textValue: node.changeList.name,\n  rendered: (\n    <ItemLayout>\n      <span style={{ fontWeight: node.changeList.active ? \"bold\" : undefined }}>\n        <HighlightedTextValue />\n      </span>\n      <ItemLayout.Hint>\n        {fileCountMsg.format({ fileCount })}{\" \"}\n        {/*in IntelliJ it's not shown if it's empty, but why not!*/}\n      </ItemLayout.Hint>\n    </ItemLayout>\n  ),\n});\nconst ChangeNodeHint = ({ node }: { node: ChangeNode }): React.ReactElement => {\n  const isGroupedByDirectory = useRecoilValue(\n    changesGroupingState(\"directory\")\n  );\n  return (\n    <ItemLayout.Hint>\n      {!isGroupedByDirectory && path.dirname(node.change.after.path)}\n    </ItemLayout.Hint>\n  );\n};\nconst changeNodeItemProps: NodeRenderer<ChangeNode> = (node) => ({\n  textValue: path.basename(node.change.after.path),\n  rendered: (\n    <ItemLayout>\n      <PlatformIcon icon={getIconForFile(node.change.after.path)} />\n      <HighlightedTextValue />\n      <ChangeNodeHint node={node} />\n    </ItemLayout>\n  ),\n});\n\nconst nodeRenderers: {\n  [type in AnyNode[\"type\"]]: NodeRenderer<AnyNode & { type: type }>;\n} = {\n  repo: repoNodeItemProps,\n  directory: directoryNodeItemProps,\n  changelist: changeListNodeItemProps,\n  change: changeNodeItemProps,\n};\n\nexport const getChangeListTreeItemProps = ({\n  node,\n  fileCountsMap,\n}: {\n  node: AnyNode;\n  fileCountsMap: Map<Key, number>;\n}): ItemProps<AnyNode> & { key: Key } => {\n  // Would make sense to handle missing renderer case if implementation is changed to be extensible with regard\n  // to node types\n  const nodeRenderer: NodeRenderer<any> /* FIXME: why is any needed? */ =\n    nodeRenderers[node.type];\n  const { textValue, rendered } = nodeRenderer(node, {\n    fileCount: fileCountsMap.get(node.key) || 0,\n    dirCount: 0, // It seems it's only used for ignored files subtree\n  });\n  return {\n    key: node.key,\n    childItems: isGroupNode(node) ? node.children : [],\n    hasChildItems: isGroupNode(node) && node.children?.length > 0,\n    textValue,\n    children: rendered,\n  };\n};\n","import React, { Key, RefObject } from \"react\";\nimport { useRecoilCallback, useRecoilState, useRecoilValue } from \"recoil\";\nimport {\n  ContextMenuContainer,\n  Item,\n  SpeedSearchTreeWithCheckboxes,\n  TreeNodeCheckbox,\n  TreeRefValue,\n} from \"@intellij-platform/core\";\nimport {\n  changesTreeNodesState,\n  expandedKeysState,\n  includedChangesNestedSelection,\n  selectedKeysState,\n} from \"./ChangesView.state\";\nimport { ChangesViewTreeContextMenu } from \"./ChangesViewTreeContextMenu\";\nimport { getChangeListTreeItemProps } from \"./changesTreeNodeRenderers\";\nimport { useActivePathsProvider } from \"../../../Project/project.state\";\nimport { useEditorStateManager } from \"../../../Editor/editor.state\";\n\n/**\n * TODO: unversioned files\n * TODO: show diff/source on double click (on action to be more precise)\n */\nexport const ChangeViewTree = ({\n  treeRef,\n}: {\n  treeRef: RefObject<TreeRefValue>;\n}): JSX.Element => {\n  const { rootNodes, fileCountsMap, byKey } = useRecoilValue(\n    changesTreeNodesState\n  );\n  const [selectedKeys, setSelectedKeys] = useRecoilState(selectedKeysState);\n  const [expandedKeys, setExpandedKeys] = useRecoilState(expandedKeysState);\n  const nestedSelection = useRecoilValue(includedChangesNestedSelection);\n  const { openPath } = useEditorStateManager();\n  const openChangeInEditor = useRecoilCallback(\n    ({ snapshot }) =>\n      (key: Key) => {\n        const change = snapshot\n          .getLoadable(changesTreeNodesState)\n          .getValue()\n          .byKey.get(key);\n        if (change?.type === \"change\") {\n          openPath(change.change.after.path);\n        }\n        return change;\n      },\n    []\n  );\n\n  const { activePathsProviderProps } = useActivePathsProvider(\n    selectedKeys === \"all\"\n      ? [] // FIXME\n      : [...selectedKeys]\n          .map((key) => {\n            const node = byKey.get(key);\n            if (node?.type === \"directory\") {\n              return node.dirPath;\n            }\n            if (node?.type === \"change\") {\n              return node.change.after.path;\n            }\n            return null;\n          })\n          .filter((i): i is string => i != null)\n  );\n\n  return (\n    <ContextMenuContainer\n      renderMenu={() => <ChangesViewTreeContextMenu />}\n      style={{ height: \"100%\" }}\n    >\n      <SpeedSearchTreeWithCheckboxes\n        ref={treeRef}\n        items={rootNodes}\n        selectionMode=\"multiple\"\n        selectedKeys={selectedKeys}\n        expandedKeys={expandedKeys}\n        onExpandedChange={setExpandedKeys}\n        onSelectionChange={setSelectedKeys}\n        onAction={openChangeInEditor}\n        nestedSelection={nestedSelection}\n        fillAvailableSpace\n        autoFocus=\"first\"\n        {...activePathsProviderProps}\n      >\n        {(node) => {\n          const props = getChangeListTreeItemProps({\n            fileCountsMap,\n            node,\n          });\n          return (\n            <Item {...props}>\n              {node.children?.length !== 0 && (\n                <TreeNodeCheckbox\n                  selectionState={nestedSelection.getSelectionState(node)}\n                  onToggle={() => nestedSelection.toggle(node)}\n                />\n              )}\n              {props.children}\n            </Item>\n          );\n        }}\n      </SpeedSearchTreeWithCheckboxes>\n    </ContextMenuContainer>\n  );\n};\n","import React from \"react\";\nimport {\n  ActionButtonWithMenu,\n  Item,\n  Menu,\n  MenuItemLayout,\n  PlatformIcon,\n} from \"@intellij-platform/core\";\n\nexport const ChangeListsActionButton = (): React.ReactElement => {\n  // Grouping is extensible in Intellij platform, but we only support grouping by directory here.\n\n  return (\n    <ActionButtonWithMenu\n      renderMenu={({ menuProps }) => (\n        <Menu\n          {...menuProps}\n          onAction={(key) => {\n            alert(\"Not implemented\");\n          }}\n        >\n          <Item key=\"new\">\n            <MenuItemLayout\n              content=\"New Changelist...\"\n              icon={<PlatformIcon icon=\"general/add.svg\" />}\n            />\n          </Item>\n          <Item key=\"edit\">\n            <MenuItemLayout\n              content=\"Edit Changelist...\"\n              icon={<PlatformIcon icon=\"actions/edit.svg\" />}\n            />\n          </Item>\n          <Item key=\"delete\">\n            <MenuItemLayout\n              content=\"Delete Changelist\"\n              icon={<PlatformIcon icon=\"general/remove.svg\" />}\n            />\n          </Item>\n          <Item key=\"moveToAnotherChangelist\">\n            <MenuItemLayout content=\"Move Files to Another Changelist...\" />\n          </Item>\n        </Menu>\n      )}\n    >\n      <PlatformIcon icon=\"vcs/changelist.svg\" />\n    </ActionButtonWithMenu>\n  );\n};\n","import React from \"react\";\nimport { useRecoilCallback, useRecoilValue } from \"recoil\";\nimport {\n  availableGroupingsState,\n  changesGroupingState,\n  GroupingIds,\n} from \"../ChangesView.state\";\nimport {\n  ActionButtonWithMenu,\n  Item,\n  Menu,\n  PlatformIcon,\n  Section,\n} from \"@intellij-platform/core\";\n\nexport const GroupByActionButton = (): React.ReactElement => {\n  // Grouping is extensible in Intellij platform, but we only support grouping by directory here.\n\n  const availableGroupings = useRecoilValue(availableGroupingsState);\n\n  const toggleGroup = useRecoilCallback(\n    ({ set }) => (id: GroupingIds) => {\n      set(changesGroupingState(id), (value) => !value);\n    },\n    []\n  );\n\n  return (\n    <ActionButtonWithMenu\n      renderMenu={({ menuProps }) => (\n        <Menu\n          {...menuProps}\n          selectedKeys={availableGroupings\n            .filter(({ isActive }) => isActive)\n            .map(({ grouping }) => grouping.id)}\n          onAction={(key) => {\n            const id = availableGroupings.find(\n              ({ grouping }) => grouping.id === key\n            )?.grouping.id;\n            if (id) {\n              toggleGroup(id);\n            }\n          }}\n        >\n          <Section title=\"Group By\">\n            {availableGroupings.map(({ grouping }) => (\n              <Item key={grouping.id}>{grouping.title}</Item>\n            ))}\n          </Section>\n        </Menu>\n      )}\n    >\n      <PlatformIcon icon=\"actions/groupBy.svg\" />\n    </ActionButtonWithMenu>\n  );\n};\n","import React from \"react\";\nimport { useRecoilState } from \"recoil\";\nimport {\n  showIgnoredFilesState,\n  showRelatedFilesState,\n} from \"../ChangesView.state\";\nimport {\n  ActionButtonWithMenu,\n  Item,\n  Menu,\n  PlatformIcon,\n} from \"@intellij-platform/core\";\n\nexport const ViewOptionsActionButton = (): React.ReactElement => {\n  const [showRelatedFiles, setShowRelatedFiles] = useRecoilState(\n    showRelatedFilesState\n  );\n  const [showIgnoredFiles, setShowIgnoredFiles] = useRecoilState(\n    showIgnoredFilesState\n  );\n  const viewOptions = { showRelatedFiles, showIgnoredFiles };\n\n  return (\n    <ActionButtonWithMenu\n      renderMenu={({ menuProps }) => (\n        <Menu\n          {...menuProps}\n          selectedKeys={Object.keys(viewOptions).filter(\n            (key) => viewOptions[key as keyof typeof viewOptions]\n          )}\n          onAction={(key) => {\n            switch (key) {\n              case \"showIgnoredFiles\":\n                return setShowIgnoredFiles((value) => !value);\n              case \"showRelatedFiles\":\n                return setShowRelatedFiles((value) => !value);\n            }\n          }}\n        >\n          <Item key=\"showIgnoredFiles\">Show Ignored Files</Item>\n          <Item key=\"showRelatedFiles\">\n            Show Files Related to Active Changelist\n          </Item>\n        </Menu>\n      )}\n    >\n      <PlatformIcon icon=\"actions/show.svg\" />\n    </ActionButtonWithMenu>\n  );\n};\n","import { ActionDefinition, PlatformIcon } from \"@intellij-platform/core\";\nimport React from \"react\";\nimport { useRecoilCallback } from \"recoil\";\nimport { openRollbackWindowForSelectionCallback } from \"./ChangesView/ChangesView.state\";\nimport { useChangeListManager } from \"./change-lists.state\";\n\nexport const ChangesViewActionIds = {\n  ROLLBACK: \"ChangesView.Revert\",\n  REFRESH: \"ChangesView.Refresh\",\n  SHELVE_SILENTLY: \"ChangesView.ShelveSilently\",\n  UNSHELVE_SILENTLY: \"ChangesView.UnshelveSilently\",\n  SHOW_DIFF: \"Diff.ShowDiff\", // Maybe doesn't belong here?\n};\n\nexport const useChangesViewActions = (): ActionDefinition[] => {\n  const openRollbackWindow = useRecoilCallback(\n    // FIXME: selection should be used to pre-include changes based on \"active path\" context, which can come from editor\n    //  projects pane, changes view, etc.\n    openRollbackWindowForSelectionCallback,\n    []\n  );\n  const { refresh } = useChangeListManager();\n\n  return [\n    {\n      id: ChangesViewActionIds.ROLLBACK,\n      title: \"Rollback...\",\n      icon: <PlatformIcon icon=\"actions/rollback.svg\" />,\n      actionPerformed: (event) => {\n        openRollbackWindow(Boolean(event));\n      },\n    },\n    {\n      id: ChangesViewActionIds.REFRESH,\n      title: \"Refresh\",\n      icon: <PlatformIcon icon=\"actions/refresh.svg\" />,\n      actionPerformed: refresh,\n    },\n    {\n      id: ChangesViewActionIds.SHOW_DIFF,\n      title: \"Show Diff\",\n      icon: <PlatformIcon icon=\"actions/diff.svg\" />,\n      actionPerformed: () => alert(\"Not implemented\"),\n    },\n    {\n      id: ChangesViewActionIds.SHELVE_SILENTLY,\n      title: \"Shelve Silently\",\n      icon: <PlatformIcon icon=\"vcs/shelveSilent.svg\" />,\n      actionPerformed: () => alert(\"Not implemented\"),\n    },\n  ];\n};\n","import {\n  ActionToolbar,\n  ActionToolbarSeparator,\n  ActionTooltip,\n  CommonActionId,\n  TooltipTrigger,\n} from \"@intellij-platform/core\";\nimport { ChangeListsActionButton } from \"./ActionButtons/ChangeListsActionButton\";\nimport { GroupByActionButton } from \"./ActionButtons/GroupByActionButton\";\nimport { ViewOptionsActionButton } from \"./ActionButtons/ViewOptionsActionButton\";\nimport React from \"react\";\nimport { Action } from \"@intellij-platform/core/ActionSystem/components\";\nimport { ChangesViewActionIds } from \"../useChangesViewActions\";\n\nexport function ChangesViewToolbar() {\n  return (\n    <ActionToolbar hasBorder>\n      <Action.Button actionId={ChangesViewActionIds.REFRESH} />\n      <Action.Button actionId={ChangesViewActionIds.ROLLBACK} />\n      <Action.Button actionId={ChangesViewActionIds.SHOW_DIFF} />\n      <TooltipTrigger tooltip={<ActionTooltip actionName=\"Changelists\" />}>\n        <ChangeListsActionButton />\n      </TooltipTrigger>\n      <Action.Button actionId={ChangesViewActionIds.SHELVE_SILENTLY} />\n      <ActionToolbarSeparator />\n      <TooltipTrigger tooltip={<ActionTooltip actionName=\"Group By\" />}>\n        <GroupByActionButton />\n      </TooltipTrigger>\n      <TooltipTrigger tooltip={<ActionTooltip actionName=\"View Options\" />}>\n        <ViewOptionsActionButton />\n      </TooltipTrigger>\n      <Action.Button actionId={CommonActionId.EXPAND_ALL} />\n      <Action.Button actionId={CommonActionId.COLLAPSE_ALL} />\n    </ActionToolbar>\n  );\n}\n","import React from \"react\";\nimport { Change } from \"./change-lists.state\";\nimport { StatusColor } from \"../FileStatusColor\";\n\nexport const ChangesSummary = ({\n  changes,\n}: {\n  changes: ReadonlyArray<Change>;\n}) => {\n  const modifiedCount = changes.filter(\n    (change) => change.after.path && change.before.path\n  ).length;\n  const addedCount = changes.filter(\n    (change) => change.after.path && !change.before.path\n  ).length;\n  const deletedCount = changes.filter(\n    (change) => change.before.path && !change.after.path\n  ).length;\n\n  return (\n    <>\n      {addedCount > 0 && (\n        <StatusColor status=\"ADDED\">{addedCount} added</StatusColor>\n      )}\n      {modifiedCount > 0 && (\n        <StatusColor status=\"MODIFIED\">{modifiedCount} modified</StatusColor>\n      )}\n      {deletedCount > 0 && (\n        <StatusColor status=\"DELETED\">{deletedCount} deleted</StatusColor>\n      )}\n    </>\n  );\n};\n","import styled from \"styled-components\";\nimport {\n  ActionButton,\n  ActionHelpTooltip,\n  ActionsProvider,\n  ActionTooltip,\n  Button,\n  Checkbox,\n  getAnchorOrientation,\n  PlatformIcon,\n  ThreeViewSplitter,\n  TooltipTrigger,\n  TreeRefValue,\n  useDefaultToolWindowContext,\n  useToolWindowState,\n  useTreeActions,\n} from \"@intellij-platform/core\";\nimport { useRecoilState, useRecoilValue } from \"recoil\";\nimport {\n  amendCommitState,\n  commitMessageSizeState,\n  commitMessageState,\n  includedChangesState,\n} from \"./ChangesView.state\";\nimport React, { useContext, useImperativeHandle, useRef } from \"react\";\nimport { ChangeViewTree } from \"./ChangeViewTree\";\nimport { ChangesViewToolbar } from \"./ChangesViewToolbar\";\nimport { ChangesSummary } from \"../ChangesSummary\";\n\nconst StyledContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n`;\n\nconst StyledTreeViewWrapper = styled.div`\n  flex: 1;\n  overflow: auto;\n`;\n\nconst StyledActionsRow = styled.div`\n  display: flex;\n  padding: 0.125rem;\n  position: relative;\n`;\n\nconst StyledAmendCheckbox = styled(Checkbox)`\n  padding-right: 0.625rem;\n`;\n\nconst StyledCommitMessageContainer = styled.div`\n  background: ${({ theme }) =>\n    theme.dark\n      ? \"#2b2b2b\" /*FIXME: should come from color scheme. attributes.TEXT.BACKGROUND*/\n      : \"#fff\"};\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst StyledCommitMessageTextArea = styled.textarea`\n  flex: 1;\n  background: none;\n  padding: 0.25rem 0.375rem;\n  color: ${({ theme }) =>\n    theme.dark\n      ? \"#a9b7c6\" /*FIXME: should come from color scheme. attributes.TEXT.BACKGROUND*/\n      : \"#000\"};\n  font-family: inherit;\n  border: none;\n  resize: none;\n  outline: none;\n`;\n\nconst StyledCommitActionsRow = styled.div`\n  display: flex;\n  gap: 0.3rem;\n  padding: 0.4rem;\n`;\n\nconst StyledChangesSummaryContainer = styled.span`\n  position: absolute;\n  right: 0.5rem;\n  top: 0.25rem;\n  background: ${({ theme }) => theme.color(\"Panel.background\")};\n  z-index: 1;\n`;\n\nconst ChangeViewContext = React.createContext({\n  focusCommitMessage: () => {},\n});\n\nexport const useChangeViewContext = () => useContext(ChangeViewContext);\n\nexport const ChangesViewSplitter = () => {\n  const {\n    state: { anchor },\n  } = useToolWindowState();\n  const treeRef = useRef<TreeRefValue>(null);\n  const editorRef = useRef<{ focus: () => void }>(null);\n  const orientation = getAnchorOrientation(anchor);\n  const [commitMessageSize, setCommitMessageSize] = useRecoilState(\n    commitMessageSizeState(orientation)\n  );\n  const treeActions = useTreeActions({ treeRef });\n  // TODO(lib-candidate): ToolWindowAwareSplitter. A wrapper around ThreeViewSplitter which sets orientation based\n  //  on anchor orientation from useToolWindowState.\n  return (\n    <ChangeViewContext.Provider\n      value={{\n        focusCommitMessage: () => {\n          setTimeout(() => {\n            editorRef.current?.focus();\n          });\n        },\n      }}\n    >\n      <ThreeViewSplitter\n        orientation={orientation}\n        innerView={\n          <ActionsProvider actions={treeActions}>\n            {({ shortcutHandlerProps }) => (\n              <StyledContainer {...shortcutHandlerProps}>\n                <ChangesViewToolbar />\n                <StyledTreeViewWrapper>\n                  <ChangeViewTree treeRef={treeRef} />\n                </StyledTreeViewWrapper>\n                <CommitActionsRow />\n              </StyledContainer>\n            )}\n          </ActionsProvider>\n        }\n        innerViewMinSize={50}\n        lastView={<CommitMessageEditorAndButtons editorRef={editorRef} />}\n        lastSize={commitMessageSize}\n        onLastResize={setCommitMessageSize}\n      />\n    </ChangeViewContext.Provider>\n  );\n};\n\nconst ChangesViewChangesSummary = () => {\n  const changes = useRecoilValue(includedChangesState);\n  return <ChangesSummary changes={changes} />;\n};\n\nfunction CommitActionsRow() {\n  const [amend, setAmend] = useRecoilState(amendCommitState);\n\n  return (\n    <StyledActionsRow>\n      <TooltipTrigger\n        tooltip={\n          <ActionHelpTooltip\n            actionName=\"Amend Commit\"\n            helpText=\"Modify the latest commit of the current branch\"\n          />\n        }\n      >\n        {(props) => (\n          <span {...props}>\n            <StyledAmendCheckbox\n              isSelected={amend}\n              onChange={setAmend}\n              preventFocus\n            >\n              Amend\n            </StyledAmendCheckbox>\n          </span>\n        )}\n      </TooltipTrigger>\n      <TooltipTrigger\n        tooltip={<ActionTooltip actionName=\"Show Commit Options\" />}\n      >\n        <ActionButton onPress={() => alert(\"Not implemented\")}>\n          <PlatformIcon icon=\"general/gear.svg\" />\n        </ActionButton>\n      </TooltipTrigger>\n      <TooltipTrigger\n        tooltip={<ActionTooltip actionName=\"Commit Message History\" />}\n      >\n        <ActionButton isDisabled onPress={() => alert(\"Not implemented\")}>\n          <PlatformIcon icon=\"vcs/historyInline.svg\" />\n        </ActionButton>\n      </TooltipTrigger>\n      <StyledChangesSummaryContainer>\n        <ChangesViewChangesSummary />\n      </StyledChangesSummaryContainer>\n    </StyledActionsRow>\n  );\n}\n\nfunction CommitMessageEditorAndButtons({\n  editorRef,\n}: {\n  editorRef: React.RefObject<{ focus: () => void }>;\n}) {\n  const commitMessageTextAreaRef = useRef<HTMLTextAreaElement>(null);\n  const [commitMessage, setCommitMessage] = useRecoilState(commitMessageState);\n\n  const { hasFocus } = useDefaultToolWindowContext();\n\n  useImperativeHandle(\n    editorRef,\n    () => ({\n      focus: () => {\n        commitMessageTextAreaRef.current?.focus();\n      },\n    }),\n    []\n  );\n\n  return (\n    <StyledCommitMessageContainer>\n      <StyledCommitMessageTextArea\n        ref={commitMessageTextAreaRef}\n        value={commitMessage}\n        onChange={(event) => {\n          setCommitMessage(event.target.value);\n        }}\n        placeholder=\"Commit Message\"\n        data-gramm=\"false\"\n      />\n      <StyledCommitActionsRow>\n        <Button\n          preventFocusOnPress\n          variant={hasFocus ? \"default\" : undefined}\n          onPress={() => {}}\n        >\n          Commit\n        </Button>\n        <Button preventFocusOnPress onPress={() => alert(\"Not implemented\")}>\n          Commit and Push...\n        </Button>\n      </StyledCommitActionsRow>\n    </StyledCommitMessageContainer>\n  );\n}\n","import React, { useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport { ChangesViewSplitter } from \"./ChangesViewSplitter\";\nimport { useChangeListManager } from \"../change-lists.state\";\n\nconst StyledContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n`;\n\nexport const ChangesViewPane = () => {\n  const { refresh } = useChangeListManager();\n  useEffect(() => {\n    refresh();\n  }, []);\n  // FIXME: Rollback window should be moved to upper levels. It should not be coupled with the changes view pane UI\n  return (\n    <StyledContainer>\n      <ChangesViewSplitter />\n    </StyledContainer>\n  );\n};\n","import { Selection } from \"@react-types/shared\";\nimport { TreeRefValue } from \"@intellij-platform/core\";\nimport React, { Key, RefObject } from \"react\";\nimport {\n  atom,\n  CallbackInterface,\n  GetRecoilValue,\n  selector,\n  useRecoilCallback,\n} from \"recoil\";\nimport { currentProjectState, Project } from \"../Project/project.state\";\nimport { dirContentState, FsItem } from \"../fs/fs.state\";\nimport { filterPath } from \"../Project/project-utils\";\nimport { getParentPaths } from \"../file-utils\";\nimport * as path from \"path\";\n\ninterface FileTreeNodeBase {\n  parent: (FileTreeNodeBase & { children: FsItem[] }) | null;\n  name: string;\n}\n\nexport type FileTreeDirNode = FileTreeNodeBase &\n  FsItem & {\n    children: FileTreeNode[];\n  };\nexport type FileTreeFileNode = FileTreeNodeBase & FsItem;\nexport type FileTreeNode = FileTreeFileNode | FileTreeDirNode;\n\ninterface ProjectTreeRoot extends FileTreeNodeBase {\n  type: \"project\";\n  path: string;\n  children: FileTreeNode[];\n}\n\nexport type ProjectTreeNode =\n  | ProjectTreeRoot\n  | ProjectTreeRoot[\"children\"][number]; // type def can be improved\n\nexport const foldersOnTopState = atom({\n  key: \"projectView.foldersOnTop\",\n  default: true,\n});\n\nexport const expandedKeysState = atom({\n  key: \"projectView.expandedKeys\",\n  default: selector({\n    key: \"projectView.expandedKeys/default\",\n    get: ({ get }) => new Set<Key>([get(currentProjectState).path]),\n  }),\n});\n\nexport const selectedKeysState = atom<Selection>({\n  key: \"projectView.selectedKeys\",\n  default: new Set<Key>([]),\n});\n\nexport const projectViewTreeRefState = atom<RefObject<TreeRefValue>>({\n  key: \"projectView.focusHandle\",\n  default: React.createRef(),\n  dangerouslyAllowMutability: true,\n});\n\nexport const currentProjectTreeState = selector({\n  key: \"projectTree\",\n  get: ({ get }) => {\n    const project = get(currentProjectState);\n    return createProjectTree(project, get);\n  },\n});\n\n// NOTE: this function could be sync, and those `await`s before `get` are unnecessary. They are there simply because\n// I didn't realize `get` returns the value, not Promise. But interestingly, when this function is made sync,\n// performance drastically drops for some reason. That needs to be investigated.\nasync function createProjectTree(\n  project: Project,\n  get: GetRecoilValue\n): Promise<ProjectTreeRoot> {\n  const rootItems = await get(dirContentState(project.path));\n  const mapItem =\n    (parent: FileTreeDirNode | null) =>\n    async (item: FsItem): Promise<FileTreeNode> => {\n      const name = path.basename(item.path);\n      const node = {\n        ...item,\n        name,\n        parent,\n      };\n      const dirNode: FileTreeDirNode = { ...node, children: [] };\n      if (item.type === \"dir\") {\n        dirNode.children = await Promise.all(\n          ((await get(dirContentState(item.path))) ?? ([] as FsItem[])).map(\n            mapItem(dirNode)\n          )\n        );\n      }\n      return item.type === \"dir\" ? dirNode : node;\n    };\n\n  return {\n    type: \"project\",\n    path: project.path,\n    name: project.name,\n    parent: null,\n    children: await Promise.all(\n      (rootItems || []).filter(filterPath).map(mapItem(null))\n    ),\n  };\n}\n\n/**\n * a function to be passed to useRecoilCallback to get back a callback for expanding to a certain path in project view.\n * @param snapshot\n * @param set\n */\nexport const expandToPathCallback =\n  ({ snapshot, set }: CallbackInterface) =>\n  (path: string) => {\n    const expandedKeys = snapshot.getLoadable(expandedKeysState).valueOrThrow();\n    const keysToExpand = [\n      snapshot.getLoadable(currentProjectState).valueOrThrow().path,\n    ].concat(getParentPaths(path));\n    set(expandedKeysState, new Set([...expandedKeys, ...keysToExpand]));\n  };\n\n/**\n * a function to be passed to useRecoilCallback to get back a callback for selecting a file in project view and focusing\n * the project view.\n * // TODO: open project view tool window if needed, when tool window state is also moved to recoil instead of local\n * //  state.\n */\nexport const selectKeyAndFocusCallback =\n  ({ snapshot }: CallbackInterface) =>\n  (key: Key) => {\n    const treeRef = snapshot\n      .getLoadable(projectViewTreeRefState)\n      .valueOrThrow()?.current;\n    treeRef?.replaceSelection(key);\n    treeRef?.focus(key);\n  };\n\nexport const useSelectPathInProjectView = () => {\n  const expandToOpenedFile = useRecoilCallback(expandToPathCallback, []);\n  const selectKeyAndFocus = useRecoilCallback(selectKeyAndFocusCallback, []);\n  return (path: string) => {\n    expandToOpenedFile(path);\n    selectKeyAndFocus(path);\n  };\n};\n","import {\n  HighlightedTextValue,\n  Item,\n  ItemLayout,\n  ItemStateContext,\n  PlatformIcon,\n  SpeedSearchTree,\n  TreeRefValue,\n} from \"@intellij-platform/core\";\nimport { identity, sortBy } from \"ramda\";\nimport React, { useContext, useLayoutEffect, useRef } from \"react\";\nimport { useRecoilState, useRecoilValue, useSetRecoilState } from \"recoil\";\nimport { DefaultSuspense } from \"../DefaultSuspense\";\nimport { useEditorStateManager } from \"../Editor/editor.state\";\nimport { DIR_ICON, FILE_ICON, getIconForFile } from \"../file-utils\";\nimport {\n  currentProjectState,\n  useActivePathsProvider,\n} from \"../Project/project.state\";\nimport {\n  currentProjectTreeState,\n  expandedKeysState,\n  FileTreeDirNode,\n  FileTreeFileNode,\n  FileTreeNode,\n  foldersOnTopState,\n  ProjectTreeNode,\n  projectViewTreeRefState,\n  selectedKeysState,\n} from \"./ProjectView.state\";\nimport { FileStatusColor } from \"../VersionControl/FileStatusColor\";\n\nexport const ProjectViewPane = (): React.ReactElement => {\n  const project = useRecoilValue(currentProjectState);\n  const editor = useEditorStateManager();\n  const treeRef = useRef<TreeRefValue>(null);\n  const setProjectViewTreeRef = useSetRecoilState(projectViewTreeRefState);\n  useLayoutEffect(() => {\n    setProjectViewTreeRef(treeRef);\n  }, [treeRef]);\n\n  const projectTree = useRecoilValue(currentProjectTreeState);\n\n  const [expandedKeys, setExpandedKeys] = useRecoilState(expandedKeysState);\n  const [selectedKeys, setSelectedKeys] = useRecoilState(selectedKeysState);\n  const foldersOnTop = useRecoilValue(foldersOnTopState);\n\n  const sortItems = foldersOnTop\n    ? sortBy<ProjectTreeNode>((a) => (a.type === \"dir\" ? 1 : 2))\n    : identity;\n\n  const selectedKeysArray =\n    selectedKeys === \"all\"\n      ? [] // FIXME\n      : [...selectedKeys].filter((i): i is string => typeof i === \"string\");\n  const { activePathsProviderProps } =\n    useActivePathsProvider(selectedKeysArray);\n\n  return (\n    <DefaultSuspense>\n      <SpeedSearchTree\n        ref={treeRef}\n        {...activePathsProviderProps}\n        items={[projectTree] as ProjectTreeNode[]}\n        onAction={(path) => {\n          editor.openPath(`${path}`);\n        }}\n        fillAvailableSpace\n        autoFocus\n        selectionMode=\"multiple\"\n        selectedKeys={selectedKeys}\n        onSelectionChange={setSelectedKeys}\n        expandedKeys={expandedKeys}\n        onExpandedChange={setExpandedKeys}\n      >\n        {(item) => (\n          <Item\n            key={item.path}\n            textValue={item.name}\n            childItems={\n              \"children\" in item ? sortItems(item.children) : undefined\n            }\n          >\n            <ItemLayout>\n              {<ProjectViewNodeIcon node={item} />}\n              {item.type === \"project\" ? (\n                <>\n                  <b>\n                    <HighlightedTextValue />\n                  </b>\n                  <ItemLayout.Hint>{project.path}</ItemLayout.Hint>\n                </>\n              ) : (\n                <FileTreeNodeText node={item} />\n              )}\n              {/* {\"loadingState\" in item &&\n                      item.loadingState === \"loading\" && (\n                        <TreeNodeHint>\n                          <Img height={16} src={loading} darkSrc={loadingDark} />\n                        </TreeNodeHint>\n                      )}*/}\n            </ItemLayout>\n          </Item>\n        )}\n      </SpeedSearchTree>\n    </DefaultSuspense>\n  );\n};\n\nconst FileTreeNodeText = ({ node }: { node: FileTreeNode }) => {\n  return node.type === \"dir\" ? (\n    // why is the explicit casting necessary? :/ isn't \"type\" enough for TS to figure out the right type?\n    <FileTreeDirNodeText node={node as FileTreeDirNode} />\n  ) : (\n    <FileTreeFileNodeText node={node as FileTreeFileNode} />\n  );\n};\n\nconst FileTreeDirNodeText = ({}: { node: FileTreeFileNode }) => (\n  // TODO: add support for \"Highlight directories that contain modified files in the Project tree\" (showDirtyRecursively)\n  <HighlightedTextValue />\n);\n\nconst FileTreeFileNodeText = ({\n  node,\n}: {\n  node: FileTreeFileNode;\n}): React.ReactElement => {\n  const state = useContext(ItemStateContext);\n  return state?.isSelected && state?.isContainerFocused ? (\n    <HighlightedTextValue />\n  ) : (\n    <FileStatusColor filepath={node.path}>\n      <HighlightedTextValue />\n    </FileStatusColor>\n  );\n};\n\nconst nodeTypeIconMap: { [key in ProjectTreeNode[\"type\"]]?: string } = {\n  project: \"nodes/folder\",\n  dir: DIR_ICON,\n  file: FILE_ICON,\n};\n\nfunction findNodeIcon(value: ProjectTreeNode): string | null {\n  if (value.type === \"file\") {\n    return getIconForFile(value.name);\n  }\n  return nodeTypeIconMap[value.type] ?? null;\n}\n\nfunction ProjectViewNodeIcon({\n  node,\n}: {\n  node: ProjectTreeNode;\n}): React.ReactElement {\n  const icon = findNodeIcon(node);\n  return <>{icon && <PlatformIcon icon={icon} />}</>;\n}\n","export const ProjectViewActionIds = {\n  SELECT_IN_PROJECT_VIEW: \"SelectInProjectView\",\n};\n","import React from \"react\";\nimport { useRecoilValue } from \"recoil\";\nimport {\n  ActionDefinition,\n  CommonActionId,\n  DefaultToolWindow,\n  PlatformIcon,\n  useTreeActions,\n} from \"@intellij-platform/core\";\nimport { Action } from \"@intellij-platform/core/ActionSystem/components\";\n\nimport {\n  projectViewTreeRefState,\n  useSelectPathInProjectView,\n} from \"./ProjectView.state\";\nimport { ProjectViewPane } from \"./ProjectViewPane\";\nimport { activeEditorTabState } from \"../Editor/editor.state\";\nimport { ProjectViewActionIds } from \"./ProjectViewActionIds\";\n\nconst { SELECT_IN_PROJECT_VIEW } = ProjectViewActionIds;\n\nexport function ProjectToolWindow() {\n  const treeRef = useRecoilValue(projectViewTreeRefState);\n  const actions = useTreeActions({ treeRef });\n  // TODO: SelectInProjectView should be provided at project level, allowing potential shortcut to be globally\n  //  accessible, and allowing other UI parts than editor's active tab, to set the context of \"file\" which needs to be\n  //  opened in project view.\n  const projectViewActions = useProjectViewActions();\n\n  return (\n    <DefaultToolWindow\n      headerContent=\"Project\"\n      actions={[...actions, ...projectViewActions]}\n      additionalActions={\n        <>\n          <Action.Button actionId={SELECT_IN_PROJECT_VIEW} />\n          <Action.Button actionId={CommonActionId.EXPAND_ALL} />\n          <Action.Button actionId={CommonActionId.COLLAPSE_ALL} />\n        </>\n      }\n    >\n      <ProjectViewPane />\n    </DefaultToolWindow>\n  );\n}\n\nfunction useProjectViewActions(): Array<ActionDefinition> {\n  // improvement: for rendering, we only depend on whether activeTab is null or not. A selector can be defined for that\n  // to prevent unnecessary re-rendering. The active tab, could be read from the state snapshot, in the handler callback.\n  const activeTab = useRecoilValue(activeEditorTabState);\n\n  const selectPathInProjectView = useSelectPathInProjectView();\n  const selectOpenedFile = () => {\n    if (activeTab) {\n      selectPathInProjectView(activeTab.filePath);\n    }\n  };\n\n  return [\n    {\n      id: SELECT_IN_PROJECT_VIEW,\n      title: \"Select Opened File\",\n      icon: <PlatformIcon icon=\"general/locate\" />,\n      actionPerformed: selectOpenedFile,\n      isDisabled: !activeTab,\n      description: \"Selects a context file in the Project View\",\n    },\n  ];\n}\n","import React from \"react\";\nimport {\n  DefaultToolWindow,\n  MultiViewToolWindow,\n  PlatformIcon,\n  ToolWindowState,\n  toolWindowState,\n} from \"@intellij-platform/core\";\nimport { Terminal } from \"../Terminal\";\nimport { ChangesViewPane } from \"../VersionControl/Changes/ChangesView/ChangesViewPane\";\nimport { CurrentBranchName } from \"../VersionControl/CurrentBranchName\";\nimport { ProjectToolWindow } from \"../ProjectView/ProjectToolWindow\";\n\nexport type ToolWindowDescriptor = {\n  id: string;\n  title: string;\n  icon: React.ReactNode;\n  content: React.ReactElement;\n  initialState: ToolWindowState;\n};\nexport const toolWindows: ToolWindowDescriptor[] = [\n  {\n    id: \"Project\",\n    title: \"Project\",\n    icon: <PlatformIcon icon=\"toolwindows/toolWindowProject\" />,\n    content: <ProjectToolWindow />,\n    initialState: toolWindowState({ isVisible: true, weight: 0.23 }),\n  },\n  {\n    id: \"Terminal\",\n    title: \"Terminal\",\n    icon: <PlatformIcon icon=\"toolwindows/toolWindowProject\" />,\n    content: (\n      <DefaultToolWindow headerContent=\"Terminal\">\n        <Terminal />\n      </DefaultToolWindow>\n    ),\n    initialState: toolWindowState({ anchor: \"bottom\" }),\n  },\n  {\n    id: \"Commit\",\n    title: \"Commit\",\n    icon: <PlatformIcon icon=\"toolwindows/toolWindowCommit\" />,\n    content: (\n      <MultiViewToolWindow>\n        <MultiViewToolWindow.View\n          tabContent={\n            <>\n              Commit to <CurrentBranchName />\n            </>\n          }\n          key=\"commit\"\n        >\n          <ChangesViewPane />\n        </MultiViewToolWindow.View>\n      </MultiViewToolWindow>\n    ),\n    initialState: toolWindowState({ anchor: \"left\", isVisible: false }),\n  },\n];\n","import { atom, useSetRecoilState } from \"recoil\";\nimport { BalloonActionLink, useBalloonManager } from \"@intellij-platform/core\";\nimport React, { useEffect } from \"react\";\n// @ts-expect-error caf doesn't have typing :/\nimport { CAF } from \"caf\";\nimport { persistentFsPreference, switchToPersistentFS } from \"./fs/fs\";\nimport path from \"path\";\n\nexport interface ProcessState {\n  state:\n    | \"STARTED\"\n    | \"PAUSED\"\n    | \"PAUSING\"\n    | \"CANCELED\"\n    | \"CANCELING\"\n    | \"FINISHED\";\n  /**\n   * between 1 and 100\n   */\n  progress: number;\n  isIndeterminate: boolean;\n  name: string;\n  details: string;\n  onCancel?: () => void;\n  onPause?: () => void;\n}\n\nexport const switchToPersistentFsProcess = atom<ProcessState | null>({\n  key: \"switchToPersistentFsProcess\",\n  default: null,\n});\n\nexport function usePersistenceFsNotification() {\n  const balloons = useBalloonManager();\n  const setProcessState = useSetRecoilState(switchToPersistentFsProcess);\n\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      if (persistentFsPreference.get() == undefined) {\n        balloons.showSticky({\n          title: \"Switch to IndexedDB filesystem\",\n          body: \"By default an in-memory filesystem is used to have a faster git clone. But it means all changes will be lost upon refresh. You can switch in the background to a persistence fs implementation which uses IndexedDB to store files.\",\n          actions: (\n            <>\n              <BalloonActionLink\n                onPress={() => {\n                  const token = new CAF.cancelToken();\n                  setProcessState({\n                    details: \"Copying ...\",\n                    isIndeterminate: true,\n                    state: \"STARTED\",\n                    progress: 0,\n                    onCancel: () => {\n                      token.abort(\"canceled\");\n                    },\n                    name: \"Switching to IndexedDB FS\",\n                  });\n                  const update = (updates: Partial<ProcessState>) =>\n                    setProcessState((state) =>\n                      state ? { ...state, ...updates } : null\n                    );\n                  switchToPersistentFS({\n                    cancelSignal: token.signal,\n                    onCopy: (filepath) => {\n                      update({ name: `Copying ${path.dirname(filepath)}` });\n                    },\n                  })\n                    .then(() => {\n                      persistentFsPreference.set(\"yes\");\n                    })\n                    .catch((e) => {\n                      if (e !== \"canceled\") {\n                        console.error(\n                          \"Error during switch to persistent FS:\",\n                          e\n                        );\n                      }\n                    })\n                    .finally(() => {\n                      setProcessState(null);\n                    });\n                }}\n              >\n                Switch to IndexedDB FS\n              </BalloonActionLink>\n              <BalloonActionLink\n                onPress={() => persistentFsPreference.set(\"no\")}\n              >\n                Don't ask again\n              </BalloonActionLink>\n            </>\n          ),\n        });\n      }\n    }, 3000);\n    return () => clearTimeout(timeoutId);\n  }, []);\n}\n","import { selector, selectorFamily } from \"recoil\";\nimport git from \"isomorphic-git\";\nimport { fs } from \"../fs/fs\";\nimport { repoCurrentBranch, vcsRootsState } from \"./file-status.state\";\n\nconst repoLocalBranchesState = selectorFamily({\n  key: \"vcs/repoLocalBranches\",\n  get:\n    (repoRoot: string) =>\n    ({ get }) => {\n      return git.listBranches({ fs, dir: repoRoot }).then((branches) => {\n        const currentBranch = get(repoCurrentBranch(repoRoot));\n        return Promise.all(\n          branches.map(async (branch) => ({\n            name: branch,\n            isCurrent: currentBranch === branch,\n            trackingBranch: await getTrackingBranch({\n              fs,\n              dir: repoRoot,\n              branch,\n            }),\n          }))\n        );\n      });\n    },\n});\nconst repoRemoteBranchesState = selectorFamily({\n  key: \"vcs/repoRemoteBranches\",\n  get: (repoRoot: string) => async () => {\n    const remotes = await git.listRemotes({ fs, dir: repoRoot });\n    return (\n      await Promise.all(\n        remotes.map(({ remote }) =>\n          git\n            .listBranches({ fs, dir: repoRoot, remote })\n            .then((branches) =>\n              branches\n                .filter((branch) => branch !== \"HEAD\")\n                .map((branch) => `${remote}/${branch}`)\n            )\n        )\n      )\n    ).flat();\n  },\n});\n\nexport const allBranchesState = selector({\n  key: \"vcs/allBranches\",\n  get: ({ get }) => {\n    const repoRoots = get(vcsRootsState);\n    return repoRoots.map(({ dir: repoRoot }) => ({\n      repoRoot,\n      localBranches: get(repoLocalBranchesState(repoRoot)),\n      remoteBranches: get(repoRemoteBranchesState(repoRoot)),\n    }));\n  },\n});\n\nasync function getTrackingBranch({\n  fs,\n  dir,\n  branch,\n}: Pick<Parameters<typeof git[\"getConfig\"]>[0], \"fs\" | \"dir\"> & {\n  branch: string;\n}): Promise<string | null> {\n  const mergeRef = await git.getConfig({\n    fs,\n    dir,\n    path: `branch.${branch}.merge`,\n  });\n  const remote = await git.getConfig({\n    fs,\n    dir,\n    path: `branch.${branch}.remote`,\n  });\n  return mergeRef && remote\n    ? `${remote}/${mergeRef.replace(/^refs\\/heads\\//, \"\")}`\n    : null;\n}\n","import path from \"path\";\nimport React from \"react\";\nimport {\n  AutoHoverPlatformIcon,\n  Divider,\n  Item,\n  ItemLayout,\n  MenuItemLayout,\n  PlatformIcon,\n  Popup,\n  PopupLayout,\n  Section,\n  SpeedSearchMenu,\n} from \"@intellij-platform/core\";\n\nimport {\n  useLatestRecoilValue,\n  // useRefreshRecoilValueOnMount,\n} from \"../../recoil-utils\";\nimport { allBranchesState } from \"../branches.state\";\n\nexport function BranchesPopupContent({ onClose }: { onClose: () => void }) {\n  const repoBranches = useLatestRecoilValue(allBranchesState);\n  // useRefreshRecoilValueOnMount(allBranchesState);\n\n  const isFavoriteBranch = (branch: string) => branch === \"master\"; // TODO;\n\n  if (!repoBranches) {\n    return null;\n  }\n  const title =\n    repoBranches.length === 1\n      ? `Git Branches in ${path.basename(repoBranches[0].repoRoot)}`\n      : \"Git Branches\";\n  return (\n    <PopupLayout\n      header={<Popup.Header>{title}</Popup.Header>}\n      content={\n        <SpeedSearchMenu\n          aria-label={title}\n          submenuBehavior=\"toggleOnPress\"\n          fillAvailableSpace\n          autoFocus=\"first\"\n          disabledKeys={repoBranches.flatMap(({ localBranches, repoRoot }) =>\n            localBranches\n              .filter(({ trackingBranch }) => !trackingBranch)\n              .map(({ name }) => `${repoRoot}/pull-${name}`)\n          )}\n          onAction={() => alert(\"Not implemented\")}\n          onClose={onClose}\n        >\n          <Item key=\"new_branch\" textValue=\"New Branch\">\n            <MenuItemLayout\n              icon={<PlatformIcon icon=\"general/add.svg\" />}\n              content=\"New Branch\"\n            />\n          </Item>\n          <Item key=\"checkout_revision\">Checkout Tag or Revision...</Item>\n          {\n            repoBranches.flatMap(\n              ({ remoteBranches, localBranches, repoRoot }) => {\n                const currentBranch = localBranches.find(\n                  ({ isCurrent }) => isCurrent\n                )?.name;\n                const getSectionLabel = (label: string) =>\n                  repoBranches.length > 1\n                    ? `${label} in ${path.basename(repoBranches[0].repoRoot)}`\n                    : label;\n                const compareActions = (\n                  branchName: string,\n                  isCurrent: boolean\n                ) => [\n                  !isCurrent && (\n                    <Item\n                      key={`${repoRoot}/compare-with-branch-${branchName}`}\n                    >{`Compare with '${branchName}'`}</Item>\n                  ),\n                  <Item\n                    key={`${repoRoot}/show-diff-with-working-tree-${branchName}`}\n                  >\n                    Show Diff with Working Tree\n                  </Item>,\n                  <Divider />,\n                ];\n                const newBranchActions = (\n                  branchName: string,\n                  isCurrent: boolean\n                ) => [\n                  !isCurrent && (\n                    <Item key={`${repoRoot}/checkout-${branchName}`}>\n                      Checkout\n                    </Item>\n                  ),\n                  <Item\n                    key={`${repoRoot}/new-branch-from-${branchName}`}\n                  >{`New Branch from '${branchName}'...`}</Item>,\n                  !isCurrent && (\n                    <Item\n                      key={`${repoRoot}/checkout-and-rebase-onto-${branchName}`}\n                    >{`Checkout and rebase onto '${branchName}'`}</Item>\n                  ),\n                  <Divider />,\n                ];\n                const mergeActions = (\n                  branchName: string,\n                  currentBranch: string | undefined\n                ) =>\n                  currentBranch &&\n                  branchName !== currentBranch && [\n                    <Item\n                      key={`${repoRoot}/rebase-current-onto-${branchName}`}\n                    >{`Rebase '${currentBranch}' onto '${branchName}'`}</Item>,\n                    <Item\n                      key={`${repoRoot}/merge-into-current-${branchName}`}\n                    >{`Merge '${branchName}' onto '${currentBranch}'`}</Item>,\n                    <Divider />,\n                  ];\n\n                return [\n                  <Section title={getSectionLabel(\"Local Branches\")}>\n                    {localBranches.map(\n                      ({ name, trackingBranch, isCurrent }) => {\n                        return (\n                          <Item\n                            key={`${repoRoot}/branch-${name}`}\n                            textValue={name}\n                            title={\n                              <MenuItemLayout\n                                content={name}\n                                icon={\n                                  isFavoriteBranch(name) ? (\n                                    <PlatformIcon icon=\"nodes/favorite.svg\" />\n                                  ) : (\n                                    <AutoHoverPlatformIcon\n                                      icon=\"nodes/emptyNode.svg\"\n                                      hoverIcon=\"nodes/notFavoriteOnHover.svg\"\n                                      hoverContainerSelector=\"[role='menuitem']\"\n                                    />\n                                  )\n                                }\n                                shortcut={\n                                  trackingBranch && (\n                                    <ItemLayout.Hint small>\n                                      {trackingBranch}\n                                    </ItemLayout.Hint>\n                                  )\n                                }\n                              />\n                            }\n                          >\n                            {newBranchActions(name, isCurrent)}\n                            {compareActions(name, isCurrent)}\n                            {mergeActions(name, currentBranch)}\n                            <Item key={`${repoRoot}/pull-${name}`}>Update</Item>\n                            <Item key={`${repoRoot}/push-${name}`}>\n                              Push...\n                            </Item>\n                            <Divider />\n                            <Item key={`${repoRoot}/rename-${name}`}>\n                              Rename...\n                            </Item>\n                            {!isCurrent && (\n                              <Item key={`${repoRoot}/delete-${name}`}>\n                                Delete\n                              </Item>\n                            )}\n                          </Item>\n                        );\n                      }\n                    )}\n                  </Section>,\n                  <Section title={getSectionLabel(\"Remote Branches\")}>\n                    {remoteBranches.map((branchName) => (\n                      <Item\n                        key={`${repoRoot}/branch-${branchName}`}\n                        textValue={branchName}\n                        title={\n                          <MenuItemLayout\n                            content={branchName}\n                            icon={\n                              isFavoriteBranch(branchName) ? (\n                                <PlatformIcon icon=\"nodes/favorite.svg\" />\n                              ) : (\n                                <AutoHoverPlatformIcon\n                                  icon=\"nodes/emptyNode.svg\"\n                                  hoverIcon=\"nodes/notFavoriteOnHover.svg\"\n                                  hoverContainerSelector=\"[role='menuitem']\"\n                                />\n                              )\n                            }\n                          />\n                        }\n                      >\n                        {newBranchActions(branchName, false)}\n                        {compareActions(branchName, false)}\n                        {mergeActions(branchName, currentBranch)}\n                        <Item\n                          key={`${repoRoot}/pull-into-using-merge-${branchName}`}\n                        >{`Pull into '${branchName}' Using Merge`}</Item>\n                        <Item\n                          key={`${repoRoot}/pull-into-using-rebase-${branchName}`}\n                        >{`Pull into '${branchName}' Using Rebase`}</Item>\n                        <Divider />\n                        <Item key={`${repoRoot}/delete-${branchName}`}>\n                          Delete\n                        </Item>\n                      </Item>\n                    ))}\n                  </Section>,\n                ];\n              }\n            ) as any\n          }\n        </SpeedSearchMenu>\n      }\n    />\n  );\n}\n","import { selector } from \"recoil\";\nimport { activeEditorTabState } from \"../Editor/editor.state\";\nimport {\n  branchForFile,\n  vcsRootForFile,\n  vcsRootsState,\n} from \"./file-status.state\";\n\n/**\n * Repo root of the file opened in the active editor tab.\n */\nexport const activeFileRepoRoot = selector({\n  key: \"vcs/activeFileRepo\",\n  get: ({ get }) => {\n    const activeFile = get(activeEditorTabState)?.filePath;\n    const activeFileRepo = activeFile && get(vcsRootForFile(activeFile));\n    return activeFileRepo ?? get(vcsRootsState)[0]?.dir;\n  },\n});\n/**\n * Current branch of the file opened in the active editor tab.\n */\nexport const activeFileCurrentBranch = selector({\n  key: \"vcs/activeFileCurrentBranch\",\n  get: ({ get }) => branchForFile(get(activeFileRepoRoot)),\n});\n","import {\n  ActionTooltip,\n  Divider,\n  Item,\n  Menu,\n  MenuItemLayout,\n  MenuTrigger,\n  PlatformIcon,\n  PopupOnTrigger,\n  ProgressBar,\n  ProgressBarPauseButton,\n  ProgressBarStopButton,\n  StatusBar,\n  StatusBarWidget,\n  TooltipTrigger,\n} from \"@intellij-platform/core\";\nimport React, { useState } from \"react\";\nimport styled from \"styled-components\";\nimport { useRecoilValue } from \"recoil\";\nimport { editorCursorPositionState } from \"../Editor/editor.state\";\nimport { switchToPersistentFsProcess } from \"../usePersistenceFsNotification\";\nimport { BranchesPopupContent } from \"../VersionControl/Branches/BranchesPopupContent\";\nimport { activeFileCurrentBranch } from \"../VersionControl/active-file.state\";\n\nconst StyledLastMessage = styled.div`\n  margin-left: 0.75rem;\n  cursor: pointer;\n`;\n\nconst StatusBarProcess = () => {\n  const process = useRecoilValue(switchToPersistentFsProcess);\n\n  return (\n    process && (\n      <ProgressBar\n        name={process.name}\n        isIndeterminate={process.isIndeterminate}\n        value={process.progress}\n        dense\n        namePosition=\"side\"\n        width={146}\n        button={\n          <>\n            {process.onPause && (\n              <ProgressBarPauseButton\n                small\n                paused={false}\n                onPausedChange={() => {}}\n              />\n            )}\n            {process.onCancel && (\n              <ProgressBarStopButton small onPress={process.onCancel} />\n            )}\n          </>\n        }\n      />\n    )\n  );\n};\n\nexport const IdeStatusBar = () => {\n  const cursorPosition = useRecoilValue(editorCursorPositionState);\n  const currentBranch = useRecoilValue(activeFileCurrentBranch);\n  const [isBranchesPopupOpen, setBranchesPopupOpen] = useState(false);\n\n  return (\n    <StatusBar\n      left={\n        <>\n          <PlatformIcon\n            icon=\"general/tbHidden.svg\"\n            role=\"button\"\n            onClick={() => alert(\"Not implemented\")}\n          />\n          <StyledLastMessage>\n            Tooltip content or last message will show up here.\n          </StyledLastMessage>\n        </>\n      }\n      right={\n        <>\n          {<StatusBarProcess />}\n          <StatusBarWidget\n            onPress={() => alert(\"Not implemented\")}\n            label=\"LF\"\n          />\n          <StatusBarWidget\n            onPress={() => alert(\"Not implemented\")}\n            label={`${cursorPosition.lineNumber},${cursorPosition.column}`}\n          />\n          <StatusBarWidget label=\"UTF-8\" />\n          <MenuTrigger\n            renderMenu={({ menuProps }) => (\n              <Menu\n                {...menuProps}\n                onAction={() => {\n                  alert(\"Not implemented\");\n                }}\n              >\n                <Item>Configure Indents for Typescript</Item>\n                <Item>Disable Indents Detection for Project</Item>\n              </Menu>\n            )}\n          >\n            {(props, ref) => (\n              <StatusBarWidget {...props} ref={ref} label=\"2 spaces\" />\n            )}\n          </MenuTrigger>\n          <MenuTrigger\n            renderMenu={({ menuProps }) => (\n              <Menu\n                {...menuProps}\n                onAction={() => {\n                  alert(\"Not implemented\");\n                }}\n              >\n                <Item title=\"Compile\">\n                  <Item>packages/jui/tsconfig.json</Item>\n                  <Item>packages/jui/src/StatusBar/StatusBar.stories.tsx</Item>\n                  <Item>Compile All</Item>\n                </Item>\n                <Divider />\n                <Item>\n                  <MenuItemLayout\n                    icon={\n                      <PlatformIcon icon=\"javaee/updateRunningApplication.svg\" />\n                    }\n                    content=\"Restart Typescript Service\"\n                  />\n                </Item>\n                <Item>\n                  <MenuItemLayout\n                    icon={<PlatformIcon icon=\"general/settings.svg\" />}\n                    content=\"Configure Typescript...\"\n                  />\n                </Item>\n              </Menu>\n            )}\n          >\n            {(props, ref) => (\n              <StatusBarWidget {...props} ref={ref} label=\"TypeScript 4.4.3\" />\n            )}\n          </MenuTrigger>\n          <PopupOnTrigger\n            isOpen={isBranchesPopupOpen}\n            onOpenChange={setBranchesPopupOpen}\n            placement=\"top\"\n            interactions=\"all\"\n            trigger={\n              <TooltipTrigger\n                tooltip={\n                  <ActionTooltip actionName={`Git Branch: ${currentBranch}`} />\n                }\n              >\n                <StatusBarWidget\n                  icon={<PlatformIcon icon=\"vcs/branch.svg\" />}\n                  label={currentBranch}\n                />\n              </TooltipTrigger>\n            }\n          >\n            <BranchesPopupContent onClose={() => setBranchesPopupOpen(false)} />{\" \"}\n          </PopupOnTrigger>\n          <StatusBarWidget icon={<PlatformIcon icon=\"ide/readwrite.svg\" />} />\n          <StatusBarWidget icon={<PlatformIcon icon=\"ide/fatalError.svg\" />} />\n        </>\n      }\n    />\n  );\n};\n","import {\n  Item,\n  Menu,\n  MenuItemLayout,\n  PlatformIcon,\n} from \"@intellij-platform/core\";\nimport React from \"react\";\n\nexport const RollbackTreeContextMenu = () => {\n  const disabledKeys = [\"showDiff\"];\n\n  return (\n    <Menu\n      disabledKeys={disabledKeys}\n      aria-label=\"Context menu\"\n      onAction={() => {\n        alert(\"Not implemented\");\n      }}\n    >\n      <Item key=\"showDiff\" textValue=\"Show Diff\">\n        <MenuItemLayout\n          icon={<PlatformIcon icon={\"actions/diff.svg\"} />}\n          content=\"Show Diff\"\n        />\n      </Item>\n    </Menu>\n  );\n};\n","import React, { Key, useRef, useState } from \"react\";\nimport { useRecoilState, useRecoilValue, useSetRecoilState } from \"recoil\";\nimport { Selection } from \"@react-types/shared\";\nimport {\n  ActionButton,\n  ActionButtonWithMenu,\n  ActionsProvider,\n  ActionToolbar,\n  Button,\n  Checkbox,\n  CommonActionId,\n  ContextMenuContainer,\n  Item,\n  Menu,\n  ModalWindow,\n  PlatformIcon,\n  Section,\n  SpeedSearchTreeWithCheckboxes,\n  styled,\n  TreeNodeCheckbox,\n  TreeRefValue,\n  useBalloonManager,\n  useNestedSelectionState,\n  useTreeActions,\n  WindowLayout,\n} from \"@intellij-platform/core\";\nimport { Action } from \"@intellij-platform/core/ActionSystem/components\";\n\nimport {\n  AnyNode,\n  changesTreeNodesState,\n  getNodeKeyForChange,\n  isGroupNode,\n} from \"../ChangesView/ChangesView.state\";\nimport { getChangeListTreeItemProps } from \"../ChangesView/changesTreeNodeRenderers\";\nimport { rollbackViewState } from \"./rollbackView.state\";\nimport { allChangesState, useChangeListManager } from \"../change-lists.state\";\nimport { ChangesSummary } from \"../ChangesSummary\";\nimport { groupings } from \"../ChangesView/changesGroupings\";\nimport { RollbackTreeContextMenu } from \"./RollbackTreeContextMenu\";\n\nconst StyledContainer = styled.div`\n  box-sizing: border-box;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem 0.75rem 0;\n`;\nconst StyledFrame = styled.div`\n  border: 1px solid ${({ theme }) => theme.commonColors.contrastBorder};\n  flex: 1;\n  overflow: auto;\n`;\n\nconst StyledLine = styled.div`\n  line-height: 2;\n  padding-left: 0.5rem;\n`;\n\nexport function RollbackWindow() {\n  const defaultExpandedKeys = useRecoilValue(\n    rollbackViewState.initiallyExpandedKeys\n  );\n  const initiallyIncludedChangeKeys = useRecoilValue(\n    rollbackViewState.initiallyIncludedChanges\n  ).map(getNodeKeyForChange);\n  const { fileCountsMap } = useRecoilValue(changesTreeNodesState);\n  const [windowBounds, setWindowBounds] = useRecoilState(\n    rollbackViewState.windowBounds\n  );\n  const rootNodes = useRecoilValue(rollbackViewState.rootNodes);\n  const [selectedKeys, setSelectedKeys] = useState<Selection>(\n    new Set<Key>(initiallyIncludedChangeKeys.slice(0, 1))\n  );\n  const [expandedKeys, setExpandedKeys] =\n    useState<Set<Key>>(defaultExpandedKeys);\n  const [includedChangeKeys, setIncludedChangeKeys] = useState(\n    new Set<Key>(initiallyIncludedChangeKeys)\n  );\n  const nestedSelection = useNestedSelectionState<AnyNode>(\n    {\n      rootNodes,\n      getKey: (node) => node.key,\n      getChildren: (node) => (isGroupNode(node) ? node.children : null),\n    },\n    {\n      selectedKeys: includedChangeKeys,\n      onSelectedKeysChange: setIncludedChangeKeys,\n    }\n  );\n  const allChanges = useRecoilValue(allChangesState);\n  const includedChanges = allChanges.filter((change) =>\n    includedChangeKeys.has(getNodeKeyForChange(change))\n  );\n  const changeListManager = useChangeListManager();\n  const balloons = useBalloonManager();\n  const setOpen = useSetRecoilState(rollbackViewState.isOpen);\n  const close = () => setOpen(false);\n\n  const treeRef = useRef<TreeRefValue>(null);\n  const treeActions = useTreeActions({ treeRef });\n\n  return (\n    <ModalWindow\n      title=\"Rollback changes\"\n      onClose={close}\n      bounds={windowBounds}\n      onBoundsChange={setWindowBounds}\n      minHeight={200}\n      minWidth={275}\n      footer={\n        <>\n          <div\n            style={{\n              padding: \"0 .75rem\",\n              display: \"flex\",\n              flexDirection: \"column\",\n            }}\n          >\n            <StyledLine>\n              <ChangesSummary changes={includedChanges} />\n            </StyledLine>\n            <Checkbox isDisabled>\n              Delete local copies of the added files\n            </Checkbox>\n          </div>\n          <WindowLayout.Footer\n            right={\n              <>\n                <Button onPress={close}>Cancel</Button>\n                <Button\n                  variant=\"default\"\n                  onPress={() => {\n                    changeListManager\n                      .rollback(includedChanges)\n                      .catch((e) => {\n                        balloons.show({\n                          title: \"Reverting changes failed\",\n                          icon: \"Error\",\n                          body: \"Could not revert selected changes. See console for more info\",\n                        });\n                        console.error(\"Git revert error:\", e);\n                      })\n                      .finally(close);\n                  }}\n                >\n                  Rollback\n                </Button>\n              </>\n            }\n          />\n        </>\n      }\n    >\n      <ActionsProvider actions={treeActions}>\n        {({ shortcutHandlerProps }) => (\n          <StyledContainer {...shortcutHandlerProps}>\n            <div style={{ display: \"flex\" }}>\n              <ActionToolbar>\n                <ActionButton isDisabled>\n                  <PlatformIcon icon=\"actions/diff\" />\n                </ActionButton>\n                <ActionButtonWithMenu\n                  renderMenu={({ menuProps }) => (\n                    <Menu\n                      {...menuProps}\n                      selectedKeys={[] /* FIXME */}\n                      onAction={(key) => {\n                        // FIXME\n                        alert(\"not implemented\");\n                      }}\n                    >\n                      <Section title=\"Group By\">\n                        {\n                          // FIXME\n                          groupings.map((grouping) => (\n                            <Item key={grouping.id}>{grouping.title}</Item>\n                          ))\n                        }\n                      </Section>\n                    </Menu>\n                  )}\n                >\n                  <PlatformIcon icon=\"actions/groupBy.svg\" />\n                </ActionButtonWithMenu>\n              </ActionToolbar>\n              <span style={{ flex: 1 }} />\n              <ActionToolbar>\n                <Action.Button actionId={CommonActionId.EXPAND_ALL} />\n                <Action.Button actionId={CommonActionId.COLLAPSE_ALL} />\n              </ActionToolbar>\n            </div>\n\n            <StyledFrame>\n              <ContextMenuContainer\n                renderMenu={() => <RollbackTreeContextMenu />}\n                style={{ height: \"100%\" }}\n              >\n                <SpeedSearchTreeWithCheckboxes\n                  ref={treeRef}\n                  items={rootNodes}\n                  selectionMode=\"multiple\"\n                  selectedKeys={selectedKeys}\n                  onSelectionChange={setSelectedKeys}\n                  expandedKeys={expandedKeys}\n                  onExpandedChange={setExpandedKeys}\n                  nestedSelection={nestedSelection}\n                  fillAvailableSpace\n                >\n                  {(node) => {\n                    const props = getChangeListTreeItemProps({\n                      node,\n                      fileCountsMap,\n                    });\n                    return (\n                      <Item {...props}>\n                        {node.children?.length !== 0 && (\n                          <TreeNodeCheckbox\n                            selectionState={nestedSelection.getSelectionState(\n                              node\n                            )}\n                            onToggle={() => nestedSelection.toggle(node)}\n                          />\n                        )}\n                        {props.children}\n                      </Item>\n                    );\n                  }}\n                </SpeedSearchTreeWithCheckboxes>\n              </ContextMenuContainer>\n            </StyledFrame>\n          </StyledContainer>\n        )}\n      </ActionsProvider>\n    </ModalWindow>\n  );\n}\n","import { atom } from \"recoil\";\nimport { ToolWindowsState } from \"@intellij-platform/core\";\nimport { toolWindows } from \"./toolWindows\";\n\nexport const toolWindowsState = atom({\n  key: \"toolWindows\",\n  default: new ToolWindowsState(\n    Object.fromEntries(\n      toolWindows.map(({ id, initialState }) => [id, initialState])\n    )\n  ),\n});\n","import { useMemo, useState } from \"react\";\nimport {\n  CommonActionId,\n  shortcutToString,\n  useKeymap,\n} from \"@intellij-platform/core\";\n\nconst tips = [\n  {\n    actionId: CommonActionId.EXPAND_SELECTION,\n    title: \"Press $shortcut to expand selection\",\n  },\n  {\n    actionId: CommonActionId.SHRINK_SELECTION,\n    title: \"Press $shortcut to shrink selection\",\n  },\n];\n\nexport const useTips = () => {\n  const keymap = useKeymap();\n\n  const renderedTips = useMemo(\n    () =>\n      tips\n        .map(({ actionId, title }) => ({\n          keyboardShortcut: keymap?.[actionId]?.find(\n            (shortcut) => shortcut.type === \"keyboard\"\n          ),\n          title,\n        }))\n        .filter(({ keyboardShortcut }) => keyboardShortcut)\n        .map(({ keyboardShortcut, title }) =>\n          title.replace(\"$shortcut\", shortcutToString(keyboardShortcut!))\n        ),\n    [keymap]\n  );\n  const [index, setIndex] = useState(\n    Math.floor(Math.random() * renderedTips.length)\n  );\n  return {\n    current: renderedTips[index],\n    next: () => {\n      const tmpIndex = Math.floor(Math.random() * (renderedTips.length - 1));\n      const newIndex = tmpIndex < index ? tmpIndex : tmpIndex + 1; // making sure index will be changed\n      console.log(\"changing index to\", newIndex, \"tmpIndex\", tmpIndex);\n      setIndex(newIndex);\n    },\n  };\n};\n","import React, { ForwardedRef, HTMLProps } from \"react\";\nimport { mergeProps, useObjectRef } from \"@react-aria/utils\";\nimport { useFocusable } from \"@react-aria/focus\";\n\nexport const Input = React.forwardRef(function Input(\n  props: HTMLProps<HTMLInputElement>,\n  forwardedRef: ForwardedRef<HTMLInputElement>\n) {\n  const ref = useObjectRef(forwardedRef);\n  // NOTE: it's important not to pass all props to useFocusable (or not to merge returned props with ALL props), as it\n  // results for duplicate event handling, for events like onKeyDown that is handled by useFocusable too.\n  const { focusableProps } = useFocusable({ autoFocus: props.autoFocus }, ref);\n  return <input {...mergeProps(focusableProps, props)} ref={ref} />;\n});\n","import { Bounds } from \"@intellij-platform/core\";\nimport { atom, atomFamily } from \"recoil\";\n\nexport type SearchEveryWhereTab =\n  | \"All\"\n  | \"Classes\"\n  | \"Files\"\n  | \"Symbols\"\n  | \"Actions\"\n  | \"Git\";\n\nexport const searchEverywhereState = {\n  /**\n   * Whether the popup is open\n   */\n  isOpen: atom({\n    key: \"search.everywhere.isOpen\",\n    default: false,\n  }),\n  /**\n   * Currently selected tab, e.g. \"Actions\", \"Files\", etc.\n   */\n  tab: atom<string>({\n    key: \"search.everywhere.tab\",\n    default: \"All\",\n  }),\n  /**\n   * The Element of the context of the action that triggered the popup. Used to provide context to search, if needed.\n   */\n  contextElement: atom<Element>({\n    key: \"search.everywhere.contextElement\",\n    default: undefined,\n  }),\n  /**\n   * Initial search query.\n   */\n  initialSearchQuery: atomFamily<string, string>({\n    key: \"search.everywhere.initialQuery\",\n    default: \"\",\n  }),\n  /**\n   * Popup bounds\n   */\n  bounds: atom<Partial<Bounds> | null>({\n    key: \"search.everywhere.bounds\",\n    default: null,\n  }),\n};\n","import React, { useEffect, useRef, useState } from \"react\";\nimport { RecoilState, useSetRecoilState } from \"recoil\";\nimport { Bounds, Popup, PopupProps } from \"@intellij-platform/core\";\nimport { useRecoilInitialValue } from \"../recoil-utils\";\n\n/**\n * A special type of popup, where the content can be toggled on and off. Needed only for SearchEveryWhere at the moment,\n * but extracted as a component, to collocate related pieces, rather than leave them with the rest of the code in the\n * component.\n * - Updates persisted {@param boundsState}, when the bounds are changed, only if the content is shown when the bounds\n *   is changed.\n * - Minimizes the popup into {@param noContentHeight}, when {@param hasContent} is `false`.\n * - Restores the popup height to it's latest value, or based on content, when {@param hasContent} changes to `true`.\n * - Returns the right to be applied based on the input {@param minHeight} and {@param hasContent}.\n */\nexport function ContentAwarePopup({\n  hasContent,\n  persistedBoundsState,\n  noContentHeight,\n  minHeight,\n  ...otherProps\n}: {\n  /**\n   * Whether the popup has content. If `false`, the popup is minimized to `noContentHeight`.\n   */\n  hasContent: boolean;\n  /**\n   * The minimized height of the popup, when there is no content.\n   */\n  noContentHeight: number;\n  /**\n   * Persisted state of the popup bounds, in form of a recoil state.\n   */\n  persistedBoundsState: RecoilState<Partial<Bounds> | null>;\n} & Omit<PopupProps, \"bounds\" | \"onBoundsChange\">) {\n  const persistBounds = useSetRecoilState(persistedBoundsState);\n  const getInitBounds = useRecoilInitialValue(persistedBoundsState, {\n    top: 150,\n    height: Math.max(200, window.innerHeight - 300),\n  });\n\n  const [bounds, setBounds] = useState<Partial<Bounds>>(getInitBounds);\n  const heightToRestoreRef = useRef(bounds.height);\n  const onBoundsChange = (bounds: Bounds) => {\n    if (hasContent) {\n      heightToRestoreRef.current = bounds.height;\n      persistBounds(bounds);\n    }\n    setBounds(bounds);\n  };\n  useEffect(() => {\n    setBounds((bounds) => ({\n      ...bounds,\n      height: hasContent ? heightToRestoreRef.current : noContentHeight,\n    }));\n  }, [hasContent]);\n\n  return (\n    <Popup\n      {...otherProps}\n      bounds={bounds}\n      onBoundsChange={onBoundsChange}\n      minHeight={!hasContent ? noContentHeight : minHeight}\n    />\n  );\n}\n","import { ItemLayout, styled } from \"@intellij-platform/core\";\n\nexport const StyledIconWrapper = styled.span`\n  width: 1.125rem;\n  display: inline-flex;\n  justify-content: center;\n`;\nexport const StyledItemLayout = styled(ItemLayout)`\n  min-height: 1.375rem;\n  width: 100%;\n  padding: 0;\n`;\nexport const StyledTitleWrapper = styled.span<{ isDisabled?: boolean }>`\n  color: ${({ theme, isDisabled }) =>\n    isDisabled &&\n    theme.currentForegroundAware(theme.commonColors.inactiveTextColor)};\n`;\n","import React, { useContext } from \"react\";\nimport {\n  Action,\n  ActionGroup,\n  ItemLayout,\n  ItemStateContext,\n  TextRange,\n  TextWithHighlights,\n  isInResolvedActionGroup,\n  styled,\n} from \"@intellij-platform/core\";\nimport {\n  StyledIconWrapper,\n  StyledItemLayout,\n  StyledTitleWrapper,\n} from \"../ItemHelpers\";\n\nconst StyledSpacer = styled.div`\n  flex: 1;\n`;\n/**\n * UI of actions in SearchEverywhere list\n */\nexport function ActionItem({\n  action,\n  highlights,\n}: {\n  action: Action;\n  highlights: null | TextRange[];\n}) {\n  const { isSelected } = useContext(ItemStateContext) || {};\n  return (\n    <StyledItemLayout>\n      <StyledIconWrapper>{action.icon}</StyledIconWrapper>\n      <StyledTitleWrapper isDisabled={action.isDisabled}>\n        {isSelected ? (\n          <TextWithHighlights highlights={highlights}>\n            {action.title}\n          </TextWithHighlights>\n        ) : (\n          action.title\n        )}\n      </StyledTitleWrapper>\n      <ItemLayout.Hint style={{ fontSize: \".85em\", fontWeight: \"bold\" }}>\n        {action.shortcut}\n      </ItemLayout.Hint>\n      <StyledSpacer />\n      <ItemLayout.Hint\n        style={{\n          marginRight:\n            \"-0.375rem\" /* to kill the default list padding on right. */,\n        }}\n      >\n        {getActionBreadcrumb(action, \"title\").join(\" | \")}\n      </ItemLayout.Hint>\n    </StyledItemLayout>\n  );\n}\n\nfunction getActionBreadcrumb<T extends keyof ActionGroup>(\n  action: Action,\n  field: T\n): Array<ActionGroup[T]>;\nfunction getActionBreadcrumb(action: Action): Array<ActionGroup>;\nfunction getActionBreadcrumb(action: Action, field?: keyof ActionGroup) {\n  let parent = isInResolvedActionGroup(action) ? action.parent : null;\n  const breadcrumb: Array<ActionGroup | ActionGroup[keyof ActionGroup]> = [];\n  while (parent) {\n    breadcrumb.unshift(field ? parent[field] : parent);\n    parent = parent.parent;\n  }\n  return breadcrumb;\n}\n","import { SearchEverywhereContributor } from \"../../SearchEverywhereContributor\";\nimport {\n  Action,\n  ActionDefinition,\n  ActionShortcut,\n  Checkbox,\n  CommonActionId,\n  getAvailableActionsFor,\n  minusculeMatch,\n  TextRange,\n} from \"@intellij-platform/core\";\nimport { searchEverywhereState } from \"../../searchEverywhere.state\";\nimport React, { useMemo, useState } from \"react\";\nimport { useRecoilValue } from \"recoil\";\nimport { ActionItem } from \"./ActionItem\";\n\nexport const actionsSearchContributor: SearchEverywhereContributor<{\n  action: Action;\n  highlights: TextRange[] | null;\n}> = {\n  id: \"Actions\",\n  title: \"Actions\",\n  actionId: CommonActionId.GO_TO_ACTION,\n  use: ({ everyWhereAutoSet }: { everyWhereAutoSet: boolean }) => {\n    const contextElement = useRecoilValue(searchEverywhereState.contextElement);\n    const [showDisabledActions, setShowDisabledActions] = useState<\n      null | boolean\n    >(null);\n    const allActions = useMemo(\n      () => (contextElement ? getAvailableActionsFor(contextElement) : []),\n      [contextElement]\n    );\n    const shouldIncludeDisabledActions =\n      showDisabledActions ?? everyWhereAutoSet;\n    const actions: ActionDefinition[] = [\n      {\n        id: CommonActionId.SHOW_INTENTION_ACTIONS,\n        title: \"Assign a shortcut\",\n        actionPerformed() {\n          alert(\"Not implemented!\");\n        },\n      },\n    ];\n    return {\n      search: (query: string) => {\n        const allResults = allActions\n          .map((action) => ({\n            highlights: minusculeMatch(action.title, query),\n            action,\n          }))\n          .filter(\n            ({ action, highlights }) =>\n              highlights || minusculeMatch(action.description || \"\", query)\n          );\n        return shouldIncludeDisabledActions\n          ? allResults\n          : allResults.filter(({ action }) => !action.isDisabled);\n      },\n      searchDeps: [shouldIncludeDisabledActions],\n      isEverywhere: shouldIncludeDisabledActions,\n      // canToggleEverywhere: true, // TODO: is it needed?\n      toggleEverywhere: () => {\n        setShowDisabledActions((currentValue) => !currentValue);\n      },\n      searchAdvertiser: (\n        <ActionShortcut actionId={CommonActionId.SHOW_INTENTION_ACTIONS}>\n          {(shortcut) => `Press ${shortcut} to assign a shortcut`}\n        </ActionShortcut>\n      ),\n      headerFilters: (\n        <Checkbox\n          preventFocus\n          isSelected={shouldIncludeDisabledActions}\n          onChange={(value) => {\n            setShowDisabledActions(value);\n          }}\n        >\n          Include disabled actions\n        </Checkbox>\n      ),\n      actions,\n      processSelectedItem({ action }) {\n        action?.perform({\n          event: null,\n          element: contextElement,\n        });\n      },\n      getKey: ({ action }) => action.id,\n      getItemText({ action: { title } }: { action: Action }): string {\n        return title;\n      },\n      renderItem({\n        action,\n        highlights,\n      }: {\n        action: Action;\n        highlights: TextRange[] | null;\n      }) {\n        return <ActionItem action={action} highlights={highlights} />;\n      },\n    };\n  },\n};\n","import path from \"path\";\nimport React, { useContext } from \"react\";\nimport { splitWhen } from \"ramda\";\nimport {\n  ItemLayout,\n  ItemStateContext,\n  PlatformIcon,\n  TextRange,\n  TextWithHighlights,\n} from \"@intellij-platform/core\";\n\nimport {\n  StyledIconWrapper,\n  StyledItemLayout,\n  StyledTitleWrapper,\n} from \"../ItemHelpers\";\nimport { ProjectFsItem } from \"../../../Project/project.state\";\nimport { getIconForFile } from \"../../../file-utils\";\n\n/**\n * UI of paths in SearchEverywhere list.\n */\nexport function FileItem({\n  file,\n  matches,\n}: {\n  file: ProjectFsItem;\n  /**\n   * matches on file.relativePath\n   */\n  matches: null | TextRange[];\n}) {\n  const { isSelected } = useContext(ItemStateContext) || {};\n  const title = path.basename(file.relativePath);\n  const dir = path.dirname(file.relativePath);\n\n  const [dirMatches, filenameMatches] = splitWhen<TextRange, TextRange>(\n    (match) => match.from >= dir.length,\n    matches || []\n  );\n  const titleMatches = filenameMatches.map(({ from, to }) => ({\n    from: from - dir.length,\n    to: to - dir.length,\n  }));\n  return (\n    <StyledItemLayout>\n      <StyledIconWrapper>\n        <PlatformIcon icon={getIconForFile(file.path)} />\n      </StyledIconWrapper>\n      <StyledTitleWrapper>\n        {isSelected ? (\n          <TextWithHighlights highlights={titleMatches}>\n            {title}\n          </TextWithHighlights>\n        ) : (\n          title\n        )}\n      </StyledTitleWrapper>\n      <ItemLayout.Hint>\n        {isSelected ? (\n          <TextWithHighlights highlights={dirMatches}>{dir}</TextWithHighlights>\n        ) : (\n          dir\n        )}\n      </ItemLayout.Hint>\n    </StyledItemLayout>\n  );\n}\n","import { SearchEverywhereContributor } from \"../../SearchEverywhereContributor\";\nimport {\n  CommonActionId,\n  minusculeMatch,\n  TextRange,\n} from \"@intellij-platform/core\";\nimport React from \"react\";\nimport { useRecoilCallback } from \"recoil\";\nimport {\n  currentProjectFilesState,\n  ProjectFsItem,\n} from \"../../../Project/project.state\";\nimport { useEditorStateManager } from \"../../../Editor/editor.state\";\nimport { useSelectPathInProjectView } from \"../../../ProjectView/ProjectView.state\";\nimport { FileItem } from \"./FileItem\";\n\nexport const filesSearchContributor: SearchEverywhereContributor<{\n  file: ProjectFsItem;\n  matches: TextRange[] | null;\n}> = {\n  id: \"Files\",\n  title: \"Files\",\n  actionId: CommonActionId.GO_TO_FILE,\n  use: () => {\n    const getProjectFiles = useRecoilCallback(\n      ({ snapshot }) =>\n        () =>\n          snapshot.getLoadable(currentProjectFilesState).getValue(),\n      []\n    );\n    const { openPath } = useEditorStateManager();\n    const selectPathInProjectView = useSelectPathInProjectView();\n    return {\n      search: (query: string) =>\n        getProjectFiles()\n          .map((file) => ({\n            matches: minusculeMatch(file.relativePath, query),\n            file,\n          }))\n          .filter(({ matches }) => matches?.length),\n      searchDeps: [],\n      isEverywhere: true,\n      processSelectedItem({ file }) {\n        if (file?.type === \"file\") {\n          openPath(file.path, true);\n        }\n        if (file?.type === \"dir\") {\n          selectPathInProjectView(file.path);\n        }\n      },\n      getKey({ file }) {\n        return file.path;\n      },\n      renderItem({\n        file,\n        matches,\n      }: {\n        file: ProjectFsItem;\n        matches: TextRange[] | null;\n      }) {\n        return <FileItem file={file} matches={matches} />;\n      },\n      getItemText({ file: { relativePath } }: { file: ProjectFsItem }): string {\n        return relativePath;\n      },\n    };\n  },\n};\n","export const SearchEverywhereActionIds = {\n  PREVIOUS_TAB: \"SearchEverywhere.PrevTab\",\n  NEXT_TAB: \"SearchEverywhere.NextTab\",\n};\n","import React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport { useRecoilState, useSetRecoilState } from \"recoil\";\nimport {\n  ActionButton,\n  ActionDefinition,\n  ActionsProvider,\n  FocusScope,\n  Item,\n  Link,\n  List,\n  PlatformIcon,\n  Popup,\n  Selection,\n  SelectionManager,\n  styled,\n  StyledTabProps,\n  Tabs,\n  Tooltip,\n  TooltipTrigger,\n  useCollectionSearchInput,\n  useGetActionShortcut,\n} from \"@intellij-platform/core\";\nimport { useTips } from \"./useTips\";\nimport { Input } from \"./Input\";\nimport {\n  searchEverywhereState,\n  SearchEveryWhereTab,\n} from \"./searchEverywhere.state\";\nimport { ContentAwarePopup } from \"./ContentAwarePopup\";\nimport {\n  SearchEverywhereContributor,\n  SearchEverywhereContributorResult,\n} from \"./SearchEverywhereContributor\";\nimport { actionsSearchContributor } from \"./contributors/action/actionsSearchContributor\";\nimport { filesSearchContributor } from \"./contributors/file/filesSearchContributor\";\nimport { SearchEverywhereActionIds } from \"./SearchEverywhereActionIds\";\nimport { useRecoilInitialValue } from \"../recoil-utils\";\n\nconst StyledHeader = styled.div`\n  display: flex;\n  width: 100%;\n  background: ${({ theme }) =>\n    theme.color(\"SearchEverywhere.Header.background\")};\n  border-bottom: 1px solid\n    ${({ theme }) => theme.color(\"SearchEverywhere.SearchField.borderColor\")};\n`;\nconst StyledTab = styled.button<StyledTabProps>`\n  all: unset;\n  background: ${({ theme, selected }) =>\n    selected && theme.color(\"SearchEverywhere.Tab.selectedBackground\")};\n  color: ${({ theme }) =>\n    theme.color(\"SearchEverywhere.Tab.selectedForeground\")};\n  opacity: ${({ disabled }) => disabled && \".5\"};\n`;\nconst StyledTabContent = styled.span`\n  display: flex;\n  padding: 0 0.75rem;\n  height: 1.8rem;\n  align-items: center;\n`;\nconst StyledTabs = styled.div`\n  line-height: normal;\n  border-bottom: none;\n`;\nconst StyledSearchFieldContainer = styled.div`\n  display: flex;\n  flex-shrink: 0;\n  height: 1.85rem;\n  align-items: center;\n  padding: 0 0.75rem 0;\n  gap: 0.75rem;\n\n  input {\n    all: unset;\n    flex: 1;\n    line-height: 1.25;\n\n    &::selection {\n      color: ${({ theme }) => theme.color(\"*.selectionForeground\")};\n      background: ${({ theme }) => theme.color(\"*.selectionBackground\")};\n    }\n  }\n`;\nconst StyledSearchResultsContainer = styled.div`\n  height: 24rem;\n  flex: 1;\n  min-height: 0; // for it to properly fill the remaining height and not to exceed that\n`;\nconst StyledDivider = styled.hr`\n  all: unset;\n  height: 1px;\n  width: 100%;\n  border-bottom: 1px solid\n    ${({ theme }) => theme.color(\"SearchEverywhere.SearchField.borderColor\")};\n`;\nconst StyledSearchFieldHint = styled.div`\n  color: ${({ theme }) =>\n    theme.color(\"SearchEverywhere.SearchField.infoForeground\")};\n  white-space: nowrap;\n`;\n\nconst StyledLoadMore = styled.div`\n  color: ${({ theme }) =>\n    theme.currentForegroundAware(\n      theme.color(\"SearchEverywhere.SearchField.infoForeground\")\n    )};\n  font-size: 0.7rem;\n  min-height: 1.375rem;\n`;\n\nconst StyledPlaceholder = styled.div`\n  color: ${({ theme }) => theme.commonColors.inactiveTextColor};\n  position: absolute;\n  text-align: center;\n  width: 100%;\n  top: 50%;\n`;\nconst SEARCH_RESULT_LIMIT = 30;\n\nconst contributors = [actionsSearchContributor, filesSearchContributor];\n\nconst LOAD_MORE_ITEM = {};\nconst LOAD_MORE_ITEM_KEY = \"LOAD_MORE_ITEM_KEY\";\n\n/**\n * TODO: implement history navigation\n */\nexport function SearchEverywherePopup() {\n  const setOpen = useSetRecoilState(searchEverywhereState.isOpen);\n  const [tab, setTab] = useRecoilState(searchEverywhereState.tab);\n  const [everyWhereAutoSet, setEveryWhereAutoSet] = useState(false);\n  const [pattern, setPattern] = useState(\n    useRecoilInitialValue(searchEverywhereState.initialSearchQuery(tab))\n  );\n  const persistInitialSearchQuery = useSetRecoilState(\n    searchEverywhereState.initialSearchQuery(tab)\n  );\n\n  const getShortcut = useGetActionShortcut();\n  const [selectedKeys, setSelectedKeys] = useState<Selection>(new Set());\n  const idToContributor: Record<\n    string,\n    SearchEverywhereContributorResult<{}> &\n      Omit<SearchEverywhereContributor<{}>, \"use\">\n  > = {};\n  contributors.forEach((contributor) => {\n    idToContributor[contributor.id] = {\n      ...contributor,\n      ...contributor.use({ everyWhereAutoSet }),\n    };\n  });\n\n  const activeContributors = contributors\n    .filter((contributor) => tab === \"\" || contributor.id === tab)\n    .map(({ id }) => idToContributor[id]);\n\n  const [searchResultLimit, setSearchResultLimit] =\n    useState(SEARCH_RESULT_LIMIT);\n  const { searchResult } = useMemo(() => {\n    // TODO: sort results\n    const searchResult = activeContributors.flatMap((contributor) =>\n      contributor.search(pattern).map((item) => ({\n        key: `${contributor.id}_${contributor.getKey(item)}`,\n        contributor,\n        item,\n      }))\n    );\n    return {\n      searchResult,\n    };\n  }, [\n    pattern,\n    tab,\n    ...activeContributors.flatMap(({ searchDeps }) => searchDeps),\n  ]);\n  const currentTabContributor = idToContributor[tab];\n\n  const visibleSearchResult = useMemo(() => {\n    const visibleSearchResult = searchResult.slice(0, searchResultLimit);\n    const hasMore = searchResult.length > visibleSearchResult.length;\n    if (hasMore) {\n      visibleSearchResult.push({\n        key: LOAD_MORE_ITEM_KEY,\n        item: LOAD_MORE_ITEM,\n        contributor: null!,\n      });\n    }\n    return visibleSearchResult;\n  }, [searchResultLimit, searchResult]);\n\n  const notFoundPatternRef = useRef<string | null>(null);\n\n  const onPatternChanged = (newPattern: string) => {\n    const newPatternContainsPrevious =\n      notFoundPatternRef.current &&\n      newPattern.includes(notFoundPatternRef.current);\n    // TODO: improve isEverywhere support. It should be supported it in \"All\" tabs too.\n    if (currentTabContributor?.isEverywhere && !newPatternContainsPrevious) {\n      setEveryWhereAutoSet(false);\n    }\n    setPattern(newPattern);\n  };\n\n  useEffect(() => {\n    if (pattern) {\n      persistInitialSearchQuery(pattern);\n    }\n  }, [pattern, tab]);\n\n  useEffect(() => {\n    if (searchResult[0]) {\n      // Currently, list auto selects the first item, only in first render. But not when the collection is changed.\n      // So we make sure the first item is selected, after each search. Perhaps, List should be changed instead to\n      // react to collection changes.\n      const { key } = searchResult[0];\n      setSelectedKeys(new Set([key]));\n      selectionManagerRef.current?.setFocusedKey(key);\n    }\n    setSearchResultLimit(SEARCH_RESULT_LIMIT);\n  }, [searchResult]);\n\n  const localActions: ActionDefinition[] = [\n    {\n      id: SearchEverywhereActionIds.PREVIOUS_TAB,\n      title: \"Prev tab\",\n      description: \"Switch to previous tab in Search Everywhere dialog\",\n      actionPerformed: () => {\n        const currentContributorIndex = contributors.findIndex(\n          ({ id }) => tab === id\n        );\n\n        setTab(\n          tab === \"\"\n            ? contributors.slice(-1)[0].id\n            : contributors[currentContributorIndex - 1]?.id || \"\"\n        );\n      },\n    },\n    {\n      id: SearchEverywhereActionIds.NEXT_TAB,\n      title: \"Next tab\",\n      description: \"Switch to next tab in Search Everywhere dialog\",\n      actionPerformed: () => {\n        const currentContributorIndex = contributors.findIndex(\n          ({ id }) => tab === id\n        );\n        setTab(contributors[currentContributorIndex + 1]?.id || \"\");\n      },\n    },\n  ];\n  const contributorActions = contributors.flatMap(({ id, actionId, title }) => {\n    return actionId\n      ? [\n          {\n            id: actionId,\n            title: `Find ${title}`,\n            description: `Quickly go to ${title} by name`,\n            actionPerformed: () => {\n              if (tab !== id) {\n                setTab(id);\n              } else {\n                currentTabContributor?.toggleEverywhere?.();\n              }\n            },\n          },\n        ]\n      : [];\n  });\n\n  const close = () => setOpen(false);\n\n  const collectionRef = useRef<HTMLUListElement>(null);\n  const selectionManagerRef = useRef<SelectionManager>(null);\n  const { collectionSearchInputProps } = useCollectionSearchInput({\n    collectionRef,\n    selectionManager: selectionManagerRef.current,\n  });\n\n  const tips = useTips();\n\n  return (\n    <ContentAwarePopup\n      persistedBoundsState={searchEverywhereState.bounds}\n      hasContent={Boolean(pattern)}\n      noContentHeight={59}\n      minWidth={670}\n      minHeight={160}\n      interactions=\"all\"\n      onClose={close}\n    >\n      <ActionsProvider\n        actions={[\n          ...(currentTabContributor?.actions || []),\n          ...contributorActions,\n          ...localActions,\n        ]}\n      >\n        {({ shortcutHandlerProps }) => (\n          <div {...shortcutHandlerProps} style={{ height: \"inherit\" }}>\n            <Popup.Layout\n              header={\n                <>\n                  <Popup.Header hasControls>\n                    <StyledHeader>\n                      <div style={{ flex: 1 }}>\n                        <Tabs\n                          TabComponent={StyledTab}\n                          TabsComponent={StyledTabs}\n                          selectedKey={tab}\n                          onSelectionChange={(key) =>\n                            setTab(key as SearchEveryWhereTab)\n                          }\n                        >\n                          <Item key=\"\">\n                            <StyledTabContent>All</StyledTabContent>\n                          </Item>\n                          {\n                            contributors.map((contributor) => {\n                              const shortcut = getShortcut(\n                                contributor.actionId\n                              );\n                              const title = (\n                                <StyledTabContent>\n                                  {contributor.title}\n                                </StyledTabContent>\n                              );\n                              return (\n                                <Item key={contributor.id}>\n                                  {shortcut ? (\n                                    <TooltipTrigger\n                                      tooltip={<Tooltip>{shortcut}</Tooltip>}\n                                    >\n                                      {/* Span needed for tooltip to work, in the current implementation of tooltip */}\n                                      <span>{title}</span>\n                                    </TooltipTrigger>\n                                  ) : (\n                                    title\n                                  )}\n                                </Item>\n                              );\n                            }) as any /*when a static Item is rendered before this array, it wrongly complains about the type*/\n                          }\n                        </Tabs>\n                      </div>\n                      {currentTabContributor?.headerFilters}\n                      <ActionButton style={{ margin: \"0 0.5rem\" }} isDisabled>\n                        <PlatformIcon icon=\"actions/moveToLeftBottom\" />\n                      </ActionButton>\n                    </StyledHeader>\n                  </Popup.Header>\n                  <StyledSearchFieldContainer>\n                    <PlatformIcon icon=\"actions/search\" />\n                    <FocusScope contain>\n                      <Input\n                        {...collectionSearchInputProps}\n                        autoFocus\n                        onFocus={(event) => {\n                          event.target.select();\n                        }}\n                        value={pattern}\n                        onChange={(e) =>\n                          onPatternChanged(e.currentTarget.value)\n                        }\n                      />\n                    </FocusScope>\n                    <StyledSearchFieldHint>\n                      {currentTabContributor?.searchAdvertiser}\n                    </StyledSearchFieldHint>\n                  </StyledSearchFieldContainer>\n                </>\n              }\n              content={\n                <>\n                  <StyledDivider />\n                  {pattern && (\n                    <StyledSearchResultsContainer>\n                      <List\n                        ref={collectionRef}\n                        selectionManagerRef={selectionManagerRef}\n                        items={visibleSearchResult}\n                        selectionMode=\"single\"\n                        alwaysShowAsFocused\n                        shouldFocusWrap\n                        fillAvailableSpace\n                        selectedKeys={selectedKeys}\n                        onSelectionChange={setSelectedKeys}\n                        onAction={(key) => {\n                          if (key === LOAD_MORE_ITEM_KEY) {\n                            setSearchResultLimit(\n                              (limit) => limit + SEARCH_RESULT_LIMIT\n                            );\n                            const nextItem =\n                              searchResult[visibleSearchResult.length + 1];\n                            if (nextItem) {\n                              // nextItem is expected to always have value\n\n                              // Timeout needed to let the item get rendered first. Could be done in an effect instead,\n                              // if we want to avoid setTimeout\n                              setTimeout(() => {\n                                setSelectedKeys(new Set([nextItem.key]));\n                                selectionManagerRef.current?.setFocusedKey(\n                                  nextItem.key\n                                );\n                              });\n                            }\n                          } else {\n                            close();\n                            // Making sure the popup is fully closed before the new action is performed. One edge case that can\n                            // make a difference is actions like FindAction that open the same popup. By performing an action\n                            // async, we make sure the popup is closed and reopened, which is good, because otherwise, the user\n                            // won't get any feedback when choosing such actions.\n                            setTimeout(() => {\n                              const itemWrapper = searchResult.find(\n                                (item) => item.key === key\n                              );\n                              itemWrapper?.contributor.processSelectedItem(\n                                itemWrapper.item\n                              );\n                              /**\n                               * The 50ms timeout is a workaround for an issue in FocusScope:\n                               * restoreFocus only works if the previously focused element is in the dom, when the focus\n                               * scope is unmounted. In case of SearchEveryWhere, actions like \"Rollback\" open a modal\n                               * window, which has a focus scope, when the window is opened, the currently focused\n                               * element (which will be the one to restore focus to), is search everywhere dialog, which\n                               * is immediately closed. So when the modal window is closed, it tries to move focus back\n                               * to search everywhere dialog, which is long gone! It would be nice if FocusScope could\n                               * track a chain of nodes to restore focus to.\n                               * With this 50ms timeout, focus is first restored to where it was, after SearchEveryWhere\n                               * is closed, and then the actions is performed, for focus restoration to work.\n                               */\n                            }, 50);\n                          }\n                        }}\n                      >\n                        {({ key, item, contributor }) => {\n                          if (key === LOAD_MORE_ITEM_KEY) {\n                            return (\n                              <Item key={LOAD_MORE_ITEM_KEY}>\n                                <StyledLoadMore>...more</StyledLoadMore>\n                              </Item>\n                            );\n                          }\n                          return (\n                            <Item\n                              key={key}\n                              textValue={contributor.getItemText(item)}\n                            >\n                              {contributor.renderItem(item)}\n                            </Item>\n                          );\n                        }}\n                      </List>\n                      {searchResult.length === 0 && (\n                        <StyledPlaceholder>\n                          No actions with such name found\n                        </StyledPlaceholder>\n                      )}\n                    </StyledSearchResultsContainer>\n                  )}\n                </>\n              }\n              footer={\n                <Popup.Hint>\n                  {tips.current} <Link onPress={tips.next}>Next Tip</Link>\n                </Popup.Hint>\n              }\n            />\n          </div>\n        )}\n      </ActionsProvider>\n    </ContentAwarePopup>\n  );\n}\n","import { useRecoilCallback } from \"recoil\";\nimport {\n  ActionContext,\n  ActionDefinition,\n  CommonActionId,\n} from \"@intellij-platform/core\";\n\nimport { searchEverywhereState } from \"../SearchEverywhere/searchEverywhere.state\";\n\nexport function useProjectActions(): ActionDefinition[] {\n  const openSearchEverywhere = useRecoilCallback(\n    ({ set }) =>\n      ({ element }: ActionContext, tab: string) => {\n        if (element) {\n          set(searchEverywhereState.isOpen, true);\n          set(searchEverywhereState.tab, tab);\n          set(searchEverywhereState.contextElement, element);\n        }\n      },\n    []\n  );\n\n  return [\n    {\n      id: CommonActionId.GO_TO_ACTION,\n      title: \"Find Action\",\n      description: \"Quickly navigate to action by name\",\n      actionPerformed: (event) => {\n        openSearchEverywhere(event, \"Actions\");\n      },\n    },\n    {\n      id: CommonActionId.GO_TO_FILE,\n      title: \"Go to file\",\n      description: \"Quickly navigate to file by name\",\n      actionPerformed: (event) => {\n        openSearchEverywhere(event, \"Files\");\n      },\n    },\n  ];\n}\n","import React, { CSSProperties } from \"react\";\nimport { useRecoilState, useRecoilValue } from \"recoil\";\nimport {\n  ActionDefinition,\n  ActionsProvider,\n  DefaultToolWindows,\n  styled,\n} from \"@intellij-platform/core\";\nimport { FileEditor } from \"../Editor/FileEditor\";\nimport { useInitializeVcs } from \"../VersionControl/file-status.state\";\nimport { toolWindows } from \"./toolWindows\";\nimport { useInitializeChanges } from \"../VersionControl/Changes/change-lists.state\";\nimport { IdeStatusBar } from \"../StatusBar/IdeStatusBar\";\nimport { usePersistenceFsNotification } from \"../usePersistenceFsNotification\";\nimport { useChangesViewActions } from \"../VersionControl/Changes/useChangesViewActions\";\nimport { RollbackWindow } from \"../VersionControl/Changes/Rollback/RollbackWindow\";\nimport { rollbackViewState } from \"../VersionControl/Changes/Rollback/rollbackView.state\";\nimport { toolWindowsState } from \"./toolWindows.state\";\nimport { SearchEverywherePopup } from \"../SearchEverywhere/SearchEverywherePopup\";\nimport { useProjectActions } from \"./useProjectActions\";\nimport { searchEverywhereState } from \"../SearchEverywhere/searchEverywhere.state\";\n\nconst StyledWindowFrame = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  min-height: 0;\n`;\n\nexport const Project = ({ height }: { height: CSSProperties[\"height\"] }) => {\n  const [state, setState] = useRecoilState(toolWindowsState);\n  const isRollbackWindowOpen = useRecoilValue(rollbackViewState.isOpen);\n  const isSearchEveryWhereOpen = useRecoilValue(searchEverywhereState.isOpen);\n\n  useInitializeVcs();\n  useInitializeChanges();\n  usePersistenceFsNotification();\n\n  const allActions: ActionDefinition[] = [\n    ...useChangesViewActions(),\n    ...useProjectActions(),\n  ];\n\n  return (\n    <StyledWindowFrame style={{ height }}>\n      <ActionsProvider\n        actions={allActions}\n        useCapture /* useCapture because of Monaco's aggressive event handling. Specifically, Cmd+Shift+O in .ts files  */\n      >\n        {({ shortcutHandlerProps }) => (\n          <DefaultToolWindows\n            toolWindowsState={state}\n            onToolWindowStateChange={(newState) => {\n              setState(newState);\n            }}\n            windows={toolWindows}\n            containerProps={shortcutHandlerProps}\n            // To make it not annoying when the whole app is a part of a bigger page. It's fine to disable focus trap,\n            // because the focusable element, the editor, fills the whole main content.\n            allowBlurOnInteractionOutside\n          >\n            <FileEditor />\n          </DefaultToolWindows>\n        )}\n      </ActionsProvider>\n\n      <IdeStatusBar />\n      {isSearchEveryWhereOpen && <SearchEverywherePopup />}\n      {isRollbackWindowOpen && <RollbackWindow />}\n    </StyledWindowFrame>\n  );\n};\n","import React, { useEffect, useState } from \"react\";\nimport { sampleRepo } from \"./Project/project.state\";\nimport { fs } from \"./fs/fs\";\nimport { clone } from \"isomorphic-git\";\nimport http from \"isomorphic-git/http/web\";\nimport styled from \"styled-components\";\nimport { WINDOW_SHADOW } from \"@intellij-platform/core\";\n\nconst StyledDialog = styled.div`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  background: ${({ theme }) => theme.color(\"*.background\")};\n  color: ${({ theme }) => theme.color(\"*.foreground\")};\n  ${WINDOW_SHADOW};\n  text-align: center;\n  line-height: 1.5;\n`;\nconst StyledDialogHeader = styled.div`\n  background: ${({ theme }) => theme.color(\"Popup.Header.activeBackground\")};\n  padding: 4px;\n  text-align: center;\n`;\nconst StyledDialogContent = styled.div`\n  padding: 8px 16px;\n`;\n\nasync function isSuccessfullyCloned(dir: string) {\n  try {\n    const stats = await fs.promises.stat(dir);\n    if (!stats.isDirectory()) {\n      console.info(\n        `Already cloned repo was not found. \"${dir}\" is not a directory.`\n      );\n      return false;\n    }\n    const files = await fs.promises.readdir(dir);\n    if (files.length === 1 && files[0] === \".git\") {\n      console.info(\n        `Already cloned repo was not found at \"${dir}\". \".git\" folder exists, but it's not successfully unpacked.`\n      );\n      return false;\n    }\n  } catch (e) {\n    console.info(`Already cloned repo was not found at \"${dir}\".`);\n    return false;\n  }\n  return true;\n}\n\nexport const SampleRepoInitializer: React.FC = ({ children }) => {\n  const [state, setState] = useState<\n    \"error\" | \"cloning\" | \"uninitialized\" | \"initialized\"\n  >(\"uninitialized\");\n  useEffect(() => {\n    async function init(dir: string, repoUrl: string) {\n      if (!(await isSuccessfullyCloned(dir))) {\n        setState(\"cloning\");\n        await cloneRepo(dir, repoUrl);\n      }\n    }\n\n    init(sampleRepo.path, sampleRepo.url)\n      .then(() => {\n        console.log(\"demo repo initialized\");\n        setState(\"initialized\");\n      })\n      .catch((e) => {\n        console.error(\"could not initialize the demo repo\", e);\n        setState(\"error\");\n      });\n  }, []);\n\n  if (state === \"uninitialized\") {\n    return null;\n  }\n  if (state === \"initialized\") {\n    return <>{children}</>;\n  }\n  return (\n    <div style={{ minHeight: \"100vh\", position: \"relative\" }}>\n      <StyledDialog>\n        <StyledDialogHeader>Cloning sample repo</StyledDialogHeader>\n        <StyledDialogContent>\n          {state === \"cloning\" ? (\n            <>\n              Cloning <b>{sampleRepo.url}</b>. <br />\n              It may take several seconds.\n            </>\n          ) : (\n            <>Something went wrong!</>\n          )}\n        </StyledDialogContent>\n      </StyledDialog>\n    </div>\n  );\n};\n\nasync function cloneRepo(dir: string, repoUrl: string) {\n  console.log(\"cloning repo: \");\n  await clone({\n    fs,\n    url: repoUrl,\n    http,\n    corsProxy: \"https://cors.isomorphic-git.org\",\n    dir,\n    singleBranch: true,\n  });\n}\n","import { Keymap } from \"@intellij-platform/core\";\nimport { ChangesViewActionIds } from \"./VersionControl/Changes/useChangesViewActions\";\nimport { SearchEverywhereActionIds } from \"./SearchEverywhere/SearchEverywhereActionIds\";\n\nexport const exampleAppKeymap: Keymap = {\n  ActivateProjectWindow: [\n    {\n      type: \"keyboard\",\n      firstKeyStroke: { code: \"Digit1\", modifiers: [\"Meta\"] },\n    },\n  ],\n  ActivateCommitWindow: [\n    {\n      type: \"keyboard\",\n      firstKeyStroke: { code: \"Digit0\", modifiers: [\"Meta\"] },\n    },\n  ],\n  ActivateTerminalWindow: [\n    { type: \"keyboard\", firstKeyStroke: { code: \"F12\", modifiers: [\"Alt\"] } },\n  ],\n  [ChangesViewActionIds.ROLLBACK]: [\n    {\n      type: \"keyboard\",\n      firstKeyStroke: { code: \"KeyZ\", modifiers: [\"Alt\", \"Meta\"] },\n    },\n  ],\n  [ChangesViewActionIds.SHOW_DIFF]: [\n    {\n      type: \"keyboard\",\n      firstKeyStroke: { code: \"KeyD\", modifiers: [\"Meta\"] },\n    },\n  ],\n  [ChangesViewActionIds.SHELVE_SILENTLY]: [\n    {\n      type: \"keyboard\",\n      firstKeyStroke: { code: \"KeyH\", modifiers: [\"Meta\", \"Shift\"] },\n    },\n  ],\n  [ChangesViewActionIds.UNSHELVE_SILENTLY]: [\n    {\n      type: \"keyboard\",\n      firstKeyStroke: { code: \"KeyU\", modifiers: [\"Meta\", \"Alt\"] },\n    },\n  ],\n  [SearchEverywhereActionIds.PREVIOUS_TAB]: [\n    {\n      type: \"keyboard\",\n      firstKeyStroke: { code: \"Tab\", modifiers: [\"Shift\"] },\n    },\n  ],\n  [SearchEverywhereActionIds.NEXT_TAB]: [\n    {\n      type: \"keyboard\",\n      firstKeyStroke: { code: \"Tab\" },\n    },\n  ],\n};\n","import React, { CSSProperties } from \"react\";\nimport { RecoilRoot } from \"recoil\";\nimport git from \"isomorphic-git\";\nimport {\n  BalloonManager,\n  KeymapProvider,\n  PopupManager,\n} from \"@intellij-platform/core\";\nimport { DefaultSuspense } from \"./DefaultSuspense\";\nimport { Project } from \"./Project/Project\";\nimport { SampleRepoInitializer } from \"./SampleRepoInitializer\";\nimport { fs, WaitForFs } from \"./fs/fs\";\nimport { exampleAppKeymap } from \"./exampleAppKeymap\";\n\n// useful globals for debugging purposes\n(window as any).git = git;\n(window as any).fs = fs;\n\n/**\n * Example app root component. It expects ThemeProvider to be provided based on where it's rendered.\n */\nexport const App = ({ height }: { height?: CSSProperties[\"height\"] }) => {\n  return (\n    // TODO: add an error boundary\n    <DefaultSuspense>\n      <WaitForFs>\n        <SampleRepoInitializer>\n          <KeymapProvider keymap={exampleAppKeymap}>\n            <RecoilRoot>\n              <PopupManager>\n                <BalloonManager disablePortal>\n                  {/* disablePortal to make example app more portable*/}\n                  <Project height={height} />\n                </BalloonManager>\n              </PopupManager>\n            </RecoilRoot>\n          </KeymapProvider>\n        </SampleRepoInitializer>\n      </WaitForFs>\n    </DefaultSuspense>\n  );\n};\n\nexport default App;\n"],"names":["LoadingGif","props","Img","src","darkSrc","Loading","styled","DefaultSuspense","fallback","children","FILE_ICON","DIR_ICON","extensionIconMap","editorconfig","js","gitignore","archive","as","config","css","dtd","hpr","htaccess","html","idl","java","jfr","json","jsp","jspx","manifest","properties","txt","wsdl","xhtml","xml","xsd","yaml","getIconForFile","filepath","extension","getExtension","split","pop","getParentPaths","upperLimit","path","getParentPathsRecursive","previousPaths","dirname","concat","darculaColorSchemeTokenRules","vsCodeTheme","scope","settings","flatMap","map","token","values","Object","keys","forEach","key","value","StyledEditor","MonacoEditor","Editor","editorTheme","monaco","useMonaco","theme","useTheme","themeName","setThemeName","useState","dark","useLayoutEffect","name","replace","editor","defineTheme","base","inherit","colors","rules","useEditorTheme","options","minimap","enabled","lineHeight","showFoldingControls","renderIndentGuides","overviewRulerBorder","scrollbar","verticalScrollbarSize","horizontalScrollbarSize","verticalSliderSize","horizontalSliderSize","horizontal","vertical","alwaysConsumeMouseWheel","async","createIndexedDBFS","storeName","idbfs","createFsBackend","cb","BrowserFS","Promise","resolve","init","store","initializeFS","fsBackend","fsm","promises","pify","window","createFs","backend","fs","initialize","fn","reject","err","copyFsRecursively","CAF","cancelSignal","params","source","target","rootDir","onCopy","force","items","readdir","fullPath","stat","isFile","isSymbolicLink","fileExists","content","readFile","ensureDir","writeFile","isDirectory","console","warn","exists","catch","e","dirPath","code","mkdir","Error","persistentFsPreference","get","localStorage","getItem","set","setItem","switchToPersistentFS","log","getRootFS","time","indexedDbFsBackend","rest","copyFs","timeEnd","fsResource","promise","response","status","suspender","then","res","read","wrapPromise","createInMemoryFS","theFs","WaitForFs","dirContentState","selectorFamily","fileNames","all","fileName","filePath","type","size","fetchFileContent","encoding","fileContent","atomFamily","default","effects","onSet","error","filterPath","includes","useRecoilInitialValue","recoilState","defaultValue","useRecoilCallback","snapshot","getLoadable","getValue","sampleRepo","url","currentProjectState","atom","projectFilePath","projectRelativePath","currentProjectFilesState","selector","project","files","addItem","item","childItems","push","relativePath","activePathsState","useActivePathsProvider","state","nullValue","setValue","useSetRecoilState","isFocusedRef","useRef","useEffect","current","activePathsProviderProps","onFocus","onBlur","temporaryTabsDefaultValue","sortWith","descend","file","endsWith","filter","slice","editorState","cursorPos","lineNumber","column","editorTabsState","activeEditorTabIndexState","activeEditorTabState","editorCursorPositionState","Position","editorRefState","useEditorStateManager","tabsState","setTabsState","useRecoilState","setActiveTabIndex","focus","valueOrThrow","select","index","closeTab","_","tabIndex","tabs","openPath","shouldFocus","findIndex","tab","newIndex","length","currentState","setTimeout","closePath","Math","max","closeOthersTabs","convertGitStatus","Array","isArray","vcsRootsState","dir","vcs","vcsRootForFile","find","root","startsWith","branchForFile","repoCurrentBranch","repoRoot","git","fullname","fileStatusState","useUpdateFileStatus","getPromise","fileStatus","useInitializeVcs","updateVcsFileStatuses","transact_UNSTABLE","vcsDirectoryMappings","rows","statusMatrix","row","useStatusColor","FileStatusColor","color","useRecoilValue","useFileStatusColor","style","StatusColor","FileEditor","editorStateManager","activeTab","editorRef","active","setActive","hideAllAction","useAction","HIDE_ALL_WINDOWS_ACTION_ID","setCursorPositionState","tabActionsRef","useLatest","setEditorRef","fileContentState","contentLoadable","useRecoilValueLoadable","setContent","updateFileStatus","setPosition","valueMaybe","StyledFileEditorContainer","mergeProps","ContextMenuContainer","renderMenu","Menu","onAction","alert","Item","EditorTabs","selectedKey","onSelectionChange","noBorders","filename","icon","PlatformIcon","TabItem","textValue","inOverflowMenu","MenuItemLayout","TooltipTrigger","tooltip","ActionTooltip","actionName","EditorTabContent","title","closeButton","TabCloseButton","onPress","altKey","indexOf","containerProps","onDoubleClick","perform","height","onMount","monacoEditor","languages","typescript","typescriptDefaults","setCompilerOptions","jsx","setDiagnosticsOptions","noSemanticValidation","noSyntaxValidation","enableJsx","onDidChangeCursorPosition","position","onDidChangeModel","getPosition","onChange","newContent","FileEditorLoading","isUnderDarcula","commonColors","panelBackground","StyledXterm","XTerm","Terminal","input","setInput","xtermRef","useMemo","background","selection","fontFamily","letterSpacing","fontSize","cursorStyle","cursorBlink","cursorWidth","rendererType","terminal","resize","write","ref","onData","data","charCodeAt","changeListsState","id","comment","changes","allChangesState","changeList","changeLists","flat","isAChange","head","workingDir","stage","refreshChanges","gitRoots","pathname","theRest","workdir","after","isDir","before","useRollbackChanges","callbackInterface","reloadFileFromDisk","reloadFileFromDiskCallback","changesWithRepoRoots","change","groupedChanges","groupBy","entries","checkout","filepaths","resetIndex","useChangeListManager","addChangeList","editChangeList","edits","mergeChangeLists","sourceId","targetId","moveChange","toChangeListId","removeChangeList","setActiveChangeList","refresh","rollback","groupings","isAvailable","groupFn","nodes","repository","repositoryNode","node","constSelector","pathToNodeCache","rootDirNodes","reduce","prevNode","directoryNode","parentNodePath","dirNode","collapseDirectories","isDirectoryNode","child","uniq","isOpen","windowBounds","initiallyIncludedChanges","rootNodes","selectedChanges","changesTreeNodesState","some","rollbackViewState","initiallyExpandedKeys","includedChanges","expandedKeys","dfsVisit","isGroupNode","childValues","isExpanded","childValue","getNodeKeyForChange","Set","getExpandAllKeys","currentBranchState","showIgnoredFilesState","showRelatedFilesState","changesGroupingState","selectedKeysState","changesUnderSelectedKeys","selectedKeys","byKey","allChanges","processNode","includedChangeKeysState","includedChangesState","includedChangeKeys","has","includedChangesNestedSelection","getCallback","setSelectedKeys","NestedSelection","createSetInterface","getChildren","getKey","expandedKeysState","availableGroupingsState","grouping","isRecoilValue","isActive","changeBrowserNodeKey","changeListNode","i","changeNode","isChangeNode","recursiveGrouping","groupingFns","nextGroupingFns","changeNodes","groupNodes","groups","groupNode","groupFns","groupChanges","fileCountsMap","Map","childrenFileCount","fileCount","total","count","commitMessageSizeState","orientation","amendCommitState","commitMessageState","openRollbackWindowForSelectionCallback","contextual","activePaths","changesUnderSelection","changesBasedOnActivePaths","activePath","ChangesViewTreeContextMenu","setIncludedChangeKeys","disabledKeys","focusCommitMessage","useChangeViewContext","openRollbackWindowForSelection","arr","StyledRepoColorSquare","useRepoRootColor","rootPath","red","blue","RepoColorIcon","backgroundColor","StyledCurrentBranchTag","Color","withTransparency","toString","currentForegroundAware","CurrentBranchName","repo","branch","fileCountMsg","IntlMessageFormat","ChangeNodeHint","isGroupedByDirectory","ItemLayout","nodeRenderers","rendered","HighlightedTextValue","format","directory","changelist","fontWeight","undefined","getChangeListTreeItemProps","nodeRenderer","dirCount","hasChildItems","ChangeViewTree","treeRef","setExpandedKeys","nestedSelection","openChangeInEditor","SpeedSearchTreeWithCheckboxes","selectionMode","onExpandedChange","fillAvailableSpace","autoFocus","TreeNodeCheckbox","selectionState","getSelectionState","onToggle","toggle","ChangeListsActionButton","ActionButtonWithMenu","menuProps","GroupByActionButton","availableGroupings","toggleGroup","ViewOptionsActionButton","showRelatedFiles","setShowRelatedFiles","showIgnoredFiles","setShowIgnoredFiles","viewOptions","ChangesViewActionIds","useChangesViewActions","openRollbackWindow","actionPerformed","event","Boolean","ChangesViewToolbar","ActionToolbar","hasBorder","actionId","CommonActionId","ChangesSummary","modifiedCount","addedCount","deletedCount","StyledContainer","StyledTreeViewWrapper","StyledActionsRow","StyledAmendCheckbox","Checkbox","StyledCommitMessageContainer","StyledCommitMessageTextArea","StyledCommitActionsRow","StyledChangesSummaryContainer","ChangeViewContext","React","useContext","ChangesViewSplitter","anchor","useToolWindowState","getAnchorOrientation","commitMessageSize","setCommitMessageSize","treeActions","useTreeActions","Provider","ThreeViewSplitter","innerView","ActionsProvider","actions","shortcutHandlerProps","CommitActionsRow","innerViewMinSize","lastView","CommitMessageEditorAndButtons","lastSize","onLastResize","ChangesViewChangesSummary","amend","setAmend","ActionHelpTooltip","helpText","isSelected","preventFocus","ActionButton","isDisabled","commitMessageTextAreaRef","commitMessage","setCommitMessage","hasFocus","useDefaultToolWindowContext","useImperativeHandle","placeholder","Button","preventFocusOnPress","variant","ChangesViewPane","foldersOnTopState","projectViewTreeRefState","dangerouslyAllowMutability","currentProjectTreeState","rootItems","mapItem","parent","createProjectTree","expandToPathCallback","keysToExpand","selectKeyAndFocusCallback","replaceSelection","useSelectPathInProjectView","expandToOpenedFile","selectKeyAndFocus","ProjectViewPane","setProjectViewTreeRef","projectTree","sortItems","sortBy","a","identity","selectedKeysArray","SpeedSearchTree","ProjectViewNodeIcon","FileTreeNodeText","FileTreeDirNodeText","FileTreeFileNodeText","ItemStateContext","isContainerFocused","nodeTypeIconMap","SELECT_IN_PROJECT_VIEW","ProjectToolWindow","projectViewActions","selectPathInProjectView","selectOpenedFile","description","useProjectViewActions","DefaultToolWindow","headerContent","additionalActions","toolWindows","initialState","toolWindowState","isVisible","weight","MultiViewToolWindow","tabContent","switchToPersistentFsProcess","usePersistenceFsNotification","balloons","useBalloonManager","setProcessState","timeoutId","showSticky","body","Balloon","details","isIndeterminate","progress","onCancel","abort","signal","updates","finally","clearTimeout","repoLocalBranchesState","branches","currentBranch","isCurrent","trackingBranch","getTrackingBranch","repoRemoteBranchesState","remotes","remote","allBranchesState","localBranches","remoteBranches","mergeRef","BranchesPopupContent","onClose","repoBranches","recoilValue","setState","loadable","contents","useLatestRecoilValue","isFavoriteBranch","PopupLayout","header","Popup","SpeedSearchMenu","submenuBehavior","getSectionLabel","label","compareActions","branchName","Divider","newBranchActions","mergeActions","AutoHoverPlatformIcon","hoverIcon","hoverContainerSelector","shortcut","small","activeFileRepoRoot","activeFile","activeFileCurrentBranch","StyledLastMessage","StatusBarProcess","process","ProgressBar","dense","namePosition","width","button","onPause","ProgressBarPauseButton","P","paused","onPausedChange","ProgressBarStopButton","IdeStatusBar","cursorPosition","isBranchesPopupOpen","setBranchesPopupOpen","StatusBar","left","role","onClick","right","StatusBarWidget","MenuTrigger","PopupOnTrigger","onOpenChange","placement","interactions","trigger","RollbackTreeContextMenu","StyledFrame","contrastBorder","StyledLine","RollbackWindow","defaultExpandedKeys","initiallyIncludedChangeKeys","setWindowBounds","useNestedSelectionState","onSelectedKeysChange","changeListManager","setOpen","close","ModalWindow","bounds","onBoundsChange","minHeight","minWidth","footer","padding","display","flexDirection","WindowLayout","show","flex","toolWindowsState","ToolWindowsState","fromEntries","tips","useTips","keymap","useKeymap","renderedTips","keyboardShortcut","shortcutToString","setIndex","floor","random","next","tmpIndex","Input","forwardedRef","useObjectRef","focusableProps","useFocusable","searchEverywhereState","contextElement","initialSearchQuery","ContentAwarePopup","hasContent","persistedBoundsState","noContentHeight","otherProps","persistBounds","getInitBounds","top","innerHeight","setBounds","heightToRestoreRef","StyledIconWrapper","StyledItemLayout","StyledTitleWrapper","inactiveTextColor","StyledSpacer","ActionItem","action","highlights","TextWithHighlights","marginRight","field","isInResolvedActionGroup","breadcrumb","unshift","getActionBreadcrumb","join","actionsSearchContributor","use","everyWhereAutoSet","showDisabledActions","setShowDisabledActions","allActions","getAvailableActionsFor","shouldIncludeDisabledActions","search","query","allResults","minusculeMatch","searchDeps","isEverywhere","toggleEverywhere","currentValue","searchAdvertiser","ActionShortcut","headerFilters","processSelectedItem","element","getItemText","renderItem","FileItem","matches","dirMatches","filenameMatches","splitWhen","match","from","titleMatches","to","filesSearchContributor","getProjectFiles","SearchEverywhereActionIds","StyledHeader","StyledTab","selected","disabled","StyledTabContent","StyledTabs","StyledSearchFieldContainer","StyledSearchResultsContainer","StyledDivider","StyledSearchFieldHint","StyledLoadMore","StyledPlaceholder","contributors","LOAD_MORE_ITEM","LOAD_MORE_ITEM_KEY","SearchEverywherePopup","setTab","setEveryWhereAutoSet","pattern","setPattern","persistInitialSearchQuery","getShortcut","useGetActionShortcut","idToContributor","contributor","activeContributors","searchResultLimit","setSearchResultLimit","searchResult","currentTabContributor","visibleSearchResult","notFoundPatternRef","selectionManagerRef","setFocusedKey","localActions","currentContributorIndex","contributorActions","collectionRef","collectionSearchInputProps","useCollectionSearchInput","selectionManager","hasControls","Tabs","TabComponent","TabsComponent","Tooltip","margin","contain","newPattern","newPatternContainsPrevious","onPatternChanged","currentTarget","List","alwaysShowAsFocused","shouldFocusWrap","limit","nextItem","itemWrapper","Link","useProjectActions","openSearchEverywhere","StyledWindowFrame","Project","isRollbackWindowOpen","isSearchEveryWhereOpen","useInitializeChanges","useCapture","DefaultToolWindows","onToolWindowStateChange","newState","windows","allowBlurOnInteractionOutside","StyledDialog","WINDOW_SHADOW","StyledDialogHeader","StyledDialogContent","SampleRepoInitializer","repoUrl","info","isSuccessfullyCloned","clone","http","corsProxy","singleBranch","cloneRepo","exampleAppKeymap","ActivateProjectWindow","firstKeyStroke","modifiers","ActivateCommitWindow","ActivateTerminalWindow","App","KeymapProvider","PopupManager","BalloonManager","disablePortal"],"sourceRoot":""}