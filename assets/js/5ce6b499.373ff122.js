"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4895],{59988:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>m,frontMatter:()=>a,metadata:()=>s,toc:()=>c});var i=t(7896),o=(t(2784),t(30876));const a={},r="Actions",s={unversionedId:"guides/ActionSystem",id:"guides/ActionSystem",title:"Actions",description:"The current implementation of the action system is experimental and is likely to undergo significant revisions to meet",source:"@site/docs/guides/ActionSystem.mdx",sourceDirName:"guides",slug:"/guides/ActionSystem",permalink:"/jui/docs/guides/ActionSystem",draft:!1,editUrl:"https://github.com/alirezamirian/jui/edit/master/packages/website/docs/guides/ActionSystem.mdx",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Theming",permalink:"/jui/docs/guides/Theming"},next:{title:"Collections",permalink:"/jui/docs/guides/Collections"}},l={},c=[{value:"Defining actions",id:"defining-actions",level:2},{value:"Action Groups",id:"action-groups",level:3},{value:"Default action group",id:"default-action-group",level:3},{value:"Using actions",id:"using-actions",level:2},{value:"Query actions based on DOM elements",id:"query-actions-based-on-dom-elements",level:3},{value:"UI components",id:"ui-components",level:3},{value:"Menu",id:"menu",level:3},{value:"ActionButton",id:"actionbutton",level:3},{value:"Shortcuts and key mapping",id:"shortcuts-and-key-mapping",level:2},{value:"Differences with the Intellij Platform",id:"differences-with-the-intellij-platform",level:2}],p={toc:c},d="wrapper";function m(e){let{components:n,...t}=e;return(0,o.kt)(d,(0,i.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"actions"},"Actions"),(0,o.kt)("admonition",{title:"Experimental",type:"warning"},(0,o.kt)("p",{parentName:"admonition"},"The current implementation of the action system is experimental and is likely to undergo significant revisions to meet\nthe performance demands of real-world applications with thousands of actions.")),(0,o.kt)("p",null,"An ",(0,o.kt)("em",{parentName:"p"},"action")," represents an available functionality, without specifying how it's invoked. Shortcuts can separately be\nassigned to actions via a ",(0,o.kt)("inlineCode",{parentName:"p"},"keymap"),", allowing for a customizable and personalized user experience. The action system,\nat its core, is only about defining actions for each part of the UI and associating these actions with\nshortcuts, without any direct dependencies on other aspects of the design system. However, there are\n",(0,o.kt)("a",{parentName:"p",href:"#ui-components"},"UI components")," available to facilitate creation of toolbars and menus based on actions."),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"The core functionality of the action system may be extracted into a standalone package in the future,\nmaking it a reusable component for applications built using any design system.")),(0,o.kt)("p",null,"The action system consists of the following primary components:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"ActionsProvider")," component, which allows for defining actions for a UI area."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"KeymapProvider")," component, which allows for assigning shortcut(s) to actions."),(0,o.kt)("li",{parentName:"ul"},"UI components that helps with creating menus, toolbars, etc. based on action system abstractions.")),(0,o.kt)("p",null,"Below is a basic example of how these components are used.\nSubsequent sections will provide detailed explanations of the components and interfaces involved."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"live noInline noPadding themed",live:!0,noInline:!0,noPadding:!0,themed:!0},'const StyledDiv = styled.div`\n  &:focus {\n    outline: 4px solid ${({ theme }) => theme.color("Button.focusedBorderColor")}!important;\n    outline-offset: 2px;\n  }\n`;\nrender(\n  <KeymapProvider\n    keymap={{\n      MY_ACTION: [\n        {\n          type: "keyboard",\n          firstKeyStroke: { modifiers: ["Shift"], code: "KeyD" },\n        },\n      ],\n    }}\n  >\n    <ActionsProvider\n      actions={[\n        {\n          id: "MY_ACTION",\n          title: "My Action",\n          icon: <PlatformIcon icon="general/information.svg" />,\n          actionPerformed: () => alert("My Action performed"),\n        },\n      ]}\n    >\n      {({ shortcutHandlerProps }) => (\n        <div {...shortcutHandlerProps} style={{ padding: "1rem" }}>\n          <StyledDiv tabIndex={0}>\n            Click here to focus, then press <code>Shift+D</code>\n          </StyledDiv>\n          <br />\n          <div style={{ display: "flex", alignItems: "center", gap: "0.5rem" }}>\n            Or press this button: <ActionButton actionId="MY_ACTION" />\n          </div>\n        </div>\n      )}\n    </ActionsProvider>\n  </KeymapProvider>\n);\n')),(0,o.kt)("h2",{id:"defining-actions"},"Defining actions"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"ActionsProvider")," is used as a wrapper component that defines available actions for the wrapped UI.\nMultiple, potentially nested ",(0,o.kt)("inlineCode",{parentName:"p"},"ActionsProvider")," may be rendered in an application. ",(0,o.kt)("inlineCode",{parentName:"p"},"ActionProvider")," itself doesn't render\nany wrapper element. Shortcut event handler props are passed to ",(0,o.kt)("inlineCode",{parentName:"p"},"children")," which is expected to be a render function:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"<ActionsProvider actions={actions}>\n  {({ shortcutHandlerProps }) => <div {...shortcutHandlerProps}>...</div>}\n</ActionsProvider>\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"actions")," is an array of objects implementing ",(0,o.kt)("inlineCode",{parentName:"p"},"ActionDefinition")," interface. At minimum, an action must have:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"id"),": A unique identifier based on which shortcuts are assigned in ",(0,o.kt)("inlineCode",{parentName:"li"},"keymap"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"actionPerformed"),": A function to be invoked when the action is triggered, e.g. via a shortcut."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"title"),": The only mandatory presentation information for the action.")),(0,o.kt)("p",null,"Moreover, an action has the following optional properties:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"isDisabled"),": If ",(0,o.kt)("inlineCode",{parentName:"li"},"true"),", prevents action from being performed. ",(0,o.kt)("a",{parentName:"li",href:"#ui-components"},"Action UI components")," will also utilize\nthis field to either disable or hide the corresponding UI component."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"icon"),": A React node to be used as the associated icon for the action. It's required if the action is to be rendered\nas an ",(0,o.kt)("a",{parentName:"li",href:"#actionbutton"},"ActionButton"),", and optional for ",(0,o.kt)("a",{parentName:"li",href:"#menu"},"menu items"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"description"),": Plain text, additional description about the action. Not used in ",(0,o.kt)("a",{parentName:"li",href:"#actionbutton"},"ActionButton"),", or\n",(0,o.kt)("a",{parentName:"li",href:"#menu"},"menu items"),".")),(0,o.kt)("h3",{id:"action-groups"},"Action Groups"),(0,o.kt)("p",null,"An ActionGroup is a special type of action with a list of children actions. An action group itself can be performed."),(0,o.kt)("h3",{id:"default-action-group"},"Default action group"),(0,o.kt)("p",null,"A default implementation of action group is available, which when performed, opens a ",(0,o.kt)("a",{parentName:"p",href:"../components/popup"},"Popup"),",\npresenting the children actions in a ",(0,o.kt)("a",{parentName:"p",href:"../components/Menu#speedsearchmenu"},"SpeedSearchMenu"),". The default action\ngroup requires ",(0,o.kt)("a",{parentName:"p",href:"../components/Popup#popupmanager"},"PopupManager"),", for opening the popup."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"useCreateDefaultActionGroup")," returns a function that creates action groups:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},'import { useCreateDefaultActionGroup } from "@intellij-platform/core";\n\nconst createDefaultActionGroup = useCreateDefaultActionGroup();\n\ncreateDefaultActionGroup({\n  id: "MY_ACTION_GROUP",\n  title: "My Action Group",\n  children: [\n    /* action definitions */\n  ],\n});\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"themed live noInline",themed:!0,live:!0,noInline:!0},'function ExampleApp({ children }) {\n  return (\n    <PopupManager>\n      <KeymapProvider\n        keymap={{\n          Changelists: [\n            {\n              type: "keyboard",\n              firstKeyStroke: { modifiers: ["Shift"], code: "KeyD" },\n            },\n          ],\n        }}\n      >\n        {children}\n      </KeymapProvider>\n    </PopupManager>\n  );\n}\nfunction DefaultActionGroupExample() {\n  const createDefaultActionGroup = useCreateDefaultActionGroup();\n\n  return (\n    <ActionsProvider\n      actions={[\n        createDefaultActionGroup({\n          id: "Changelists",\n          title: "Changelists",\n          icon: <PlatformIcon icon="vcs/changelist.svg" />,\n          children: [\n            {\n              id: "New Changelist...",\n              title: "New Changelist...",\n              icon: <PlatformIcon icon="general/add.svg" />,\n              actionPerformed: () => alert("New Changelist..."),\n            },\n            {\n              id: "Edit Changelist...",\n              title: "Edit Changelist...",\n              icon: <PlatformIcon icon="actions/edit.svg" />,\n              actionPerformed: () => alert("Edit Changelist..."),\n            },\n            {\n              id: "Move to another changelist...",\n              title: "Move to another changelist...",\n              actionPerformed: () => alert("Edit Changelist..."),\n            },\n          ],\n        }),\n      ]}\n    >\n      {({ shortcutHandlerProps }) => (\n        <div {...shortcutHandlerProps}>\n          <ActionButton actionId="Changelists" />\n        </div>\n      )}\n    </ActionsProvider>\n  );\n}\n\nrender(\n  <ExampleApp>\n    <DefaultActionGroupExample />\n  </ExampleApp>\n);\n')),(0,o.kt)("h2",{id:"using-actions"},"Using actions"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"useActions")," can be used to query the list of all provided actions. Use ",(0,o.kt)("inlineCode",{parentName:"p"},"useAction")," instead to query an specific action,\nby id. The queried ",(0,o.kt)("inlineCode",{parentName:"p"},"Action")," object has a ",(0,o.kt)("inlineCode",{parentName:"p"},"perform")," method which can be invoked e.g. when a menu item or a button is\npressed. Note that ",(0,o.kt)("inlineCode",{parentName:"p"},"Action")," interface is quite similar but not identical to ",(0,o.kt)("inlineCode",{parentName:"p"},"ActionDefinition"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},'function MyActionButton() {\n  const action = useAction("MY_ACTION");\n  return action && <Button onPress={() => action.perform()}>My Action</Button>;\n}\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"useActionGroup")," is also similar to ",(0,o.kt)("inlineCode",{parentName:"p"},"useAction"),", but it asserts the queried action is a group."),(0,o.kt)("h3",{id:"query-actions-based-on-dom-elements"},"Query actions based on DOM elements"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"useAction")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"useActions")," is the canonical API for accessing currently provided actions from a React component.\n",(0,o.kt)("inlineCode",{parentName:"p"},"getAvailableActionsFor")," is an alternative API that allows for querying available actions from a DOM element. This can\nbe useful in specific scenarios such as the implementation of the ",(0,o.kt)("a",{parentName:"p",href:"https://www.jetbrains.com/idea/guide/tutorials/presenting/find-action"},"find action"),'.\nYou can also check out the implementation of "find action" action ',(0,o.kt)("a",{parentName:"p",href:"https://github.com/alirezamirian/jui/blob/master/packages/example-app/src/SearchEverywhere/contributors/action/actionsSearchContributor.tsx"},"in the example app"),"."),(0,o.kt)("h3",{id:"ui-components"},"UI components"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"useAction"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"useActionGroup")," can be used to query actions and create a menu or toolbar out of them. For typical\nuse cases, however, there are convenient components that interface on ",(0,o.kt)("inlineCode",{parentName:"p"},"Action")," or action id."),(0,o.kt)("h3",{id:"menu"},"Menu"),(0,o.kt)("p",null,"Use ",(0,o.kt)("inlineCode",{parentName:"p"},"ActionsMenu")," to render a list of action objects as a menu. ",(0,o.kt)("inlineCode",{parentName:"p"},"ActionGroup")," items are rendered as a section or a\nsubmenu, depending on ",(0,o.kt)("inlineCode",{parentName:"p"},"menuPresentation")," property of the action group object.\nNote that ",(0,o.kt)("inlineCode",{parentName:"p"},"ActionsMenu")," just provides an interface based on action items, but it doesn't query any action from the\nactions context, and just uses action properties to create menu items from it."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"themed live",themed:!0,live:!0},'<ActionsMenu\n  // actions would normally be coming from useAction calls, rather than hard coded like this, but this example\n  // shows how ActionsMenu is a dump component mapping Action objects to menu items.\n  actions={[\n    {\n      id: "Cut",\n      title: "Cut",\n      icon: <PlatformIcon icon="actions/menu-cut.svg" />,\n      shortcut: "\u2318X",\n      perform: () => alert("Cut"),\n    },\n    {\n      id: "Copy",\n      title: "Copy",\n      icon: <PlatformIcon icon="actions/copy.svg" />,\n      shortcut: "\u2318C",\n      perform: () => alert("Copy"),\n    },\n    {\n      id: "Copy Path/Reference...",\n      title: "Copy Path/Reference...",\n      perform: () => alert("Copy Path/Reference..."),\n    },\n    {\n      id: "Paste",\n      title: "Paste",\n      icon: <PlatformIcon icon="actions/menu-paste.svg" />,\n      shortcut: "\u2318V",\n      perform: () => alert("Paste"),\n    },\n    new DividerItem(),\n    {\n      id: "Compare with...",\n      title: "Diff",\n      icon: <PlatformIcon icon="actions/diff.svg" />,\n      shortcut: "\u2318D",\n      perform: () => alert("Diff"),\n    },\n  ]}\n/>\n')),(0,o.kt)("p",null,"Use ",(0,o.kt)("inlineCode",{parentName:"p"},"ActionGroupMenu")," to render actions of an action group, as a menu:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"themed live",themed:!0,live:!0},'<ActionGroupMenu\n  // actions would normally be coming from useAction calls, rather than hard coded like this, but this example\n  // shows how ActionsMenu is a dump component mapping Action objects to menu items.\n  actionGroup={{\n    id: "FILE_ACTIONS",\n    title: "File Actions",\n    children: [\n      {\n        id: "Cut",\n        title: "Cut",\n        icon: <PlatformIcon icon="actions/menu-cut.svg" />,\n        shortcut: "\u2318X",\n        perform: () => alert("Cut"),\n      },\n      {\n        id: "Copy",\n        title: "Copy",\n        icon: <PlatformIcon icon="actions/copy.svg" />,\n        shortcut: "\u2318C",\n        perform: () => alert("Copy"),\n      },\n      {\n        id: "Copy Path/Reference...",\n        title: "Copy Path/Reference...",\n        perform: () => alert("Copy Path/Reference..."),\n      },\n      {\n        id: "Paste",\n        title: "Paste",\n        icon: <PlatformIcon icon="actions/menu-paste.svg" />,\n        shortcut: "\u2318V",\n        perform: () => alert("Paste"),\n      },\n      {\n        id: "DIFF_ACTION_GROUP",\n        title: "Diff actions",\n        children: [\n          {\n            id: "Compare with...",\n            title: "Diff",\n            icon: <PlatformIcon icon="actions/diff.svg" />,\n            shortcut: "\u2318D",\n            perform: () => alert("Diff"),\n          },\n        ],\n      },\n    ],\n  }}\n/>\n')),(0,o.kt)("h3",{id:"actionbutton"},"ActionButton"),(0,o.kt)("p",null,"Use ",(0,o.kt)("inlineCode",{parentName:"p"},"ActionButton")," to create an ",(0,o.kt)("inlineCode",{parentName:"p"},"IconButton")," based on a provided action. Unlike ",(0,o.kt)("inlineCode",{parentName:"p"},"ActionsMenu")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"ActionGroupMenu"),",\n",(0,o.kt)("inlineCode",{parentName:"p"},"ActionButton")," interfaces on action ID, and queries the target action via ",(0,o.kt)("inlineCode",{parentName:"p"},"useAction"),". If the action doesn't exist,\nit renders nothing."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx",metastring:"live themed noPadding",live:!0,themed:!0,noPadding:!0},'<ActionsProvider\n  actions={[\n    {\n      id: "refresh",\n      title: "Refresh",\n      icon: <PlatformIcon icon="actions/refresh.svg" />,\n      actionPerformed: () => alert("Refresh"),\n    },\n  ]}\n>\n  {({ shortcutHandlerProps }) => (\n    <div {...shortcutHandlerProps} style={{ padding: "1rem" }}>\n      <ActionButton actionId="refresh" />\n    </div>\n  )}\n</ActionsProvider>\n')),(0,o.kt)("h2",{id:"shortcuts-and-key-mapping"},"Shortcuts and key mapping"),(0,o.kt)("p",null,"A ",(0,o.kt)("inlineCode",{parentName:"p"},"Keymap")," is a mapping from action ids to a list of associated shortcuts. In an application that uses actions, the\n",(0,o.kt)("inlineCode",{parentName:"p"},"KeymapProvider")," is typically used as a top level wrapper, to provide a keymap."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import {Keymap, KeymapProvider} from '@intellij-platform/core';\n\nconst keymap: Keymap = isMac() ? macKeymap : defaultKeymap;\n<KeymapProvider keymap={keymap}>...</KeyMapProvider>\n")),(0,o.kt)("h2",{id:"differences-with-the-intellij-platform"},"Differences with the Intellij Platform"),(0,o.kt)("p",null,"While the action system almost replicates ",(0,o.kt)("a",{parentName:"p",href:"https://plugins.jetbrains.com/docs/intellij/basic-action-system.html"},"Intellij Platform's Action System"),", there are some design\ndifferences worth noting:"),(0,o.kt)("p",null,"TODO"))}m.isMDXComponent=!0}}]);
//# sourceMappingURL=5ce6b499.373ff122.js.map