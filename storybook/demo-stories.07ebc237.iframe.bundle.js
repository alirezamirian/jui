"use strict";(self.webpackChunk_intellij_platform_core=self.webpackChunk_intellij_platform_core||[]).push([[7752],{"./src/demo.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ExampleApp:()=>ExampleApp,__namedExportsOrder:()=>__namedExportsOrder,default:()=>demo_stories});var react=__webpack_require__("../../node_modules/react/index.js"),story_helpers=__webpack_require__("./src/story-helpers.tsx"),es=__webpack_require__("../../node_modules/recoil/es/index.js"),isomorphic_git=__webpack_require__("../../node_modules/isomorphic-git/index.js"),web=__webpack_require__("../../node_modules/isomorphic-git/http/web/index.js"),KeymapProvider=__webpack_require__("./src/ActionSystem/KeymapProvider.tsx"),BalloonManager=__webpack_require__("./src/Balloon/BalloonManager.tsx"),ModalWindow=__webpack_require__("./src/ModalWindow/ModalWindow.tsx"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");const WindowsContext=react.createContext({open:()=>{throw new Error("WindowManager not found. Wrap your application with WindowManager to be able to open windows imperatively")}}),useWindowManager=()=>(0,react.useContext)(WindowsContext),WindowManager=({children})=>{const[windows,setWindows]=(0,react.useState)([]),newKeyRef=(0,react.useRef)(0),api=(0,react.useMemo)((()=>({open:content=>{newKeyRef.current++;const close=()=>{setWindows((currentWindows=>currentWindows.filter((aWindow=>aWindow!==window))))},window=(0,jsx_runtime.jsx)(ModalWindow.zj.Provider,{value:{onClose:close},children:"function"==typeof content?content({close}):content},newKeyRef.current);setWindows((currentWindows=>currentWindows.concat(window)))}})),[]);return(0,jsx_runtime.jsxs)(WindowsContext.Provider,{value:api,children:[children,windows]})};WindowManager.displayName="WindowManager";try{useWindowManager.displayName="useWindowManager",useWindowManager.__docgenInfo={description:"Returns imperative API for showing windows.",displayName:"useWindowManager",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ModalWindow/WindowManager.tsx#useWindowManager"]={docgenInfo:useWindowManager.__docgenInfo,name:"useWindowManager",path:"src/ModalWindow/WindowManager.tsx#useWindowManager"})}catch(__react_docgen_typescript_loader_error){}try{WindowManager.displayName="WindowManager",WindowManager.__docgenInfo={description:"Enables imperative API (via {@link useWindowManager}) for opening windows.\nIt renders windows in a portal appended to `body`, unless `disablePortal` is `true`.",displayName:"WindowManager",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ModalWindow/WindowManager.tsx#WindowManager"]={docgenInfo:WindowManager.__docgenInfo,name:"WindowManager",path:"src/ModalWindow/WindowManager.tsx#WindowManager"})}catch(__react_docgen_typescript_loader_error){}var PopupManager=__webpack_require__("./src/Popup/PopupManager.tsx"),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js");const Img=({darkSrc,...props})=>(0,styled_components_browser_esm.Fg)().dark?(0,jsx_runtime.jsx)("img",{...props,src:darkSrc||props.src}):(0,jsx_runtime.jsx)("img",{...props});Img.displayName="Img";try{Img.displayName="Img",Img.__docgenInfo={description:"Same as default `img`, but theme aware. Meaning that you can specify different sources for normal and dark mode.",displayName:"Img",props:{darkSrc:{defaultValue:null,description:"src for when a dark theme is active. if `darkSrc` doesn't have a non-empty string value, src will be used both\nfor dark and light themes.",name:"darkSrc",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/Img.tsx#Img"]={docgenInfo:Img.__docgenInfo,name:"Img",path:"src/Img.tsx#Img"})}catch(__react_docgen_typescript_loader_error){}const loading_namespaceObject=__webpack_require__.p+"static/media/loading.e4ce7cef.gif",loading_dark_namespaceObject=__webpack_require__.p+"static/media/loading_dark.63238210.gif",LoadingGif=props=>(0,jsx_runtime.jsx)(Img,{...props,src:loading_namespaceObject,darkSrc:loading_dark_namespaceObject});LoadingGif.displayName="LoadingGif";try{LoadingGif.displayName="LoadingGif",LoadingGif.__docgenInfo={description:"",displayName:"LoadingGif",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/LoadingGif.tsx#LoadingGif"]={docgenInfo:LoadingGif.__docgenInfo,name:"LoadingGif",path:"../example-app/src/LoadingGif.tsx#LoadingGif"})}catch(__react_docgen_typescript_loader_error){}const Loading=(0,styled_components_browser_esm.ZP)(LoadingGif).withConfig({displayName:"DefaultSuspense__Loading",componentId:"sc-1n9vzm7-0"})(["width:fit-content;margin:auto;"]),DefaultSuspense=({fallback=(0,jsx_runtime.jsx)(Loading,{}),children})=>(0,jsx_runtime.jsx)(react.Suspense,{fallback,children});DefaultSuspense.displayName="DefaultSuspense";try{DefaultSuspense.displayName="DefaultSuspense",DefaultSuspense.__docgenInfo={description:"",displayName:"DefaultSuspense",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/DefaultSuspense.tsx#DefaultSuspense"]={docgenInfo:DefaultSuspense.__docgenInfo,name:"DefaultSuspense",path:"../example-app/src/DefaultSuspense.tsx#DefaultSuspense"})}catch(__react_docgen_typescript_loader_error){}var styled=__webpack_require__("./src/styled.ts"),ActionsProvider=__webpack_require__("./src/ActionSystem/ActionsProvider.tsx"),DefaultToolWindows=__webpack_require__("./src/ToolWindowsImpl/DefaultToolWindows.tsx"),ToolWindowActionIds=__webpack_require__("./src/ToolWindowsImpl/ToolWindowActionIds.ts"),useLatest=__webpack_require__("./src/utils/useLatest.ts"),ContextMenuContainer=__webpack_require__("./src/Menu/ContextMenuContainer.tsx"),Menu=__webpack_require__("./src/Menu/Menu.tsx"),Item=__webpack_require__("./src/Collections/Item.ts"),EditorTabs=__webpack_require__("./src/Tabs/EditorTabs/EditorTabs.tsx"),PlatformIcon=__webpack_require__("./src/Icon/PlatformIcon.tsx"),TabItem=__webpack_require__("./src/Tabs/TabItem.tsx"),MenuItemLayout=__webpack_require__("./src/Menu/MenuItemLayout.tsx"),TooltipTrigger=__webpack_require__("./src/Tooltip/TooltipTrigger.tsx"),ActionTooltip=__webpack_require__("./src/Tooltip/ActionTooltip.tsx"),EditorTabContent=__webpack_require__("./src/Tabs/EditorTabs/EditorTabContent.tsx"),TabCloseButton=__webpack_require__("./src/Tabs/TabCloseButton.tsx"),editor_main=__webpack_require__("../../node_modules/monaco-editor/esm/vs/editor/editor.main.js"),path_browserify=__webpack_require__("../../node_modules/path-browserify/index.js"),path_browserify_default=__webpack_require__.n(path_browserify);const extensionIconMap={editorconfig:"nodes/editorconfig",js:"fileTypes/javaScript",gitignore:"vcs/ignore_file",archive:"fileTypes/archive",as:"fileTypes/as",config:"fileTypes/config",css:"fileTypes/css",dtd:"fileTypes/dtd",hpr:"fileTypes/hprof",htaccess:"fileTypes/htaccess",html:"fileTypes/html",idl:"fileTypes/idl",java:"fileTypes/java",jfr:"fileTypes/jfr",json:"fileTypes/json",jsp:"fileTypes/jsp",jspx:"fileTypes/jspx",manifest:"fileTypes/manifest",properties:"fileTypes/properties",txt:"fileTypes/text",wsdl:"fileTypes/wsdlFile",xhtml:"fileTypes/xhtml",xml:"fileTypes/xml",xsd:"fileTypes/xsdFile",yaml:"fileTypes/yaml"},getIconForFile=filepath=>{const extension=getExtension(filepath);return extensionIconMap[extension]||"fileTypes/text"},getExtension=filepath=>filepath.split(".").pop()||"";function getParentPaths(filepath,upperLimit=path_browserify_default().sep){return getParentPathsRecursive(filepath,upperLimit)}function getParentPathsRecursive(filepath,upperLimit,previousPaths=[]){const dirname=path_browserify_default().dirname(filepath);return dirname!==upperLimit?[dirname].concat(getParentPathsRecursive(dirname,upperLimit,previousPaths)):previousPaths}try{getIconForFile.displayName="getIconForFile",getIconForFile.__docgenInfo={description:"",displayName:"getIconForFile",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/file-utils.tsx#getIconForFile"]={docgenInfo:getIconForFile.__docgenInfo,name:"getIconForFile",path:"../example-app/src/file-utils.tsx#getIconForFile"})}catch(__react_docgen_typescript_loader_error){}var lib_es=__webpack_require__("../../node_modules/@monaco-editor/react/lib/es/index.js");const darculaColorSchemeTokenRules=JSON.parse('{"nG":[{"scope":"emphasis","settings":{"fontStyle":"italic"}},{"scope":"strong","settings":{"fontStyle":"bold"}},{"scope":"header","settings":{"foreground":"#000080"}},{"scope":"comment","settings":{"foreground":"#808080"}},{"scope":"constant.language","settings":{"foreground":"#CC7832","fontStyle":"bold"}},{"scope":["constant.numeric"],"settings":{"foreground":"#6897BB"}},{"scope":"constant.regexp","settings":{"foreground":"#646695"}},{"scope":"entity.name.tag","settings":{"foreground":"#FFC66D"}},{"scope":"entity.name.tag.css","settings":{"foreground":"#d7ba7d"}},{"scope":"entity.other.attribute-name","settings":{"foreground":"#BABABA"}},{"scope":["entity.other.attribute-name.class.css","entity.other.attribute-name.class.mixin.css","entity.other.attribute-name.id.css","entity.other.attribute-name.parent-selector.css","entity.other.attribute-name.pseudo-class.css","entity.other.attribute-name.pseudo-element.css","source.css.less entity.other.attribute-name.id","entity.other.attribute-name.attribute.scss","entity.other.attribute-name.scss"],"settings":{"foreground":"#d7ba7d"}},{"scope":"invalid","settings":{"foreground":"#f44747"}},{"scope":"markup.underline","settings":{"fontStyle":"underline"}},{"scope":"markup.bold","settings":{"foreground":"#A9B7C6"}},{"scope":"markup.heading","settings":{"foreground":"#A9B7C6"}},{"scope":"markup.italic","settings":{"fontStyle":"italic"}},{"scope":"markup.inserted","settings":{"foreground":"#b5cea8"}},{"scope":"markup.deleted","settings":{"foreground":"#ce9178"}},{"scope":"markup.changed","settings":{"foreground":"#A9B7C6"}},{"scope":"beginning.punctuation.definition.quote.markdown","settings":{"foreground":"#608b4e"}},{"scope":"beginning.punctuation.definition.list.markdown","settings":{"foreground":"#6796e6"}},{"scope":"markup.inline.raw","settings":{"foreground":"#ce9178"}},{"scope":"meta.selector","settings":{"foreground":"#d7ba7d"}},{"name":"brackets of XML/HTML tags","scope":"punctuation.definition.tag","settings":{"foreground":"#FFC66D"}},{"scope":"meta.preprocessor","settings":{"foreground":"#CC7832"}},{"scope":"meta.preprocessor.string","settings":{"foreground":"#ce9178"}},{"scope":"meta.preprocessor.numeric","settings":{"foreground":"#b5cea8"}},{"scope":"meta.structure.dictionary.key.python","settings":{"foreground":"#9876AA"}},{"scope":"meta.diff.header","settings":{"foreground":"#CC7832"}},{"scope":"storage","settings":{"foreground":"#ff0000"}},{"scope":"storage.type","settings":{"foreground":"#CC7832","fontStyle":"bold"}},{"scope":["keyword.other.phpdoc.php","keyword.other.type.php","storage.type.class.jsdoc","entity.name.type.instance.jsdoc","variable.other.jsdoc"],"settings":{"foreground":"#808080"}},{"scope":"storage.modifier","settings":{"foreground":"#CC7832","fontStyle":"bold"}},{"scope":"string","settings":{"foreground":"#6A8759"}},{"scope":"string.tag","settings":{"foreground":"#6A8759"}},{"scope":"string.value","settings":{"foreground":"#6A8759"}},{"scope":"string.regexp","settings":{"foreground":"#6A8759"}},{"name":"JavaScript string interpolation ${}","scope":["punctuation.definition.template-expression.begin.js","punctuation.definition.template-expression.begin.ts","punctuation.definition.template-expression.end.ts","punctuation.definition.template-expression.end.js"],"settings":{"foreground":"#A9B7C6"}},{"scope":["support.type.vendored.property-name","support.type.property-name","variable.css","variable.scss","variable.other.less"],"settings":{"foreground":"#9876AA"}},{"scope":["variable.other.property","support.variable.property.dom","entity.other.inherited-class"],"settings":{"foreground":"#9876AA"}},{"scope":["variable.other.object","variable.other.object.property","support.class.dom","meta.function-call","entity.name.type.module"],"settings":{"foreground":"#A9B7C6"}},{"scope":["variable.other.readwrite","variable.other.constant.ts","variable.parameter","variable.other.readwrite.alias"],"settings":{"foreground":"#A9B7C6"}},{"scope":"keyword","settings":{"foreground":"#CC7832","fontStyle":"bold"}},{"scope":"keyword.control","settings":{"foreground":"#CC7832","fontStyle":"bold"}},{"scope":"keyword.operator","settings":{"foreground":"#A9B7C6"}},{"scope":["keyword.operator.new","keyword.operator.expression","keyword.operator.cast","keyword.operator.sizeof","keyword.operator.logical.python"],"settings":{"foreground":"#CC7832"}},{"scope":"keyword.other.unit","settings":{"foreground":"#b5cea8"}},{"scope":["punctuation.section.embedded.begin.metatag.php","punctuation.section.embedded.end.metatag.php"],"settings":{"foreground":"#CC7832"}},{"scope":"support.function.git-rebase","settings":{"foreground":"#9876AA"}},{"scope":"constant.sha.git-rebase","settings":{"foreground":"#b5cea8"}},{"name":"coloring of the Java import and package identifiers","scope":["storage.modifier.import.java","storage.modifier.package.java"],"settings":{"foreground":"#d4d4d4"}},{"name":"this.self","scope":"variable.language","settings":{"foreground":"#CC7832","fontStyle":"bold"}},{"name":"Source Python","scope":["source.python"],"settings":{"foreground":"#A9B7C6"}},{"name":"Magic function python","scope":["support.function.magic.python"],"settings":{"foreground":"#9876AA"}},{"name":"Self keyword python","scope":["variable.language.special.self.python","variable.parameter.function.language.special.self.python"],"settings":{"foreground":"#9876AA","fontStyle":""}},{"name":"Function declarations Python","scope":["entity.name.function.python","meta.function-call.generic.python"],"settings":{"foreground":"#FFC66D"}},{"name":"Function declarations","scope":["entity.name.function","support.function","support.constant.handlebars"],"settings":{"foreground":"#FFC66D"}},{"name":"Types declaration and references","scope":["meta.return-type","support.class","support.type","entity.name.type","entity.name.class","storage.type.cs","storage.type.generic.cs","storage.type.modifier.cs","storage.type.variable.cs","storage.type.annotation.java","storage.type.generic.java","storage.type.java","storage.type.object.array.java","storage.type.primitive.array.java","storage.type.primitive.java","storage.type.token.java","storage.type.groovy","storage.type.annotation.groovy","storage.type.parameters.groovy","storage.type.generic.groovy","storage.type.object.array.groovy","storage.type.primitive.array.groovy","storage.type.primitive.groovy"],"settings":{"foreground":"#4EC9B0"}},{"name":"Types declaration and references","scope":["support.class","entity.name.class","support.type","entity.name.type"],"settings":{"foreground":"#FFC66D"}},{"name":"Arrow Function","scope":["storage.type.function.arrow"],"settings":{"foreground":"#A9B7C6"}},{"name":"Types declaration and references, TS grammar specific","scope":["meta.type.cast.expr","meta.type.new.expr","support.constant.math","support.constant.dom","support.constant.json"],"settings":{"foreground":"#4EC9B0"}},{"name":"Control flow keywords","scope":"keyword.control","settings":{"foreground":"#CC7832","fontStyle":"bold"}},{"name":"Variable and parameter name","scope":["meta.definition.variable.name","support.variable"],"settings":{"foreground":"#A9B7C6"}},{"scope":["variable"],"settings":{"foreground":"#9876AA"}},{"name":"Object keys, TS grammar specific","scope":["meta.object-literal.key","meta.object-literal.key entity.name.function"],"settings":{"foreground":"#9876AA"}},{"name":"CSS property value","scope":["support.constant.property-value","support.constant.font-name","support.constant.media-type","support.constant.media","constant.other.color.rgb-value","constant.other.rgb-value","support.constant.color"],"settings":{"foreground":"#CE9178"}},{"scope":"token.info-token","settings":{"foreground":"#6796e6"}},{"scope":"token.warn-token","settings":{"foreground":"#cd9731"}},{"scope":"token.error-token","settings":{"foreground":"#f44747"}},{"scope":"token.debug-token","settings":{"foreground":"#b267e6"}}]}').nG.flatMap((({scope,settings})=>[].concat(scope).flatMap((scope=>scope.split(" "))).map((token=>{const values={token};return Object.keys(settings).forEach((key=>{const value=settings[key];value&&(values[key]=value)})),values})))),StyledEditor=(0,styled.zo)(lib_es.ZP)`
  .monaco-editor {
    .margin-view-overlays .line-numbers {
      text-align: left;
      padding-left: 7px;
    }

    .scrollbar .slider {
      border-radius: 0.25rem;
    }
  }
`,Editor=props=>{const editorTheme=(()=>{const monaco=(0,lib_es.Ik)(),theme=(0,styled_components_browser_esm.Fg)(),[themeName,setThemeName]=(0,react.useState)(theme.dark?"vs-dark":"light");return(0,react.useLayoutEffect)((()=>{if(monaco){const name=`jui-theme-${theme.name.replace(" ","")}`;monaco.editor.defineTheme(name,{base:theme.dark?"vs-dark":"vs",inherit:!0,colors:theme.dark?{"editor.background":"#2B2B2B","editor.lineHighlightBackground":"#323232","editor.lineHighlightBorder":"none","editorLineNumber.foreground":"#606366","editorActiveLineNumber.foreground":"#a4a3a3","editorIndentGuide.background":"#373737","editorIndentGuide.activeBackground":"#505050","editorGutter.background":theme.dark?"#313335":"#f0f0f0"}:{},rules:darculaColorSchemeTokenRules}),setThemeName(name)}}),[monaco,theme]),themeName})();return(0,jsx_runtime.jsx)(StyledEditor,{...props,options:{minimap:{enabled:!1},lineHeight:20,showFoldingControls:"always",renderIndentGuides:!0,overviewRulerBorder:!1,scrollbar:{verticalScrollbarSize:14,horizontalScrollbarSize:8,verticalSliderSize:8,horizontalSliderSize:8,horizontal:"auto",vertical:"visible",alwaysConsumeMouseWheel:!1},...props.options},theme:editorTheme})};Editor.displayName="Editor";try{StyledEditor.displayName="StyledEditor",StyledEditor.__docgenInfo={description:"",displayName:"StyledEditor",props:{theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"Theme<KnownThemePropertyPath>"}},as:{defaultValue:null,description:"",name:"as",required:!1,type:{name:"undefined"}},forwardedAs:{defaultValue:null,description:"",name:"forwardedAs",required:!1,type:{name:"undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/Editor/Editor.tsx#StyledEditor"]={docgenInfo:StyledEditor.__docgenInfo,name:"StyledEditor",path:"../example-app/src/Editor/Editor.tsx#StyledEditor"})}catch(__react_docgen_typescript_loader_error){}try{Editor.displayName="Editor",Editor.__docgenInfo={description:"Monaco Editor styled to look like Intellij Platform's editor.\nTODO:\n - folding controls appearance is different and should be changed\n - highlighting pairs of parens, brackets, etc. is different.\n - context menu look different.\n - selection look different.\n - BUG: height is more than necessary. Needs investigation first.",displayName:"Editor",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/Editor/Editor.tsx#Editor"]={docgenInfo:Editor.__docgenInfo,name:"Editor",path:"../example-app/src/Editor/Editor.tsx#Editor"})}catch(__react_docgen_typescript_loader_error){}var sortWith=__webpack_require__("../../node_modules/ramda/es/sortWith.js"),descend=__webpack_require__("../../node_modules/ramda/es/descend.js"),browserfs=__webpack_require__("../../node_modules/browserfs/dist/browserfs.js"),pify=__webpack_require__("../../node_modules/pify/index.js"),pify_default=__webpack_require__.n(pify);async function createIndexedDBFS(storeName="bfs-local-fs"){const idbfs=await createFsBackend((cb=>{browserfs.FileSystem.IndexedDB.Create({storeName},cb)}));return await new Promise((resolve=>idbfs.init(idbfs.store,resolve))),idbfs}function initializeFS(fsBackend){browserfs.initialize(fsBackend);const fsm=browserfs.BFSRequire("fs");return fsm.promises=pify_default()({...fsm,exists:(filePath,cb)=>fsm.exists(filePath,(value=>cb(null,value)))}),fsm}const createFs=backend=>{const fs=new(browserfs.BFSRequire("fs").FS);return fs.initialize(backend),fs};function createFsBackend(fn){return new Promise(((resolve,reject)=>{fn(((err,fs)=>{if(err||!fs)return reject(err);resolve(fs)}))}))}try{createIndexedDBFS.displayName="createIndexedDBFS",createIndexedDBFS.__docgenInfo={description:"",displayName:"createIndexedDBFS",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/fs/browser-fs.tsx#createIndexedDBFS"]={docgenInfo:createIndexedDBFS.__docgenInfo,name:"createIndexedDBFS",path:"../example-app/src/fs/browser-fs.tsx#createIndexedDBFS"})}catch(__react_docgen_typescript_loader_error){}try{initializeFS.displayName="initializeFS",initializeFS.__docgenInfo={description:"",displayName:"initializeFS",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/fs/browser-fs.tsx#initializeFS"]={docgenInfo:initializeFS.__docgenInfo,name:"initializeFS",path:"../example-app/src/fs/browser-fs.tsx#initializeFS"})}catch(__react_docgen_typescript_loader_error){}try{createFs.displayName="createFs",createFs.__docgenInfo={description:"",displayName:"createFs",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/fs/browser-fs.tsx#createFs"]={docgenInfo:createFs.__docgenInfo,name:"createFs",path:"../example-app/src/fs/browser-fs.tsx#createFs"})}catch(__react_docgen_typescript_loader_error){}var esm=__webpack_require__("../../node_modules/caf/dist/esm/index.mjs");const copyFsRecursively=(0,esm.qf)((function*(cancelSignal,params){const{source,target,rootDir,onCopy,force}=params,items=yield source.readdir(rootDir);for(const name of items){const fullPath=path_browserify_default().join(rootDir,name),stat=yield source.stat(fullPath);if(stat.isFile()||stat.isSymbolicLink()){if(!force&&(yield fileExists(target,fullPath)))return;onCopy?.(fullPath);const content=yield source.readFile(fullPath);yield ensureDir(target,path_browserify_default().dirname(fullPath)),yield target.writeFile(fullPath,content)}else stat.isDirectory()?yield copyFsRecursively(cancelSignal,{...params,rootDir:path_browserify_default().join(rootDir,name)}):console.warn("unsupported file system item skipped, when copying:",stat)}})),fileExists=async(fs,filepath)=>await fs.exists(filepath)&&!(await fs.stat(filepath)).isDirectory();async function ensureDir(fs,dirPath){const stat=await fs.stat(dirPath).catch((e=>"ENOENT"!==e.code&&Promise.reject(e)));if(!1===stat){const dirname=path_browserify_default().dirname(dirPath);dirname!==path_browserify_default().dirname(dirname)&&await ensureDir(fs,dirname),await fs.mkdir(dirPath).catch((e=>"EEXIST"===e.code?Promise.resolve():Promise.reject(e)))}else if(!stat.isDirectory())throw new Error(`path is not a directory, but already exists: ${dirPath}`)}let fs;const persistentFsPreference=(key="demo_app_use_persistent_fs",{get:()=>localStorage.getItem(key),set:value=>localStorage.setItem(key,value)});var key;async function switchToPersistentFS({onCopy=console.log,cancelSignal}={}){if(!function isFsInMemory(){return fs.getRootFS()instanceof browserfs.FileSystem.InMemory}())return void console.log("Already on persistent fs. Nothing to do.");console.log("Creating IndexedDB FS"),console.time("creating db");const indexedDbFsBackend=await createIndexedDBFS();await async function copyFs({source,target,cancelSignal,...rest}){await copyFsRecursively(cancelSignal,{...rest,source:pify_default()(source),target:pify_default()(target),rootDir:"/"})}({source:fs,target:await createFs(indexedDbFsBackend),cancelSignal,force:!0,onCopy}),console.timeEnd("creating db"),initializeFS(indexedDbFsBackend),console.log("FS switched to IndexedDB backend",indexedDbFsBackend)}const fsResource=function wrapPromise(promise){let response,status="pending";const suspender=promise.then((res=>{status="success",response=res}),(err=>{status="error",response=err}));return{read:()=>{switch(status){case"pending":throw suspender;case"error":throw response;default:return response}}}}(("yes"===persistentFsPreference.get()?createIndexedDBFS():async function createInMemoryFS(){return await createFsBackend((cb=>{browserfs.FileSystem.InMemory.Create({},cb)}))}()).then(initializeFS).then((theFs=>(window.fs=theFs,fs=theFs))).catch((e=>{throw console.log("could not initialize FS:",e),e}))),WaitForFs=({children})=>(fsResource.read(),children);try{switchToPersistentFS.displayName="switchToPersistentFS",switchToPersistentFS.__docgenInfo={description:"",displayName:"switchToPersistentFS",props:{onCopy:{defaultValue:{value:"console.log"},description:"",name:"onCopy",required:!1,type:{name:"((filepath: string) => void)"}},cancelSignal:{defaultValue:null,description:"",name:"cancelSignal",required:!1,type:{name:"unknown"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/fs/fs.tsx#switchToPersistentFS"]={docgenInfo:switchToPersistentFS.__docgenInfo,name:"switchToPersistentFS",path:"../example-app/src/fs/fs.tsx#switchToPersistentFS"})}catch(__react_docgen_typescript_loader_error){}try{fs.displayName="fs",fs.__docgenInfo={description:"local fs, for when used in browser. Most of the things here would be a noop in node environment.",displayName:"fs",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/fs/fs.tsx#fs"]={docgenInfo:fs.__docgenInfo,name:"fs",path:"../example-app/src/fs/fs.tsx#fs"})}catch(__react_docgen_typescript_loader_error){}try{persistentFsPreference.displayName="persistentFsPreference",persistentFsPreference.__docgenInfo={description:"Global fs preferences for which the file system itself can't be used as storage.",displayName:"persistentFsPreference",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/fs/fs.tsx#persistentFsPreference"]={docgenInfo:persistentFsPreference.__docgenInfo,name:"persistentFsPreference",path:"../example-app/src/fs/fs.tsx#persistentFsPreference"})}catch(__react_docgen_typescript_loader_error){}try{WaitForFs.displayName="WaitForFs",WaitForFs.__docgenInfo={description:"Suspense aware wrapper for waiting for FS to be initialized. initialization API in some fs backends such as\nBrowserFs, is async. That's why it's safe to use this on a high level.",displayName:"WaitForFs",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/fs/fs.tsx#WaitForFs"]={docgenInfo:WaitForFs.__docgenInfo,name:"WaitForFs",path:"../example-app/src/fs/fs.tsx#WaitForFs"})}catch(__react_docgen_typescript_loader_error){}const dirContentState=(0,es.CG)({key:"dirContents",get:path=>async()=>{let fileNames;try{fileNames=await fs.promises.readdir(path)}catch(e){return null}return(await Promise.all(fileNames.map((fileName=>{const filePath=`${path}/${fileName}`;return fs.promises.stat(filePath).then((stat=>({...stat,type:stat.isDirectory()?"dir":"file",filePath})))})))).map((stat=>({type:stat.type,path:stat.filePath,size:stat.size})))}}),reloadFileFromDiskCallback=({set})=>async path=>{try{const content=await fetchFileContent(path);return set(fileContent(path),content),!0}catch{return!1}},fetchFileContent=async filepath=>filepath?fs.promises.readFile(filepath,{encoding:"utf8"}):"",fileContent=(0,es.xu)({key:"fileContent",default:fetchFileContent,effects:filepath=>[({onSet})=>{onSet((content=>{filepath&&fs.promises.writeFile(filepath,content,"utf8").catch((e=>{console.error("failed to sync the file back to the fs",e)}))}))}]}),filterPath=({path})=>!path.split("/").includes(".git");var equals=__webpack_require__("../../node_modules/ramda/es/equals.js");function useLatestRecoilValue(recoilValue){const[state,setState]=(0,react.useState)(null);let loadable=(0,es.$P)(recoilValue);return(0,react.useEffect)((()=>{"hasValue"===loadable.state&&setState(loadable.contents)}),[loadable]),state}function useRecoilInitialValue(recoilState,defaultValue){return(0,es._8)((({snapshot})=>()=>snapshot.getLoadable(recoilState).getValue()??defaultValue),[])}const sampleRepos={JUI:{path:"/workspace/jui",url:"https://github.com/alirezamirian/jui.git"},"React Spectrum":{path:"/workspace/react-spectrum",url:"https://github.com/adobe/react-spectrum.git"},Recoil:{path:"/workspace/recoil",url:"https://github.com/facebookexperimental/Recoil.git"},ExampleRepo:{path:"/workspace/example-repo",url:"https://github.com/thurwitz/example-branches.git"}},sampleRepo=sampleRepos.JUI,currentProjectState=(0,es.cn)({key:"project",default:{name:"Workspace",path:"/workspace"}}),projectFilePath=(0,es.CG)({key:"projectFilePath",get:projectRelativePath=>({get})=>path_browserify_default().join(get(currentProjectState).path,projectRelativePath)}),currentProjectFilesState=(0,es.nZ)({key:"project.current.files",get:async({get})=>{const project=get(currentProjectState);return get(projectFilesState(project.path))}}),projectFilesState=(0,es.CG)({key:"project.files",get:projectPath=>async({get})=>{const items=get(dirContentState(projectPath)),files=[],addItem=item=>{if("dir"===item.type){if(filterPath(item)){const childItems=get(dirContentState(item.path));childItems&&childItems.forEach(addItem)}}else files.push({...item,relativePath:path_browserify_default().relative(projectPath,item.path)})};return(items||[]).forEach((item=>addItem(item))),files}}),activePathsState=(0,es.cn)({key:"project.activePaths",default:[]}),useActivePathsProvider=(state=activePathsState,nullValue=[],value=>{const setValue=(0,es.Zl)(state),isFocusedRef=(0,react.useRef)(!1);return(0,react.useEffect)((()=>{isFocusedRef.current&&setValue((currentValue=>(0,equals.Z)(value,currentValue)?currentValue:value))}),[value]),{onFocus:()=>{setValue(value),isFocusedRef.current=!0},onBlur:e=>{e.relatedTarget instanceof Element&&e.relatedTarget?.closest("[data-overlay-container]")||(setValue(nullValue),isFocusedRef.current=!1)}}});var state,nullValue;const temporaryTabsDefaultValue=(0,es.nZ)({key:"editor.tabs/Default",get:({get})=>(0,sortWith.Z)([(0,descend.Z)((file=>file.path===get(projectFilePath("README.md")))),(0,descend.Z)((file=>file.path.endsWith(".ts"))),(0,descend.Z)((file=>file.path.endsWith(".js")))],get(currentProjectFilesState).filter((item=>"file"===item.type))).slice(0,12).map((file=>({filePath:file.path,editorState:{cursorPos:{lineNumber:0,column:0}}})))}),editorTabsState=(0,es.cn)({key:"editor.tabs",default:temporaryTabsDefaultValue}),activeEditorTabIndexState=(0,es.cn)({key:"editor.activeTabIndex",default:0}),activeEditorTabState=(0,es.nZ)({key:"editor.activeTab",get:({get})=>{const tabs=get(editorTabsState);return tabs[get(activeEditorTabIndexState)]||tabs[0]||null}}),editorCursorPositionState=(0,es.cn)({key:"editor.cursorPosition",default:new editor_main.Ly(0,0)}),editorRefState=(0,es.cn)({key:"editor.focusHandle",default:null}),useEditorStateManager=()=>{const[tabsState,setTabsState]=(0,es.FV)(editorTabsState),setActiveTabIndex=(0,es.Zl)(activeEditorTabIndexState),focus=(0,es._8)((({snapshot})=>()=>{snapshot.getLoadable(editorRefState).valueOrThrow()?.focus()}),[]),select=index=>{setActiveTabIndex(index)},closeTab=index=>{setTabsState((tabsState=>tabsState.filter(((_,tabIndex)=>tabIndex!==index))))};return{tabs:tabsState,openPath:(filePath,shouldFocus=!0)=>{const index=tabsState.findIndex((tab=>tab.filePath===filePath));if(index>-1)select(index);else{const newIndex=tabsState.length;setTabsState((currentState=>[...currentState,{filePath,editorState:{cursorPos:{lineNumber:0,column:0}}}])),select(newIndex)}shouldFocus&&setTimeout(focus)},closePath:filePath=>{const index=tabsState.findIndex((tab=>tab.filePath===filePath));index>-1&&(closeTab(index),setActiveTabIndex(Math.max(index-1,0)))},closeTab,closeOthersTabs:index=>{setTabsState((tabsState=>tabsState.filter(((_,tabIndex)=>tabIndex===index))))},select}};function convertGitStatus(status){return Array.isArray(status)?1===status[1]?["DELETED","NOT_CHANGED","MODIFIED"][status[2]]:0===status[1]?0===status[3]?"UNKNOWN":"ADDED":"UNKNOWN":"modified"===status||"*modified"===status?"MODIFIED":"deleted"===status||"*deleted"===status?"DELETED":"added"===status?"ADDED":"unmodified"===status?"NOT_CHANGED":"UNKNOWN"}async function asyncFilter(predicate,array){const predicateResult=await Promise.all(array.map((item=>predicate(item).catch((()=>!1)))));return array.filter(((item,index)=>predicateResult[index]))}const vcsRootsState=(0,es.cn)({key:"vcsRoots",default:(0,es.nZ)({key:"vcsRoots/temporaryDefault",get:async()=>asyncFilter((({dir})=>fs.promises.stat(dir).then(Boolean)),Object.values(sampleRepos).map((({path})=>({dir:path,vcs:"git"}))))})}),vcsRootForFile=(0,es.CG)({key:"gitRootForFile",get:filepath=>({get})=>(0,isomorphic_git.AY)({fs,filepath}).catch((()=>null))}),fileStatusState=(0,es.xu)({key:"fileStatus",default:"NOT_CHANGED"}),useUpdateFileStatus=()=>(0,es._8)((({snapshot,set})=>async filepath=>{const repoRoot=await snapshot.getPromise(vcsRootForFile(filepath));if(null!=repoRoot){console.time(`status ${filepath}`);const fileStatus=await(0,isomorphic_git.i7)({fs,dir:repoRoot,filepath:path_browserify.relative(repoRoot,filepath)});console.timeEnd(`status ${filepath}`),set(fileStatusState(filepath),convertGitStatus(fileStatus))}}),[]),useUpdateVcsFileStatuses=()=>(0,es._8)((({snapshot,transact_UNSTABLE})=>async()=>{const vcsDirectoryMappings=await snapshot.getPromise(vcsRootsState);return Promise.all(vcsDirectoryMappings.filter((({vcs})=>"git"===vcs)).map((async({dir})=>{console.time("statusMatrix");const rows=await(0,isomorphic_git.ks)({fs,dir});console.timeEnd("statusMatrix"),transact_UNSTABLE((({set})=>{rows.forEach((row=>{set(fileStatusState(`${dir}/${row[0]}`),convertGitStatus(row))}))}))})))}),[]),useStatusColor=status=>{const theme=(0,styled_components_browser_esm.Fg)();switch(status){case"MODIFIED":return theme.dark?"#6897bb":"#0032a0";case"ADDED":return theme.dark?"#629755":"#0a7700";case"DELETED":return theme.dark?"#6c6c6c":"#616161";case"UNKNOWN":return theme.dark?"#d1675a":"#993300"}},useFileStatusColor=filepath=>{const fileStatus=(0,es.sJ)(fileStatusState(filepath));return useStatusColor(fileStatus)},FileStatusColor=({children,filepath})=>{const color=useFileStatusColor(filepath);return(0,jsx_runtime.jsx)("span",{style:{color},children})};FileStatusColor.displayName="FileStatusColor";const StatusColor=({children,status})=>{const color=useStatusColor(status);return(0,jsx_runtime.jsx)("span",{style:{color},children})};StatusColor.displayName="StatusColor";try{useStatusColor.displayName="useStatusColor",useStatusColor.__docgenInfo={description:"",displayName:"useStatusColor",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/FileStatusColor.tsx#useStatusColor"]={docgenInfo:useStatusColor.__docgenInfo,name:"useStatusColor",path:"../example-app/src/VersionControl/FileStatusColor.tsx#useStatusColor"})}catch(__react_docgen_typescript_loader_error){}try{useFileStatusColor.displayName="useFileStatusColor",useFileStatusColor.__docgenInfo={description:"",displayName:"useFileStatusColor",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/FileStatusColor.tsx#useFileStatusColor"]={docgenInfo:useFileStatusColor.__docgenInfo,name:"useFileStatusColor",path:"../example-app/src/VersionControl/FileStatusColor.tsx#useFileStatusColor"})}catch(__react_docgen_typescript_loader_error){}try{FileStatusColor.displayName="FileStatusColor",FileStatusColor.__docgenInfo={description:"",displayName:"FileStatusColor",props:{filepath:{defaultValue:null,description:"",name:"filepath",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/FileStatusColor.tsx#FileStatusColor"]={docgenInfo:FileStatusColor.__docgenInfo,name:"FileStatusColor",path:"../example-app/src/VersionControl/FileStatusColor.tsx#FileStatusColor"})}catch(__react_docgen_typescript_loader_error){}try{StatusColor.displayName="StatusColor",StatusColor.__docgenInfo={description:"",displayName:"StatusColor",props:{status:{defaultValue:null,description:"",name:"status",required:!0,type:{name:"enum",value:[{value:'"UNKNOWN"'},{value:'"ADDED"'},{value:'"NOT_CHANGED"'},{value:'"MODIFIED"'},{value:'"DELETED"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/FileStatusColor.tsx#StatusColor"]={docgenInfo:StatusColor.__docgenInfo,name:"StatusColor",path:"../example-app/src/VersionControl/FileStatusColor.tsx#StatusColor"})}catch(__react_docgen_typescript_loader_error){}var dist_module=__webpack_require__("../../node_modules/@react-aria/utils/dist/module.js"),Link=__webpack_require__("./src/Link/Link.tsx");const _balloonManagerRef={value:null};function notImplemented(){_balloonManagerRef.value?.show({icon:"Warning",title:"Unimplemented action",body:"This action is not implemented yet.",actions:(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:(0,jsx_runtime.jsx)(Link.r,{onPress:notImplemented,children:"Read more..."})})})}try{_balloonManagerRef.displayName="_balloonManagerRef",_balloonManagerRef.__docgenInfo={description:"For ease of use, and to make notImplemented a simple function, not a hook, we set balloon manager in Project.\nIt's intentionally kept in a separate file, to avoid circular dependency caused by many components importing\nProject.tsx",displayName:"_balloonManagerRef",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/Project/notImplemented.tsx#_balloonManagerRef"]={docgenInfo:_balloonManagerRef.__docgenInfo,name:"_balloonManagerRef",path:"../example-app/src/Project/notImplemented.tsx#_balloonManagerRef"})}catch(__react_docgen_typescript_loader_error){}const FileEditor=()=>{const editorStateManager=useEditorStateManager(),activeTab=(0,es.sJ)(activeEditorTabState),editorRef=(0,react.useRef)(),[active,setActive]=(0,react.useState)(!1),hideAllAction=(0,ActionsProvider.BH)(ToolWindowActionIds.xm),setCursorPositionState=(0,es.Zl)(editorCursorPositionState),tabActionsRef=(0,useLatest.d)({closePath:editorStateManager.closePath,closeOthersTabs:editorStateManager.closeOthersTabs}),setEditorRef=(0,es.Zl)(editorRefState),fileContentState=fileContent(activeTab?.filePath),contentLoadable=(0,es.$P)(fileContentState),setContent=(0,es.Zl)(fileContentState),updateFileStatus=useUpdateFileStatus();(0,react.useEffect)((()=>{editorRef.current?.focus(),activeTab?.editorState.cursorPos&&editorRef.current?.setPosition(activeTab?.editorState.cursorPos)}),[activeTab?.filePath]);const activePathsProviderProps=useActivePathsProvider(activeTab?[activeTab.filePath]:[]),content=contentLoadable.valueMaybe();return(0,jsx_runtime.jsxs)(StyledFileEditorContainer,{...(0,dist_module.dG)(activePathsProviderProps,{onFocus:()=>{setActive(!0),setEditorRef({focus:()=>editorRef.current?.focus()})}}),children:[editorStateManager.tabs.length>0&&(0,jsx_runtime.jsx)(ContextMenuContainer.X,{renderMenu:()=>(0,jsx_runtime.jsxs)(Menu.v2,{onAction:notImplemented,children:[(0,jsx_runtime.jsx)(Item.c,{children:"Close"},"close"),(0,jsx_runtime.jsx)(Item.c,{children:"Close Other tabs"},"closeOthers"),(0,jsx_runtime.jsx)(Item.c,{children:"Close all tabs"},"closeAll"),(0,jsx_runtime.jsx)(Item.c,{children:"Close tabs to the left"},"closeLeft"),(0,jsx_runtime.jsx)(Item.c,{children:"Close tabs to the right"},"closeRight")]}),children:(0,jsx_runtime.jsx)(EditorTabs.s,{items:editorStateManager.tabs,active,selectedKey:activeTab?.filePath,onSelectionChange:key=>editorStateManager.select(editorStateManager.tabs.findIndex((tab=>tab.filePath===key))),noBorders:!0,children:tab=>{const filename=path_browserify.basename(tab.filePath),icon=(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:getIconForFile(tab.filePath)});return(0,jsx_runtime.jsx)(TabItem.E,{textValue:filename,inOverflowMenu:(0,jsx_runtime.jsx)(MenuItemLayout._,{content:filename,icon}),children:(0,jsx_runtime.jsx)(TooltipTrigger.a,{tooltip:(0,jsx_runtime.jsx)(ActionTooltip.M,{actionName:tab.filePath}),children:(0,jsx_runtime.jsx)(EditorTabContent.X,{icon,title:(0,jsx_runtime.jsx)(FileStatusColor,{filepath:tab.filePath,children:filename}),closeButton:(0,jsx_runtime.jsx)(TooltipTrigger.a,{tooltip:(0,jsx_runtime.jsx)(ActionTooltip.M,{actionName:"Close. Alt-Click to Close Others"}),children:(0,jsx_runtime.jsx)(TabCloseButton.W,{onPress:e=>{e.altKey?tabActionsRef.current.closeOthersTabs(editorStateManager.tabs.indexOf(tab)):tabActionsRef.current.closePath(tab.filePath)}})}),containerProps:{onDoubleClick:()=>{hideAllAction?.perform()}}})})},tab.filePath)}})}),activeTab&&("string"==typeof content?(0,jsx_runtime.jsx)(Editor,{height:"100%",path:activeTab.filePath,onMount:(monacoEditor,monaco)=>{monacoEditor.focus(),function enableJsx(monaco){monaco.languages.typescript.typescriptDefaults.setCompilerOptions({jsx:editor_main.Mj.typescript.JsxEmit.React}),monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSemanticValidation:!1,noSyntaxValidation:!1})}(monaco),editorRef.current=monacoEditor,monacoEditor.onDidChangeCursorPosition((e=>{setCursorPositionState(e.position)})),monacoEditor.onDidChangeModel((()=>{const position=editorRef.current?.getPosition();position&&setCursorPositionState(position)}))},onChange:(newContent="")=>{setActive(!1),setContent(newContent),activeTab&&updateFileStatus(activeTab.filePath).catch((e=>{console.error("Could not update file status",e)}))},value:content}):content&&"UNSUPPORTED CONTENT"),"loading"===contentLoadable.state&&(0,jsx_runtime.jsx)(FileEditorLoading,{})]})};FileEditor.displayName="FileEditor";const StyledFileEditorContainer=styled.zo.div`
  position: relative;
  height: 100%;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  background: ${({theme})=>theme.color("Editor.background",theme.isUnderDarcula()?"rgb(40,40,40)":theme.commonColors.panelBackground)};
`,FileEditorLoading=(0,styled.zo)(LoadingGif)`
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
`;try{FileEditor.displayName="FileEditor",FileEditor.__docgenInfo={description:"Used as main content in the main ToolWindows. Shows currently opened files tabs and the editor.\n\nTODO: preserve editor state when switching between tabs\nTODO: support multiple editors in split view.",displayName:"FileEditor",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/Editor/FileEditor.tsx#FileEditor"]={docgenInfo:FileEditor.__docgenInfo,name:"FileEditor",path:"../example-app/src/Editor/FileEditor.tsx#FileEditor"})}catch(__react_docgen_typescript_loader_error){}var ToolWindowsState=__webpack_require__("./src/ToolWindows/ToolWindowsState/ToolWindowsState.ts"),DefaultToolWindow=__webpack_require__("./src/ToolWindowsImpl/DefaultToolWindow.tsx"),bundle=__webpack_require__("../../node_modules/xterm-for-react/dist/bundle.js");const StyledXterm=(0,styled_components_browser_esm.ZP)(bundle.O).withConfig({displayName:"Terminal__StyledXterm",componentId:"sc-19jke66-0"})(["height:100%;background:rgb(43,43,43);"]),Terminal=()=>{const[input,setInput]=(0,react.useState)(""),xtermRef=(0,react.useRef)(null),options=(0,react.useMemo)((()=>({theme:{background:"rgb(43,43,43)",selection:"#214283"},fontFamily:"sans-serif",letterSpacing:-8,fontSize:12,lineHeight:1.3,cursorStyle:"block",cursorBlink:!0,cursorWidth:8,rendererType:"dom"})),[]);return(0,react.useEffect)((()=>{setTimeout((()=>{xtermRef.current?.terminal.resize(80,10),xtermRef.current?.terminal.write("$ ")}),3e3)}),[]),(0,jsx_runtime.jsx)(StyledXterm,{ref:xtermRef,options,onData:data=>{const code=data.charCodeAt(0);if(13===code)input.length>0&&xtermRef.current?.terminal.write("\r\nYou typed: '"+input+"'"),xtermRef.current?.terminal.write("\r\n$ "),setInput("");else{if(code<32||127===code)return;xtermRef.current?.terminal.write(data),setInput(input+data)}}})};Terminal.displayName="Terminal";var useTreeActions=__webpack_require__("./src/TreeActions/useTreeActions.tsx"),ActionButton=__webpack_require__("./src/ActionSystem/components/ActionButton.tsx"),CommonActionIds=__webpack_require__("./src/ActionSystem/CommonActionIds.ts"),array_utils=__webpack_require__("./src/utils/array-utils.ts");const foldersOnTopState=(0,es.cn)({key:"projectView.foldersOnTop",default:!0}),expandedKeysState=(0,es.cn)({key:"projectView.expandedKeys",default:(0,es.nZ)({key:"projectView.expandedKeys/default",get:({get})=>new Set(get(vcsRootsState).flatMap((({dir})=>getParentPaths(dir).concat(dir))))})}),selectedKeysState=(0,es.cn)({key:"projectView.selectedKeys",default:new Set([])}),projectViewTreeRefState=(0,es.cn)({key:"projectView.focusHandle",default:react.createRef(),dangerouslyAllowMutability:!0}),currentProjectTreeState=(0,es.nZ)({key:"projectTree",get:({get})=>async function createProjectTree(project,get){const rootItems=get(dirContentState(project.path)),mapItem=parent=>async item=>{const name=path_browserify.basename(item.path),node={...item,name,parent},dirNode={...node,children:[]};return"dir"===item.type?filterPath(item)?(dirNode.children=(await Promise.all((get(dirContentState(item.path))??[]).map(mapItem(dirNode)))).filter(array_utils.N),dirNode):null:node};return{type:"project",path:project.path,name:project.name,parent:null,children:(await Promise.all((rootItems||[]).map(mapItem(null)))).filter(array_utils.N)}}(get(currentProjectState),get)});const expandToPathCallback=({snapshot,set})=>path=>{const expandedKeys=snapshot.getLoadable(expandedKeysState).valueOrThrow(),keysToExpand=[snapshot.getLoadable(currentProjectState).valueOrThrow().path].concat(getParentPaths(path));set(expandedKeysState,new Set([...expandedKeys,...keysToExpand]))},selectKeyAndFocusCallback=({snapshot})=>key=>{const treeRef=snapshot.getLoadable(projectViewTreeRefState).valueOrThrow()?.current;treeRef?.replaceSelection(key),treeRef?.focus(key)},useSelectPathInProjectView=()=>{const expandToOpenedFile=(0,es._8)(expandToPathCallback,[]),selectKeyAndFocus=(0,es._8)(selectKeyAndFocusCallback,[]);return path=>{expandToOpenedFile(path),selectKeyAndFocus(path)}};var SpeedSearchTree=__webpack_require__("./src/Tree/SpeedSearchTree/SpeedSearchTree.tsx"),ItemLayout=__webpack_require__("./src/Collections/ItemLayout.tsx"),HighlightedTextValue=__webpack_require__("./src/CollectionSpeedSearch/HighlightedTextValue.tsx"),ItemStateContext=__webpack_require__("./src/Collections/ItemStateContext.tsx"),sortBy=__webpack_require__("../../node_modules/ramda/es/sortBy.js"),identity=__webpack_require__("../../node_modules/ramda/es/identity.js");const ProjectViewPane=()=>{const project=(0,es.sJ)(currentProjectState),editor=useEditorStateManager(),treeRef=(0,react.useRef)(null),setProjectViewTreeRef=(0,es.Zl)(projectViewTreeRefState);(0,react.useLayoutEffect)((()=>{setProjectViewTreeRef(treeRef)}),[treeRef]);const projectTree=(0,es.sJ)(currentProjectTreeState),[expandedKeys,setExpandedKeys]=(0,es.FV)(expandedKeysState),[selectedKeys,setSelectedKeys]=(0,es.FV)(selectedKeysState),sortItems=(0,es.sJ)(foldersOnTopState)?(0,sortBy.Z)((a=>"dir"===a.type?1:2)):identity.Z,selectedKeysArray="all"===selectedKeys?[]:[...selectedKeys].filter((i=>"string"==typeof i)),activePathsProviderProps=useActivePathsProvider(selectedKeysArray);return(0,jsx_runtime.jsx)(DefaultSuspense,{children:(0,jsx_runtime.jsx)(SpeedSearchTree.b,{ref:treeRef,...activePathsProviderProps,items:[projectTree],onAction:path=>{editor.openPath(`${path}`)},fillAvailableSpace:!0,autoFocus:!0,selectionMode:"multiple",selectedKeys,onSelectionChange:setSelectedKeys,expandedKeys,onExpandedChange:setExpandedKeys,children:item=>(0,jsx_runtime.jsx)(Item.c,{textValue:item.name,childItems:"children"in item?sortItems(item.children):void 0,children:(0,jsx_runtime.jsxs)(ItemLayout.e,{children:[(0,jsx_runtime.jsx)(ProjectViewNodeIcon,{node:item}),"project"===item.type?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("b",{children:(0,jsx_runtime.jsx)(HighlightedTextValue.J,{})}),(0,jsx_runtime.jsx)(ItemLayout.e.Hint,{children:project.path})]}):(0,jsx_runtime.jsx)(FileTreeNodeText,{node:item})]})},item.path)})})};ProjectViewPane.displayName="ProjectViewPane";const FileTreeNodeText=({node})=>"dir"===node.type?(0,jsx_runtime.jsx)(FileTreeDirNodeText,{node}):(0,jsx_runtime.jsx)(FileTreeFileNodeText,{node}),FileTreeDirNodeText=({})=>(0,jsx_runtime.jsx)(HighlightedTextValue.J,{});FileTreeDirNodeText.displayName="FileTreeDirNodeText";const FileTreeFileNodeText=({node})=>{const state=(0,react.useContext)(ItemStateContext.k);return state?.isSelected&&state?.isContainerFocused?(0,jsx_runtime.jsx)(HighlightedTextValue.J,{}):(0,jsx_runtime.jsx)(FileStatusColor,{filepath:node.path,children:(0,jsx_runtime.jsx)(HighlightedTextValue.J,{})})},nodeTypeIconMap={project:"nodes/folder",dir:"nodes/folder",file:"fileTypes/text"};function ProjectViewNodeIcon({node}){const icon=function findNodeIcon(value){return"file"===value.type?getIconForFile(value.name):nodeTypeIconMap[value.type]??null}(node);return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:icon&&(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon})})}const{SELECT_IN_PROJECT_VIEW}={SELECT_IN_PROJECT_VIEW:"SelectInProjectView"};function ProjectToolWindow(){const treeRef=(0,es.sJ)(projectViewTreeRefState),actions=(0,useTreeActions.x)({treeRef}),projectViewActions=function useProjectViewActions(){const activeTab=(0,es.sJ)(activeEditorTabState),selectPathInProjectView=useSelectPathInProjectView(),selectOpenedFile=()=>{activeTab&&selectPathInProjectView(activeTab.filePath)};return[{id:SELECT_IN_PROJECT_VIEW,title:"Select Opened File",icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"general/locate"}),actionPerformed:selectOpenedFile,isDisabled:!activeTab,description:"Selects a context file in the Project View"}]}();return(0,jsx_runtime.jsx)(DefaultToolWindow.n,{headerContent:"Project",actions:[...actions,...projectViewActions],additionalActions:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(ActionButton.K,{actionId:SELECT_IN_PROJECT_VIEW}),(0,jsx_runtime.jsx)(ActionButton.K,{actionId:CommonActionIds.$.EXPAND_ALL}),(0,jsx_runtime.jsx)(ActionButton.K,{actionId:CommonActionIds.$.COLLAPSE_ALL})]}),children:(0,jsx_runtime.jsx)(ProjectViewPane,{})})}ProjectToolWindow.displayName="ProjectToolWindow";var MultiViewToolWindow=__webpack_require__("./src/ToolWindowsImpl/MultiViewToolWindow.tsx"),ToolWindowStateProvider=__webpack_require__("./src/ToolWindows/ToolWindowsState/ToolWindowStateProvider.tsx"),utils=__webpack_require__("./src/ToolWindows/utils.ts"),ThreeViewSplitter=__webpack_require__("./src/ThreeViewSplitter/ThreeViewSplitter.tsx"),groupBy=__webpack_require__("../../node_modules/ramda/es/groupBy.js");const changeListsState=(0,es.cn)({key:"changelists.lists",default:[{id:"some-UUID",name:"Changes",comment:"last modified commit message",changes:[],active:!0},{id:"some-other-UUID",name:"Some other changelist",comment:"Some empty changelist for testing",changes:[],active:!1}]}),allChangesState=((0,es.nZ)({key:"changelists.lists/default",get:({get})=>get(changeListsState).find((changeList=>changeList.active))??null}),(0,es.nZ)({key:"changelists.allChanges",get:({get})=>get(changeListsState).map((changeLists=>changeLists.changes)).flat()})),isAChange=([,head,workingDir,stage])=>1!==head||1!==workingDir||1!==stage,refreshChangesCallback=({snapshot,set})=>async()=>{const gitRoots=(await snapshot.getPromise(vcsRootsState)).filter((root=>"git"===root.vcs)),changes=(await Promise.all(gitRoots.map((async({dir})=>(await(0,isomorphic_git.ks)({fs,dir})).filter(isAChange).map((([pathname,...theRest])=>[path_browserify_default().join(dir,pathname),...theRest])))))).flat().map((([path,head,workdir,stage])=>({after:{path,isDir:!1},before:{path,isDir:!1}})));set(changeListsState,(changeLists=>changeLists.map((changeList=>changeList.active?{...changeList,changes}:{...changeList,changes:[]}))))},useRefreshChanges=()=>(0,es._8)(refreshChangesCallback,[]);var uniq=__webpack_require__("../../node_modules/ramda/es/uniq.js");const changeBrowserNodeKey=(type,id)=>`${type}_${id}`,getNodeKeyForChange=change=>changeBrowserNodeKey("change",change.after.path),changeListNode=(changeList,groupFn=(i=>i))=>({type:"changelist",key:changeBrowserNodeKey("changelist",changeList.id),changeList,children:groupFn(changeList.changes.map((change=>(change=>({type:"change",key:getNodeKeyForChange(change),change}))(change))))}),directoryNode=(dirPath,parentNodePath,children=[])=>({type:"directory",key:changeBrowserNodeKey("directory",dirPath),dirPath,parentNodePath,children}),isGroupNode=node=>"children"in node,isChangeNode=node=>"change"===node.type,isDirectoryNode=node=>"directory"===node.type,getChildren=node=>isGroupNode(node)?node.children:null,groupings=[{id:"repository",title:"Repository",isAvailable:(0,es.nZ)({key:"repositoryGrouping/isAvailable",get:({get})=>get(vcsRootsState).length>0}),groupFn:(0,es.nZ)({key:"repositoryGrouping/groupFn",get:({get})=>nodes=>get(vcsRootsState).map((repository=>((repository,children=[])=>({type:"repo",key:changeBrowserNodeKey("repo",repository.dir),repository,children}))(repository,nodes.filter((node=>(node.change.after?.path||node.change.before?.path)?.startsWith(repository.dir))))))})},{id:"directory",title:"Directory",isAvailable:(0,es.Kz)(!0),groupFn:nodes=>{const pathToNodeCache={},rootDirNodes=nodes.map((node=>{if(node.change.after.isDir)throw new Error("isDir=true is not supported for changes ATM!");return getParentPaths(node.change.after.path).reduce(((prevNode,dirPath)=>{pathToNodeCache[dirPath]||(pathToNodeCache[dirPath]=directoryNode(dirPath,"")),"directory"===prevNode.type&&(prevNode.parentNodePath=dirPath);const dirNode=pathToNodeCache[dirPath];return dirNode.children=dirNode.children.includes(prevNode)?dirNode.children:[prevNode,...dirNode.children],dirNode}),node)})),collapseDirectories=dirNode=>{let{children,dirPath,parentNodePath}=dirNode;return 1===dirNode.children.length&&isDirectoryNode(dirNode.children[0])?(dirPath=dirNode.children[0].dirPath,children=dirNode.children[0].children.map((child=>isDirectoryNode(child)?collapseDirectories({...child,parentNodePath:dirPath}):child)),collapseDirectories(directoryNode(dirPath,parentNodePath,children))):{...dirNode,children:children.map((child=>isDirectoryNode(child)?collapseDirectories(child):child))}};return(0,uniq.Z)(rootDirNodes).map(collapseDirectories)}}];var tree_utils=__webpack_require__("./src/utils/tree-utils.ts");function _defineProperty(obj,key,value){return(key=function _toPropertyKey(arg){var key=function _toPrimitive(input,hint){if("object"!=typeof input||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!=typeof res)return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"==typeof key?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}const collectSelectableItemsRecursive=(item,getChildren,collectedItems=[])=>{const children=getChildren(item);null==children?collectedItems.push(item):children.forEach((child=>collectSelectableItemsRecursive(child,getChildren,collectedItems)))};class NestedSelection{constructor(state,tree){this.state=state,this.tree=tree,_defineProperty(this,"cache",new WeakMap),this.tree=tree,this.state=state}toggle(item){const children=this.tree.getChildren(item),key=this.tree.getKey(item);if(null==children)this.state.toggle(key);else{const state=this.getSelectionState(item),itemsInSubtree=((item,getChildren)=>{const collectedItems=[];return collectSelectableItemsRecursive(item,getChildren,collectedItems),collectedItems})(item,(item=>normalizeChildren(this.tree.getChildren(item)))).map(this.tree.getKey);"Selected"===state?this.state.delete(...itemsInSubtree):this.state.add(...itemsInSubtree)}}getSelectionState(item){const cachedState=this.cache.get(item);if(cachedState)return cachedState;const children=normalizeChildren(this.tree.getChildren(item)),key=this.tree.getKey(item);let state;if(null==children)state=[...this.state.items].includes(key)?"Selected":"NotSelected";else{const allDescendantsStates=children.map((child=>this.getSelectionState(child)));state=allDescendantsStates.every((state=>"NotSelected"===state))?"NotSelected":allDescendantsStates.every((state=>"Selected"===state))?"Selected":"PartiallySelected"}return this.cache.set(item,state),state}}function normalizeChildren(children){return children?[].concat(children):null}var utils_dist_module=__webpack_require__("../../node_modules/@react-stately/utils/dist/module.js");let _Symbol$iterator;function immutableSet_defineProperty(obj,key,value){return(key=function immutableSet_toPropertyKey(arg){var key=function immutableSet_toPrimitive(input,hint){if("object"!=typeof input||null===input)return input;var prim=input[Symbol.toPrimitive];if(void 0!==prim){var res=prim.call(input,hint||"default");if("object"!=typeof res)return res;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===hint?String:Number)(input)}(arg,"string");return"symbol"==typeof key?key:String(key)}(key))in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}_Symbol$iterator=Symbol.iterator;class ImmutableSet{constructor(values){immutableSet_defineProperty(this,"size",void 0),immutableSet_defineProperty(this,"set",void 0),this.set=new Set(values),this.size=this.set.size}add(...items){return this.setValueWithMutation((newValue=>{items.forEach((item=>{newValue.add(item)}))}))}delete(...items){return this.setValueWithMutation((newValue=>{items.forEach((item=>{newValue.delete(item)}))}))}toggle(...items){return this.setValueWithMutation((newValue=>{items.forEach((item=>{newValue.delete(item)||newValue.add(item)}))}))}clear(){return this.setValueWithMutation((newValue=>{newValue.clear()}))}setValueWithMutation(mutate){const newValue=new Set(this.set);return mutate(newValue),new ImmutableSet(newValue)}forEach(...args){return this.set.forEach(...args)}has(value){return this.set.has(value)}[_Symbol$iterator](){return this.set[Symbol.iterator]()}entries(){return this.set.entries()}keys(){return this.set.keys()}values(){return this.set.values()}}const createSetInterface=set=>({add:(...values)=>set((currentValue=>new Set(new ImmutableSet(currentValue).add(...values)))),delete:(...values)=>set((currentValue=>new Set(new ImmutableSet(currentValue).delete(...values)))),clear:()=>set((currentValue=>new Set(new ImmutableSet(currentValue).clear()))),toggle:(...values)=>set((currentValue=>new Set(new ImmutableSet(currentValue).toggle(...values))))});function useStateSetterForSet(setValue){return(0,react.useMemo)((()=>createSetInterface(setValue)),[setValue])}const isOpen=(0,es.cn)({key:"rollbackView.isOpen",default:!1}),windowBounds=(0,es.cn)({key:"rollbackView.windowBounds",default:{height:500}}),initiallyIncludedChanges=(0,es.cn)({key:"rollbackView.initiallySelectedChanges",default:[]}),rootNodes=(0,es.nZ)({key:"rollbackView.includedRootNodes",get:({get})=>{const selectedChanges=get(initiallyIncludedChanges),{rootNodes}=get(changesTreeNodesState);return rootNodes.filter((({changeList:{changes,active}})=>0===selectedChanges.length&&active||selectedChanges.some((change=>changes.includes(change)))))}}),rollbackViewState={isOpen,windowBounds,initiallyExpandedKeys:(0,es.nZ)({key:"rollbackView.initiallyExpandedKeys",get:({get})=>{const includedChanges=get(initiallyIncludedChanges),nodes=get(rootNodes),expandedKeys=(0,tree_utils.Bp)((node=>isGroupNode(node)?node.children:null),(node=>node.key),nodes,includedChanges.map(getNodeKeyForChange));return new Set(expandedKeys.length?expandedKeys:(0,tree_utils.Om)((node=>isGroupNode(node)?node.children:null),(node=>node.key),nodes))}}),initiallyIncludedChanges,rootNodes},showIgnoredFilesState=(0,es.cn)({key:"changesView/showIgnoredFiles",default:!1}),showRelatedFilesState=(0,es.cn)({key:"changesView/showRelatedFiles",default:!1}),changesGroupingState=(0,es.xu)({key:"changesView/grouping",default:!0}),ChangesView_state_selectedKeysState=(0,es.cn)({key:"changesView.selectedKeys",default:new Set([])}),resolvedSelectedKeysState=(0,es.nZ)({key:"changesView.resolvedSelectedKeys",get:({get})=>{const selection=get(ChangesView_state_selectedKeysState);if("all"===selection){const{rootNodes}=get(changesTreeNodesState);return new Set((0,tree_utils.eA)((node=>isGroupNode(node)?node.children:[]),((node,parentValue)=>{const nodes=parentValue??[];return nodes.push(node),nodes}),rootNodes).flat().map((node=>node.key)))}return selection}}),selectedNodesState=(0,es.nZ)({key:"changesView.selectedNodes",get:({get})=>{const selectedKeys=get(resolvedSelectedKeysState),{byKey}=get(changesTreeNodesState);return new Set([...selectedKeys].map((key=>byKey.get(key))).filter(array_utils.N))}}),changesUnderSelectedKeys=(0,es.nZ)({key:"changesView.selectedKeys.changes",get:({get})=>{const selectedNodes=get(selectedNodesState),allChanges=new Set,processNode=node=>{node&&("change"===node.type&&allChanges.add(node.change),isGroupNode(node)&&node.children.forEach(processNode))};return selectedNodes.forEach(processNode),allChanges}}),changeListsUnderSelection=(0,es.nZ)({key:"changesView.selectedChangeLists",get:({get})=>{const selectedNodes=get(selectedNodesState),allChangeLists=get(changeListsState),selectedChangeLists=new Set,processNode=node=>{if(node){if("changelist"===node.type&&selectedChangeLists.add(node.changeList),"change"===node.type){const changeList=allChangeLists.find((changeList=>changeList.changes.includes(node.change)));changeList&&selectedChangeLists.add(changeList)}isGroupNode(node)&&node.children.forEach(processNode)}};return selectedNodes.forEach(processNode),selectedChangeLists}}),includedChangeKeysState=(0,es.cn)({key:"changesView.includedChangeKeys",default:new Set([])}),includedChangesState=(0,es.nZ)({key:"changesView.includedChanges",get:({get})=>{const includedChangeKeys=get(includedChangeKeysState);return get(allChangesState).filter((change=>includedChangeKeys.has(getNodeKeyForChange(change))))}}),includedChangesNestedSelection=(0,es.nZ)({key:"changesView.selectedChanges.nestedSelectionState",get:({get,getCallback})=>{const{rootNodes}=get(changesTreeNodesState),includedChangeKeys=get(includedChangeKeysState),setSelectedKeys=getCallback((({set})=>setValue=>set(includedChangeKeysState,setValue)));return new NestedSelection({items:includedChangeKeys,...createSetInterface(setSelectedKeys)},{rootNodes,getChildren:item=>isGroupNode(item)?item.children:null,getKey:item=>item.key})}}),ChangesView_state_expandedKeysState=(0,es.cn)({key:"changesView.expandedKeys",default:(0,es.nZ)({key:"changesView.expandedKeys/temporaryDefault",get:({get})=>new Set(get(changesTreeNodesState).rootNodes.map((node=>[node.key,...node.children.map((child=>child.key))])).flat())})}),availableGroupingsState=(0,es.nZ)({key:"changes.availableGroupings",get:({get})=>groupings.filter((grouping=>(0,es.Oy)(grouping.isAvailable)?get(grouping.isAvailable):grouping.isAvailable)).map((grouping=>({grouping,isActive:get(changesGroupingState(grouping.id))})))}),recursiveGrouping=(groupingFns,nodes)=>{if(0===groupingFns.length||0===nodes.length)return nodes;const nextGroupingFns=groupingFns.slice(1),changeNodes=nodes.filter(isChangeNode),groupNodes=nodes.filter(isGroupNode),groups=groupingFns[0](changeNodes);return[...groupNodes,...groups].forEach((groupNode=>{groupNode.children=recursiveGrouping(nextGroupingFns,groupNode.children)})),groups.filter((group=>group.children.length>0))},changesTreeNodesState=(0,es.nZ)({key:"changesView.treeNodes",get:({get})=>{const changeLists=get(changeListsState),groupFns=get(availableGroupingsState).filter((({isActive})=>isActive)).map((({grouping})=>{return value=grouping.groupFn,(0,es.Oy)(value)?get(value):value;var value})),groupChanges=changes=>recursiveGrouping(groupFns,changes),rootNodes=(0,sortBy.Z)((({active})=>!active),changeLists).map((changeList=>changeListNode(changeList,groupChanges))),fileCountsMap=new Map,byKey=new Map;return(0,tree_utils.Ck)(getChildren,((node,childrenFileCount)=>{if(byKey.set(node.key,node),!childrenFileCount)return 1;const fileCount=childrenFileCount.reduce(((total,count)=>total+count),0);return fileCountsMap.set(node.key,fileCount),fileCount}),rootNodes),{rootNodes,fileCountsMap,byKey}}}),commitMessageSizeState=(0,es.xu)({key:"changesView/splitter/commitMessageSize",default:orientation=>"horizontal"===orientation?.4:.3}),amendCommitState=(0,es.cn)({key:"changesView/amendCommit",default:!1}),commitMessageState=(0,es.cn)({key:"changesView/commitMessage",default:""}),commitErrorMessageState=(0,es.cn)({key:"changesView/commitErrorMessage",default:""}),isCommitInProgressState=(0,es.cn)({key:"changesView/commitInProgress",default:!1}),changesFromActivePaths=(0,es.nZ)({key:"changesView/changesFromActivePaths",get:({get})=>{const activePaths=get(activePathsState);return get(allChangesState).filter((change=>activePaths.some((activePath=>change.after.path.startsWith(activePath)))))}}),queueCheckInCallback=({set,snapshot})=>paths=>{const includedChangeKeys=(paths?snapshot.getLoadable(allChangesState).getValue().filter((change=>paths.some((activePath=>change.after.path.startsWith(activePath))))):snapshot.getLoadable(changesFromActivePaths).getValue()).map(getNodeKeyForChange);if(set(includedChangeKeysState,new Set(includedChangeKeys)),includedChangeKeys.length>0){const expandedKeys=(0,tree_utils.Bp)((node=>isGroupNode(node)?node.children:null),(node=>node.key),snapshot.getLoadable(changesTreeNodesState).getValue().rootNodes,includedChangeKeys);set(ChangesView_state_expandedKeysState,(currentExpandedKeys=>new Set([..."all"!==currentExpandedKeys?currentExpandedKeys:new Set,...expandedKeys]))),set(ChangesView_state_selectedKeysState,new Set([includedChangeKeys[0]]))}},openRollbackWindowForSelectionCallback=({set,snapshot})=>(contextual=!0)=>{const activePaths=snapshot.getLoadable(activePathsState).getValue(),changesUnderSelection=snapshot.getLoadable(changesUnderSelectedKeys).getValue(),changesBasedOnActivePaths=contextual&&activePaths.length>0?snapshot.getLoadable(changesFromActivePaths).getValue():null;set(rollbackViewState.initiallyIncludedChanges,changesBasedOnActivePaths??[...changesUnderSelection]),set(rollbackViewState.isOpen,!0)},SpeedSearchTreeWithCheckboxes=react.forwardRef((({nestedSelection,cacheInvalidation,onNodeKeyDown,...props},ref)=>{const otherInvalidators="object"==typeof cacheInvalidation?cacheInvalidation.invalidators:[];return(0,jsx_runtime.jsx)(SpeedSearchTree.b,{ref,...props,cacheInvalidation:{invalidators:[nestedSelection,...otherInvalidators]},onNodeKeyDown:(event,item)=>{" "===event.key&&nestedSelection.toggle(item.value),onNodeKeyDown?.(event,item)}})}));try{SpeedSearchTreeWithCheckboxes.displayName="SpeedSearchTreeWithCheckboxes",SpeedSearchTreeWithCheckboxes.__docgenInfo={description:"Experimental wrapper component around SpeedSearchTree, which allows rendering {@link TreeNodeCheckbox } in nodes.\n\nSee [design-decisions.md](../Tree/design-decisions.md) for more thoughts about how should different features\nlike this be supported.",displayName:"SpeedSearchTreeWithCheckboxes",props:{fillAvailableSpace:{defaultValue:null,description:"",name:"fillAvailableSpace",required:!1,type:{name:"boolean"}},alwaysShowAsFocused:{defaultValue:null,description:"Shows the tree in focused style, even when it's not focused. Should be avoided in general, but there might be\nspecial valid use cases.",name:"alwaysShowAsFocused",required:!1,type:{name:"boolean"}},cacheInvalidation:{defaultValue:null,description:"Defines cache invalidation policy for items. By default, the render result is cached based on the item objects.\nThis is equivalent of passing false or not passing anything for `cacheInvalidation`. If `true` is passed, it will\nalways invalidate the render result, causing the collection to be recreated on each re-render. It can\nconsiderably affect performance in large collections. in addition to boolean value, an object with the list of\ninvalidators can also be passed. renderer function is called each time any of the invalidators are changed.\nThink of it as [dependency array in react hooks](https://reactjs.org/docs/hooks-reference.html#usememo). Except\nthat the length of the array can also safely change.",name:"cacheInvalidation",required:!1,type:{name:"boolean | { invalidators: readonly unknown[]; }"}},onAction:{defaultValue:null,description:"Called when the action associated with a leaf tree node should be taken.\nThe exact UI interaction is abstracted away, but it's either Enter key or double click.",name:"onAction",required:!1,type:{name:"((key: Key) => void)"}},onNodeKeyDown:{defaultValue:null,description:"",name:"onNodeKeyDown",required:!1,type:{name:"((event: KeyboardEvent, node: Node<object>) => void)"}},allowEmptySelection:{defaultValue:null,description:"",name:"allowEmptySelection",required:!1,type:{name:"boolean"}},autoFocus:{defaultValue:null,description:"",name:"autoFocus",required:!1,type:{name:"boolean | FocusStrategy"}},stickySearch:{defaultValue:null,description:"",name:"stickySearch",required:!1,type:{name:"boolean"}},nestedSelection:{defaultValue:null,description:"",name:"nestedSelection",required:!0,type:{name:"NestedSelectionState<object>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/TreeCheckboxes/SpeedSearchTreeWithCheckboxes.tsx#SpeedSearchTreeWithCheckboxes"]={docgenInfo:SpeedSearchTreeWithCheckboxes.__docgenInfo,name:"SpeedSearchTreeWithCheckboxes",path:"src/TreeCheckboxes/SpeedSearchTreeWithCheckboxes.tsx#SpeedSearchTreeWithCheckboxes"})}catch(__react_docgen_typescript_loader_error){}var Checkbox=__webpack_require__("./src/Checkbox/Checkbox.tsx"),TreeContext=__webpack_require__("./src/Tree/TreeContext.tsx");const StyledCheckboxWrapper=styled_components_browser_esm.ZP.span.withConfig({displayName:"TreeNodeCheckbox__StyledCheckboxWrapper",componentId:"sc-1dgtqwa-0"})(["margin-right:0.125rem;display:inline-flex;"]),TreeNodeCheckbox=({selectionState,onToggle,selectItemOnPress=!0})=>{const treeContext=(0,react.useContext)(TreeContext.k),itemContext=(0,react.useContext)(ItemStateContext.k);if(!itemContext)throw new Error("TreeNodeCheckbox is rendered outside tree nodes.");return(0,jsx_runtime.jsx)(StyledCheckboxWrapper,{children:(0,jsx_runtime.jsx)(Checkbox.X,{preventFocus:!0,"aria-label":`Select ${itemContext.node.textValue}`,isSelected:"Selected"===selectionState,isIndeterminate:"PartiallySelected"===selectionState,isDisabled:itemContext.isDisabled,onChange:()=>{onToggle(),treeContext&&itemContext&&selectItemOnPress&&(treeContext.state.selectionManager.setFocusedKey(itemContext.node.key),treeContext.state.selectionManager.setFocused(!0),treeContext.state.selectionManager.setSelectedKeys([itemContext.node.key]))}})})};TreeNodeCheckbox.displayName="TreeNodeCheckbox";try{TreeNodeCheckbox.displayName="TreeNodeCheckbox",TreeNodeCheckbox.__docgenInfo={description:"Checkbox to be used with {@link SpeedSearchTreeWithCheckboxes }. `SpeedSearchTreeWithCheckboxes` doesn't add the\ncheckboxes by default to the nodes, which makes it more flexible in terms of which nodes should have checkbox, or\nit's exact placement within the tree rows.\n\nTreeNodeCheckbox renders a Checkbox with a few extras:\n- `aria-label` set based on the encompassing item's textValue\n- `isSelected` and `isIndeterminate` set based on `selectionState`\n- `isDisabled` is set based in disabled state of the item.\n- The encompassing item will be selected upon press, if `selectItemOnPress` is `true` (default is `true`).\n- Small styling adjustment achieved by a wrapper StyledListIconWrapper.",displayName:"TreeNodeCheckbox",props:{selectionState:{defaultValue:null,description:"",name:"selectionState",required:!1,type:{name:"enum",value:[{value:'"NotSelected"'},{value:'"Selected"'},{value:'"PartiallySelected"'}]}},selectItemOnPress:{defaultValue:{value:"true"},description:"",name:"selectItemOnPress",required:!1,type:{name:"boolean"}},onToggle:{defaultValue:null,description:"",name:"onToggle",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/TreeCheckboxes/TreeNodeCheckbox.tsx#TreeNodeCheckbox"]={docgenInfo:TreeNodeCheckbox.__docgenInfo,name:"TreeNodeCheckbox",path:"src/TreeCheckboxes/TreeNodeCheckbox.tsx#TreeNodeCheckbox"})}catch(__react_docgen_typescript_loader_error){}var Divider=__webpack_require__("./src/Collections/Divider.ts");const VcsActionIds={ROLLBACK:"ChangesView.Revert",REFRESH:"ChangesView.Refresh",SHELVE_SILENTLY:"ChangesView.ShelveSilently",SHELVE:"ChangesView.Shelve",UNSHELVE_SILENTLY:"ChangesView.UnshelveSilently",NEW_CHANGELIST:"ChangesView.NewChangeList",RENAME_CHANGELIST:"ChangesView.Rename",REMOVE_CHANGELIST:"ChangesView.RemoveChangeList",SET_DEFAULT_CHANGELIST:"ChangesView.SetDefault",MOVE_TO_ANOTHER_CHANGELIST:"ChangesView.Move",SHOW_DIFF:"Diff.ShowDiff",CHECKIN_FILES:"CheckinFiles",CHECKIN_PROJECT:"CheckinProject",JUMP_TO_SOURCE:CommonActionIds.$.EDIT_SOURCE,GROUP_CHANGES_VIEW_POPUP_MENU:"ChangesViewPopupMenu",GIT_CREATE_NEW_BRANCH:"Git.CreateNewBranch",GIT_BRANCHES:"Git.Branches"};var ActionsMenu=__webpack_require__("./src/ActionSystem/components/ActionsMenu.tsx");const ChangesViewTreeContextMenu=()=>0===[...(0,es.sJ)(ChangesView_state_selectedKeysState)].length?null:(0,jsx_runtime.jsx)(ActionsMenu.C,{"aria-label":"Context menu",actions:[(0,ActionsProvider.BH)(VcsActionIds.CHECKIN_FILES),(0,ActionsProvider.BH)(VcsActionIds.ROLLBACK),(0,ActionsProvider.BH)(VcsActionIds.JUMP_TO_SOURCE),new Divider.P,(0,ActionsProvider.BH)(VcsActionIds.SHELVE),new Divider.P,(0,ActionsProvider.BH)(VcsActionIds.NEW_CHANGELIST),(0,ActionsProvider.BH)(VcsActionIds.RENAME_CHANGELIST),(0,ActionsProvider.BH)(VcsActionIds.REMOVE_CHANGELIST),(0,ActionsProvider.BH)(VcsActionIds.SET_DEFAULT_CHANGELIST),(0,ActionsProvider.BH)(VcsActionIds.MOVE_TO_ANOTHER_CHANGELIST),new Divider.P,(0,ActionsProvider.BH)(VcsActionIds.REFRESH)].filter(array_utils.N)});ChangesViewTreeContextMenu.displayName="ChangesViewTreeContextMenu";var core=__webpack_require__("../../node_modules/intl-messageformat/lib/src/core.js");const StyledRepoColorSquare=styled.zo.span`
  width: 14px;
  height: 14px;
  align-self: center;
  margin-right: 0.1rem;
  position: relative;

  //  after pseudo element is used to create the color mixing implemented here:
  //  https://github.com/JetBrains/intellij-community/blob/82f201386c3f7a339ff25fc8f3389024c8078a87/platform/vcs-log/impl/src/com/intellij/vcs/log/ui/VcsLogColorManagerImpl.java#L60
  &&:after {
    content: "";
    position: absolute;
    inset: 0;
    opacity: 0.75;
    background: ${({theme})=>theme.color("Table.background")||(theme.dark?"#3C3F41":"#fff")};
  }
`,useRepoRootColor=rootPath=>{const index=(0,es.sJ)(vcsRootsState).findIndex((root=>root.dir===rootPath)),theme=(0,styled_components_browser_esm.Fg)(),colors=[theme.commonColors.red,theme.commonColors.blue];return colors[index%colors.length]??colors[0]},RepoColorIcon=({rootPath})=>(0,jsx_runtime.jsx)(StyledRepoColorSquare,{style:{backgroundColor:useRepoRootColor(rootPath)}});RepoColorIcon.displayName="RepoColorIcon";try{RepoColorIcon.displayName="RepoColorIcon",RepoColorIcon.__docgenInfo={description:"",displayName:"RepoColorIcon",props:{rootPath:{defaultValue:null,description:"",name:"rootPath",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/Changes/ChangesView/StyledRepoColorSquare.tsx#RepoColorIcon"]={docgenInfo:RepoColorIcon.__docgenInfo,name:"RepoColorIcon",path:"../example-app/src/VersionControl/Changes/ChangesView/StyledRepoColorSquare.tsx#RepoColorIcon"})}catch(__react_docgen_typescript_loader_error){}var Color=__webpack_require__("./src/Theme/Color.ts");const StyledCurrentBranchTag=styled.zo.span`
  display: inline-flex;
  align-self: center;
  height: 1.1rem;
  line-height: 1.1rem;
  padding: 0 0.25rem;

  background: ${({theme})=>new Color.I(theme.color("VersionControl.RefLabel.backgroundBase",theme.dark?"#fff":"#000")).withTransparency(theme.value("VersionControl.RefLabel.backgroundBrightness")??.08).toString()};
  color: ${({theme})=>theme.currentForegroundAware(theme.color("VersionControl.RefLabel.foreground",theme.dark?"#909090":"#7a7a7a"))};
`;try{StyledCurrentBranchTag.displayName="StyledCurrentBranchTag",StyledCurrentBranchTag.__docgenInfo={description:"",displayName:"StyledCurrentBranchTag",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: HTMLSpanElement | null) => void) | RefObject<HTMLSpanElement> | null"}},theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"Theme<KnownThemePropertyPath>"}},as:{defaultValue:null,description:"",name:"as",required:!1,type:{name:"undefined"}},forwardedAs:{defaultValue:null,description:"",name:"forwardedAs",required:!1,type:{name:"undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/Changes/ChangesView/StyledCurrentBranchTag.tsx#StyledCurrentBranchTag"]={docgenInfo:StyledCurrentBranchTag.__docgenInfo,name:"StyledCurrentBranchTag",path:"../example-app/src/VersionControl/Changes/ChangesView/StyledCurrentBranchTag.tsx#StyledCurrentBranchTag"})}catch(__react_docgen_typescript_loader_error){}async function getTrackingBranch({fs,dir,localBranchName}){const mergeRef=await isomorphic_git.ZP.getConfig({fs,dir,path:`branch.${localBranchName}.merge`}),remote=await isomorphic_git.ZP.getConfig({fs,dir,path:`branch.${localBranchName}.remote`});return mergeRef&&remote?`${remote}/${mergeRef.replace(/^refs\/heads\//,"")}`:null}var refine_es=__webpack_require__("../../node_modules/@recoiljs/refine/es/index.js"),recoil_sync_es=__webpack_require__("../../node_modules/recoil-sync/es/index.js");let StorageFiles;function persistentAtomEffect({componentName,refine,read,update,storageFile=StorageFiles.WORKSPACE_FILE}){const itemKey=[storageFile,componentName].join("|");return(0,recoil_sync_es.ok)({storeKey:"ProjectWorkspace",itemKey,syncDefault:!1,read:async({read:readComponentState})=>read(await readComponentState(itemKey)),write:({write,read},value)=>{value instanceof es.nY||write(itemKey,update(value))},refine})}!function(StorageFiles){StorageFiles.WORKSPACE_FILE="$WORKSPACE_FILE$"}(StorageFiles||(StorageFiles={}));const repoLocalBranchesState=(0,es.CG)({key:"vcs/repoLocalBranches",get:repoRoot=>async({})=>{const branches=await isomorphic_git.ZP.listBranches({fs,dir:repoRoot});return Promise.all(branches.map((async branch=>({name:branch,trackingBranch:await getTrackingBranch({fs,dir:repoRoot,localBranchName:branch})}))))}}),repoRemoteBranchesState=(0,es.CG)({key:"vcs/repoRemoteBranches",get:repoRoot=>async()=>{const remotes=await isomorphic_git.ZP.listRemotes({fs,dir:repoRoot});return(await Promise.all(remotes.map((({remote})=>isomorphic_git.ZP.listBranches({fs,dir:repoRoot,remote}).then((branches=>branches.filter((branch=>"HEAD"!==branch)).map((branch=>({name:branch,remote}))))))))).flat()}}),repoBranchesState=(0,es.CG)({key:"vcs/repoBranches",get:repoRoot=>async({get})=>{const currentBranchName=get(repoCurrentBranchNameState(repoRoot)),localBranches=get(repoLocalBranchesState(repoRoot));return{repoRoot,currentBranch:localBranches.find((branch=>branch.name===currentBranchName))||null,localBranches,remoteBranches:get(repoRemoteBranchesState(repoRoot))}}}),repoCurrentBranchNameState=(0,es.CG)({key:"vcs/repoCurrentBranch",get:repoRoot=>()=>isomorphic_git.ZP.currentBranch({fs,dir:repoRoot,fullname:!1})}),allBranchesState=(0,es.nZ)({key:"vcs/allBranches",get:({get})=>get(vcsRootsState).map((({dir:repoRoot})=>get(repoBranchesState(repoRoot))))}),branchForPathState=(0,es.CG)({key:"gitBranchForFile",get:filepath=>({get})=>{const root=get(vcsRootForFile(filepath));return root&&get(repoBranchesState(root)).currentBranch?.name||null}}),PREDEFINED_FAVORITE_BRANCH_NAMES=[{branchType:"LOCAL",branchName:"master"},{branchType:"REMOTE",branchName:"origin/master"}],maybeArray=input=>Array.isArray(input)?input:input?[input]:[];function readBranchStorage(branchStorage){return maybeArray(branchStorage?.map).flatMap((entry=>maybeArray(entry?.entry.value.list).map((({"branch-info":{"@source":branchName,"@repo":repoRoot}})=>({branchType:entry?.entry["@type"],branchName,repoRoot})))))||[]}function toBranchStorage(value){const branchesByType=(0,groupBy.Z)((({branchType})=>branchType),value);return{map:Object.entries(branchesByType).map((([branchType,branches])=>({entry:{"@type":branchType,value:{list:branches.map((branch=>({"branch-info":{"@repo":branch.repoRoot,"@source":branch.branchName}})))}}})))}}const branchInfoArrayChecker=(0,refine_es.IX)((0,refine_es.Ry)({branchType:(0,refine_es.G0)((0,refine_es.i0)("LOCAL"),(0,refine_es.i0)("REMOTE")),branchName:(0,refine_es.Z_)(),repoRoot:(0,refine_es.Z_)()})),favoriteBranchesState=(0,es.cn)({key:"vcs/branches/favorite",default:[],effects:[persistentAtomEffect({refine:branchInfoArrayChecker,componentName:"Git.Settings",read:gitSettings=>readBranchStorage(gitSettings?.["favorite-branches"]?.["branch-storage"]),update:value=>currentValue=>({...currentValue||{},"favorite-branches":{"branch-storage":toBranchStorage(value)}})})]}),excludedFromFavoriteBranchesState=(0,es.cn)({key:"vcs/branches/favorite-excluded",default:[],effects:[persistentAtomEffect({refine:branchInfoArrayChecker,componentName:"Git.Settings",read:gitSettings=>readBranchStorage(gitSettings?.["exclude-from-favorite"]?.["branch-storage"]),update:value=>currentValue=>({...currentValue||{},"exclude-from-favorite":{"branch-storage":toBranchStorage(value)}})})]});function isPredefinedAsFavorite(params){return PREDEFINED_FAVORITE_BRANCH_NAMES.some((({branchType,branchName})=>branchName===params.branchName&&branchType===params.branchType))}const isFavorite=(favoriteBranches,excludedFromFavoriteBranches,params)=>!!favoriteBranches.find((0,equals.Z)(params))||!excludedFromFavoriteBranches.find((0,equals.Z)(params))&&isPredefinedAsFavorite(params);function useToggleFavoriteBranch(){return(0,es._8)((({set,snapshot})=>(params,favorite=!isFavorite(snapshot.getLoadable(favoriteBranchesState).getValue(),snapshot.getLoadable(excludedFromFavoriteBranchesState).getValue(),params))=>{const remove=currentValue=>currentValue.filter((favoriteBranch=>!(0,equals.Z)(favoriteBranch,params))),add=currentValue=>currentValue.some((0,equals.Z)(params))?currentValue:currentValue.concat(params);favorite?(set(excludedFromFavoriteBranchesState,remove),isPredefinedAsFavorite(params)||set(favoriteBranchesState,add)):(set(favoriteBranchesState,remove),isPredefinedAsFavorite(params)&&set(excludedFromFavoriteBranchesState,add))}),[])}function useFavoriteBranches(){const favoriteBranches=(0,es.sJ)(favoriteBranchesState),excludedFromFavoriteBranches=(0,es.sJ)(excludedFromFavoriteBranchesState);return{isFavorite:params=>isFavorite(favoriteBranches,excludedFromFavoriteBranches,params),toggleFavorite:useToggleFavoriteBranch()}}const RepoCurrentBranchName=({repo})=>{const branch=(0,es.sJ)(branchForPathState(repo.dir));return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:branch})};try{RepoCurrentBranchName.displayName="RepoCurrentBranchName",RepoCurrentBranchName.__docgenInfo={description:"",displayName:"RepoCurrentBranchName",props:{repo:{defaultValue:null,description:"",name:"repo",required:!0,type:{name:"VcsDirectoryMapping"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/RepoCurrentBranchName.tsx#RepoCurrentBranchName"]={docgenInfo:RepoCurrentBranchName.__docgenInfo,name:"RepoCurrentBranchName",path:"../example-app/src/VersionControl/RepoCurrentBranchName.tsx#RepoCurrentBranchName"})}catch(__react_docgen_typescript_loader_error){}const fileCountMsg=new core.C("{fileCount, plural,\n    =0 {No files}\n    =1 {1 file}\n    other {# files}\n  }","en-US"),ChangeNodeHint=({node})=>{const isGroupedByDirectory=(0,es.sJ)(changesGroupingState("directory"));return(0,jsx_runtime.jsx)(ItemLayout.e.Hint,{children:!isGroupedByDirectory&&path_browserify_default().dirname(node.change.after.path)})};ChangeNodeHint.displayName="ChangeNodeHint";const nodeRenderers={repo:(node,{fileCount})=>({textValue:path_browserify_default().basename(node.repository.dir),rendered:(0,jsx_runtime.jsxs)(ItemLayout.e,{children:[(0,jsx_runtime.jsx)(RepoColorIcon,{rootPath:node.repository.dir}),(0,jsx_runtime.jsx)(HighlightedTextValue.J,{}),(0,jsx_runtime.jsx)(ItemLayout.e.Hint,{children:fileCountMsg.format({fileCount})}),(0,jsx_runtime.jsx)(StyledCurrentBranchTag,{children:(0,jsx_runtime.jsx)(RepoCurrentBranchName,{repo:node.repository})})]})}),directory:(node,{fileCount})=>({textValue:node.parentNodePath?path_browserify_default().relative(node.parentNodePath,node.dirPath):node.dirPath,rendered:(0,jsx_runtime.jsxs)(ItemLayout.e,{children:[(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"nodes/folder"}),(0,jsx_runtime.jsx)(HighlightedTextValue.J,{}),(0,jsx_runtime.jsx)(ItemLayout.e.Hint,{children:fileCountMsg.format({fileCount})})]})}),changelist:(node,{fileCount})=>({textValue:node.changeList.name,rendered:(0,jsx_runtime.jsxs)(ItemLayout.e,{children:[(0,jsx_runtime.jsx)("span",{style:{fontWeight:node.changeList.active?"bold":void 0},children:(0,jsx_runtime.jsx)(HighlightedTextValue.J,{})}),(0,jsx_runtime.jsxs)(ItemLayout.e.Hint,{children:[fileCountMsg.format({fileCount})," "]})]})}),change:node=>({textValue:path_browserify_default().basename(node.change.after.path),rendered:(0,jsx_runtime.jsxs)(ItemLayout.e,{children:[(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:getIconForFile(node.change.after.path)}),(0,jsx_runtime.jsx)(HighlightedTextValue.J,{}),(0,jsx_runtime.jsx)(ChangeNodeHint,{node})]})})},getChangeListTreeItemProps=({node,fileCountsMap})=>{const nodeRenderer=nodeRenderers[node.type],{textValue,rendered}=nodeRenderer(node,{fileCount:fileCountsMap.get(node.key)||0,dirCount:0});return{key:node.key,childItems:isGroupNode(node)?node.children:[],hasChildItems:isGroupNode(node)&&node.children?.length>0,textValue,children:rendered}};try{getChangeListTreeItemProps.displayName="getChangeListTreeItemProps",getChangeListTreeItemProps.__docgenInfo={description:"",displayName:"getChangeListTreeItemProps",props:{node:{defaultValue:null,description:"",name:"node",required:!0,type:{name:"AnyNode"}},fileCountsMap:{defaultValue:null,description:"",name:"fileCountsMap",required:!0,type:{name:"Map<Key, number>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/Changes/ChangesView/changesTreeNodeRenderers.tsx#getChangeListTreeItemProps"]={docgenInfo:getChangeListTreeItemProps.__docgenInfo,name:"getChangeListTreeItemProps",path:"../example-app/src/VersionControl/Changes/ChangesView/changesTreeNodeRenderers.tsx#getChangeListTreeItemProps"})}catch(__react_docgen_typescript_loader_error){}function findPathsUnderNode(node){return"directory"===node?.type?[node.dirPath]:"change"===node?.type?[node.change.after.path]:isGroupNode(node)?node.children.flatMap(findPathsUnderNode):[]}const ChangeViewTree=({treeRef})=>{const{rootNodes,fileCountsMap,byKey}=(0,es.sJ)(changesTreeNodesState),[selectedKeys,setSelectedKeys]=(0,es.FV)(ChangesView_state_selectedKeysState),[expandedKeys,setExpandedKeys]=(0,es.FV)(ChangesView_state_expandedKeysState),nestedSelection=(0,es.sJ)(includedChangesNestedSelection),{openPath}=useEditorStateManager(),openChangeInEditor=(0,es._8)((({snapshot})=>key=>{const change=snapshot.getLoadable(changesTreeNodesState).getValue().byKey.get(key);return"change"===change?.type&&openPath(change.change.after.path),change}),[]),activePathsProviderProps=useActivePathsProvider("all"===selectedKeys?[]:[...selectedKeys].flatMap((key=>{const node=byKey.get(key);return node?findPathsUnderNode(node):[]})));return(0,jsx_runtime.jsx)(ContextMenuContainer.X,{renderMenu:()=>(0,jsx_runtime.jsx)(ChangesViewTreeContextMenu,{}),style:{height:"100%"},children:(0,jsx_runtime.jsx)(SpeedSearchTreeWithCheckboxes,{ref:treeRef,items:rootNodes,selectionMode:"multiple",selectedKeys,expandedKeys,onExpandedChange:setExpandedKeys,onSelectionChange:setSelectedKeys,onAction:openChangeInEditor,nestedSelection,fillAvailableSpace:!0,autoFocus:"first",...activePathsProviderProps,children:node=>{const props=getChangeListTreeItemProps({fileCountsMap,node});return(0,jsx_runtime.jsxs)(Item.c,{...props,children:[0!==node.children?.length&&(0,jsx_runtime.jsx)(TreeNodeCheckbox,{selectionState:nestedSelection.getSelectionState(node),onToggle:()=>nestedSelection.toggle(node)}),props.children]})}})})};ChangeViewTree.displayName="ChangeViewTree";try{ChangeViewTree.displayName="ChangeViewTree",ChangeViewTree.__docgenInfo={description:"TODO: unversioned files\nTODO: show diff/source on double click (on action to be more precise)",displayName:"ChangeViewTree",props:{treeRef:{defaultValue:null,description:"",name:"treeRef",required:!0,type:{name:"RefObject<TreeRefValue>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/Changes/ChangesView/ChangeViewTree.tsx#ChangeViewTree"]={docgenInfo:ChangeViewTree.__docgenInfo,name:"ChangeViewTree",path:"../example-app/src/VersionControl/Changes/ChangesView/ChangeViewTree.tsx#ChangeViewTree"})}catch(__react_docgen_typescript_loader_error){}var Toolbar=__webpack_require__("./src/Toolbar/Toolbar.tsx"),IconButton=__webpack_require__("./src/IconButton/IconButton.tsx"),MenuTrigger=__webpack_require__("./src/Menu/MenuTrigger.tsx");const ArrowIcon=(0,styled_components_browser_esm.ZP)(PlatformIcon.vq).withConfig({displayName:"IconButtonWithMenu__ArrowIcon",componentId:"sc-t9mrdg-0"})(["position:absolute;right:1px;bottom:1px;"]),IconButtonWithMenu=({renderMenu,children,noArrow=!1,...buttonProps})=>{const previouslyFocusedElementRef=(0,react.useRef)();return(0,jsx_runtime.jsx)(MenuTrigger.b,{renderMenu,onOpenChange:open=>{!open&&previouslyFocusedElementRef.current&&previouslyFocusedElementRef.current.focus()},children:(props,ref)=>(0,jsx_runtime.jsxs)(IconButton.hU,{...(0,dist_module.dG)(buttonProps,props,{onFocus:e=>{e.relatedTarget&&e.relatedTarget instanceof HTMLElement&&(previouslyFocusedElementRef.current=e.relatedTarget)}}),ref,children:[children,!noArrow&&(0,jsx_runtime.jsx)(ArrowIcon,{icon:"general/dropdown.svg"})]})})};IconButtonWithMenu.displayName="IconButtonWithMenu";try{IconButtonWithMenu.displayName="IconButtonWithMenu",IconButtonWithMenu.__docgenInfo={description:"Renders an IconButton which opens a menu. by default a down arrow icon is shown as an overlay on the rendered\nicon, but it can be disabled by passing `noArrow`. It also restores the focus to the previously focused element,\nwhen the menu is closed.",displayName:"IconButtonWithMenu",props:{minSize:{defaultValue:null,description:"The minimum width/height of the button.",name:"minSize",required:!1,type:{name:"number"}},excludeFromTabOrder:{defaultValue:null,description:"Whether the button should be focusable by pressing tab. The default is true for icon buttons (aka. action buttons),\nwhich means they are not included in the tab order.",name:"excludeFromTabOrder",required:!1,type:{name:"boolean"}},renderMenu:{defaultValue:null,description:"",name:"renderMenu",required:!0,type:{name:"(props: { menuProps: HTMLAttributes<HTMLElement>; }) => ReactNode"}},noArrow:{defaultValue:{value:"false"},description:"whether the default arrow should be removed or not. false by default.",name:"noArrow",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/IconButtonWithMenu/IconButtonWithMenu.tsx#IconButtonWithMenu"]={docgenInfo:IconButtonWithMenu.__docgenInfo,name:"IconButtonWithMenu",path:"src/IconButtonWithMenu/IconButtonWithMenu.tsx#IconButtonWithMenu"})}catch(__react_docgen_typescript_loader_error){}const ChangeListsActionButton=()=>{const actions=[(0,ActionsProvider.BH)(VcsActionIds.NEW_CHANGELIST),(0,ActionsProvider.BH)(VcsActionIds.RENAME_CHANGELIST),(0,ActionsProvider.BH)(VcsActionIds.REMOVE_CHANGELIST),(0,ActionsProvider.BH)(VcsActionIds.SET_DEFAULT_CHANGELIST),(0,ActionsProvider.BH)(VcsActionIds.MOVE_TO_ANOTHER_CHANGELIST)].filter(array_utils.N);return(0,jsx_runtime.jsx)(IconButtonWithMenu,{renderMenu:({menuProps})=>(0,jsx_runtime.jsx)(ActionsMenu.C,{menuProps,actions}),children:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"vcs/changelist.svg"})})};ChangeListsActionButton.displayName="ChangeListsActionButton";var collections_dist_module=__webpack_require__("../../node_modules/@react-stately/collections/dist/module.js");const GroupByActionButton=()=>{const availableGroupings=(0,es.sJ)(availableGroupingsState),toggleGroup=(0,es._8)((({set})=>id=>{set(changesGroupingState(id),(value=>!value))}),[]);return(0,jsx_runtime.jsx)(IconButtonWithMenu,{renderMenu:({menuProps})=>(0,jsx_runtime.jsx)(Menu.v2,{...menuProps,selectedKeys:availableGroupings.filter((({isActive})=>isActive)).map((({grouping})=>grouping.id)),onAction:key=>{const id=availableGroupings.find((({grouping})=>grouping.id===key))?.grouping.id;id&&toggleGroup(id)},children:(0,jsx_runtime.jsx)(collections_dist_module.$0,{title:"Group By",children:availableGroupings.map((({grouping})=>(0,jsx_runtime.jsx)(Item.c,{children:grouping.title},grouping.id)))})}),children:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"actions/groupBy.svg"})})};GroupByActionButton.displayName="GroupByActionButton";const ViewOptionsActionButton=()=>{const[showRelatedFiles,setShowRelatedFiles]=(0,es.FV)(showRelatedFilesState),[showIgnoredFiles,setShowIgnoredFiles]=(0,es.FV)(showIgnoredFilesState),viewOptions={showRelatedFiles,showIgnoredFiles};return(0,jsx_runtime.jsx)(IconButtonWithMenu,{renderMenu:({menuProps})=>(0,jsx_runtime.jsxs)(Menu.v2,{...menuProps,selectedKeys:Object.keys(viewOptions).filter((key=>viewOptions[key])),onAction:key=>{switch(key){case"showIgnoredFiles":return setShowIgnoredFiles((value=>!value));case"showRelatedFiles":return setShowRelatedFiles((value=>!value))}},children:[(0,jsx_runtime.jsx)(Item.c,{children:"Show Ignored Files"},"showIgnoredFiles"),(0,jsx_runtime.jsx)(Item.c,{children:"Show Files Related to Active Changelist"},"showRelatedFiles")]}),children:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"actions/show.svg"})})};function ChangesViewToolbar(){return(0,jsx_runtime.jsxs)(Toolbar.o,{hasBorder:!0,children:[(0,jsx_runtime.jsx)(ActionButton.K,{actionId:VcsActionIds.REFRESH}),(0,jsx_runtime.jsx)(ActionButton.K,{actionId:VcsActionIds.ROLLBACK}),(0,jsx_runtime.jsx)(ActionButton.K,{actionId:VcsActionIds.SHOW_DIFF}),(0,jsx_runtime.jsx)(TooltipTrigger.a,{tooltip:(0,jsx_runtime.jsx)(ActionTooltip.M,{actionName:"Changelists"}),children:(0,jsx_runtime.jsx)(ChangeListsActionButton,{})}),(0,jsx_runtime.jsx)(ActionButton.K,{actionId:VcsActionIds.SHELVE_SILENTLY}),(0,jsx_runtime.jsx)(Toolbar.J,{}),(0,jsx_runtime.jsx)(TooltipTrigger.a,{tooltip:(0,jsx_runtime.jsx)(ActionTooltip.M,{actionName:"Group By"}),children:(0,jsx_runtime.jsx)(GroupByActionButton,{})}),(0,jsx_runtime.jsx)(TooltipTrigger.a,{tooltip:(0,jsx_runtime.jsx)(ActionTooltip.M,{actionName:"View Options"}),children:(0,jsx_runtime.jsx)(ViewOptionsActionButton,{})}),(0,jsx_runtime.jsx)(ActionButton.K,{actionId:CommonActionIds.$.EXPAND_ALL}),(0,jsx_runtime.jsx)(ActionButton.K,{actionId:CommonActionIds.$.COLLAPSE_ALL})]})}ViewOptionsActionButton.displayName="ViewOptionsActionButton",ChangesViewToolbar.displayName="ChangesViewToolbar";var Button=__webpack_require__("./src/Button/Button.tsx");function useCommit(){const refreshChanges=useRefreshChanges(),refreshFileStatus=useUpdateVcsFileStatuses();return(0,es._8)((({snapshot})=>async(changes,commitMessage)=>{const changesGroupedByRepo=(0,groupBy.Z)((({repoRoot})=>repoRoot),(await Promise.all(changes.map((async change=>{const filePath=change.after.path,repoRoot=snapshot.getLoadable(vcsRootForFile(filePath)).getValue(),content=await fs.promises.readFile(filePath);return repoRoot?{repoRoot,filePath:path_browserify_default().relative(repoRoot,filePath),content}:null})))).filter(array_utils.N));await Promise.all(Object.entries(changesGroupedByRepo).map((async([repoRoot,files])=>{const updates=files.reduce(((soFar,{filePath,content})=>({...soFar,[filePath]:content})),{});await async function commitFiles({files,fs,dir,gitdir,...options}){const headTreeOid=await isomorphic_git.ZP.resolveRef({fs,dir,gitdir,ref:"HEAD"}),entries=(await isomorphic_git.ZP.readTree({fs,dir,gitdir,oid:headTreeOid})).tree;await Promise.all(Object.entries(files).map((async([filePath,blob])=>{const entry=entries.find((({path})=>path===filePath)),oid=await isomorphic_git.ZP.writeBlob({fs,dir,gitdir,blob});entry?entry.oid=oid:entries.push({type:"blob",mode:"100644",oid,path:filePath})})));const newTreeOid=await isomorphic_git.ZP.writeTree({fs,dir,gitdir,tree:entries}),commitRef=await isomorphic_git.ZP.commit({...options,fs,dir,gitdir,tree:newTreeOid});await Promise.all(Object.keys(files).map((filepath=>isomorphic_git.ZP.resetIndex({fs,dir,gitdir,filepath,ref:commitRef}))))}({fs,dir:repoRoot,files:updates,message:commitMessage,author:{name:"Alireza",email:"alireza.mirian@gmail.com"}})}))),await Promise.all([refreshChanges(),refreshFileStatus()])}),[refreshChanges])}try{useCommit.displayName="useCommit",useCommit.__docgenInfo={description:"Returns a commit callback to be used to commit a bunch of changes.\nSyncs all relevant state (like file status, and change lists) after commit.",displayName:"useCommit",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/Changes/ChangesView/useCommit.tsx#useCommit"]={docgenInfo:useCommit.__docgenInfo,name:"useCommit",path:"../example-app/src/VersionControl/Changes/ChangesView/useCommit.tsx#useCommit"})}catch(__react_docgen_typescript_loader_error){}const StyledCommitMessageContainer=styled.zo.div`
  background: ${({theme})=>theme.dark?"#2b2b2b":"#fff"};
  height: 100%;
  display: flex;
  flex-direction: column;
`,StyledCommitMessageTextArea=styled.zo.textarea`
  flex: 1;
  background: none;
  padding: 0.25rem 0.375rem;
  color: ${({theme})=>theme.dark?"#a9b7c6":"#000"};
  font-family: inherit;
  border: none;
  resize: none;
  outline: none;
`,StyledCommitActionsRow=styled.zo.div`
  display: flex;
  gap: 0.3rem;
  padding: 0.4rem;
`,StyledErrorMessage=styled.zo.div`
  display: flex;
  align-items: center;
  padding: 0.125rem 0.5rem;
  gap: 0.25rem;
  position: sticky; // prevents commit message scroll jump when message is toggled on and off
  color: ${({theme})=>theme.commonColors.red};
`,commitSuccessfulMessage=new core.C("{count, plural,\n    =1 {1 file committed}\n    other {# files committed}\n  }","en-US");function CommitView({editorRef}){const commitMessageTextAreaRef=(0,react.useRef)(null),[commitMessage,setCommitMessage]=(0,es.FV)(commitMessageState),commit=useCommit(),balloonManager=(0,BalloonManager.L)(),[errorMessage,setErrorMessage]=(0,es.FV)(commitErrorMessageState),isCommitInProgress=(0,es.sJ)(isCommitInProgressState);(0,react.useEffect)((()=>{commitMessage&&setErrorMessage("")}),[commitMessage]);const commitSelectedChanges=(0,es._8)((({snapshot,set})=>{const includedChanges=snapshot.getLoadable(includedChangesState).getValue(),commitMessage=snapshot.getLoadable(commitMessageState).getValue();return()=>{if(0!==includedChanges.length)if(commitMessage){if(!snapshot.getLoadable(amendCommitState).getValue())return set(isCommitInProgressState,!0),commit(includedChanges,commitMessage).then((()=>{balloonManager.show({icon:"Info",body:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[`${commitSuccessfulMessage.format({count:includedChanges.length})}: `,commitMessage.split("\n").flatMap(((part,index)=>[(0,jsx_runtime.jsx)("br",{},index),part])).slice(1)]})})}),(e=>{balloonManager.show({icon:"Error",title:"Commit failed!",body:"Could not commit files."}),console.error("Commit error",e)})).finally((()=>{set(isCommitInProgressState,!1)}));balloonManager.show({icon:"Error",title:"Unsupported action",body:"Amending commits is not yet supported."})}else setErrorMessage("Specify commit message");else setErrorMessage("Select files to commit")}}),[]),{hasFocus}=(0,DefaultToolWindow.e)();return(0,react.useImperativeHandle)(editorRef,(()=>({focus:()=>{commitMessageTextAreaRef.current?.focus()}})),[]),(0,jsx_runtime.jsxs)(StyledCommitMessageContainer,{children:[(0,jsx_runtime.jsx)(StyledCommitMessageTextArea,{ref:commitMessageTextAreaRef,value:commitMessage,onChange:event=>{setCommitMessage(event.target.value)},placeholder:"Commit Message","data-gramm":"false"}),errorMessage&&(0,jsx_runtime.jsxs)(StyledErrorMessage,{children:[(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"general/error.svg"})," ",errorMessage]}),(0,jsx_runtime.jsxs)(StyledCommitActionsRow,{children:[(0,jsx_runtime.jsx)(Button.z,{preventFocusOnPress:!0,variant:hasFocus?"default":void 0,onPress:commitSelectedChanges,isDisabled:isCommitInProgress,children:"Commit"}),(0,jsx_runtime.jsx)(Button.z,{preventFocusOnPress:!0,onPress:notImplemented,children:"Commit and Push..."})]})]})}CommitView.displayName="CommitView";try{CommitView.displayName="CommitView",CommitView.__docgenInfo={description:"Commit message and commit buttons shown in the bottom/right split view of the commit toolwindow",displayName:"CommitView",props:{editorRef:{defaultValue:null,description:"",name:"editorRef",required:!0,type:{name:"RefObject<{ focus: () => void; }>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/Changes/ChangesView/CommitView.tsx#CommitView"]={docgenInfo:CommitView.__docgenInfo,name:"CommitView",path:"../example-app/src/VersionControl/Changes/ChangesView/CommitView.tsx#CommitView"})}catch(__react_docgen_typescript_loader_error){}var ActionHelpTooltip=__webpack_require__("./src/Tooltip/ActionHelpTooltip.tsx");const ChangesSummary=({changes})=>{const modifiedCount=changes.filter((change=>change.after.path&&change.before.path)).length,addedCount=changes.filter((change=>change.after.path&&!change.before.path)).length,deletedCount=changes.filter((change=>change.before.path&&!change.after.path)).length;return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[addedCount>0&&(0,jsx_runtime.jsxs)(StatusColor,{status:"ADDED",children:[addedCount," added"]}),modifiedCount>0&&(0,jsx_runtime.jsxs)(StatusColor,{status:"MODIFIED",children:[modifiedCount," modified"]}),deletedCount>0&&(0,jsx_runtime.jsxs)(StatusColor,{status:"DELETED",children:[deletedCount," deleted"]})]})};try{ChangesSummary.displayName="ChangesSummary",ChangesSummary.__docgenInfo={description:"",displayName:"ChangesSummary",props:{changes:{defaultValue:null,description:"",name:"changes",required:!0,type:{name:"readonly Change[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/Changes/ChangesSummary.tsx#ChangesSummary"]={docgenInfo:ChangesSummary.__docgenInfo,name:"ChangesSummary",path:"../example-app/src/VersionControl/Changes/ChangesSummary.tsx#ChangesSummary"})}catch(__react_docgen_typescript_loader_error){}const StyledActionsRow=styled.zo.div`
  display: flex;
  padding: 0.125rem;
  position: relative;
`,StyledAmendCheckbox=(0,styled.zo)(Checkbox.X)`
  padding-right: 0.625rem;
`,StyledChangesSummaryContainer=styled.zo.span`
  position: absolute;
  right: 0.5rem;
  top: 0.25rem;
  background: ${({theme})=>theme.color("Panel.background")};
  z-index: 1;
`,ChangesViewChangesSummary=()=>{const changes=(0,es.sJ)(includedChangesState);return(0,jsx_runtime.jsx)(ChangesSummary,{changes})};function CommitActionsRow(){const[amend,setAmend]=(0,es.FV)(amendCommitState);return(0,jsx_runtime.jsxs)(StyledActionsRow,{children:[(0,jsx_runtime.jsx)(TooltipTrigger.a,{tooltip:(0,jsx_runtime.jsx)(ActionHelpTooltip.h,{actionName:"Amend Commit",helpText:"Modify the latest commit of the current branch"}),children:props=>(0,jsx_runtime.jsx)("span",{...props,children:(0,jsx_runtime.jsx)(StyledAmendCheckbox,{isSelected:amend,onChange:setAmend,preventFocus:!0,children:"Amend"})})}),(0,jsx_runtime.jsx)(TooltipTrigger.a,{tooltip:(0,jsx_runtime.jsx)(ActionTooltip.M,{actionName:"Show Commit Options"}),children:(0,jsx_runtime.jsx)(IconButton.hU,{onPress:notImplemented,children:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"general/gear.svg"})})}),(0,jsx_runtime.jsx)(TooltipTrigger.a,{tooltip:(0,jsx_runtime.jsx)(ActionTooltip.M,{actionName:"Commit Message History"}),children:(0,jsx_runtime.jsx)(IconButton.hU,{isDisabled:!0,onPress:notImplemented,children:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"vcs/historyInline.svg"})})}),(0,jsx_runtime.jsx)(StyledChangesSummaryContainer,{children:(0,jsx_runtime.jsx)(ChangesViewChangesSummary,{})})]})}ChangesViewChangesSummary.displayName="ChangesViewChangesSummary",CommitActionsRow.displayName="CommitActionsRow";try{CommitActionsRow.displayName="CommitActionsRow",CommitActionsRow.__docgenInfo={description:"Amend checkbox, commit message history button, and summary of included changes, shown as a row\nbellow changes tree, in commit tool window.",displayName:"CommitActionsRow",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/Changes/ChangesView/CommitActionsRow.tsx#CommitActionsRow"]={docgenInfo:CommitActionsRow.__docgenInfo,name:"CommitActionsRow",path:"../example-app/src/VersionControl/Changes/ChangesView/CommitActionsRow.tsx#CommitActionsRow"})}catch(__react_docgen_typescript_loader_error){}const StyledContainer=styled.zo.div`
  display: flex;
  flex-direction: column;
  height: 100%;
`,StyledTreeViewWrapper=styled.zo.div`
  flex: 1;
  overflow: auto;
`;let editor=null,focusCommitMessage=()=>{setTimeout((()=>{editor?.focus()}))};const ChangesViewSplitter=()=>{const{state:{anchor}}=(0,ToolWindowStateProvider.j)(),treeRef=(0,react.useRef)(null),editorRef=(0,react.useRef)(null),orientation=(0,utils.Ss)(anchor),[commitMessageSize,setCommitMessageSize]=(0,es.FV)(commitMessageSizeState(orientation)),treeActions=(0,useTreeActions.x)({treeRef});return editor=editorRef.current,(0,jsx_runtime.jsx)(ThreeViewSplitter.D,{orientation,innerView:(0,jsx_runtime.jsx)(ActionsProvider.DG,{actions:treeActions,children:({shortcutHandlerProps})=>(0,jsx_runtime.jsxs)(StyledContainer,{...shortcutHandlerProps,children:[(0,jsx_runtime.jsx)(ChangesViewToolbar,{}),(0,jsx_runtime.jsx)(StyledTreeViewWrapper,{children:(0,jsx_runtime.jsx)(ChangeViewTree,{treeRef})}),(0,jsx_runtime.jsx)(CommitActionsRow,{})]})}),innerViewMinSize:50,lastView:(0,jsx_runtime.jsx)(CommitView,{editorRef}),lastSize:commitMessageSize,onLastResize:setCommitMessageSize})};ChangesViewSplitter.displayName="ChangesViewSplitter";const ChangesViewPane_StyledContainer=styled_components_browser_esm.ZP.div.withConfig({displayName:"ChangesViewPane__StyledContainer",componentId:"sc-1pqba05-0"})(["display:flex;flex-direction:column;height:100%;"]),ChangesViewPane=()=>{const refresh=useRefreshChanges();return(0,react.useEffect)((()=>{refresh()}),[]),(0,jsx_runtime.jsx)(ChangesViewPane_StyledContainer,{children:(0,jsx_runtime.jsx)(ChangesViewSplitter,{})})};ChangesViewPane.displayName="ChangesViewPane";const changesBranchesState=(0,es.nZ)({key:"vcs/commitToolWindow/changedRepos",get:({get})=>get(allChangesState).map((change=>get(vcsRootForFile(change.after.path)))).filter(array_utils.N).map((repoRoot=>({repoRoot,branch:get(repoBranchesState(repoRoot)).currentBranch})))}),CommitToolWindow=()=>{const areChangesGroupedByRepo=(0,es.sJ)(changesGroupingState("repository")),changesBranches=(0,es.sJ)(changesBranchesState),title=!areChangesGroupedByRepo&&changesBranches[0]?`Commit to ${changesBranches[0]?.branch?.name||"!"}`:"Commit";return(0,jsx_runtime.jsx)(MultiViewToolWindow.y,{children:(0,jsx_runtime.jsx)(MultiViewToolWindow.y.View,{tabContent:(0,jsx_runtime.jsx)(TooltipTrigger.a,{isDisabled:areChangesGroupedByRepo||0===changesBranches.length,tooltip:(0,jsx_runtime.jsx)(ActionTooltip.M,{actionName:(0,jsx_runtime.jsx)(ChangesBranches,{changesBranches})}),children:(0,jsx_runtime.jsx)("span",{children:title})}),children:(0,jsx_runtime.jsx)(ChangesViewPane,{})},"commit")})};function ChangesBranches({changesBranches}){return(0,jsx_runtime.jsx)("table",{children:changesBranches.map((({branch,repoRoot})=>{if(branch){const mapping=branch.trackingBranch?`${branch.name}  ${branch.trackingBranch}`:changesBranches.length>1?`${branch.name} (no tracking branch)`:"No tracking branch";return changesBranches.length>1?(0,jsx_runtime.jsxs)("tr",{children:[(0,jsx_runtime.jsxs)("td",{children:[path_browserify_default().basename(repoRoot),": "]}),(0,jsx_runtime.jsx)("td",{children:mapping})]},repoRoot):(0,jsx_runtime.jsx)("tr",{children:(0,jsx_runtime.jsx)("td",{children:mapping})},repoRoot)}return null})).filter(array_utils.N)})}function UNSAFE_FocusRestoringSuspense({children=null}){return(0,react.useEffect)((()=>{const focusedElement=document.activeElement;return()=>{focusedElement instanceof HTMLElement&&focusedElement!==document.activeElement&&document.activeElement===document.body&&focusedElement.isConnected&&focusedElement.focus()}}),[]),(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children})}CommitToolWindow.displayName="CommitToolWindow",ChangesBranches.displayName="ChangesBranches";try{UNSAFE_FocusRestoringSuspense.displayName="UNSAFE_FocusRestoringSuspense",UNSAFE_FocusRestoringSuspense.__docgenInfo={description:"Works around an issue where the focus is lost after a component rendering the focused element is suspended and\nunsuspended. Haven't tracked down the issue, but it can be the same react 17 issue we worked around in\n{@link UNSAFE_React17SuspenseFix }.",displayName:"UNSAFE_FocusRestoringSuspense",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/UNSAFE_FocusRestoringSuspense.tsx#UNSAFE_FocusRestoringSuspense"]={docgenInfo:UNSAFE_FocusRestoringSuspense.__docgenInfo,name:"UNSAFE_FocusRestoringSuspense",path:"../example-app/src/UNSAFE_FocusRestoringSuspense.tsx#UNSAFE_FocusRestoringSuspense"})}catch(__react_docgen_typescript_loader_error){}const toolWindows=[{id:"Project",title:"Project",icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"toolwindows/toolWindowProject"}),content:(0,jsx_runtime.jsx)(ProjectToolWindow,{}),initialState:(0,ToolWindowsState.x5)({isVisible:!0,weight:.23})},{id:"Terminal",title:"Terminal",icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"toolwindows/toolWindowProject"}),content:(0,jsx_runtime.jsx)(DefaultToolWindow.n,{headerContent:"Terminal",children:(0,jsx_runtime.jsx)(Terminal,{})}),initialState:(0,ToolWindowsState.x5)({anchor:"bottom"})},{id:"Commit",title:"Commit",icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"toolwindows/toolWindowCommit"}),content:(0,jsx_runtime.jsx)(react.Suspense,{fallback:(0,jsx_runtime.jsx)(UNSAFE_FocusRestoringSuspense,{}),children:(0,jsx_runtime.jsx)(CommitToolWindow,{})}),initialState:(0,ToolWindowsState.x5)({anchor:"left",isVisible:!1})}];var ProgressBar=__webpack_require__("./src/ProgressBar/ProgressBar.tsx"),ProgressBarPauseButton=__webpack_require__("./src/ProgressBar/ProgressBarPauseButton.tsx"),ProgressBarStopButton=__webpack_require__("./src/ProgressBar/ProgressBarStopButton.tsx"),StatusBar=__webpack_require__("./src/StatusBar/StatusBar.tsx"),StatusBarWidget=__webpack_require__("./src/StatusBar/StatusBarWidget.tsx"),PopupTrigger=__webpack_require__("./src/Popup/PopupTrigger.tsx"),Balloon=__webpack_require__("./src/Balloon/Balloon.tsx");const switchToPersistentFsProcess=(0,es.cn)({key:"switchToPersistentFsProcess",default:null});function usePersistenceFsNotification(){const balloons=(0,BalloonManager.L)(),setProcessState=(0,es.Zl)(switchToPersistentFsProcess);(0,react.useEffect)((()=>{const timeoutId=setTimeout((()=>{null==persistentFsPreference.get()&&balloons.showSticky({title:"Switch to IndexedDB filesystem",body:"By default an in-memory filesystem is used to have a faster git clone. But it means all changes will be lost upon refresh. You can switch in the background to a persistence fs implementation which uses IndexedDB to store files.",actions:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Balloon.g,{onPress:()=>{const token=new esm.qf.cancelToken;setProcessState({details:"Copying ...",isIndeterminate:!0,state:"STARTED",progress:0,onCancel:()=>{token.abort("canceled")},name:"Switching to IndexedDB FS"});switchToPersistentFS({cancelSignal:token.signal,onCopy:filepath=>{var updates;updates={name:`Copying ${path_browserify_default().dirname(filepath)}`},setProcessState((state=>state?{...state,...updates}:null))}}).then((()=>{persistentFsPreference.set("yes")})).catch((e=>{"canceled"!==e&&console.error("Error during switch to persistent FS:",e)})).finally((()=>{setProcessState(null)}))},children:"Switch to IndexedDB FS"}),(0,jsx_runtime.jsx)(Balloon.g,{onPress:()=>persistentFsPreference.set("no"),children:"Don't ask again"})]})})}),3e3);return()=>clearTimeout(timeoutId)}),[])}var Popup=__webpack_require__("./src/Popup/Popup.tsx"),PopupLayout=__webpack_require__("./src/Popup/PopupLayout.tsx"),SpeedSearchMenu=__webpack_require__("./src/Menu/SpeedSearchMenu.tsx"),InputField=__webpack_require__("./src/InputField/InputField.tsx"),WindowLayout=__webpack_require__("./src/ModalWindow/WindowLayout.tsx");function validateBranchName(branches,newBranchName){return branches.remoteBranches.some((remoteBranch=>`${remoteBranch.remote}/${remoteBranch.name}`===newBranchName))?"CLASHING_WITH_REMOTE":branches.localBranches.some((({name})=>name===newBranchName))?"EXISTING":null}const ILLEGAL_CHARS_PATTERN=new RegExp(`(^\\.)|(^-)|(^/)|(\\.\\.)+|[ ~:^?*\\[\\\\]+|(@\\{)+|[${Array(32).fill(null).map(((_,index)=>String.fromCharCode(index))).join("")}u007F]`);function cleanUpBranchName(branchName){return branchName.replace(ILLEGAL_CHARS_PATTERN,"_")}try{cleanUpBranchName.displayName="cleanUpBranchName",cleanUpBranchName.__docgenInfo={description:"",displayName:"cleanUpBranchName",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/Branches/branch-name-utils.tsx#cleanUpBranchName"]={docgenInfo:cleanUpBranchName.__docgenInfo,name:"cleanUpBranchName",path:"../example-app/src/VersionControl/Branches/branch-name-utils.tsx#cleanUpBranchName"})}catch(__react_docgen_typescript_loader_error){}const RenameBranchWindow_StyledContainer=styled.zo.div`
  padding: 0.5rem 1rem;
`,StyledInputField=(0,styled.zo)(InputField.U)`
  width: 100%;
`,ErrorMessages={EXISTING:branchName=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Branch name ",branchName," already exists ",(0,jsx_runtime.jsx)("br",{})]}),CLASHING_WITH_REMOTE:branchName=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Branch name ",branchName," clashes with remote branch ",(0,jsx_runtime.jsx)("br",{}),"with the same name"]})};function RenameBranchWindow({branchName,repoRoot,close}){const[newBranchName,setNewBranchName]=(0,react.useState)(branchName),[touched,setTouched]=(0,react.useState)(!1),balloonManager=(0,BalloonManager.L)(),branches=(0,es.sJ)(repoBranchesState(repoRoot)),renameBranch=function useRenameBranch(){const toggleFavoriteBranch=useToggleFavoriteBranch();return(0,es._8)((({refresh,snapshot})=>async(repoRoot,branchName,newBranchName)=>{await(0,isomorphic_git.R_)({fs,dir:repoRoot,oldref:branchName,ref:newBranchName}),refresh(repoBranchesState(repoRoot));const favoriteBranch={branchType:"LOCAL",branchName,repoRoot};isFavorite(snapshot.getLoadable(favoriteBranchesState).getValue(),snapshot.getLoadable(excludedFromFavoriteBranchesState).getValue(),favoriteBranch)&&(toggleFavoriteBranch(favoriteBranch,!1),toggleFavoriteBranch({...favoriteBranch,branchName:newBranchName},!0))}),[])}(),error=validateBranchName(branches,newBranchName),validationState=error&&touched?"invalid":"valid";return(0,jsx_runtime.jsx)(ModalWindow.Du,{minWidth:"content",minHeight:"content",children:(0,jsx_runtime.jsx)(WindowLayout.b,{header:`Rename branch ${branchName}`,content:(0,jsx_runtime.jsx)(RenameBranchWindow_StyledContainer,{children:(0,jsx_runtime.jsx)("form",{id:"branch_rename_form",onSubmit:event=>{event.preventDefault(),error?setTouched(!0):renameBranch(branches.repoRoot,branchName,newBranchName).catch((e=>{balloonManager.show({icon:"Error",title:"Unexpected error",body:`Could not rename branch ${branchName} to ${newBranchName}.`}),console.error("Branch rename error: ",e)})).then((()=>{close()}))},children:(0,jsx_runtime.jsx)(StyledInputField,{labelPlacement:"above",label:"New branch name:",value:newBranchName,onChange:newValue=>{setNewBranchName(cleanUpBranchName(newValue)),setTouched(!0)},validationState,errorMessage:error&&"invalid"===validationState?ErrorMessages[error]?.(branchName):void 0})})}),footer:(0,jsx_runtime.jsx)(WindowLayout.b.Footer,{right:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Button.z,{onPress:close,children:"Cancel"}),(0,jsx_runtime.jsx)(Button.z,{variant:"default",type:"submit",form:"branch_rename_form",isDisabled:Boolean(error)&&touched,children:"Rename"})]})})})})}RenameBranchWindow.displayName="RenameBranchWindow";try{RenameBranchWindow.displayName="RenameBranchWindow",RenameBranchWindow.__docgenInfo={description:"",displayName:"RenameBranchWindow",props:{branchName:{defaultValue:null,description:"",name:"branchName",required:!0,type:{name:"string"}},repoRoot:{defaultValue:null,description:"",name:"repoRoot",required:!0,type:{name:"string"}},close:{defaultValue:null,description:"",name:"close",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/Branches/RenameBranchWindow.tsx#RenameBranchWindow"]={docgenInfo:RenameBranchWindow.__docgenInfo,name:"RenameBranchWindow",path:"../example-app/src/VersionControl/Branches/RenameBranchWindow.tsx#RenameBranchWindow"})}catch(__react_docgen_typescript_loader_error){}var AutoHoverPlatformIcon=__webpack_require__("./src/Icon/AutoHoverPlatformIcon.tsx");const StyledMenuIconButton=styled.zo.span.attrs({role:"button"})`
  display: inline-flex;
`;function BranchFavoriteButton({onClick,isFavorite,isCurrent}){return(0,jsx_runtime.jsx)(StyledMenuIconButton,{onPointerUp:e=>{e.stopPropagation()},onClick,children:isCurrent?(0,jsx_runtime.jsx)(AutoHoverPlatformIcon.v,{icon:isFavorite?"/platform/dvcs-impl/resources/icons/currentBranchFavoriteLabel.svg":"/platform/dvcs-impl/resources/icons/currentBranchLabel.svg",hoverIcon:isFavorite?"nodes/favorite.svg":"nodes/notFavoriteOnHover.svg",hoverContainerSelector:"[role='menuitem']"}):isFavorite?(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"nodes/favorite.svg"}):(0,jsx_runtime.jsx)(AutoHoverPlatformIcon.v,{icon:"nodes/emptyNode.svg",hoverIcon:"nodes/notFavoriteOnHover.svg",hoverContainerSelector:"[role='menuitem']"})})}BranchFavoriteButton.displayName="BranchFavoriteButton";try{BranchFavoriteButton.displayName="BranchFavoriteButton",BranchFavoriteButton.__docgenInfo={description:"",displayName:"BranchFavoriteButton",props:{isCurrent:{defaultValue:null,description:"",name:"isCurrent",required:!1,type:{name:"boolean"}},isFavorite:{defaultValue:null,description:"",name:"isFavorite",required:!0,type:{name:"boolean"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/Branches/BranchFavoriteButton.tsx#BranchFavoriteButton"]={docgenInfo:BranchFavoriteButton.__docgenInfo,name:"BranchFavoriteButton",path:"../example-app/src/VersionControl/Branches/BranchFavoriteButton.tsx#BranchFavoriteButton"})}catch(__react_docgen_typescript_loader_error){}const StyledHeader=styled.zo.div`
  box-sizing: border-box;
  padding: 0 0.375rem;
  display: flex;
  align-items: center;
  width: 100%;
`,StyledTitle=styled.zo.div`
  flex: 1;
  text-align: center;
  overflow: hidden;
  text-overflow: ellipsis;
  margin: 0 0.625rem;
`,branchesPopupSizeState=(0,es.cn)({key:"branchesPopup.bounds",default:void 0});function BranchesPopup({onClose}){const repoBranches=useLatestRecoilValue(allBranchesState),[branchesPopupPersistedSize,setBranchesPopupPersistedSize]=(0,es.FV)(branchesPopupSizeState),[branchesPopupBounds,setBranchesPopupBounds]=(0,react.useState)(branchesPopupPersistedSize??{}),newBranchAction=(0,ActionsProvider.BH)(VcsActionIds.GIT_CREATE_NEW_BRANCH),deleteBranch=function useDeleteBranch(){return(0,es._8)((({refresh})=>(repoRoot,branchName)=>(0,isomorphic_git.NA)({fs,dir:repoRoot,ref:branchName}).then((()=>{refresh(repoBranchesState(repoRoot))}))),[])}(),balloonManager=(0,BalloonManager.L)(),windowManager=useWindowManager(),checkoutBranch=function useCheckoutBranch(){return(0,es._8)((callbackInterface=>async(repoRoot,branchName,remote)=>{const{refresh,snapshot,set}=callbackInterface,reloadFileFromDisk=reloadFileFromDiskCallback(callbackInterface);await(0,isomorphic_git.JE)({fs,dir:repoRoot,remote,ref:branchName}),refresh(repoBranchesState(repoRoot)),refresh(dirContentState(repoRoot));const openedFiles=snapshot.getLoadable(editorTabsState).getValue(),existingOpenedFile=await asyncFilter((({filePath})=>reloadFileFromDisk(filePath)),openedFiles);set(editorTabsState,existingOpenedFile)}),[])}(),{isFavorite,toggleFavorite}=useFavoriteBranches();if(!repoBranches)return null;const title=1===repoBranches.length?`Git Branches in ${path_browserify_default().basename(repoBranches[0].repoRoot)}`:"Git Branches";return(0,jsx_runtime.jsx)(Popup.GI,{interactions:"all",minHeight:55,minWidth:300,bounds:branchesPopupBounds,onBoundsChange:(bounds,interactionType)=>{"resize"===interactionType&&setBranchesPopupPersistedSize({width:bounds.width,height:bounds.height}),setBranchesPopupBounds(bounds)},children:(0,jsx_runtime.jsx)(PopupLayout.F,{header:(0,jsx_runtime.jsx)(Popup.GI.Header,{hasControls:!0,children:(0,jsx_runtime.jsxs)(StyledHeader,{children:[(0,jsx_runtime.jsx)(StyledTitle,{children:title}),(0,jsx_runtime.jsxs)(Toolbar.o,{children:[(0,jsx_runtime.jsx)(TooltipTrigger.a,{tooltip:(0,jsx_runtime.jsx)(ActionTooltip.M,{actionName:"Fetch"}),children:(0,jsx_runtime.jsx)(IconButton.hU,{onPress:()=>{notImplemented(),onClose()},children:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"vcs/fetch.svg"})})}),(0,jsx_runtime.jsx)(TooltipTrigger.a,{tooltip:(0,jsx_runtime.jsx)(ActionTooltip.M,{actionName:"Restore Popup Size"}),children:(0,jsx_runtime.jsx)(IconButton.hU,{isDisabled:void 0===branchesPopupPersistedSize,onPress:()=>{setBranchesPopupPersistedSize(void 0),setBranchesPopupBounds((({width,height,...currentBounds})=>({...currentBounds})))},children:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"general/fitContent.svg"})})})]})]})}),content:(0,jsx_runtime.jsxs)(SpeedSearchMenu.w,{"aria-label":title,submenuBehavior:"toggleOnPress",fillAvailableSpace:!0,autoFocus:"first",disabledKeys:repoBranches.flatMap((({localBranches,repoRoot})=>localBranches.filter((({trackingBranch})=>!trackingBranch)).map((({name})=>`${repoRoot}/pull-${name}`)))),onAction:key=>{const[repoRoot,branch,operation]=`${key}`.split("//");async function tryCheckout(checkout){try{await checkout()}catch(e){e instanceof isomorphic_git.D1.CheckoutConflictError?balloonManager.show({icon:"Error",title:"Git Checkout Problem",body:e.message}):balloonManager.show({icon:"Error",title:"Checkout failed",body:`Could not checkout branch ${branch}`})}}if(key===newBranchAction?.id)return newBranchAction?.perform();switch(operation){case"delete":return deleteBranch(repoRoot,branch).then((()=>{balloonManager.show({title:`Deleted branch: ${branch}`,icon:"Info",actions:(0,jsx_runtime.jsx)(Balloon.g,{onPress:notImplemented,children:"Restore"})})}),(()=>{balloonManager.show({title:`Could not deleted branch: ${branch}`,icon:"Error"})}));case"rename":return windowManager.open((({close})=>(0,jsx_runtime.jsx)(RenameBranchWindow,{repoRoot,branchName:branch,close})));case"checkout":return function checkoutLocalBranch(){return tryCheckout((()=>checkoutBranch(repoRoot,branch)))}();case"remote-checkout":return function checkoutRemoteBranch(){const remoteBranch=repoBranches?.find((({repoRoot:aRepoRoot})=>aRepoRoot===repoRoot))?.remoteBranches.find((({name,remote})=>`${remote}/${name}`===branch));if(remoteBranch)return tryCheckout((()=>checkoutBranch(repoRoot,remoteBranch.name,remoteBranch.remote)))}();default:return notImplemented()}},onClose,children:[newBranchAction&&(0,jsx_runtime.jsx)(Item.c,{textValue:newBranchAction.title,children:(0,jsx_runtime.jsx)(MenuItemLayout._,{icon:newBranchAction.icon,content:newBranchAction.title})},newBranchAction.id),(0,jsx_runtime.jsx)(Item.c,{children:"Checkout Tag or Revision..."},"checkout_revision"),repoBranches.flatMap((({remoteBranches,localBranches,repoRoot,currentBranch})=>{const getSectionLabel=(label,repoRoot)=>repoBranches.length>1?`${label} in ${path_browserify_default().basename(repoRoot)}`:label,compareActions=(branchName,isCurrent)=>[!isCurrent&&(0,jsx_runtime.jsx)(Item.c,{children:`Compare with '${branchName}'`},`${repoRoot}//${branchName}//compare-with-branch`),(0,jsx_runtime.jsx)(Item.c,{children:"Show Diff with Working Tree"},`${repoRoot}//${branchName}//show-diff-with-working-tree`),(0,jsx_runtime.jsx)(Divider.i,{},"compare-actions-divider")],mergeActions=(branchName,currentBranch)=>currentBranch&&branchName!==currentBranch&&[(0,jsx_runtime.jsx)(Item.c,{children:`Rebase '${currentBranch}' onto '${branchName}'`},`${repoRoot}//${branchName}//rebase-current-onto`),(0,jsx_runtime.jsx)(Item.c,{children:`Merge '${branchName}' onto '${currentBranch}'`},`${repoRoot}//${branchName}//merge-into-current`),(0,jsx_runtime.jsx)(Divider.i,{},"merge-actions-divider")];return[(0,jsx_runtime.jsx)(collections_dist_module.$0,{title:getSectionLabel("Local Branches",repoRoot),children:localBranches.map((({name,trackingBranch})=>{const isCurrent=name===currentBranch?.name,favoriteBranchArgs={branchName:name,branchType:"LOCAL",repoRoot};return(0,jsx_runtime.jsxs)(Item.c,{textValue:name,title:(0,jsx_runtime.jsx)(MenuItemLayout._,{content:name,icon:(0,jsx_runtime.jsx)(BranchFavoriteButton,{isFavorite:isFavorite(favoriteBranchArgs),isCurrent,onClick:()=>{toggleFavorite(favoriteBranchArgs)}}),shortcut:trackingBranch&&(0,jsx_runtime.jsx)(ItemLayout.e.Hint,{small:!0,children:trackingBranch})}),children:[!isCurrent&&(0,jsx_runtime.jsx)(Item.c,{children:"Checkout"},`${repoRoot}//${name}//checkout`),(0,jsx_runtime.jsx)(Item.c,{children:`New Branch from '${name}'...`},`${repoRoot}//${name}//new-branch-from`),!isCurrent&&(0,jsx_runtime.jsx)(Item.c,{children:`Checkout and rebase onto '${name}'`},`${repoRoot}//${name}//checkout-and-rebase-onto`),(0,jsx_runtime.jsx)(Divider.i,{},"new-branch-actions-divider"),compareActions(name,isCurrent),mergeActions(name,currentBranch?.name),(0,jsx_runtime.jsx)(Item.c,{children:"Update"},`${repoRoot}//${name}//pull`),(0,jsx_runtime.jsx)(Item.c,{children:"Push..."},`${repoRoot}//${name}//push`),(0,jsx_runtime.jsx)(Divider.i,{},"push-divider"),(0,jsx_runtime.jsx)(Item.c,{children:"Rename..."},`${repoRoot}//${name}//rename`),!isCurrent&&(0,jsx_runtime.jsx)(Item.c,{children:"Delete"},`${repoRoot}//${name}//delete`)]},`${repoRoot}//${name}`)}))},`${repoRoot}//local_branches`),(0,jsx_runtime.jsx)(collections_dist_module.$0,{title:getSectionLabel("Remote Branches",repoRoot),children:remoteBranches.map((branch=>{const branchName=`${branch.remote}/${branch.name}`,favoriteBranchArgs={branchName,branchType:"REMOTE",repoRoot};return(0,jsx_runtime.jsxs)(Item.c,{textValue:branchName,title:(0,jsx_runtime.jsx)(MenuItemLayout._,{content:branchName,icon:(0,jsx_runtime.jsx)(BranchFavoriteButton,{isFavorite:isFavorite(favoriteBranchArgs),onClick:()=>{toggleFavorite(favoriteBranchArgs)}})}),children:[(0,jsx_runtime.jsx)(Item.c,{children:"Checkout"},`${repoRoot}//${branchName}//remote-checkout`),(0,jsx_runtime.jsx)(Item.c,{children:`New Branch from '${branchName}'...`},`${repoRoot}//${branchName}//new-branch-from`),(0,jsx_runtime.jsx)(Item.c,{children:`Checkout and rebase onto '${branchName}'`},`${repoRoot}//${branchName}//checkout-and-rebase-onto`),(0,jsx_runtime.jsx)(Divider.i,{},"new-branch-actions-divider"),compareActions(branchName,!1),mergeActions(branchName,currentBranch?.name),(0,jsx_runtime.jsx)(Item.c,{children:`Pull into '${branchName}' Using Merge`},`${repoRoot}//${branchName}//pull-into-using-merge`),(0,jsx_runtime.jsx)(Item.c,{children:`Pull into '${branchName}' Using Rebase`},`${repoRoot}//${branchName}//pull-into-using-rebase`),(0,jsx_runtime.jsx)(Divider.i,{}),(0,jsx_runtime.jsx)(Item.c,{children:"Delete"},`${repoRoot}//${branchName}//delete`)]},`${repoRoot}//${branchName}`)}))},`${repoRoot}//remote_branches`)]}))]})})})}BranchesPopup.displayName="BranchesPopup";try{BranchesPopup.displayName="BranchesPopup",BranchesPopup.__docgenInfo={description:"",displayName:"BranchesPopup",props:{onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/Branches/BranchesPopup.tsx#BranchesPopup"]={docgenInfo:BranchesPopup.__docgenInfo,name:"BranchesPopup",path:"../example-app/src/VersionControl/Branches/BranchesPopup.tsx#BranchesPopup"})}catch(__react_docgen_typescript_loader_error){}const activeFileRepoRootState=(0,es.nZ)({key:"vcs/activeFileRepo",get:({get})=>{const activeFile=get(activeEditorTabState)?.filePath;return(activeFile&&get(vcsRootForFile(activeFile)))??get(vcsRootsState)[0]?.dir}}),activeFileRepoBranchesState=(0,es.nZ)({key:"vcs/activeFileRepoBranches",get:({get})=>{const activeFileRepoRoot=get(activeFileRepoRootState);return get(repoBranchesState(activeFileRepoRoot))}}),activeFileCurrentBranchState=(0,es.nZ)({key:"vcs/activeFileCurrentBranch",get:({get})=>{const activeFile=get(activeEditorTabState)?.filePath;return activeFile?branchForPathState(activeFile):null}}),activeFileRepoHeadState=(0,es.nZ)({key:"vcs/activeFileRepoHead",get:async({get})=>{const branch=get(activeFileCurrentBranchState);if(branch)return{detached:!1,head:branch};const repoRoot=get(activeFileRepoRootState);return{detached:!0,head:await(0,isomorphic_git.qq)({fs,dir:repoRoot,ref:"HEAD"})}}}),StyledLastMessage=styled_components_browser_esm.ZP.div.withConfig({displayName:"IdeStatusBar__StyledLastMessage",componentId:"sc-1hz1fp-0"})(["margin-left:0.75rem;cursor:pointer;"]);function StatusBarProgress(props){return(0,jsx_runtime.jsx)(ProgressBar.ko,{dense:!0,namePosition:"side",width:146,...props})}StatusBarProgress.displayName="StatusBarProgress";const StatusBarProcess=()=>{const process=(0,es.sJ)(switchToPersistentFsProcess),isCommitInProgress=(0,es.sJ)(isCommitInProgressState);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[process&&(0,jsx_runtime.jsx)(StatusBarProgress,{name:process.name,isIndeterminate:process.isIndeterminate,value:process.progress,button:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[process.onPause&&(0,jsx_runtime.jsx)(ProgressBarPauseButton.P,{small:!0,paused:!1,onPausedChange:()=>{}}),process.onCancel&&(0,jsx_runtime.jsx)(ProgressBarStopButton.b,{small:!0,onPress:process.onCancel})]})}),isCommitInProgress&&(0,jsx_runtime.jsx)(StatusBarProgress,{name:"Committing...",isIndeterminate:!0})]})},IdeStatusBar=()=>{const cursorPosition=(0,es.sJ)(editorCursorPositionState);return(0,jsx_runtime.jsx)(StatusBar.A,{left:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"general/tbHidden.svg",role:"button",onClick:notImplemented}),(0,jsx_runtime.jsx)(StyledLastMessage,{children:"Tooltip content or last message will show up here."})]}),right:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(StatusBarProcess,{}),(0,jsx_runtime.jsx)(StatusBarWidget.V,{onPress:notImplemented,label:"LF"}),(0,jsx_runtime.jsx)(StatusBarWidget.V,{onPress:notImplemented,label:`${cursorPosition.lineNumber},${cursorPosition.column}`}),(0,jsx_runtime.jsx)(StatusBarWidget.V,{label:"UTF-8"}),(0,jsx_runtime.jsx)(MenuTrigger.b,{renderMenu:({menuProps})=>(0,jsx_runtime.jsxs)(Menu.v2,{...menuProps,onAction:notImplemented,children:[(0,jsx_runtime.jsx)(Item.c,{children:"Configure Indents for Typescript"}),(0,jsx_runtime.jsx)(Item.c,{children:"Disable Indents Detection for Project"})]}),children:(props,ref)=>(0,jsx_runtime.jsx)(StatusBarWidget.V,{...props,ref,label:"2 spaces"})}),(0,jsx_runtime.jsx)(MenuTrigger.b,{renderMenu:({menuProps})=>(0,jsx_runtime.jsxs)(Menu.v2,{...menuProps,onAction:notImplemented,children:[(0,jsx_runtime.jsxs)(Item.c,{title:"Compile",children:[(0,jsx_runtime.jsx)(Item.c,{children:"packages/jui/tsconfig.json"}),(0,jsx_runtime.jsx)(Item.c,{children:"packages/jui/src/StatusBar/StatusBar.stories.tsx"}),(0,jsx_runtime.jsx)(Item.c,{children:"Compile All"})]}),(0,jsx_runtime.jsx)(Divider.i,{}),(0,jsx_runtime.jsx)(Item.c,{children:(0,jsx_runtime.jsx)(MenuItemLayout._,{icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"javaee/updateRunningApplication.svg"}),content:"Restart Typescript Service"})}),(0,jsx_runtime.jsx)(Item.c,{children:(0,jsx_runtime.jsx)(MenuItemLayout._,{icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"general/settings.svg"}),content:"Configure Typescript..."})})]}),children:(props,ref)=>(0,jsx_runtime.jsx)(StatusBarWidget.V,{...props,ref,label:"TypeScript 4.4.3"})}),(0,jsx_runtime.jsx)(PopupTrigger.q,{placement:"top",popup:({close})=>(0,jsx_runtime.jsx)(BranchesPopup,{onClose:close}),children:(0,jsx_runtime.jsx)(BranchPopupTrigger,{})}),(0,jsx_runtime.jsx)(StatusBarWidget.V,{icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"ide/readwrite.svg"})}),(0,jsx_runtime.jsx)(StatusBarWidget.V,{icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"ide/fatalError.svg"})})]})})};function BranchPopupTrigger(){const gitRepoHead=useLatestRecoilValue(activeFileRepoHeadState);return gitRepoHead&&(0,jsx_runtime.jsx)(TooltipTrigger.a,{tooltip:(0,jsx_runtime.jsx)(ActionTooltip.M,{actionName:gitRepoHead.detached?"Git: Detached HEAD doesn't point to any branch":`Git Branch: ${gitRepoHead.head}`}),children:(0,jsx_runtime.jsx)(StatusBarWidget.V,{icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:gitRepoHead.detached?"general/warning.svg":"vcs/branch.svg"}),label:gitRepoHead.head.slice(0,gitRepoHead.detached?8:void 0)})})}IdeStatusBar.displayName="IdeStatusBar";const useNestedSelectionState=(tree,{selectedKeys:selectedKeysProp,defaultSelectedKeys,onSelectedKeysChange})=>{const[selectedKeys,selectedKeysSetter]=((valueProp,defaultValue=new Set,onChange)=>{const[value,setValue]=(0,utils_dist_module.zk)(valueProp,defaultValue,onChange);return[value,useStateSetterForSet(setValue)]})(selectedKeysProp,defaultSelectedKeys||new Set,onSelectedKeysChange),treeRef=(0,useLatest.d)(tree);return(0,react.useMemo)((()=>new NestedSelection({items:selectedKeys,...selectedKeysSetter},treeRef.current)),[selectedKeys,tree.rootNodes])},RollbackTreeContextMenu=()=>(0,jsx_runtime.jsx)(Menu.v2,{disabledKeys:["showDiff"],"aria-label":"Context menu",onAction:notImplemented,children:(0,jsx_runtime.jsx)(Item.c,{textValue:"Show Diff",children:(0,jsx_runtime.jsx)(MenuItemLayout._,{icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"actions/diff.svg"}),content:"Show Diff"})},"showDiff")});RollbackTreeContextMenu.displayName="RollbackTreeContextMenu";const RollbackWindow_StyledContainer=styled.zo.div`
  box-sizing: border-box;
  height: 100%;
  display: flex;
  flex-direction: column;
  padding: 1rem 0.75rem 0;
`,StyledFrame=styled.zo.div`
  border: 1px solid ${({theme})=>theme.commonColors.contrastBorder};
  flex: 1;
  overflow: auto;
`,StyledLine=styled.zo.div`
  line-height: 2;
  padding-left: 0.5rem;
`;function RollbackWindow(){const defaultExpandedKeys=(0,es.sJ)(rollbackViewState.initiallyExpandedKeys),initiallyIncludedChangeKeys=(0,es.sJ)(rollbackViewState.initiallyIncludedChanges).map(getNodeKeyForChange),{fileCountsMap}=(0,es.sJ)(changesTreeNodesState),[windowBounds,setWindowBounds]=(0,es.FV)(rollbackViewState.windowBounds),rootNodes=(0,es.sJ)(rollbackViewState.rootNodes),[selectedKeys,setSelectedKeys]=(0,react.useState)(new Set(initiallyIncludedChangeKeys.slice(0,1))),[expandedKeys,setExpandedKeys]=(0,react.useState)(defaultExpandedKeys),[includedChangeKeys,setIncludedChangeKeys]=(0,react.useState)(new Set(initiallyIncludedChangeKeys)),nestedSelection=useNestedSelectionState({rootNodes,getKey:node=>node.key,getChildren:node=>isGroupNode(node)?node.children:null},{selectedKeys:includedChangeKeys,onSelectedKeysChange:setIncludedChangeKeys}),includedChanges=(0,es.sJ)(allChangesState).filter((change=>includedChangeKeys.has(getNodeKeyForChange(change)))),rollbackChanges=(()=>{const updateFileStatus=useUpdateFileStatus();return(0,es._8)((callbackInterface=>async changes=>{const{snapshot,set}=callbackInterface,reloadFileFromDisk=reloadFileFromDiskCallback(callbackInterface),changesWithRepoRoots=await Promise.all(changes.filter((change=>!change.after.isDir)).map((async change=>{const repoRoot=await snapshot.getPromise(vcsRootForFile(change.after.path));return{repoRoot,fullPath:change.after.path,relativePath:path_browserify_default().relative(repoRoot,change.after.path)}}))),groupedChanges=(0,groupBy.Z)((({repoRoot})=>repoRoot),changesWithRepoRoots);await Promise.all(Object.entries(groupedChanges).map((async([repoRoot,items])=>{await(0,isomorphic_git.JE)({fs,dir:repoRoot,force:!0,filepaths:items.map((({relativePath})=>relativePath))}),await Promise.all(items.map((async({fullPath,relativePath})=>(await(0,isomorphic_git.us)({fs,dir:repoRoot,filepath:relativePath}),await reloadFileFromDisk(fullPath),updateFileStatus(fullPath)))))}))),set(changeListsState,(changeLists=>changeLists.map((changeList=>({...changeList,changes:changeList.changes.filter((change=>!changes.includes(change)))})))))}),[])})(),balloons=(0,BalloonManager.L)(),setOpen=(0,es.Zl)(rollbackViewState.isOpen),close=()=>setOpen(!1),treeRef=(0,react.useRef)(null),treeActions=(0,useTreeActions.x)({treeRef});return(0,jsx_runtime.jsx)(ModalWindow.Du,{onClose:close,bounds:windowBounds,onBoundsChange:setWindowBounds,minHeight:200,minWidth:275,children:(0,jsx_runtime.jsx)(WindowLayout.b,{header:"Rollback changes",content:(0,jsx_runtime.jsx)(ActionsProvider.DG,{actions:treeActions,children:({shortcutHandlerProps})=>(0,jsx_runtime.jsxs)(RollbackWindow_StyledContainer,{...shortcutHandlerProps,children:[(0,jsx_runtime.jsxs)("div",{style:{display:"flex"},children:[(0,jsx_runtime.jsxs)(Toolbar.o,{children:[(0,jsx_runtime.jsx)(IconButton.hU,{isDisabled:!0,children:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"actions/diff"})}),(0,jsx_runtime.jsx)(IconButtonWithMenu,{renderMenu:({menuProps})=>(0,jsx_runtime.jsx)(Menu.v2,{...menuProps,selectedKeys:[],onAction:notImplemented,children:(0,jsx_runtime.jsx)(collections_dist_module.$0,{title:"Group By",children:groupings.map((grouping=>(0,jsx_runtime.jsx)(Item.c,{children:grouping.title},grouping.id)))})}),children:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"actions/groupBy.svg"})})]}),(0,jsx_runtime.jsx)("span",{style:{flex:1}}),(0,jsx_runtime.jsxs)(Toolbar.o,{children:[(0,jsx_runtime.jsx)(ActionButton.K,{actionId:CommonActionIds.$.EXPAND_ALL}),(0,jsx_runtime.jsx)(ActionButton.K,{actionId:CommonActionIds.$.COLLAPSE_ALL})]})]}),(0,jsx_runtime.jsx)(StyledFrame,{children:(0,jsx_runtime.jsx)(ContextMenuContainer.X,{renderMenu:()=>(0,jsx_runtime.jsx)(RollbackTreeContextMenu,{}),style:{height:"100%"},children:(0,jsx_runtime.jsx)(SpeedSearchTreeWithCheckboxes,{ref:treeRef,items:rootNodes,selectionMode:"multiple",selectedKeys,onSelectionChange:setSelectedKeys,expandedKeys,onExpandedChange:setExpandedKeys,nestedSelection,fillAvailableSpace:!0,children:node=>{const props=getChangeListTreeItemProps({node,fileCountsMap});return(0,jsx_runtime.jsxs)(Item.c,{...props,children:[0!==node.children?.length&&(0,jsx_runtime.jsx)(TreeNodeCheckbox,{selectionState:nestedSelection.getSelectionState(node),onToggle:()=>nestedSelection.toggle(node)}),props.children]})}})})})]})}),footer:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{style:{padding:"0 .75rem",display:"flex",flexDirection:"column"},children:[(0,jsx_runtime.jsx)(StyledLine,{children:(0,jsx_runtime.jsx)(ChangesSummary,{changes:includedChanges})}),(0,jsx_runtime.jsx)(Checkbox.X,{isDisabled:!0,children:"Delete local copies of the added files"})]}),(0,jsx_runtime.jsx)(WindowLayout.b.Footer,{right:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Button.z,{onPress:close,children:"Cancel"}),(0,jsx_runtime.jsx)(Button.z,{variant:"default",onPress:()=>{rollbackChanges(includedChanges).catch((e=>{balloons.show({title:"Reverting changes failed",icon:"Error",body:"Could not revert selected changes. See console for more info"}),console.error("Git revert error:",e)})).finally(close)},children:"Rollback"})]})})]})})})}RollbackWindow.displayName="RollbackWindow";const toolWindowsState=(0,es.cn)({key:"toolWindows",default:new ToolWindowsState.iC(Object.fromEntries(toolWindows.map((({id,initialState})=>[id,initialState]))))});var ActionShortcut=__webpack_require__("./src/ActionSystem/ActionShortcut.tsx"),useCollectionSearchInput=__webpack_require__("./src/Collections/useCollectionSearchInput.ts"),Tabs=__webpack_require__("./src/Tabs/Tabs.tsx"),Tooltip=__webpack_require__("./src/Tooltip/Tooltip.tsx"),focus_dist_module=__webpack_require__("../../node_modules/@react-aria/focus/dist/module.js"),List=__webpack_require__("./src/List/List.tsx"),shortcutToString=__webpack_require__("./src/ActionSystem/shortcutToString.ts");const tips=[{actionId:CommonActionIds.$.EXPAND_SELECTION,title:"Press $shortcut to expand selection"},{actionId:CommonActionIds.$.SHRINK_SELECTION,title:"Press $shortcut to shrink selection"}],useTips=()=>{const keymap=(0,KeymapProvider.og)(),renderedTips=(0,react.useMemo)((()=>tips.map((({actionId,title})=>({keyboardShortcut:keymap?.[actionId]?.find((shortcut=>"keyboard"===shortcut.type)),title}))).filter((({keyboardShortcut})=>keyboardShortcut)).map((({keyboardShortcut,title})=>title.replace("$shortcut",(0,shortcutToString.W)(keyboardShortcut))))),[keymap]),[index,setIndex]=(0,react.useState)(Math.floor(Math.random()*renderedTips.length));return{current:renderedTips[index],next:()=>{const tmpIndex=Math.floor(Math.random()*(renderedTips.length-1)),newIndex=tmpIndex<index?tmpIndex:tmpIndex+1;console.log("changing index to",newIndex,"tmpIndex",tmpIndex),setIndex(newIndex)}}},Input=react.forwardRef((function Input(props,forwardedRef){const ref=(0,dist_module.B3)(forwardedRef),{focusableProps}=(0,focus_dist_module.kc)({autoFocus:props.autoFocus},ref);return(0,jsx_runtime.jsx)("input",{...(0,dist_module.dG)(focusableProps,props),ref})}));try{Input.displayName="Input",Input.__docgenInfo={description:"",displayName:"Input",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/SearchEverywhere/Input.tsx#Input"]={docgenInfo:Input.__docgenInfo,name:"Input",path:"../example-app/src/SearchEverywhere/Input.tsx#Input"})}catch(__react_docgen_typescript_loader_error){}const searchEverywhereState={isOpen:(0,es.cn)({key:"search.everywhere.isOpen",default:!1}),tab:(0,es.cn)({key:"search.everywhere.tab",default:"All"}),contextElement:(0,es.cn)({key:"search.everywhere.contextElement",default:void 0}),initialSearchQuery:(0,es.xu)({key:"search.everywhere.initialQuery",default:""}),bounds:(0,es.cn)({key:"search.everywhere.bounds",default:null})};function ContentAwarePopup({hasContent,persistedBoundsState,noContentHeight,minHeight,...otherProps}){const persistBounds=(0,es.Zl)(persistedBoundsState),getInitBounds=useRecoilInitialValue(persistedBoundsState,{top:150,height:Math.max(200,window.innerHeight-300)}),[bounds,setBounds]=(0,react.useState)(getInitBounds),heightToRestoreRef=(0,react.useRef)(bounds.height);return(0,react.useEffect)((()=>{setBounds((bounds=>({...bounds,height:hasContent?heightToRestoreRef.current:noContentHeight})))}),[hasContent]),(0,jsx_runtime.jsx)(Popup.GI,{...otherProps,bounds,onBoundsChange:bounds=>{hasContent&&(heightToRestoreRef.current=bounds.height,persistBounds(bounds)),setBounds(bounds)},minHeight:hasContent?minHeight:noContentHeight})}ContentAwarePopup.displayName="ContentAwarePopup";try{ContentAwarePopup.displayName="ContentAwarePopup",ContentAwarePopup.__docgenInfo={description:"A special type of popup, where the content can be toggled on and off. Needed only for SearchEveryWhere at the moment,\nbut extracted as a component, to collocate related pieces, rather than leave them with the rest of the code in the\ncomponent.\n- Updates persisted {@param boundsState}, when the bounds are changed, only if the content is shown when the bounds\n  is changed.\n- Minimizes the popup into {@param noContentHeight}, when {@param hasContent} is `false`.\n- Restores the popup height to it's latest value, or based on content, when {@param hasContent} changes to `true`.\n- Returns the right to be applied based on the input {@param minHeight} and {@param hasContent}.",displayName:"ContentAwarePopup",props:{hasContent:{defaultValue:null,description:"Whether the popup has content. If `false`, the popup is minimized to `noContentHeight`.",name:"hasContent",required:!0,type:{name:"boolean"}},noContentHeight:{defaultValue:null,description:"The minimized height of the popup, when there is no content.",name:"noContentHeight",required:!0,type:{name:"number"}},persistedBoundsState:{defaultValue:null,description:"Persisted state of the popup bounds, in form of a recoil state.",name:"persistedBoundsState",required:!0,type:{name:"RecoilState<Partial<Bounds> | null>"}},minHeight:{defaultValue:null,description:"",name:"minHeight",required:!1,type:{name:'number | "content"'}},minWidth:{defaultValue:null,description:"",name:"minWidth",required:!1,type:{name:'number | "content"'}},positioning:{defaultValue:null,description:"Used to position the popup relative to a target element, if there is no positioning information in the input\n`bounds`/`defaultBounds`.",name:"positioning",required:!1,type:{name:'{ targetRef: RefObject<HTMLElement>; placement?: "top" | "bottom"; }'}},onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"(() => void)"}},nonDismissable:{defaultValue:null,description:"",name:"nonDismissable",required:!1,type:{name:"boolean"}},allowScroll:{defaultValue:null,description:"By default, Popup prevents scrolling on the scrollable ancestor, if popup is positioned relative to a target\nelement. Allowing or disallowing scroll can be forced by passing boolean value.",name:"allowScroll",required:!1,type:{name:'boolean | "auto"'}},onBoundsChanging:{defaultValue:null,description:"For performance reason, overlay bounds is kept in a local state during a resize or move interaction, and\n`onBoundsChange` is called once at the end of interaction. `onBoundsChanging` gives a chance of rectifying\nbounds changes during an interaction to for example apply custom size/placement constraints.",name:"onBoundsChanging",required:!1,type:{name:'((newBounds: Bounds, interactionType: "resize" | "move") => Bounds)'}},defaultBounds:{defaultValue:null,description:"Default bounds in uncontrolled mode. Can be a partially specified bounds.\n- If `top` not specified, the returned bounds will be centered vertically.\n- If `left` not specified, the returned bounds will be centered horizontally.\n- If `width` not specified, the width of the bounds will be based on content width.\n- If `height` not specified, the height of the bounds will be based on content height.\nNote that regardless of `defaultBounds`, `onBoundsChange` always receives a full `bounds` object which is solely\nbased on the bounds of the overlay, at the end of an interaction.",name:"defaultBounds",required:!1,type:{name:"Partial<Bounds>"}},interactions:{defaultValue:{value:'"all"'},description:'Allowed interactions:\n- "all": both resizable and movable\n- "move": movable, but not resizable\n- "none": fixed size and position\nThe reason there are no `resizable` and `movable` boolean props is that resizable=true,movable=false doesn\'t make\nsense from UX perspective.',name:"interactions",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"all"'},{value:'"move"'}]}},observeContentResize:{defaultValue:null,description:"When the size is not specified by `bounds` or `defaultBounds` props, the content size is measured and used in the\nreturned bounds. By default, the content size is measured initially. If `observeContentSize` is true, the DOM\nmutations will be observed and the content is re-measured as changes are observed.",name:"observeContentResize",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/SearchEverywhere/ContentAwarePopup.tsx#ContentAwarePopup"]={docgenInfo:ContentAwarePopup.__docgenInfo,name:"ContentAwarePopup",path:"../example-app/src/SearchEverywhere/ContentAwarePopup.tsx#ContentAwarePopup"})}catch(__react_docgen_typescript_loader_error){}var minusculeMatch=__webpack_require__("./src/minusculeMatch.ts"),TextWithHighlights=__webpack_require__("./src/TextWithHighlights/TextWithHighlights.tsx"),ActionGroup=__webpack_require__("./src/ActionSystem/ActionGroup.tsx");const StyledIconWrapper=styled.zo.span`
  width: 1.125rem;
  display: inline-flex;
  justify-content: center;
`,StyledItemLayout=(0,styled.zo)(ItemLayout.e)`
  min-height: 1.375rem;
  width: 100%;
  padding: 0;
`,StyledTitleWrapper=styled.zo.span`
  color: ${({theme,isDisabled})=>isDisabled&&theme.currentForegroundAware(theme.commonColors.inactiveTextColor)};
`;try{StyledIconWrapper.displayName="StyledIconWrapper",StyledIconWrapper.__docgenInfo={description:"",displayName:"StyledIconWrapper",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: HTMLSpanElement | null) => void) | RefObject<HTMLSpanElement> | null"}},theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"Theme<KnownThemePropertyPath>"}},as:{defaultValue:null,description:"",name:"as",required:!1,type:{name:"undefined"}},forwardedAs:{defaultValue:null,description:"",name:"forwardedAs",required:!1,type:{name:"undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/SearchEverywhere/contributors/ItemHelpers.tsx#StyledIconWrapper"]={docgenInfo:StyledIconWrapper.__docgenInfo,name:"StyledIconWrapper",path:"../example-app/src/SearchEverywhere/contributors/ItemHelpers.tsx#StyledIconWrapper"})}catch(__react_docgen_typescript_loader_error){}try{StyledItemLayout.displayName="StyledItemLayout",StyledItemLayout.__docgenInfo={description:"",displayName:"StyledItemLayout",props:{theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"Theme<KnownThemePropertyPath>"}},as:{defaultValue:null,description:"",name:"as",required:!1,type:{name:"undefined"}},forwardedAs:{defaultValue:null,description:"",name:"forwardedAs",required:!1,type:{name:"undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/SearchEverywhere/contributors/ItemHelpers.tsx#StyledItemLayout"]={docgenInfo:StyledItemLayout.__docgenInfo,name:"StyledItemLayout",path:"../example-app/src/SearchEverywhere/contributors/ItemHelpers.tsx#StyledItemLayout"})}catch(__react_docgen_typescript_loader_error){}try{StyledTitleWrapper.displayName="StyledTitleWrapper",StyledTitleWrapper.__docgenInfo={description:"",displayName:"StyledTitleWrapper",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: HTMLSpanElement | null) => void) | RefObject<HTMLSpanElement> | null"}},isDisabled:{defaultValue:null,description:"",name:"isDisabled",required:!1,type:{name:"boolean"}},theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"Theme<KnownThemePropertyPath>"}},as:{defaultValue:null,description:"",name:"as",required:!1,type:{name:"undefined"}},forwardedAs:{defaultValue:null,description:"",name:"forwardedAs",required:!1,type:{name:"undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/SearchEverywhere/contributors/ItemHelpers.tsx#StyledTitleWrapper"]={docgenInfo:StyledTitleWrapper.__docgenInfo,name:"StyledTitleWrapper",path:"../example-app/src/SearchEverywhere/contributors/ItemHelpers.tsx#StyledTitleWrapper"})}catch(__react_docgen_typescript_loader_error){}const StyledSpacer=styled.zo.div`
  flex: 1;
`;function ActionItem({action,highlights}){const{isSelected}=(0,react.useContext)(ItemStateContext.k)||{};return(0,jsx_runtime.jsxs)(StyledItemLayout,{children:[(0,jsx_runtime.jsx)(StyledIconWrapper,{children:action.icon}),(0,jsx_runtime.jsx)(StyledTitleWrapper,{isDisabled:action.isDisabled,children:isSelected?(0,jsx_runtime.jsx)(TextWithHighlights.x,{highlights,children:action.title}):action.title}),(0,jsx_runtime.jsx)(ItemLayout.e.Hint,{style:{fontSize:".85em",fontWeight:"bold"},children:action.shortcut}),(0,jsx_runtime.jsx)(StyledSpacer,{}),(0,jsx_runtime.jsx)(ItemLayout.e.Hint,{style:{marginRight:"-0.375rem"},children:getActionBreadcrumb(action,"title").join(" | ")})]})}function getActionBreadcrumb(action,field){let parent=(0,ActionGroup.nf)(action)?action.parent:null;const breadcrumb=[];for(;parent;)breadcrumb.unshift(field?parent[field]:parent),parent=parent.parent;return breadcrumb}ActionItem.displayName="ActionItem";try{ActionItem.displayName="ActionItem",ActionItem.__docgenInfo={description:"UI of actions in SearchEverywhere list",displayName:"ActionItem",props:{action:{defaultValue:null,description:"",name:"action",required:!0,type:{name:"Readonly<MutableAction>"}},highlights:{defaultValue:null,description:"",name:"highlights",required:!0,type:{name:"TextRange[] | null"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/SearchEverywhere/contributors/action/ActionItem.tsx#ActionItem"]={docgenInfo:ActionItem.__docgenInfo,name:"ActionItem",path:"../example-app/src/SearchEverywhere/contributors/action/ActionItem.tsx#ActionItem"})}catch(__react_docgen_typescript_loader_error){}const actionsSearchContributor={id:"Actions",title:"Actions",actionId:CommonActionIds.$.GO_TO_ACTION,use:({everyWhereAutoSet})=>{const contextElement=(0,es.sJ)(searchEverywhereState.contextElement),[showDisabledActions,setShowDisabledActions]=(0,react.useState)(null),allActions=(0,react.useMemo)((()=>contextElement?(0,ActionsProvider.C9)(contextElement):[]),[contextElement]),shouldIncludeDisabledActions=showDisabledActions??everyWhereAutoSet,actions=[{id:CommonActionIds.$.SHOW_INTENTION_ACTIONS,title:"Assign a shortcut",actionPerformed:notImplemented}];return{search:query=>{const allResults=allActions.map((action=>({highlights:(0,minusculeMatch.M)(action.title,query),action}))).filter((({action,highlights})=>highlights||(0,minusculeMatch.M)(action.description||"",query)));return shouldIncludeDisabledActions?allResults:allResults.filter((({action})=>!action.isDisabled))},searchDeps:[shouldIncludeDisabledActions],isEverywhere:shouldIncludeDisabledActions,toggleEverywhere:()=>{setShowDisabledActions((currentValue=>!currentValue))},searchAdvertiser:(0,jsx_runtime.jsx)(ActionShortcut.i,{actionId:CommonActionIds.$.SHOW_INTENTION_ACTIONS,children:shortcut=>`Press ${shortcut} to assign a shortcut`}),headerFilters:(0,jsx_runtime.jsx)(Checkbox.X,{preventFocus:!0,isSelected:shouldIncludeDisabledActions,onChange:value=>{setShowDisabledActions(value)},children:"Include disabled actions"}),actions,processSelectedItem({action}){action?.perform({event:null,element:contextElement})},getKey:({action})=>action.id,getItemText:({action:{title}})=>title,renderItem:({action,highlights})=>(0,jsx_runtime.jsx)(ActionItem,{action,highlights})}}};var splitWhen=__webpack_require__("../../node_modules/ramda/es/splitWhen.js");function FileItem({file,matches}){const{isSelected}=(0,react.useContext)(ItemStateContext.k)||{},title=path_browserify_default().basename(file.relativePath),dir=path_browserify_default().dirname(file.relativePath),[dirMatches,filenameMatches]=(0,splitWhen.Z)((match=>match.from>=dir.length),matches||[]),titleMatches=filenameMatches.map((({from,to})=>({from:from-dir.length,to:to-dir.length})));return(0,jsx_runtime.jsxs)(StyledItemLayout,{children:[(0,jsx_runtime.jsx)(StyledIconWrapper,{children:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:getIconForFile(file.path)})}),(0,jsx_runtime.jsx)(StyledTitleWrapper,{children:isSelected?(0,jsx_runtime.jsx)(TextWithHighlights.x,{highlights:titleMatches,children:title}):title}),(0,jsx_runtime.jsx)(ItemLayout.e.Hint,{children:isSelected?(0,jsx_runtime.jsx)(TextWithHighlights.x,{highlights:dirMatches,children:dir}):dir})]})}FileItem.displayName="FileItem";try{FileItem.displayName="FileItem",FileItem.__docgenInfo={description:"UI of paths in SearchEverywhere list.",displayName:"FileItem",props:{file:{defaultValue:null,description:"",name:"file",required:!0,type:{name:"ProjectFsItem"}},matches:{defaultValue:null,description:"matches on file.relativePath",name:"matches",required:!0,type:{name:"TextRange[] | null"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/SearchEverywhere/contributors/file/FileItem.tsx#FileItem"]={docgenInfo:FileItem.__docgenInfo,name:"FileItem",path:"../example-app/src/SearchEverywhere/contributors/file/FileItem.tsx#FileItem"})}catch(__react_docgen_typescript_loader_error){}const filesSearchContributor={id:"Files",title:"Files",actionId:CommonActionIds.$.GO_TO_FILE,use:()=>{const getProjectFiles=(0,es._8)((({snapshot})=>()=>snapshot.getLoadable(currentProjectFilesState).getValue()),[]),{openPath}=useEditorStateManager(),selectPathInProjectView=useSelectPathInProjectView();return{search:query=>getProjectFiles().map((file=>({matches:(0,minusculeMatch.M)(file.relativePath,query),file}))).filter((({matches})=>matches?.length)),searchDeps:[],isEverywhere:!0,processSelectedItem({file}){"file"===file?.type&&openPath(file.path,!0),"dir"===file?.type&&selectPathInProjectView(file.path)},getKey:({file})=>file.path,renderItem:({file,matches})=>(0,jsx_runtime.jsx)(FileItem,{file,matches}),getItemText:({file:{relativePath}})=>relativePath}}},SearchEverywhereActionIds_PREVIOUS_TAB="SearchEverywhere.PrevTab",SearchEverywhereActionIds_NEXT_TAB="SearchEverywhere.NextTab",SearchEverywherePopup_StyledHeader=styled.zo.div`
  display: flex;
  width: 100%;
  background: ${({theme})=>theme.color("SearchEverywhere.Header.background")};
  border-bottom: 1px solid
    ${({theme})=>theme.color("SearchEverywhere.SearchField.borderColor")};
`,StyledTab=styled.zo.button`
  all: unset;
  background: ${({theme,selected})=>selected&&theme.color("SearchEverywhere.Tab.selectedBackground")};
  color: ${({theme})=>theme.color("SearchEverywhere.Tab.selectedForeground")};
  opacity: ${({disabled})=>disabled&&".5"};
`,StyledTabContent=styled.zo.span`
  display: flex;
  padding: 0 0.75rem;
  height: 1.8rem;
  align-items: center;
`,StyledTabs=styled.zo.div`
  line-height: normal;
  border-bottom: none;
`,StyledSearchFieldContainer=styled.zo.div`
  display: flex;
  flex-shrink: 0;
  height: 1.85rem;
  align-items: center;
  padding: 0 0.75rem 0;
  gap: 0.75rem;

  input {
    all: unset;
    flex: 1;
    line-height: 1.25;

    &::selection {
      color: ${({theme})=>theme.color("*.selectionForeground")};
      background: ${({theme})=>theme.color("*.selectionBackground")};
    }
  }
`,StyledSearchResultsContainer=styled.zo.div`
  height: 24rem;
  flex: 1;
  min-height: 0; // for it to properly fill the remaining height and not to exceed that
`,StyledDivider=styled.zo.hr`
  all: unset;
  height: 1px;
  width: 100%;
  border-bottom: 1px solid
    ${({theme})=>theme.color("SearchEverywhere.SearchField.borderColor")};
`,StyledSearchFieldHint=styled.zo.div`
  color: ${({theme})=>theme.color("SearchEverywhere.SearchField.infoForeground")};
  white-space: nowrap;
`,StyledLoadMore=styled.zo.div`
  color: ${({theme})=>theme.currentForegroundAware(theme.color("SearchEverywhere.SearchField.infoForeground"))};
  font-size: 0.7rem;
  min-height: 1.375rem;
`,StyledPlaceholder=styled.zo.div`
  color: ${({theme})=>theme.commonColors.inactiveTextColor};
  position: absolute;
  text-align: center;
  width: 100%;
  top: 50%;
`,contributors=[actionsSearchContributor,filesSearchContributor],LOAD_MORE_ITEM={};function SearchEverywherePopup(){const setOpen=(0,es.Zl)(searchEverywhereState.isOpen),[tab,setTab]=(0,es.FV)(searchEverywhereState.tab),[everyWhereAutoSet,setEveryWhereAutoSet]=(0,react.useState)(!1),[pattern,setPattern]=(0,react.useState)(useRecoilInitialValue(searchEverywhereState.initialSearchQuery(tab))),persistInitialSearchQuery=(0,es.Zl)(searchEverywhereState.initialSearchQuery(tab)),getShortcut=(0,ActionShortcut.k)(),[selectedKeys,setSelectedKeys]=(0,react.useState)(new Set),idToContributor={};contributors.forEach((contributor=>{idToContributor[contributor.id]={...contributor,...contributor.use({everyWhereAutoSet})}}));const activeContributors=contributors.filter((contributor=>""===tab||contributor.id===tab)).map((({id})=>idToContributor[id])),[searchResultLimit,setSearchResultLimit]=(0,react.useState)(30),{searchResult}=(0,react.useMemo)((()=>({searchResult:activeContributors.flatMap((contributor=>contributor.search(pattern).map((item=>({key:`${contributor.id}_${contributor.getKey(item)}`,contributor,item})))))})),[pattern,tab,...activeContributors.flatMap((({searchDeps})=>searchDeps))]),currentTabContributor=idToContributor[tab],visibleSearchResult=(0,react.useMemo)((()=>{const visibleSearchResult=searchResult.slice(0,searchResultLimit);return searchResult.length>visibleSearchResult.length&&visibleSearchResult.push({key:"LOAD_MORE_ITEM_KEY",item:LOAD_MORE_ITEM,contributor:null}),visibleSearchResult}),[searchResultLimit,searchResult]),notFoundPatternRef=(0,react.useRef)(null);(0,react.useEffect)((()=>{pattern&&persistInitialSearchQuery(pattern)}),[pattern,tab]),(0,react.useEffect)((()=>{if(searchResult[0]){const{key}=searchResult[0];setSelectedKeys(new Set([key])),selectionManagerRef.current?.setFocusedKey(key),requestAnimationFrame((()=>{selectionManagerRef.current?.setFocusedKey(key)}))}setSearchResultLimit(30)}),[searchResult]);const localActions=[{id:SearchEverywhereActionIds_PREVIOUS_TAB,title:"Prev tab",description:"Switch to previous tab in Search Everywhere dialog",actionPerformed:()=>{const currentContributorIndex=contributors.findIndex((({id})=>tab===id));setTab(""===tab?contributors.slice(-1)[0].id:contributors[currentContributorIndex-1]?.id||"")}},{id:SearchEverywhereActionIds_NEXT_TAB,title:"Next tab",description:"Switch to next tab in Search Everywhere dialog",actionPerformed:()=>{const currentContributorIndex=contributors.findIndex((({id})=>tab===id));setTab(contributors[currentContributorIndex+1]?.id||"")}}],contributorActions=contributors.flatMap((({id,actionId,title})=>actionId?[{id:actionId,title:`Find ${title}`,description:`Quickly go to ${title} by name`,actionPerformed:()=>{tab!==id?setTab(id):currentTabContributor?.toggleEverywhere?.()}}]:[])),close=()=>setOpen(!1),collectionRef=(0,react.useRef)(null),selectionManagerRef=(0,react.useRef)(null),{collectionSearchInputProps}=(0,useCollectionSearchInput.R)({collectionRef,selectionManager:selectionManagerRef.current}),tips=useTips();return(0,jsx_runtime.jsx)(ContentAwarePopup,{persistedBoundsState:searchEverywhereState.bounds,hasContent:Boolean(pattern),noContentHeight:59,minWidth:670,minHeight:160,interactions:"all",onClose:close,children:(0,jsx_runtime.jsx)(ActionsProvider.DG,{actions:[...currentTabContributor?.actions||[],...contributorActions,...localActions],children:({shortcutHandlerProps})=>(0,jsx_runtime.jsx)("div",{...shortcutHandlerProps,style:{height:"inherit"},children:(0,jsx_runtime.jsx)(Popup.GI.Layout,{header:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Popup.GI.Header,{hasControls:!0,children:(0,jsx_runtime.jsxs)(SearchEverywherePopup_StyledHeader,{children:[(0,jsx_runtime.jsx)("div",{style:{flex:1},children:(0,jsx_runtime.jsxs)(Tabs.m,{TabComponent:StyledTab,TabsComponent:StyledTabs,selectedKey:tab,onSelectionChange:key=>setTab(key),children:[(0,jsx_runtime.jsx)(Item.c,{children:(0,jsx_runtime.jsx)(StyledTabContent,{children:"All"})},""),contributors.map((contributor=>{const shortcut=getShortcut(contributor.actionId),title=(0,jsx_runtime.jsx)(StyledTabContent,{children:contributor.title});return(0,jsx_runtime.jsx)(Item.c,{children:shortcut?(0,jsx_runtime.jsx)(TooltipTrigger.a,{tooltip:(0,jsx_runtime.jsx)(Tooltip.u,{children:shortcut}),children:(0,jsx_runtime.jsx)("span",{children:title})}):title},contributor.id)}))]})}),currentTabContributor?.headerFilters,(0,jsx_runtime.jsx)(IconButton.hU,{style:{margin:"0 0.5rem"},isDisabled:!0,children:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"actions/moveToLeftBottom"})})]})}),(0,jsx_runtime.jsxs)(StyledSearchFieldContainer,{children:[(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"actions/search"}),(0,jsx_runtime.jsx)(focus_dist_module.MT,{contain:!0,children:(0,jsx_runtime.jsx)(Input,{...collectionSearchInputProps,autoFocus:!0,onFocus:event=>{event.target.select()},value:pattern,onChange:e=>(newPattern=>{const newPatternContainsPrevious=notFoundPatternRef.current&&newPattern.includes(notFoundPatternRef.current);currentTabContributor?.isEverywhere&&!newPatternContainsPrevious&&setEveryWhereAutoSet(!1),setPattern(newPattern)})(e.currentTarget.value)})}),(0,jsx_runtime.jsx)(StyledSearchFieldHint,{children:currentTabContributor?.searchAdvertiser})]})]}),content:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(StyledDivider,{}),pattern&&(0,jsx_runtime.jsxs)(StyledSearchResultsContainer,{children:[(0,jsx_runtime.jsx)(List.a,{ref:collectionRef,selectionManagerRef,items:visibleSearchResult,selectionMode:"single",alwaysShowAsFocused:!0,shouldFocusWrap:!0,fillAvailableSpace:!0,selectedKeys,onSelectionChange:setSelectedKeys,onAction:key=>{if("LOAD_MORE_ITEM_KEY"===key){setSearchResultLimit((limit=>limit+30));const nextItem=searchResult[visibleSearchResult.length+1];nextItem&&setTimeout((()=>{setSelectedKeys(new Set([nextItem.key])),selectionManagerRef.current?.setFocusedKey(nextItem.key)}))}else close(),setTimeout((()=>{const itemWrapper=searchResult.find((item=>item.key===key));itemWrapper?.contributor.processSelectedItem(itemWrapper.item)}),50)},children:({key,item,contributor})=>"LOAD_MORE_ITEM_KEY"===key?(0,jsx_runtime.jsx)(Item.c,{children:(0,jsx_runtime.jsx)(StyledLoadMore,{children:"...more"})},"LOAD_MORE_ITEM_KEY"):(0,jsx_runtime.jsx)(Item.c,{textValue:contributor.getItemText(item),children:contributor.renderItem(item)},key)}),0===searchResult.length&&(0,jsx_runtime.jsx)(StyledPlaceholder,{children:"No actions with such name found"})]})]}),footer:(0,jsx_runtime.jsxs)(Popup.GI.Hint,{children:[tips.current," ",(0,jsx_runtime.jsx)(Link.r,{onPress:tips.next,children:"Next Tip"})]})})})})})}SearchEverywherePopup.displayName="SearchEverywherePopup";try{SearchEverywherePopup.displayName="SearchEverywherePopup",SearchEverywherePopup.__docgenInfo={description:"TODO: implement history navigation",displayName:"SearchEverywherePopup",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/SearchEverywhere/SearchEverywherePopup.tsx#SearchEverywherePopup"]={docgenInfo:SearchEverywherePopup.__docgenInfo,name:"SearchEverywherePopup",path:"../example-app/src/SearchEverywhere/SearchEverywherePopup.tsx#SearchEverywherePopup"})}catch(__react_docgen_typescript_loader_error){}function useProjectActions(){const openSearchEverywhere=(0,es._8)((({set})=>({element},tab)=>{element&&(set(searchEverywhereState.isOpen,!0),set(searchEverywhereState.tab,tab),set(searchEverywhereState.contextElement,element))}),[]);return[{id:CommonActionIds.$.GO_TO_ACTION,title:"Find Action",description:"Quickly navigate to action by name",actionPerformed:event=>{openSearchEverywhere(event,"Actions")}},{id:CommonActionIds.$.GO_TO_FILE,title:"Go to file",description:"Quickly navigate to file by name",actionPerformed:event=>{openSearchEverywhere(event,"Files")}}]}const ToolWindowsRefContext=react.createContext(null),useToolWindowManager=()=>{const toolWindowRef=(0,react.useContext)(ToolWindowsRefContext);return{open:key=>{toolWindowRef?.current?.changeState((state=>state.show(key))),toolWindowRef?.current?.focus(key)}}},useChangesViewActionDefinitions=()=>{const openRollbackWindow=(0,es._8)(openRollbackWindowForSelectionCallback,[]),refresh=useRefreshChanges();return[useCheckInActionDefinition(),useCheckInProjectAction(),useJumpToSourceAction(),{id:VcsActionIds.ROLLBACK,title:"Rollback...",icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"actions/rollback.svg"}),actionPerformed:event=>{openRollbackWindow(Boolean(event))}},{id:VcsActionIds.REFRESH,title:"Refresh",icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"actions/refresh.svg"}),actionPerformed:refresh},{id:VcsActionIds.SHOW_DIFF,title:"Show Diff",icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"actions/diff.svg"}),actionPerformed:notImplemented},{id:VcsActionIds.SHELVE_SILENTLY,title:"Shelve Silently",icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"vcs/shelveSilent.svg"}),actionPerformed:notImplemented},{id:VcsActionIds.SHELVE,title:"Shelve Changes...",description:"Save changes to an external patch file and remove them from the code",icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"vcs/shelve.svg"}),actionPerformed:notImplemented},...useChangeListActionDefinitions()]},commitFileMsg=new core.C("{count, plural,\n    =1 {Commit File...}\n    other {Commit Files...}\n  }","en-US"),commitDirMsg=new core.C("{count, plural,\n    =1 {Commit Directory...}\n    other {Commit Directories...}\n  }","en-US");function useCheckInActionDefinition(){const queueCheckIn=(0,es._8)(queueCheckInCallback,[]),toolWindowManager=useToolWindowManager(),activePaths=(0,es.sJ)(activePathsState),projectFiles=(0,es.sJ)(currentProjectFilesState),roots=activePaths.filter((path=>!activePaths.find((activePath=>path!==activePath&&path.startsWith(activePath))))),isDir=projectFiles.find((item=>path_browserify_default().dirname(item.path).startsWith(roots[0]))),allChanges=(0,es.sJ)(allChangesState),containsChange=roots.some((root=>allChanges.find((change=>function isPathInside(parent,dir){const relative=path_browserify_default().relative(parent,dir);return!relative||!relative.startsWith("..")&&!path_browserify_default().isAbsolute(relative)}(root,change.after.path)))));return{id:VcsActionIds.CHECKIN_FILES,title:isDir?commitDirMsg.format({count:roots.length}):commitFileMsg.format({count:roots.length}),isDisabled:!containsChange,actionPerformed:()=>{queueCheckIn(),toolWindowManager.open("Commit"),focusCommitMessage()}}}function useCheckInProjectAction(){const toolWindowManager=useToolWindowManager(),queueChanges=(0,es._8)((({snapshot,set})=>()=>{const includedChangesKeys=snapshot.getLoadable(includedChangeKeysState).getValue();let keyToSelect=includedChangesKeys.values().next().value;if(0===includedChangesKeys.size){const allKeys=snapshot.getLoadable(allChangesState).getValue().map(getNodeKeyForChange);set(includedChangeKeysState,new Set(allKeys)),keyToSelect=allKeys[0]}if(keyToSelect){const{rootNodes}=snapshot.getLoadable(changesTreeNodesState).getValue();set(ChangesView_state_expandedKeysState,new Set([...snapshot.getLoadable(ChangesView_state_expandedKeysState).getValue(),...(0,tree_utils.Bp)((node=>isGroupNode(node)?node.children:null),(node=>node.key),rootNodes,[keyToSelect])])),set(ChangesView_state_selectedKeysState,new Set([keyToSelect]))}}),[]);return{id:VcsActionIds.CHECKIN_PROJECT,title:"Commit",actionPerformed:()=>{queueChanges(),toolWindowManager.open("Commit"),focusCommitMessage()}}}function useJumpToSourceAction(){const editorStateManager=useEditorStateManager(),selectedChanges=(0,es.sJ)(changesUnderSelectedKeys);return{id:VcsActionIds.JUMP_TO_SOURCE,title:"Jump to source",icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"actions/editSource.svg"}),actionPerformed:()=>{[...selectedChanges].forEach(((change,index,arr)=>{change.after.isDir||editorStateManager.openPath(change.after.path,index===arr.length-1)}))}}}const deleteChangeListMsg=new core.C("Delete {count, plural,\n    =1 {Changelist}\n    other {Changelists}\n  }","en-US");function useChangeListActionDefinitions(){const selectedChangeLists=(0,es.sJ)(changeListsUnderSelection),selectedChanges=(0,es.sJ)(changesUnderSelectedKeys),setActiveChangeList=(0,es._8)((({set,snapshot})=>changeListId=>{const changeLists=snapshot.getLoadable(changeListsState).getValue(),targetChangeList=changeLists.find((({id})=>id===changeListId));targetChangeList&&set(changeListsState,changeLists.map((changeList=>({...changeList,active:changeList===targetChangeList}))))}),[]),nonActiveSelectedChangeLists=[...selectedChangeLists].filter((list=>!list.active)),actions=[{id:VcsActionIds.NEW_CHANGELIST,title:"New Changelist...",description:"Create new changelist",icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"general/add.svg"}),actionPerformed:notImplemented}];return 1===selectedChangeLists.size&&actions.push({id:VcsActionIds.RENAME_CHANGELIST,title:"Edit Changelist...",description:"Edit name and description of selected changelist",icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"actions/edit.svg"}),actionPerformed:notImplemented}),nonActiveSelectedChangeLists.length>0&&actions.push({id:VcsActionIds.REMOVE_CHANGELIST,title:deleteChangeListMsg.format({count:nonActiveSelectedChangeLists.length}),description:"Remove changelist and move all changes to another",icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"general/remove.svg"}),actionPerformed:notImplemented}),1===nonActiveSelectedChangeLists.length&&actions.push({title:"Set Active Changelist",description:"Set changelist to which new changes are placed by default",id:VcsActionIds.SET_DEFAULT_CHANGELIST,icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"actions/selectall.svg"}),actionPerformed:()=>{setActiveChangeList(nonActiveSelectedChangeLists[0].id)}}),selectedChanges.size>0&&actions.push({title:"Move to Another Changelist...",description:"Move selected changes to another changelist",id:VcsActionIds.MOVE_TO_ANOTHER_CHANGELIST,actionPerformed:notImplemented}),actions}const CreateNewBranchWindow_StyledContainer=styled.zo.div`
  display: flex;
  flex-direction: column;
  align-items: stretch;
  padding: 1rem 0.875rem 0.25rem;
  gap: 0.6rem;
`,StyledCheckboxesContainer=styled.zo.div`
  margin-left: -0.25rem; // to align with the field. Maybe something to look into in checkbox.
  display: flex;
  gap: 0.75rem;
`,CreateNewBranchWindow_ErrorMessages={EXISTING:branchName=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Branch name ",branchName," already exists. ",(0,jsx_runtime.jsx)("br",{}),"Change the name or overwrite existing branch"]}),CLASHING_WITH_REMOTE:branchName=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Branch name ",branchName," clashes with remote branch ",(0,jsx_runtime.jsx)("br",{}),"with the same name"]})};function CreateNewBranchWindow({close}){const[checkout,setCheckout]=(0,react.useState)(!0),[overwrite,setOverwrite]=(0,react.useState)(!1),branches=(0,es.sJ)(activeFileRepoBranchesState),[isErrorVisible,setIsErrorVisible]=(0,react.useState)(!1),balloonManager=(0,BalloonManager.L)(),createBranch=function useCreateBranch(){return(0,es._8)((({refresh})=>(repoRoot,branchName,checkout=!0)=>(0,isomorphic_git.WY)({fs,dir:repoRoot,checkout,ref:branchName}).then((()=>{refresh(repoBranchesState(repoRoot))}))),[])}(),currentBranchName=branches.currentBranch?.name,[branchName,setBranchName]=(0,react.useState)(currentBranchName||""),error=validateBranchName(branches,branchName),isValid=!error||"EXISTING"===error&&overwrite,validationState=!isValid&&isErrorVisible?"invalid":"valid";return(0,jsx_runtime.jsx)(ModalWindow.Du,{minWidth:"content",minHeight:"content",children:(0,jsx_runtime.jsx)(WindowLayout.b,{header:"Create New Branch",content:(0,jsx_runtime.jsxs)(CreateNewBranchWindow_StyledContainer,{id:"create_branch_form",as:"form",onSubmit:e=>{e.preventDefault(),isValid?createBranch(branches.repoRoot,branchName,checkout).catch((e=>{e instanceof isomorphic_git.D1.AlreadyExistsError?balloonManager.show({icon:"Error",title:"Unimplemented action",body:"Overwrite option is currently not supported."}):balloonManager.show({icon:"Error",title:"Unexpected error",body:`Could not create branch ${branchName}.`}),console.error("Branch creation error: ",e)})).then((()=>{close()})):setIsErrorVisible(!0)},children:[(0,jsx_runtime.jsx)(InputField.U,{autoFocus:!0,autoSelect:!0,value:branchName,onChange:newValue=>{setBranchName(cleanUpBranchName(newValue)),setIsErrorVisible(!0)},validationState,errorMessage:"invalid"===validationState&&error&&CreateNewBranchWindow_ErrorMessages[error](branchName),label:"New branch name:",labelPlacement:"above"}),(0,jsx_runtime.jsxs)(StyledCheckboxesContainer,{children:[(0,jsx_runtime.jsx)(Checkbox.X,{isSelected:checkout,onChange:setCheckout,children:"Checkout branch"}),(0,jsx_runtime.jsx)(Checkbox.X,{isSelected:overwrite,isDisabled:!isErrorVisible||"EXISTING"!==error,onChange:setOverwrite,children:"Overwrite existing branch"})]})]}),footer:(0,jsx_runtime.jsx)(WindowLayout.b.Footer,{right:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Button.z,{onPress:close,children:"Cancel"}),(0,jsx_runtime.jsx)(Button.z,{variant:"default",type:"submit",form:"create_branch_form",isDisabled:"invalid"===validationState,children:"Create"})]})})})})}CreateNewBranchWindow.displayName="CreateNewBranchWindow";try{CreateNewBranchWindow.displayName="CreateNewBranchWindow",CreateNewBranchWindow.__docgenInfo={description:"",displayName:"CreateNewBranchWindow",props:{close:{defaultValue:null,description:"",name:"close",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/VersionControl/Branches/CreateNewBranchWindow.tsx#CreateNewBranchWindow"]={docgenInfo:CreateNewBranchWindow.__docgenInfo,name:"CreateNewBranchWindow",path:"../example-app/src/VersionControl/Branches/CreateNewBranchWindow.tsx#CreateNewBranchWindow"})}catch(__react_docgen_typescript_loader_error){}function useVcsActions(){const popupManager=(0,PopupManager.U)(),windowManager=useWindowManager();return[...useChangesViewActionDefinitions(),{id:VcsActionIds.GIT_CREATE_NEW_BRANCH,title:"New Branch",description:"Create new branch starting from the selected commit",icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"general/add.svg"}),actionPerformed:()=>{windowManager.open((({close})=>(0,jsx_runtime.jsx)(CreateNewBranchWindow,{close})))}},{id:VcsActionIds.GIT_BRANCHES,title:"Branches",icon:(0,jsx_runtime.jsx)(PlatformIcon.vq,{icon:"vcs/branch.svg"}),actionPerformed:()=>{popupManager.show((({close})=>(0,jsx_runtime.jsx)(BranchesPopup,{onClose:close})))}}]}var fxp=__webpack_require__("../../node_modules/fast-xml-parser/src/fxp.js");const WORKSPACE_XML_PARSE_OPTIONS={attributeNamePrefix:"@",ignoreAttributes:!1,isArray:(tagName,jPath)=>"project.component"===jPath},WORKSPACE_XML_BUILD_OPTIONS={format:!0,attributeNamePrefix:"@",ignoreAttributes:!1};async function readWorkspace(storageFile){const xmlParser=new fxp.XMLParser(WORKSPACE_XML_PARSE_OPTIONS);if(!await fs.promises.exists(storageFile))return null;const xmlData=await fs.promises.readFile(storageFile,{encoding:"utf8"}),workspace=xmlParser.parse(xmlData);return workspace.project=workspace.project||{},workspace.project.component=workspace.project.component||{component:[]},workspace}async function writeWorkspace(storageFile,workspaceState){const xmlString=new fxp.XMLBuilder(WORKSPACE_XML_BUILD_OPTIONS).build(workspaceState);await ensureDir(fs.promises,path_browserify_default().dirname(storageFile)),await fs.promises.writeFile(storageFile,xmlString)}const storageFileMapping={[StorageFiles.WORKSPACE_FILE]:"workspace.xml"};function PersistentStateProvider({children}){const containerDirectory=path_browserify_default().join((0,es.sJ)(currentProjectState).path,".idea"),workspacePromiseRef=(0,react.useRef)({}),resolveStorageFile=storageFile=>path_browserify_default().join(containerDirectory,storageFileMapping[storageFile]||storageFile),getWorkspace=storageFile=>{const resolvedStorageFile=resolveStorageFile(storageFile);return workspacePromiseRef.current[resolvedStorageFile]||(workspacePromiseRef.current[resolvedStorageFile]=readWorkspace(resolvedStorageFile)),workspacePromiseRef.current[resolvedStorageFile]};return(0,react.useEffect)((()=>{getWorkspace(StorageFiles.WORKSPACE_FILE)}),[]),(0,jsx_runtime.jsx)(recoil_sync_es.J1,{storeKey:"ProjectWorkspace",read:async key=>{const[storageFile,componentName]=key.split("|"),workspace=await getWorkspace(storageFile);return workspace?.project.component.find((({"@name":name})=>name===componentName))},write:async({diff})=>{const changesByFile=(0,groupBy.Z)((({storageFile})=>storageFile),[...diff.entries()].map((([key,value])=>{const[storageFile,componentName]=key.split("|");return{storageFile,componentName,value}})));for(const storageFile in changesByFile){const changes=changesByFile[storageFile],workspace=await readWorkspace(storageFile)||{"?xml":{"@version":"1.0","@encoding":"UTF-8"},project:{"@version":"4",component:[]}};for(const{value,componentName}of changes){const components=workspace.project.component,index=components.findIndex((({"@name":name})=>name===componentName)),componentState="function"==typeof value?value(components[index]||null):value;components.splice(index,index>=0?1:0,{"@name":componentName,...componentState})}await writeWorkspace(resolveStorageFile(storageFile),workspace)}},children})}PersistentStateProvider.displayName="PersistentStateProvider";try{PersistentStateProvider.displayName="PersistentStateProvider",PersistentStateProvider.__docgenInfo={description:"",displayName:"PersistentStateProvider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/Project/persistence/PersistentStateProvider.tsx#PersistentStateProvider"]={docgenInfo:PersistentStateProvider.__docgenInfo,name:"PersistentStateProvider",path:"../example-app/src/Project/persistence/PersistentStateProvider.tsx#PersistentStateProvider"})}catch(__react_docgen_typescript_loader_error){}const StyledWindowFrame=styled.zo.div`
  display: flex;
  flex-direction: column;
  height: 100vh;
  min-height: 0;
`,Project=({height,toolWindowRef})=>{const[state,setState]=(0,es.FV)(toolWindowsState),isRollbackWindowOpen=(0,es.sJ)(rollbackViewState.isOpen),isSearchEveryWhereOpen=(0,es.sJ)(searchEverywhereState.isOpen);(()=>{const updateVcsFileStatuses=useUpdateVcsFileStatuses();(0,react.useEffect)((()=>{updateVcsFileStatuses().catch((e=>{console.error("could not initialize VCS file statuses",e)}))}),[])})(),(()=>{const refresh=useRefreshChanges();(0,react.useEffect)((()=>{refresh().catch((e=>console.error("could not initialize changes",e)))}),[refresh])})(),usePersistenceFsNotification(),_balloonManagerRef.value=(0,BalloonManager.L)();const allActions=[...useProjectActions(),...useVcsActions()];return(0,jsx_runtime.jsx)(PersistentStateProvider,{children:(0,jsx_runtime.jsxs)(StyledWindowFrame,{style:{height},children:[(0,jsx_runtime.jsx)(ActionsProvider.DG,{actions:allActions,useCapture:!0,children:({shortcutHandlerProps})=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(DefaultToolWindows.u,{ref:toolWindowRef,toolWindowsState:state,onToolWindowStateChange:newState=>{setState(newState)},windows:toolWindows,containerProps:shortcutHandlerProps,children:(0,jsx_runtime.jsx)(FileEditor,{})}),(0,jsx_runtime.jsx)(IdeStatusBar,{})]})}),isSearchEveryWhereOpen&&(0,jsx_runtime.jsx)(SearchEverywherePopup,{}),isRollbackWindowOpen&&(0,jsx_runtime.jsx)(RollbackWindow,{})]})})};Project.displayName="Project";try{Project.displayName="Project",Project.__docgenInfo={description:"",displayName:"Project",props:{height:{defaultValue:null,description:"",name:"height",required:!0,type:{name:"Height<string | number> | undefined"}},toolWindowRef:{defaultValue:null,description:"",name:"toolWindowRef",required:!0,type:{name:"RefObject<ToolWindowRefValue>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/Project/Project.tsx#Project"]={docgenInfo:Project.__docgenInfo,name:"Project",path:"../example-app/src/Project/Project.tsx#Project"})}catch(__react_docgen_typescript_loader_error){}var style_constants=__webpack_require__("./src/style-constants.ts");const StyledDialog=styled_components_browser_esm.ZP.div.withConfig({displayName:"SampleRepoInitializer__StyledDialog",componentId:"sc-1ljr97b-0"})(["position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:",";color:",";",";text-align:center;line-height:1.5;"],(({theme})=>theme.color("*.background")),(({theme})=>theme.color("*.foreground")),style_constants.s),StyledDialogHeader=styled_components_browser_esm.ZP.div.withConfig({displayName:"SampleRepoInitializer__StyledDialogHeader",componentId:"sc-1ljr97b-1"})(["background:",";padding:4px;text-align:center;"],(({theme})=>theme.color("Popup.Header.activeBackground"))),StyledDialogContent=styled_components_browser_esm.ZP.div.withConfig({displayName:"SampleRepoInitializer__StyledDialogContent",componentId:"sc-1ljr97b-2"})(["padding:8px 16px;"]);const SampleRepoInitializer=({children})=>{const[state,setState]=(0,react.useState)("uninitialized");return(0,react.useEffect)((()=>{(async function init(dir,repoUrl){await async function isSuccessfullyCloned(dir){try{if(!(await fs.promises.stat(dir)).isDirectory())return console.info(`Already cloned repo was not found. "${dir}" is not a directory.`),!1;const files=await fs.promises.readdir(dir);if(1===files.length&&".git"===files[0])return console.info(`Already cloned repo was not found at "${dir}". ".git" folder exists, but it's not successfully unpacked.`),!1}catch(e){return console.info(`Already cloned repo was not found at "${dir}".`),!1}return!0}(dir)||(setState("cloning"),await async function cloneRepo(dir,repoUrl){console.log("cloning repo: "),await(0,isomorphic_git.d9)({fs,url:repoUrl,http:web.Z,corsProxy:"https://cors.isomorphic-git.org",dir,singleBranch:!0})}(dir,repoUrl))})(sampleRepo.path,sampleRepo.url).then((()=>{console.log("demo repo initialized"),setState("initialized")})).catch((e=>{console.error("could not initialize the demo repo",e),setState("error")}))}),[]),"uninitialized"===state?null:"initialized"===state?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children}):(0,jsx_runtime.jsx)("div",{style:{minHeight:"100vh",position:"relative"},children:(0,jsx_runtime.jsxs)(StyledDialog,{children:[(0,jsx_runtime.jsx)(StyledDialogHeader,{children:"Cloning sample repo"}),(0,jsx_runtime.jsx)(StyledDialogContent,{children:"cloning"===state?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Cloning ",(0,jsx_runtime.jsx)("b",{children:sampleRepo.url}),". ",(0,jsx_runtime.jsx)("br",{}),"It may take several seconds."]}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:"Something went wrong!"})})]})})};SampleRepoInitializer.displayName="SampleRepoInitializer";try{SampleRepoInitializer.displayName="SampleRepoInitializer",SampleRepoInitializer.__docgenInfo={description:"",displayName:"SampleRepoInitializer",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/SampleRepoInitializer.tsx#SampleRepoInitializer"]={docgenInfo:SampleRepoInitializer.__docgenInfo,name:"SampleRepoInitializer",path:"../example-app/src/SampleRepoInitializer.tsx#SampleRepoInitializer"})}catch(__react_docgen_typescript_loader_error){}const exampleAppKeymap={ActivateProjectWindow:[{type:"keyboard",firstKeyStroke:{code:"Digit1",modifiers:["Meta"]}}],ActivateCommitWindow:[{type:"keyboard",firstKeyStroke:{code:"Digit0",modifiers:["Meta"]}}],ActivateTerminalWindow:[{type:"keyboard",firstKeyStroke:{code:"F12",modifiers:["Alt"]}}],[VcsActionIds.ROLLBACK]:[{type:"keyboard",firstKeyStroke:{code:"KeyZ",modifiers:["Alt","Meta"]}}],[VcsActionIds.SHOW_DIFF]:[{type:"keyboard",firstKeyStroke:{code:"KeyD",modifiers:["Meta"]}}],[VcsActionIds.SHELVE_SILENTLY]:[{type:"keyboard",firstKeyStroke:{code:"KeyH",modifiers:["Meta","Shift"]}}],[VcsActionIds.UNSHELVE_SILENTLY]:[{type:"keyboard",firstKeyStroke:{code:"KeyU",modifiers:["Meta","Alt"]}}],[SearchEverywhereActionIds_PREVIOUS_TAB]:[{type:"keyboard",firstKeyStroke:{code:"Tab",modifiers:["Shift"]}}],[SearchEverywhereActionIds_NEXT_TAB]:[{type:"keyboard",firstKeyStroke:{code:"Tab"}}],[VcsActionIds.RENAME_CHANGELIST]:[{type:"keyboard",firstKeyStroke:{code:"F2"}}],[VcsActionIds.MOVE_TO_ANOTHER_CHANGELIST]:[{type:"keyboard",firstKeyStroke:{modifiers:["Meta","Shift"],code:"KeyM"}}],[VcsActionIds.SET_DEFAULT_CHANGELIST]:[{type:"keyboard",firstKeyStroke:{modifiers:["Control"],code:"Space"}}],[VcsActionIds.REMOVE_CHANGELIST]:[{type:"keyboard",firstKeyStroke:{code:"Backspace"}}],[VcsActionIds.CHECKIN_PROJECT]:[{type:"keyboard",firstKeyStroke:{modifiers:["Meta"],code:"KeyK"}}]};window.git=isomorphic_git.ZP,window.fs=fs,window.path=path_browserify,window.http=web.Z;const App=({height})=>{const toolWindowRef=(0,react.useRef)(null);return(0,jsx_runtime.jsx)(DefaultSuspense,{children:(0,jsx_runtime.jsx)(WaitForFs,{children:(0,jsx_runtime.jsx)(SampleRepoInitializer,{children:(0,jsx_runtime.jsx)(KeymapProvider.ur,{keymap:exampleAppKeymap,children:(0,jsx_runtime.jsx)(es.Wh,{children:(0,jsx_runtime.jsx)(BalloonManager.a,{disablePortal:!0,children:(0,jsx_runtime.jsx)(WindowManager,{children:(0,jsx_runtime.jsx)(PopupManager.q,{children:(0,jsx_runtime.jsx)(ToolWindowsRefContext.Provider,{value:toolWindowRef,children:(0,jsx_runtime.jsx)(Project,{height,toolWindowRef})})})})})})})})})})};App.displayName="App";try{App.displayName="App",App.__docgenInfo={description:"Example app root component. It expects ThemeProvider to be provided based on where it's rendered.",displayName:"App",props:{height:{defaultValue:null,description:"",name:"height",required:!1,type:{name:"Height<string | number>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../example-app/src/App.tsx#App"]={docgenInfo:App.__docgenInfo,name:"App",path:"../example-app/src/App.tsx#App"})}catch(__react_docgen_typescript_loader_error){}const demo_stories={title:"Demos/Example App"},ExampleApp={render:()=>(0,jsx_runtime.jsx)(App,{}),parameters:{layout:"fullscreen",controls:{exclude:story_helpers.q}}};ExampleApp.parameters={...ExampleApp.parameters,docs:{...ExampleApp.parameters?.docs,source:{originalSource:'{\n  render: () => <App />,\n  parameters: {\n    layout: "fullscreen",\n    controls: {\n      exclude: styledComponentsControlsExclude\n    }\n  }\n}',...ExampleApp.parameters?.docs?.source}}};const __namedExportsOrder=["ExampleApp"]},"./src/Balloon/BalloonManager.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{a:()=>BalloonManager,L:()=>useBalloonManager});var react=__webpack_require__("../../node_modules/react/index.js"),react_dom=__webpack_require__("../../node_modules/react-dom/index.js"),Balloon=__webpack_require__("./src/Balloon/Balloon.tsx"),styled_components_browser_esm=__webpack_require__("../../node_modules/styled-components/dist/styled-components.browser.esm.js"),Balloon_styled=__webpack_require__("./src/Balloon/Balloon.styled.tsx");const StyledBalloonsStack=styled_components_browser_esm.ZP.div.withConfig({displayName:"StyledBalloonsStack",componentId:"sc-mzizjy-0"})(["position:fixed;z-index:1;bottom:42px;right:26px;","{margin-bottom:12px;}"],Balloon_styled.NY);try{StyledBalloonsStack.displayName="StyledBalloonsStack",StyledBalloonsStack.__docgenInfo={description:"Container component for stacking a number of Balloons in an overlay placed on the bottom right of where it's rendered.",displayName:"StyledBalloonsStack",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: HTMLDivElement | null) => void) | RefObject<HTMLDivElement> | null"}},theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"any"}},as:{defaultValue:null,description:"",name:"as",required:!1,type:{name:"undefined"}},forwardedAs:{defaultValue:null,description:"",name:"forwardedAs",required:!1,type:{name:"undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/Balloon/StyledBalloonsStack.tsx#StyledBalloonsStack"]={docgenInfo:StyledBalloonsStack.__docgenInfo,name:"StyledBalloonsStack",path:"src/Balloon/StyledBalloonsStack.tsx#StyledBalloonsStack"})}catch(__react_docgen_typescript_loader_error){}var jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");const NotImplementedFn=()=>{throw new Error("You must render a BalloonManager...")},BalloonsContext=react.createContext({show:NotImplementedFn,showSticky:NotImplementedFn}),useBalloonManager=()=>(0,react.useContext)(BalloonsContext),BalloonManager=({children,disablePortal,BalloonsContainer=StyledBalloonsStack})=>{const[balloons,setBalloons]=(0,react.useState)([]),timeoutIdsRef=(0,react.useRef)([]),lastIdRef=(0,react.useRef)(0),api=(0,react.useMemo)((()=>{const show=(props,timeout=1e4)=>{lastIdRef.current++;const onClose=()=>{setBalloons((balloons=>balloons.filter((aBalloon=>aBalloon!==balloon))))},balloon=(0,jsx_runtime.jsx)(Balloon.y,{...props,title:props.title,onClose},lastIdRef.current);return setBalloons((balloons=>{if(timeout>0){const timeoutId=window.setTimeout((()=>{onClose(),timeoutIdsRef.current=timeoutIdsRef.current.filter((aTimeoutId=>aTimeoutId!==timeoutId))}),timeout);timeoutIdsRef.current=[...timeoutIdsRef.current,timeoutId]}return balloons.concat(balloon)})),onClose};return{show,showSticky:props=>show(props,0)}}),[]);(0,react.useEffect)((()=>()=>{timeoutIdsRef.current.forEach((id=>{window.clearTimeout(id)}))}),[]);const notificationsStack=(0,jsx_runtime.jsx)(BalloonsContainer,{style:{position:disablePortal?"absolute":void 0},children:balloons});return(0,jsx_runtime.jsxs)(BalloonsContext.Provider,{value:api,children:[children,disablePortal?notificationsStack:react_dom.createPortal(notificationsStack,document.body)]})};BalloonManager.displayName="BalloonManager";try{BalloonManager.displayName="BalloonManager",BalloonManager.__docgenInfo={description:"Enables imperative API (via {@link useBalloonManager}) for showing Balloon notifications on the bottom right of the screen.\nIt renders notifications in a portal appended to `body`, unless `disablePortal` is `true`.",displayName:"BalloonManager",props:{disablePortal:{defaultValue:null,description:"",name:"disablePortal",required:!1,type:{name:"boolean"}},BalloonsContainer:{defaultValue:{value:"styled.div`\n  position: fixed;\n  z-index: 1;\n  bottom: 42px;\n  right: 26px;\n  ${StyledBalloonContainer} {\n    margin-bottom: 12px;\n  }\n`"},description:"",name:"BalloonsContainer",required:!1,type:{name:"ElementType<any>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/Balloon/BalloonManager.tsx#BalloonManager"]={docgenInfo:BalloonManager.__docgenInfo,name:"BalloonManager",path:"src/Balloon/BalloonManager.tsx#BalloonManager"})}catch(__react_docgen_typescript_loader_error){}},"./src/Button/Button.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{z:()=>Button});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/index.js"),_react_aria_button__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/@react-aria/button/dist/module.js"),_react_aria_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/@react-aria/utils/dist/module.js"),_intellij_platform_core_Button_StyledButton__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/Button/StyledButton.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/jsx-runtime.js");const variants={default:_intellij_platform_core_Button_StyledButton__WEBPACK_IMPORTED_MODULE_2__.Pi,icon:_intellij_platform_core_Button_StyledButton__WEBPACK_IMPORTED_MODULE_2__.Qh},Button=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((function Button({variant,...props},forwardedRef){const ref=(0,_react_aria_utils__WEBPACK_IMPORTED_MODULE_3__.B3)(forwardedRef),{buttonProps}=(0,_react_aria_button__WEBPACK_IMPORTED_MODULE_4__.U)(props,ref),domProps=(0,_react_aria_utils__WEBPACK_IMPORTED_MODULE_3__.zL)(props),{autoFocus,form}=props,Component=variant&&variants[variant]||_intellij_platform_core_Button_StyledButton__WEBPACK_IMPORTED_MODULE_2__.Sn;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(Component,{...(0,_react_aria_utils__WEBPACK_IMPORTED_MODULE_3__.dG)(domProps,buttonProps,{autoFocus,form}),ref,children:props.children})}));try{Button.displayName="Button",Button.__docgenInfo={description:'https://jetbrains.github.io/ui/controls/button/\n\nTODO:\n- Support for "default" button behaviour. it\'s kind of similar to a <button type="submit" /> in html, but textarea\nbehaviour is different from what is explained here: https://jetbrains.github.io/ui/controls/button/#16\nCmd+Enter should always trigger onPress. Plus, maybe it should work independent of "form" being used? or maybe it\'s\nnot a big deal to expect an ancestor "form" element, when variant is "default"?\n- Support for mnemonic\n- "Default" style differences in Windows.\n- Gradient colors (low hanging fruit, but negligible added value).\n\nKnown issues:\n- In the original impl, default button looks the same as normal button, when focus is not within the same area that\nthe button is. For example in the commit tool window, "Commit" button which is default, is not blue, unless the\n"Commit" tool window is focused. This particular case can easily be achieved by conditionally setting variant to,\n"default" based on tool window focus state, which is accessible via useDefaultToolWindowContext(), if\nDefaultToolWindow is used. But we need to see if the same requirement exists in various places.\nNOTE: this item is related to the first item in the to-do list above. There can be a container kind of component,\nwhich enables "default" behaviour and look. Maybe it can be FocusScope or at least related to FocusScope.\n- In the original impl, there is no visual clue for pressed state, which is poor accessibility. For now, the same\nbehaviour is followed here too. But we may reconsider deviating from the original impl for an improvement here.',displayName:"Button",props:{variant:{defaultValue:null,description:"",name:"variant",required:!1,type:{name:"enum",value:[{value:'"default"'},{value:'"icon"'}]}},preventFocusOnPress:{defaultValue:null,description:"",name:"preventFocusOnPress",required:!1,type:{name:"boolean"}},form:{defaultValue:null,description:"",name:"form",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/Button/Button.tsx#Button"]={docgenInfo:Button.__docgenInfo,name:"Button",path:"src/Button/Button.tsx#Button"})}catch(__react_docgen_typescript_loader_error){}},"./src/Collections/useCollectionSearchInput.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{R:()=>useCollectionSearchInput});var _intellij_platform_core_utils_useEventCallback__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/utils/useEventCallback.ts");const useCollectionSearchInput=({collectionRef,selectionManager})=>{const relayEventsToCollection=(0,_intellij_platform_core_utils_useEventCallback__WEBPACK_IMPORTED_MODULE_0__.$)((event=>{"keydown"!==event.type||"ArrowUp"!==event.key&&"ArrowDown"!==event.key?"Enter"===event.key&&selectionManager?.focusedKey&&(collectionRef.current?.querySelector(`[data-key="${selectionManager?.focusedKey}"]`)?.dispatchEvent(new KeyboardEvent(event.type,event.nativeEvent)),event.preventDefault()):(event.preventDefault(),event.stopPropagation(),collectionRef.current?.dispatchEvent(new KeyboardEvent(event.type,event.nativeEvent)))}));return{collectionSearchInputProps:{onKeyDown:relayEventsToCollection,onKeyUp:relayEventsToCollection,onKeyPress:relayEventsToCollection}}}},"./src/List/List.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{a:()=>List});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/index.js"),_useList__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/List/useList.ts"),_ListItem__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/List/ListItem.tsx"),_StyledList__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/List/StyledList.tsx"),_listItemRenderer__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/List/listItemRenderer.tsx"),_useListState__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/List/useListState.ts"),_react_aria_utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/@react-aria/utils/dist/module.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/jsx-runtime.js");const List=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((function List({allowEmptySelection=!1,alwaysShowAsFocused=!1,fillAvailableSpace=!1,onAction,...inputProps},forwardedRef){const props={...inputProps,disallowEmptySelection:!allowEmptySelection},ref=(0,_react_aria_utils__WEBPACK_IMPORTED_MODULE_2__.B3)(forwardedRef),state=(0,_useListState__WEBPACK_IMPORTED_MODULE_3__.n)(props),{listProps,focused}=(0,_useList__WEBPACK_IMPORTED_MODULE_4__.s)(props,state,ref);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_StyledList__WEBPACK_IMPORTED_MODULE_5__.C,{fillAvailableSpace,...listProps,ref,children:[...state.collection].map((0,_listItemRenderer__WEBPACK_IMPORTED_MODULE_6__.X)({item:item=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_ListItem__WEBPACK_IMPORTED_MODULE_7__.H,{item,state,onAction:()=>onAction?.(item.key),listFocused:alwaysShowAsFocused||focused},item.key)}))})}));try{List.displayName="List",List.__docgenInfo={description:"List view with speedSearch instead of default typeahead.\nTODO:\n - Support virtualization\n - Support custom rendering\n -",displayName:"List",props:{selectionManagerRef:{defaultValue:null,description:"Gives imperative access to selection manager.",name:"selectionManagerRef",required:!1,type:{name:"RefObject<SelectionManager>"}},fillAvailableSpace:{defaultValue:{value:"false"},description:"fills the available horizontal or vertical space, when rendered in a flex container.",name:"fillAvailableSpace",required:!1,type:{name:"boolean"}},alwaysShowAsFocused:{defaultValue:{value:"false"},description:"By default, if list is not focused, it shows a different style on the selected item,\nwhich acts as a visual clue for list's focus state. This behaviour can be suppressed by setting\n`alwaysShowAsFocused` to `true`. One use case is in master-detail views where you don't\nwant the list to appear as blurred, when interacting with the details view of the selected\nlist item. Note that in such use cases, there won't be any visual clue to distinguish focused\nstate of the link, which is not great from UX perspective, but it's kept like this to match\nJetbrains UI behaviour.",name:"alwaysShowAsFocused",required:!1,type:{name:"boolean"}},allowEmptySelection:{defaultValue:{value:"false"},description:"",name:"allowEmptySelection",required:!1,type:{name:"boolean"}},onAction:{defaultValue:null,description:"Called when the action for the item should be triggered, which can be by double click or pressing Enter.\nEnter not implemented yet :D",name:"onAction",required:!1,type:{name:"((key: Key) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/List/List.tsx#List"]={docgenInfo:List.__docgenInfo,name:"List",path:"src/List/List.tsx#List"})}catch(__react_docgen_typescript_loader_error){}},"./src/Menu/ContextMenuContainer.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{X:()=>ContextMenuContainer});var react=__webpack_require__("../../node_modules/react/index.js"),dist_module=__webpack_require__("../../node_modules/@react-aria/utils/dist/module.js"),menu_dist_module=__webpack_require__("../../node_modules/@react-stately/menu/dist/module.js"),overlays_dist_module=__webpack_require__("../../node_modules/@react-aria/overlays/dist/module.js"),useMouseEventOverlayPosition=__webpack_require__("./src/utils/useMouseEventOverlayPosition.tsx"),Overlay=__webpack_require__("./src/Overlay/Overlay.tsx");const useContextMenu=({isDisabled=!1},state)=>{const overlayRef=(0,react.useRef)(null),{overlayProps:positionProps,updatePosition}=(0,useMouseEventOverlayPosition.u)({overlayRef,placement:"bottom start",shouldFlip:!0,offset:-8,isOpen:state.isOpen}),{overlayProps}=(0,overlays_dist_module.Ir)({onClose:()=>state.close(),shouldCloseOnBlur:!1,isOpen:state.isOpen,isKeyboardDismissDisabled:!1,isDismissable:!0,shouldCloseOnInteractOutside:element=>!(0,Overlay.Z)(overlayRef.current,element)},overlayRef);return{containerProps:isDisabled?{}:{onContextMenu:e=>{e.preventDefault(),state.isOpen||state.open(null),updatePosition(e)}},overlayRef,overlayProps:(0,dist_module.dG)(overlayProps,positionProps)}};try{useContextMenu.displayName="useContextMenu",useContextMenu.__docgenInfo={description:"Functionality and accessibility of context menu.",displayName:"useContextMenu",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/Menu/useContextMenu.tsx#useContextMenu"]={docgenInfo:useContextMenu.__docgenInfo,name:"useContextMenu",path:"src/Menu/useContextMenu.tsx#useContextMenu"})}catch(__react_docgen_typescript_loader_error){}var MenuOverlay=__webpack_require__("./src/Menu/MenuOverlay.tsx"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");const ContextMenuContainer=({children,renderMenu,...props})=>{const state=(0,menu_dist_module.W)({}),{overlayProps,containerProps,overlayRef}=useContextMenu({},state),allProps=(0,dist_module.dG)(props,containerProps);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["function"==typeof children?children(allProps):(0,jsx_runtime.jsx)("div",{...allProps,children}),(0,jsx_runtime.jsx)(MenuOverlay.T,{state,overlayRef,overlayProps,restoreFocus:!0,children:renderMenu()})]})};try{ContextMenuContainer.displayName="ContextMenuContainer",ContextMenuContainer.__docgenInfo={description:"A generic container for context menu. It's the same as a normal div, only with an additional `renderMenu` prop,\nto be used to render context menu, when it's triggered.\nCloses the menu when a menu action is triggered.",displayName:"ContextMenuContainer",props:{renderMenu:{defaultValue:null,description:"Will be called to return the Menu when context menu is triggered. Use {@link Menu } component to render a menu.",name:"renderMenu",required:!0,type:{name:"() => ReactNode"}},children:{defaultValue:null,description:"If children is a function, context menu props is passed to it, to be passed to the underlying element.\nOtherwise, a div container will be rendered.",name:"children",required:!0,type:{name:"ReactNode | ((props: HTMLAttributes<HTMLElement>) => ReactNode)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/Menu/ContextMenuContainer.tsx#ContextMenuContainer"]={docgenInfo:ContextMenuContainer.__docgenInfo,name:"ContextMenuContainer",path:"src/Menu/ContextMenuContainer.tsx#ContextMenuContainer"})}catch(__react_docgen_typescript_loader_error){}},"./src/ModalWindow/ModalWindow.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Du:()=>ModalWindow,zj:()=>WindowControllerContext});var react=__webpack_require__("../../node_modules/react/index.js"),dist_module=__webpack_require__("../../node_modules/@react-aria/overlays/dist/module.js"),focus_dist_module=__webpack_require__("../../node_modules/@react-aria/focus/dist/module.js"),dialog_dist_module=__webpack_require__("../../node_modules/@react-aria/dialog/dist/module.js"),styled=__webpack_require__("./src/styled.ts"),style_constants=__webpack_require__("./src/style-constants.ts"),utils_dist_module=__webpack_require__("../../node_modules/@react-aria/utils/dist/module.js"),useResizableMovableOverlay=__webpack_require__("./src/Overlay/useResizableMovableOverlay.tsx"),OverlayInteractionHandler=__webpack_require__("./src/Overlay/OverlayInteractionHandler.tsx"),OverlayResizeHandles=__webpack_require__("./src/Overlay/OverlayResizeHandles.tsx"),WindowContext=__webpack_require__("./src/ModalWindow/WindowContext.ts"),useEventCallback=__webpack_require__("./src/utils/useEventCallback.ts"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");function UNSAFE_React17SuspenseFix({measureContentSize,children}){return react.version.startsWith("17")?(0,jsx_runtime.jsx)(react.Suspense,{fallback:(0,jsx_runtime.jsx)(NullSuspenseFallback,{afterUnsuspended:measureContentSize}),children}):(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children})}function NullSuspenseFallback({afterSuspended:afterSuspendedProp=(()=>{}),afterUnsuspended:afterUnsuspendedProp=(()=>{})}){const afterSuspended=(0,useEventCallback.$)(afterSuspendedProp),afterUnsuspended=(0,useEventCallback.$)(afterUnsuspendedProp);return(0,react.useEffect)((()=>(afterSuspended?.(),()=>{afterUnsuspended?.()})),[]),null}try{UNSAFE_React17SuspenseFix.displayName="UNSAFE_React17SuspenseFix",UNSAFE_React17SuspenseFix.__docgenInfo={description:"A workaround for an issue in measuring overlay size, caused by a limitation/bug in how React 17 runs effects when\nchildren suspend rendering: https://github.com/facebook/react/issues/21510\n\nHere is a simplified demonstration of the issue:\nExpected behavior (React 18): https://codesandbox.io/s/parent-effects-suspense-v18-38m8p7?file=/src/App.tsx\nBroken behavior (React 17): https://codesandbox.io/s/parent-effects-suspense-v17-h39g4g\n\nThe overlay content size measuring runs in an effect, and that effect won't run when the content is rendered after\nsuspense.",displayName:"UNSAFE_React17SuspenseFix",props:{measureContentSize:{defaultValue:null,description:"",name:"measureContentSize",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/Overlay/UNSAFE_React17SuspenseFix.tsx#UNSAFE_React17SuspenseFix"]={docgenInfo:UNSAFE_React17SuspenseFix.__docgenInfo,name:"UNSAFE_React17SuspenseFix",path:"src/Overlay/UNSAFE_React17SuspenseFix.tsx#UNSAFE_React17SuspenseFix"})}catch(__react_docgen_typescript_loader_error){}const StyledWindowUnderlay=styled.zo.div`
  position: fixed;
  z-index: 1000; // FIXME: z-index should not be hard-coded like this
  inset: 0;
`,StyledWindowContainer=styled.zo.div`
  position: fixed;
  // not checked if there should be a better substitute for * in the following colors. Maybe "Component"?
  background-color: ${({theme})=>theme.color("*.background")};
  color: ${({theme})=>theme.color("*.foreground")};
  border-radius: 8px;
  ${style_constants.s}; // FIXME: OS-dependant style?
  outline: 1px solid #555; // FIXME
`,StyledWindowInnerContainer=styled.zo.div`
  height: inherit;
  overflow: hidden;
  display: flex;
  flex-direction: column;
`,WindowControllerContext=react.createContext({}),ModalWindow=({interactions="all",minWidth=50,minHeight=24,...props})=>{const{children}=props,propsContext=(0,react.useContext)(WindowControllerContext),ref=react.useRef(null),{overlayProps,underlayProps}=(0,dist_module.Ir)({isOpen:!0,onClose:()=>{propsContext.onClose?.(),props.onClose?.()},isDismissable:!1,isKeyboardDismissDisabled:!1,shouldCloseOnBlur:!1},ref);(0,dist_module.tk)();const{modalProps}=(0,dist_module.dd)(),{dialogProps,titleProps}=(0,dialog_dist_module.R)(props,ref),{bounds:style,overlayInteractionHandlerProps,UNSAFE_measureContentSize}=(0,useResizableMovableOverlay.t)(ref,{...props,minHeight,minWidth}),{focusContainmentFixProps}=function useFocusContainmentFix(){const lastFocusedElementRef=(0,react.useRef)(null);return{focusContainmentFixProps:{onFocus:e=>{lastFocusedElementRef.current=e.target},onBlur:e=>{const probablyFocusedElement=e.relatedTarget;if(!probablyFocusedElement||probablyFocusedElement instanceof Element&&!e.currentTarget.contains(probablyFocusedElement)){const elementToFocus=lastFocusedElementRef.current;elementToFocus&&(0,focus_dist_module.ex)(elementToFocus)}}}}}();return(0,jsx_runtime.jsx)(StyledWindowUnderlay,{...underlayProps,children:(0,jsx_runtime.jsx)(OverlayInteractionHandler.Z,{...overlayInteractionHandlerProps,children:(0,jsx_runtime.jsx)(focus_dist_module.MT,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,jsx_runtime.jsxs)(StyledWindowContainer,{...(0,utils_dist_module.dG)(overlayProps,dialogProps,modalProps,focusContainmentFixProps,{style}),ref,children:[(0,jsx_runtime.jsx)(StyledWindowInnerContainer,{children:(0,jsx_runtime.jsx)(WindowContext.H.Provider,{value:{isActive:!0,titleProps,movable:"none"!==interactions},children:(0,jsx_runtime.jsx)(UNSAFE_React17SuspenseFix,{measureContentSize:UNSAFE_measureContentSize,children})})}),"all"===interactions&&(0,jsx_runtime.jsx)(OverlayResizeHandles.S,{})]})})})})};ModalWindow.displayName="ModalWindow";try{ModalWindow.displayName="ModalWindow",ModalWindow.__docgenInfo={description:'A movable/resizable modal window. The window header which holds the title, can be used to drag the window around.\nIn the reference impl, modal windows are os-native, and contain os-level buttons for minimize/close/maximise, which\nare not relevant here since they wouldn\'t be os-native windows. A close button is still relevant (and kind of\nnecessary) and will be added in next iterations.\n\nThe content container doesn\'t come with any padding. Other related components should be used for common layouts in\nmodal windows.\nExample use cases: Window for git operations such as push, update, revert, new branch, etc.\n\n![img.png](https://user-images.githubusercontent.com/3150694/181095858-968c5c66-2ae7-4e40-84e3-e6df43cd4aa4.png)\n\nNOTE: The part regarding rendering OverlayInteractionHandler, and rendering as a dialog with a focus scope, in an\noverlay container could be extracted into a component which is then used to create custom resizable/movable overlay\ndialogs, like "Branches", or "Search Everywhere".\n\nTODO: show close button (maybe os-aware styles?)',displayName:"ModalWindow",props:{onClose:{defaultValue:null,description:"",name:"onClose",required:!1,type:{name:"(() => void)"}},onBoundsChange:{defaultValue:null,description:"",name:"onBoundsChange",required:!1,type:{name:'((bounds: Bounds, interactionType: "resize" | "move") => void)'}},onBoundsChanging:{defaultValue:null,description:"For performance reason, overlay bounds is kept in a local state during a resize or move interaction, and\n`onBoundsChange` is called once at the end of interaction. `onBoundsChanging` gives a chance of rectifying\nbounds changes during an interaction to for example apply custom size/placement constraints.",name:"onBoundsChanging",required:!1,type:{name:'((newBounds: Bounds, interactionType: "resize" | "move") => Bounds)'}},bounds:{defaultValue:null,description:"Controlled bounds. Can be a partially specified bounds.\n- If `top` not specified, the returned bounds will be centered vertically.\n- If `left` not specified, the returned bounds will be centered horizontally.\n- If `width` not specified, the width of the bounds will be based on content width.\n- If `height` not specified, the height of the bounds will be based on content height.\nNote that regardless of `bounds`, `onBoundsChange` always receives a full `bounds` object which is solely\nbased on the bounds of the overlay, at the end of an interaction.",name:"bounds",required:!1,type:{name:"Partial<Bounds>"}},defaultBounds:{defaultValue:null,description:"Default bounds in uncontrolled mode. Can be a partially specified bounds.\n- If `top` not specified, the returned bounds will be centered vertically.\n- If `left` not specified, the returned bounds will be centered horizontally.\n- If `width` not specified, the width of the bounds will be based on content width.\n- If `height` not specified, the height of the bounds will be based on content height.\nNote that regardless of `defaultBounds`, `onBoundsChange` always receives a full `bounds` object which is solely\nbased on the bounds of the overlay, at the end of an interaction.",name:"defaultBounds",required:!1,type:{name:"Partial<Bounds>"}},minWidth:{defaultValue:{value:"50"},description:"",name:"minWidth",required:!1,type:{name:'number | "content"'}},minHeight:{defaultValue:{value:"24"},description:"",name:"minHeight",required:!1,type:{name:'number | "content"'}},interactions:{defaultValue:{value:"all"},description:'Allowed interactions:\n- "all": both resizable and movable\n- "move": movable, but not resizable\n- "none": fixed size and position\nThe reason there are no `resizable` and `movable` boolean props is that resizable=true,movable=false doesn\'t make\nsense from UX perspective.',name:"interactions",required:!1,type:{name:"enum",value:[{value:'"none"'},{value:'"all"'},{value:'"move"'}]}},observeContentResize:{defaultValue:null,description:"When the size is not specified by `bounds` or `defaultBounds` props, the content size is measured and used in the\nreturned bounds. By default, the content size is measured initially. If `observeContentSize` is true, the DOM\nmutations will be observed and the content is re-measured as changes are observed.",name:"observeContentResize",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ModalWindow/ModalWindow.tsx#ModalWindow"]={docgenInfo:ModalWindow.__docgenInfo,name:"ModalWindow",path:"src/ModalWindow/ModalWindow.tsx#ModalWindow"})}catch(__react_docgen_typescript_loader_error){}},"./src/ModalWindow/WindowContext.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>WindowContext});const WindowContext=__webpack_require__("../../node_modules/react/index.js").createContext({isActive:!1,movable:!0,titleProps:{}})},"./src/ModalWindow/WindowLayout.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{b:()=>WindowLayout});var styled=__webpack_require__("./src/styled.ts"),react=__webpack_require__("../../node_modules/react/index.js"),OverlayMoveHandle=__webpack_require__("./src/Overlay/OverlayMoveHandle.tsx"),WindowContext=__webpack_require__("./src/ModalWindow/WindowContext.ts"),dist_module=__webpack_require__("../../node_modules/@react-aria/utils/dist/module.js"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");const StyledWindowTitle=styled.zo.h1`
  margin: 0;
  text-align: center;
  font-size: 13px; // not rem! intentional
  line-height: 20px;
  cursor: default;
  user-select: none;
  padding: 0 8px;
`,WindowHeader=({children})=>{const{movable,titleProps}=(0,react.useContext)(WindowContext.H),renderTitle=(otherProps={})=>(0,jsx_runtime.jsx)(StyledWindowTitle,{...(0,dist_module.dG)(titleProps,otherProps),children:children||(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:""})});return movable?(0,jsx_runtime.jsx)(OverlayMoveHandle.F,{children:({moveHandleProps})=>renderTitle(moveHandleProps)}):renderTitle()};try{WindowHeader.displayName="WindowHeader",WindowHeader.__docgenInfo={description:"Implements appearance of Window header, and also acts as a handle for moving the window.\nExpected to be used with {@link WindowLayout }:",displayName:"WindowHeader",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ModalWindow/WindowHeader.tsx#WindowHeader"]={docgenInfo:WindowHeader.__docgenInfo,name:"WindowHeader",path:"src/ModalWindow/WindowHeader.tsx#WindowHeader"})}catch(__react_docgen_typescript_loader_error){}const StyledFooter=styled.zo.div`
  padding: 0.625rem 0.875rem;
  display: flex;
  gap: 0.5rem;
  justify-content: space-between;
  align-items: center;
  border-top: 1px solid transparent;
  border-color: ${({hasBorder,theme})=>hasBorder&&theme.commonColors.contrastBorder};
`,StyledFooterSide=styled.zo.div`
  display: flex;
  gap: 0.75rem;
`;function WindowFooter({left,right,hasBorder}){return(0,jsx_runtime.jsxs)(StyledFooter,{hasBorder,children:[(0,jsx_runtime.jsx)(StyledFooterSide,{children:left}),(0,jsx_runtime.jsx)(StyledFooterSide,{children:right})]})}WindowFooter.displayName="WindowFooter";try{WindowFooter.displayName="WindowFooter",WindowFooter.__docgenInfo={description:"Implements the common layout for window footer, to be used in {@link ModalWindowProps#footer }.\nFooter has a left and a right side. There is a standard gap between the children of each side.",displayName:"WindowFooter",props:{left:{defaultValue:null,description:"The content to go to the left side the footer. A help icon button is very common on the left side.",name:"left",required:!1,type:{name:"ReactNode"}},right:{defaultValue:null,description:"The content to go to the right side the footer. {@link Button }s are usually used inside the right content",name:"right",required:!1,type:{name:"ReactNode"}},hasBorder:{defaultValue:null,description:"Whether to show top border for footer or not",name:"hasBorder",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ModalWindow/WindowFooter.tsx#WindowFooter"]={docgenInfo:WindowFooter.__docgenInfo,name:"WindowFooter",path:"src/ModalWindow/WindowFooter.tsx#WindowFooter"})}catch(__react_docgen_typescript_loader_error){}const StyledWindowFooter=styled.zo.div`
  min-height: min-content;
`,StyledWindowContentWrapper=styled.zo.div`
  overflow: auto;
  flex: 1;
`;function WindowLayout({header,footer,content}){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[header&&("string"==typeof header?(0,jsx_runtime.jsx)(WindowHeader,{children:header}):header),(0,jsx_runtime.jsx)(StyledWindowContentWrapper,{children:content}),footer&&(0,jsx_runtime.jsx)(StyledWindowFooter,{children:footer})]})}WindowLayout.Footer=WindowFooter,WindowLayout.Header=WindowHeader;try{WindowLayout.displayName="WindowLayout",WindowLayout.__docgenInfo={description:"Window content layout, supporting fixed `header` and `footer` sections, and a scrollable `content` area.",displayName:"WindowLayout",props:{header:{defaultValue:null,description:"Fixed position header of the window at the top. Use {@link WindowLayout.Header} for the default window header,\nwhich also acts as a move handle for the window. If a string is passed, it will be wrapped by\n{@link WindowLayout.Header} automatically.",name:"header",required:!0,type:{name:"ReactNode"}},content:{defaultValue:null,description:"Scrollable content of the window.",name:"content",required:!0,type:{name:"ReactNode"}},footer:{defaultValue:null,description:"An area at the bottom of the window which is not scrolled as opposed to `content`. Use {@link WindowLayout.Footer}\nfor rendering the common layout of a window footer.",name:"footer",required:!1,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ModalWindow/WindowLayout.tsx#WindowLayout"]={docgenInfo:WindowLayout.__docgenInfo,name:"WindowLayout",path:"src/ModalWindow/WindowLayout.tsx#WindowLayout"})}catch(__react_docgen_typescript_loader_error){}try{Footer.displayName="WindowLayout.Footer",Footer.__docgenInfo={description:"Implements the common layout for window footer, to be used in {@link ModalWindowProps#footer }.\nFooter has a left and a right side. There is a standard gap between the children of each side.",displayName:"WindowLayout.Footer",props:{left:{defaultValue:null,description:"The content to go to the left side the footer. A help icon button is very common on the left side.",name:"left",required:!1,type:{name:"ReactNode"}},right:{defaultValue:null,description:"The content to go to the right side the footer. {@link Button }s are usually used inside the right content",name:"right",required:!1,type:{name:"ReactNode"}},hasBorder:{defaultValue:null,description:"Whether to show top border for footer or not",name:"hasBorder",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ModalWindow/WindowLayout.tsx#WindowLayout.Footer"]={docgenInfo:WindowLayout.Footer.__docgenInfo,name:"WindowLayout.Footer",path:"src/ModalWindow/WindowLayout.tsx#WindowLayout.Footer"})}catch(__react_docgen_typescript_loader_error){}try{Header.displayName="WindowLayout.Header",Header.__docgenInfo={description:"Implements appearance of Window header, and also acts as a handle for moving the window.\nExpected to be used with {@link WindowLayout }:",displayName:"WindowLayout.Header",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ModalWindow/WindowLayout.tsx#WindowLayout.Header"]={docgenInfo:WindowLayout.Header.__docgenInfo,name:"WindowLayout.Header",path:"src/ModalWindow/WindowLayout.tsx#WindowLayout.Header"})}catch(__react_docgen_typescript_loader_error){}},"./src/Popup/PopupTrigger.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{q:()=>PopupTrigger});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/index.js"),_react_aria_overlays__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../node_modules/@react-aria/overlays/dist/module.js"),_react_aria_interactions__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../node_modules/@react-aria/interactions/dist/module.js"),_react_aria_utils__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../node_modules/@react-aria/utils/dist/module.js"),_react_stately_overlays__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../node_modules/@react-stately/overlays/dist/module.js"),_PopupContext__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/Popup/PopupContext.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/jsx-runtime.js");const PopupTrigger=react__WEBPACK_IMPORTED_MODULE_0__.forwardRef((function PopupTrigger({placement,children,popup,...props},forwardedRef){const state=(0,_react_stately_overlays__WEBPACK_IMPORTED_MODULE_2__.d)(props),triggerRef=(0,_react_aria_utils__WEBPACK_IMPORTED_MODULE_3__.B3)(forwardedRef),{overlayProps,triggerProps}=(0,_react_aria_overlays__WEBPACK_IMPORTED_MODULE_4__.IB)({type:props.type||"menu"},state,triggerRef);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_react_aria_interactions__WEBPACK_IMPORTED_MODULE_5__.NL,{ref:triggerRef,...triggerProps,children}),state.isOpen&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_PopupContext__WEBPACK_IMPORTED_MODULE_6__.V.Provider,{value:{overlayProps,positioning:{targetRef:triggerRef,placement},onClose:state.close},children:"function"==typeof popup?popup({close:state.close}):popup})]})}));try{PopupTrigger.displayName="PopupTrigger",PopupTrigger.__docgenInfo={description:"Popup opened by a trigger. `trigger` can be an element of any pressable component (such as {@link Button } or\n{@link IconButton }), and is rendered in place. Similar to {@link Popup component}, `children` defines the content\nof Popup.",displayName:"PopupTrigger",props:{placement:{defaultValue:null,description:"",name:"placement",required:!1,type:{name:"enum",value:[{value:'"top"'},{value:'"bottom"'}]}},popup:{defaultValue:null,description:"",name:"popup",required:!0,type:{name:"ReactElement<any, string | JSXElementConstructor<any>> | (({ close }: { close: () => void; }) => ReactNode)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/Popup/PopupTrigger.tsx#PopupTrigger"]={docgenInfo:PopupTrigger.__docgenInfo,name:"PopupTrigger",path:"src/Popup/PopupTrigger.tsx#PopupTrigger"})}catch(__react_docgen_typescript_loader_error){}},"./src/ProgressBar/ProgressBarStopButton.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{b:()=>ProgressBarStopButton});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/index.js"),_intellij_platform_core_Icon__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/Icon/AutoHoverPlatformIcon.tsx"),_ProgressBar__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/ProgressBar/ProgressBar.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/jsx-runtime.js");const ProgressBarStopButton=({small,onPress})=>{const ref=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),{buttonProps}=(0,_ProgressBar__WEBPACK_IMPORTED_MODULE_2__.th)({onPress,hoverTooltip:"Cancel"},ref);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_intellij_platform_core_Icon__WEBPACK_IMPORTED_MODULE_3__.v,{ref,...buttonProps,icon:`process/stop${small?"Small":""}.svg`,hoverIcon:`process/stop${small?"Small":""}Hovered.svg`})};ProgressBarStopButton.displayName="ProgressBarStopButton";try{ProgressBarStopButton.displayName="ProgressBarStopButton",ProgressBarStopButton.__docgenInfo={description:"Stop (cancel) icon button for progress bar, to be used in {@link ProgressBarProps#button }.",displayName:"ProgressBarStopButton",props:{small:{defaultValue:null,description:"whether small icon should be used.",name:"small",required:!1,type:{name:"boolean"}},onPress:{defaultValue:null,description:"",name:"onPress",required:!0,type:{name:"() => void"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ProgressBar/ProgressBarStopButton.tsx#ProgressBarStopButton"]={docgenInfo:ProgressBarStopButton.__docgenInfo,name:"ProgressBarStopButton",path:"src/ProgressBar/ProgressBarStopButton.tsx#ProgressBarStopButton"})}catch(__react_docgen_typescript_loader_error){}},"./src/Tabs/EditorTabs/EditorTabContent.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{X:()=>EditorTabContent});__webpack_require__("../../node_modules/react/index.js");var _intellij_platform_core_Icon__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/Icon/PlatformIcon.tsx"),_intellij_platform_core_Tabs_TabContentLayout__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/Tabs/TabContentLayout.tsx"),_intellij_platform_core_Tooltip__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/Tooltip/TooltipTrigger.tsx"),_intellij_platform_core_Tooltip__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/Tooltip/ActionTooltip.tsx"),_intellij_platform_core_Button__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/Button/BareButton.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/jsx-runtime.js");const EditorTabContent=({icon,title,closeButton,onUnpin,pinned,containerProps})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_intellij_platform_core_Tabs_TabContentLayout__WEBPACK_IMPORTED_MODULE_2__.X,{startIcon:icon,title,containerProps,endIcon:pinned?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_intellij_platform_core_Tooltip__WEBPACK_IMPORTED_MODULE_3__.a,{tooltip:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_intellij_platform_core_Tooltip__WEBPACK_IMPORTED_MODULE_4__.M,{actionName:"Unpin Tab"}),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_intellij_platform_core_Button__WEBPACK_IMPORTED_MODULE_5__.V,{onPress:onUnpin,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_intellij_platform_core_Icon__WEBPACK_IMPORTED_MODULE_6__.vq,{icon:"actions/pinTab"})})}):closeButton});EditorTabContent.displayName="EditorTabContent";try{EditorTabContent.displayName="EditorTabContent",EditorTabContent.__docgenInfo={description:"For rendering the content of Editor tabs. supports for file icon which is shown on the left and close or unpin\nbutton shown on the right.",displayName:"EditorTabContent",props:{icon:{defaultValue:null,description:"",name:"icon",required:!0,type:{name:"ReactNode"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"ReactNode"}},closeButton:{defaultValue:null,description:'Close button, shown in place of "pin" button if not pinned. Use {@link TabCloseButton} to render the close button\nfor the tab.\n@example ```tsx\n<EditorTabContent\n  closeButton={\n    <TooltipTrigger\n      tooltip={<ActionTooltip actionName="Close Tab" shortcut="^F4" />}\n    >\n      <TabCloseButton onPress={}></TabCloseButton>\n    </TooltipTrigger>\n  }\n/>\n```',name:"closeButton",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},onUnpin:{defaultValue:null,description:"",name:"onUnpin",required:!1,type:{name:"(() => void)"}},pinned:{defaultValue:null,description:"",name:"pinned",required:!1,type:{name:"boolean"}},containerProps:{defaultValue:null,description:"",name:"containerProps",required:!1,type:{name:'Omit<HTMLProps<HTMLDivElement>, "as" | "ref">'}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/Tabs/EditorTabs/EditorTabContent.tsx#EditorTabContent"]={docgenInfo:EditorTabContent.__docgenInfo,name:"EditorTabContent",path:"src/Tabs/EditorTabs/EditorTabContent.tsx#EditorTabContent"})}catch(__react_docgen_typescript_loader_error){}},"./src/Tabs/EditorTabs/EditorTabs.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{s:()=>EditorTabs});var _intellij_platform_core_Tabs_Tabs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/Tabs/Tabs.tsx"),_StyledEditorTab__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/Tabs/EditorTabs/StyledEditorTab.ts"),_StyledEditorTabs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/Tabs/EditorTabs/StyledEditorTabs.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=(__webpack_require__("../../node_modules/react/index.js"),__webpack_require__("../../node_modules/react/jsx-runtime.js"));const EditorTabs=props=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_intellij_platform_core_Tabs_Tabs__WEBPACK_IMPORTED_MODULE_2__.m,{...props,TabComponent:_StyledEditorTab__WEBPACK_IMPORTED_MODULE_3__.o,TabsComponent:_StyledEditorTabs__WEBPACK_IMPORTED_MODULE_4__.p,focusable:!1});EditorTabs.displayName="EditorTabs";try{EditorTabs.displayName="EditorTabs",EditorTabs.__docgenInfo={description:"",displayName:"EditorTabs",props:{active:{defaultValue:null,description:'Enables "active" style on tabs. Is usually related to a container having focus.',name:"active",required:!1,type:{name:"boolean"}},noBorders:{defaultValue:{value:"false"},description:"Removes the top and bottom border when passed.\nIt's still not clear whether such option makes sense or not, but\nat least in common use cases like in tool windows, it seems borders are already there and there should be a way\nof removing tab borders. On the other hand, when Tabs is used without any assumption about the surrounding UI,\nit kind of makes sense to have the top and bottom borders by default. So that's why this is made an option for\nnow, maybe until things are clearer.",name:"noBorders",required:!1,type:{name:"boolean"}},multiRow:{defaultValue:{value:"false"},description:"If set to true, tabs will be wrapped into multiple rows if needed.\nNOTE: In the original implementation, in multi row mode, rows are separated by a border. It's not easy to achieve\nthis when we are implementing this feature with a simple `flex-wrap: wrap` css rule. It doesn't seem that\nimportant, but we can achieve something similar by some css tricks like the ones suggested here:\nhttps://stackoverflow.com/questions/36128333/row-lines-for-flex-container-css",name:"multiRow",required:!1,type:{name:"boolean"}},noOverflowMenu:{defaultValue:null,description:"Only effective when {@link multiRow } is not true.\nWhen set to true, tabs that couldn't be fitted into the available space, are either shrunk (if {@link noScroll }\nis set to true), or are just accessible by scroll.",name:"noOverflowMenu",required:!1,type:{name:"boolean"}},noScroll:{defaultValue:{value:"false"},description:"Only effective when {@link multiRow } is not true.\nIf set to true and multiRow is not true, it will prevent horizontal scroll of tabs. Depending on the value of\nIn this case:\n- if {@link noOverflowMenu } is not set to true, tabs that can't be fitted into the available space will be\n  accessible via an overflow menu.\n- if {@link noOverflowMenu } is set to true, the tabs will be fitted into the available space, and they will\n  be shrunk when needed.\n@todo : not implemented yet.",name:"noScroll",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/Tabs/EditorTabs/EditorTabs.tsx#EditorTabs"]={docgenInfo:EditorTabs.__docgenInfo,name:"EditorTabs",path:"src/Tabs/EditorTabs/EditorTabs.tsx#EditorTabs"})}catch(__react_docgen_typescript_loader_error){}},"./src/ToolWindowsImpl/DefaultToolWindows.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{u:()=>DefaultToolWindows});var react=__webpack_require__("../../node_modules/react/index.js"),indexBy=__webpack_require__("../../node_modules/ramda/es/indexBy.js"),dist_module=__webpack_require__("../../node_modules/@react-aria/utils/dist/module.js"),ToolWindows=__webpack_require__("./src/ToolWindows/ToolWindows.tsx"),ToolWindowsState=__webpack_require__("./src/ToolWindows/ToolWindowsState/ToolWindowsState.ts"),ToolWindowActionIds=__webpack_require__("./src/ToolWindowsImpl/ToolWindowActionIds.ts");const getActivateToolWindowActionId=id=>`Activate${id.replace(" ","")}Window`;function useToolWindowsActions({toolWindowsState,toolWindowsRef,getPresentation}){const isAnySideWindowWindowOpen=state=>Object.values(state.windows).some((({isVisible,viewMode})=>isVisible&&"float"!==(0,ToolWindowsState.Qy)(viewMode)));return[...Object.keys(toolWindowsState.windows).map((key=>`${key}`)).map(((id,index)=>{const{title,icon}=getPresentation?.(id)||{};return{id:getActivateToolWindowActionId(id),title:title||`${getOrdinal(index)} window`,icon,description:`Activate ${title||getOrdinal(index)} window`,actionPerformed:()=>{toolWindowsState.windows[id]?.isVisible&&!toolWindowsRef.current?.hasFocus(id)?toolWindowsRef.current?.focus(id):toolWindowsRef.current?.changeState((state=>state.toggle(id)))}}})),{id:ToolWindowActionIds.xm,title:isAnySideWindowWindowOpen(toolWindowsState)?"Hide All Windows":"Restore windows",actionPerformed:()=>{toolWindowsRef.current?.changeState((state=>isAnySideWindowWindowOpen(state)?state.hideAll():state.restoreWindows())),setTimeout((()=>{toolWindowsRef.current?.focusMainContent()}))}},{id:ToolWindowActionIds.Dw,title:"Jump to Last Tool Window",isDisabled:null==toolWindowsState.lastFocusedKey,actionPerformed:()=>{toolWindowsRef.current?.focusLastActiveWindow()}}]}function getOrdinal(n){let ord=["st","nd","rd"];return n+(null==ord[n%10-1]||[11,12,13].includes(n%100)?"th":ord[n%10-1])}try{useToolWindowsActions.displayName="useToolWindowsActions",useToolWindowsActions.__docgenInfo={description:"Provides default tool windows actions:\n- Hide all tool windows\n- Activate{id}Window action for each window\n- Jump to last tool window",displayName:"useToolWindowsActions",props:{toolWindowsState:{defaultValue:null,description:"",name:"toolWindowsState",required:!0,type:{name:"Readonly<ToolWindowsState>"}},toolWindowsRef:{defaultValue:null,description:"",name:"toolWindowsRef",required:!0,type:{name:"RefObject<ToolWindowRefValue>"}},getPresentation:{defaultValue:null,description:"Used when creating ActivateToolWindow action for each tool window.",name:"getPresentation",required:!1,type:{name:"((key: Key) => { title: string; icon: ReactNode; })"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ToolWindowsImpl/useToolWindowsActions.tsx#useToolWindowsActions"]={docgenInfo:useToolWindowsActions.__docgenInfo,name:"useToolWindowsActions",path:"src/ToolWindowsImpl/useToolWindowsActions.tsx#useToolWindowsActions"})}catch(__react_docgen_typescript_loader_error){}try{getActivateToolWindowActionId.displayName="getActivateToolWindowActionId",getActivateToolWindowActionId.__docgenInfo={description:"",displayName:"getActivateToolWindowActionId",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ToolWindowsImpl/useToolWindowsActions.tsx#getActivateToolWindowActionId"]={docgenInfo:getActivateToolWindowActionId.__docgenInfo,name:"getActivateToolWindowActionId",path:"src/ToolWindowsImpl/useToolWindowsActions.tsx#getActivateToolWindowActionId"})}catch(__react_docgen_typescript_loader_error){}var ActionsProvider=__webpack_require__("./src/ActionSystem/ActionsProvider.tsx"),TooltipTrigger=__webpack_require__("./src/Tooltip/TooltipTrigger.tsx"),ActionTooltip=__webpack_require__("./src/Tooltip/ActionTooltip.tsx"),jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js");const getToolWindowNumberFromShortcut=shortcut=>{const num="keyboard"===shortcut.type&&1===shortcut.firstKeyStroke.modifiers?.length&&["Alt","Meta","Control"].includes(shortcut.firstKeyStroke.modifiers[0])&&shortcut.firstKeyStroke.code.match(/^(Digit|Numpad)([0-9])$/)?.[2];return num?parseInt(num):null},DefaultToolWindowToolbarButton=({id,title,icon,showNumber=!0})=>{const action=(0,ActionsProvider.BH)(getActivateToolWindowActionId(`${id}`)),number=action?.shortcuts?.map(getToolWindowNumberFromShortcut).find(Number.isInteger);return(0,jsx_runtime.jsx)(TooltipTrigger.a,{tooltip:(0,jsx_runtime.jsx)(ActionTooltip.M,{actionName:title,shortcut:action?.shortcut}),children:(0,jsx_runtime.jsxs)("span",{children:[icon,"",null!=number&&showNumber?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("u",{children:number}),":"]}):null,title]})})};DefaultToolWindowToolbarButton.displayName="DefaultToolWindowToolbarButton";try{DefaultToolWindowToolbarButton.displayName="DefaultToolWindowToolbarButton",DefaultToolWindowToolbarButton.__docgenInfo={description:"Default UI for the toolbar button (aka. stripe button) of the tool window.\n- Renders the title and icon for the tool window\n- Optionally shows the number before the title, if a numeric shortcut is set for the corresponding ActivateToolWindow\n  action, in the currently applied keymap.\n- Adds an Action Tooltip",displayName:"DefaultToolWindowToolbarButton",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"Key"}},title:{defaultValue:null,description:"",name:"title",required:!0,type:{name:"string"}},icon:{defaultValue:null,description:"",name:"icon",required:!0,type:{name:"ReactNode"}},showNumber:{defaultValue:{value:"true"},description:"",name:"showNumber",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ToolWindowsImpl/DefaultToolWindowToolbarButton.tsx#DefaultToolWindowToolbarButton"]={docgenInfo:DefaultToolWindowToolbarButton.__docgenInfo,name:"DefaultToolWindowToolbarButton",path:"src/ToolWindowsImpl/DefaultToolWindowToolbarButton.tsx#DefaultToolWindowToolbarButton"})}catch(__react_docgen_typescript_loader_error){}const DefaultToolWindows=react.forwardRef((function DefaultToolWindows({windows:toolWindows,toolWindowsState,showNumbers,...props},forwardedRef){const toolWindowsRef=(0,dist_module.B3)(forwardedRef),windowById=(0,indexBy.Z)((({id})=>id),toolWindows),actions=useToolWindowsActions({toolWindowsRef,toolWindowsState,getPresentation:id=>windowById[id]});return(0,jsx_runtime.jsx)(ActionsProvider.DG,{actions,children:({shortcutHandlerProps})=>(0,jsx_runtime.jsx)(ToolWindows.n,{...props,ref:toolWindowsRef,toolWindowsState,windows:toolWindows.map((({id,icon,content,title})=>({id,toolbarButton:(0,jsx_runtime.jsx)(DefaultToolWindowToolbarButton,{id,icon,title,showNumber:showNumbers}),content}))),containerProps:(0,dist_module.dG)(props.containerProps||{},shortcutHandlerProps)})})}));try{DefaultToolWindows.displayName="DefaultToolWindows",DefaultToolWindows.__docgenInfo={description:"A wrapper around ToolWindows, which provides default actions. It also expects windows to have a `title` and an `icon`\ninstead of more generic `toolbarButton`. The `title` and `icon` are then used in toolbar button, and also in the\nactions that are dynamically created for each window to toggle/focus the tool window.",displayName:"DefaultToolWindows",props:{height:{defaultValue:null,description:"",name:"height",required:!1,type:{name:"Height<string | number>"}},containerProps:{defaultValue:null,description:"props to be passed to the container element.",name:"containerProps",required:!1,type:{name:'Omit<HTMLProps<HTMLDivElement>, "as">'}},minHeight:{defaultValue:null,description:"",name:"minHeight",required:!1,type:{name:"MinHeight<string | number>"}},margin:{defaultValue:null,description:"",name:"margin",required:!1,type:{name:"Margin<string | number>"}},hideToolWindowBars:{defaultValue:null,description:"Whether stripe buttons should be hidden or not.\n`hideToolStripes` UISettings in Intellij Platform",name:"hideToolWindowBars",required:!1,type:{name:"boolean"}},useWidescreenLayout:{defaultValue:null,description:"`wideScreenSupport` in UISettings in Intellij Platform",name:"useWidescreenLayout",required:!1,type:{name:"boolean"}},toolWindowsState:{defaultValue:null,description:"",name:"toolWindowsState",required:!0,type:{name:"Readonly<ToolWindowsState>"}},onToolWindowStateChange:{defaultValue:null,description:"",name:"onToolWindowStateChange",required:!0,type:{name:"(newState: ToolWindowsState) => void"}},mainContentMinWidth:{defaultValue:{value:"50"},description:"min width applied to the main content (children).",name:"mainContentMinWidth",required:!1,type:{name:"number"}},windows:{defaultValue:null,description:"",name:"windows",required:!0,type:{name:"DefaultToolWindow[]"}},showNumbers:{defaultValue:null,description:"",name:"showNumbers",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/ToolWindowsImpl/DefaultToolWindows.tsx#DefaultToolWindows"]={docgenInfo:DefaultToolWindows.__docgenInfo,name:"DefaultToolWindows",path:"src/ToolWindowsImpl/DefaultToolWindows.tsx#DefaultToolWindows"})}catch(__react_docgen_typescript_loader_error){}},"./src/TreeActions/useTreeActions.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{x:()=>useTreeActions});__webpack_require__("../../node_modules/react/index.js");var _intellij_platform_core_ActionSystem__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/ActionSystem/CommonActionIds.ts"),_intellij_platform_core_Icon__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/Icon/PlatformIcon.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/react/jsx-runtime.js");function useTreeActions({treeRef}){return[{id:_intellij_platform_core_ActionSystem__WEBPACK_IMPORTED_MODULE_2__.$.EXPAND_ALL,title:"Expand All",icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_intellij_platform_core_Icon__WEBPACK_IMPORTED_MODULE_3__.vq,{icon:"actions/expandall"}),actionPerformed:()=>{treeRef.current?.expandAll()}},{id:_intellij_platform_core_ActionSystem__WEBPACK_IMPORTED_MODULE_2__.$.COLLAPSE_ALL,title:"Collapse All",icon:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(_intellij_platform_core_Icon__WEBPACK_IMPORTED_MODULE_3__.vq,{icon:"actions/collapseall"}),actionPerformed:()=>{treeRef.current?.collapseAll()}},{id:_intellij_platform_core_ActionSystem__WEBPACK_IMPORTED_MODULE_2__.$.EXPAND_SELECTION,title:"Expand Selection",actionPerformed:()=>{treeRef.current?.expandSelection()}},{id:_intellij_platform_core_ActionSystem__WEBPACK_IMPORTED_MODULE_2__.$.SHRINK_SELECTION,title:"Shrink Selection",actionPerformed:()=>{treeRef.current?.shrinkSelection()}}]}try{useTreeActions.displayName="useTreeActions",useTreeActions.__docgenInfo={description:"Returns action definitions object for common tree actions\nTODO: add example in docs",displayName:"useTreeActions",props:{treeRef:{defaultValue:null,description:"",name:"treeRef",required:!0,type:{name:"RefObject<TreeRefValue>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/TreeActions/useTreeActions.tsx#useTreeActions"]={docgenInfo:useTreeActions.__docgenInfo,name:"useTreeActions",path:"src/TreeActions/useTreeActions.tsx#useTreeActions"})}catch(__react_docgen_typescript_loader_error){}},"./src/story-helpers.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{q:()=>styledComponentsControlsExclude});const styledComponentsControlsExclude=["theme","as","forwardedAs","ref"]},"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAAHUlEQVQYV2PYvXu3JAi7uLiAMaYAjAGTQBPYLQkAa/0Zef3qRswAAAAASUVORK5CYII=":module=>{module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAAHUlEQVQYV2PYvXu3JAi7uLiAMaYAjAGTQBPYLQkAa/0Zef3qRswAAAAASUVORK5CYII="},"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAL0lEQVQoz2NgCD3x//9/BhBYBWdhgFVAiVW4JBFKGIa4AqD0//9D3pt4I4tAdAMAHTQ/j5Zom30AAAAASUVORK5CYII=":module=>{module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAL0lEQVQoz2NgCD3x//9/BhBYBWdhgFVAiVW4JBFKGIa4AqD0//9D3pt4I4tAdAMAHTQ/j5Zom30AAAAASUVORK5CYII="},"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAAz0lEQVRIx2NgYGBY/R8I/vx5eelX3n82IJ9FxGf6tksvf/8FiTMQAcAGQMDvSwu09abffY8QYSAScNk45G198eX//yev73/4///701eh//kZSARckrNBRvz//+8+6ZohwCzjGNjdgQxkAg7B9WADeBjIBqtJCbhRA0YNoIkBSNmaPEMoNmA0FkYNoFKhapJ6FGyAH3nauaSmPfwI0v/3OukVi0CIZ+F25KrtYcx/CTIy0e+rC7R1Z4KMICVTQQ14feVXIbR695u14+Ir4gwAAD49E54wc1kWAAAAAElFTkSuQmCC":module=>{module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAAz0lEQVRIx2NgYGBY/R8I/vx5eelX3n82IJ9FxGf6tksvf/8FiTMQAcAGQMDvSwu09abffY8QYSAScNk45G198eX//yev73/4///701eh//kZSARckrNBRvz//+8+6ZohwCzjGNjdgQxkAg7B9WADeBjIBqtJCbhRA0YNoIkBSNmaPEMoNmA0FkYNoFKhapJ6FGyAH3nauaSmPfwI0v/3OukVi0CIZ+F25KrtYcx/CTIy0e+rC7R1Z4KMICVTQQ14feVXIbR695u14+Ir4gwAAD49E54wc1kWAAAAAElFTkSuQmCC"},"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTMiIGhlaWdodD0iMzYiIHZpZXdCb3g9IjAgMCA1MyAzNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMCkiPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00OC4wMzY0IDQuMDEwNDJINC4wMDc3OUw0LjAwNzc5IDMyLjAyODZINDguMDM2NFY0LjAxMDQyWk00LjAwNzc5IDAuMDA3ODEyNUMxLjc5NzIxIDAuMDA3ODEyNSAwLjAwNTE4Nzk5IDEuNzk5ODQgMC4wMDUxODc5OSA0LjAxMDQyVjMyLjAyODZDMC4wMDUxODc5OSAzNC4yMzkyIDEuNzk3MjEgMzYuMDMxMiA0LjAwNzc5IDM2LjAzMTJINDguMDM2NEM1MC4yNDcgMzYuMDMxMiA1Mi4wMzkgMzQuMjM5MiA1Mi4wMzkgMzIuMDI4NlY0LjAxMDQyQzUyLjAzOSAxLjc5OTg0IDUwLjI0NyAwLjAwNzgxMjUgNDguMDM2NCAwLjAwNzgxMjVINC4wMDc3OVpNOC4wMTA0MiA4LjAxMzAySDEyLjAxM1YxMi4wMTU2SDguMDEwNDJWOC4wMTMwMlpNMjAuMDE4MiA4LjAxMzAySDE2LjAxNTZWMTIuMDE1NkgyMC4wMTgyVjguMDEzMDJaTTI0LjAyMDggOC4wMTMwMkgyOC4wMjM0VjEyLjAxNTZIMjQuMDIwOFY4LjAxMzAyWk0zNi4wMjg2IDguMDEzMDJIMzIuMDI2VjEyLjAxNTZIMzYuMDI4NlY4LjAxMzAyWk00MC4wMzEyIDguMDEzMDJINDQuMDMzOVYxMi4wMTU2SDQwLjAzMTJWOC4wMTMwMlpNMTYuMDE1NiAxNi4wMTgySDguMDEwNDJWMjAuMDIwOEgxNi4wMTU2VjE2LjAxODJaTTIwLjAxODIgMTYuMDE4MkgyNC4wMjA4VjIwLjAyMDhIMjAuMDE4MlYxNi4wMTgyWk0zMi4wMjYgMTYuMDE4MkgyOC4wMjM0VjIwLjAyMDhIMzIuMDI2VjE2LjAxODJaTTQ0LjAzMzkgMTYuMDE4MlYyMC4wMjA4SDM2LjAyODZWMTYuMDE4Mkg0NC4wMzM5Wk0xMi4wMTMgMjQuMDIzNEg4LjAxMDQyVjI4LjAyNkgxMi4wMTNWMjQuMDIzNFpNMTYuMDE1NiAyNC4wMjM0SDM2LjAyODZWMjguMDI2SDE2LjAxNTZWMjQuMDIzNFpNNDQuMDMzOSAyNC4wMjM0SDQwLjAzMTJWMjguMDI2SDQ0LjAzMzlWMjQuMDIzNFoiIGZpbGw9IiM0MjQyNDIiLz4NCjwvZz4NCjxkZWZzPg0KPGNsaXBQYXRoIGlkPSJjbGlwMCI+DQo8cmVjdCB3aWR0aD0iNTMiIGhlaWdodD0iMzYiIGZpbGw9IndoaXRlIi8+DQo8L2NsaXBQYXRoPg0KPC9kZWZzPg0KPC9zdmc+DQo=":module=>{module.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTMiIGhlaWdodD0iMzYiIHZpZXdCb3g9IjAgMCA1MyAzNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMCkiPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00OC4wMzY0IDQuMDEwNDJINC4wMDc3OUw0LjAwNzc5IDMyLjAyODZINDguMDM2NFY0LjAxMDQyWk00LjAwNzc5IDAuMDA3ODEyNUMxLjc5NzIxIDAuMDA3ODEyNSAwLjAwNTE4Nzk5IDEuNzk5ODQgMC4wMDUxODc5OSA0LjAxMDQyVjMyLjAyODZDMC4wMDUxODc5OSAzNC4yMzkyIDEuNzk3MjEgMzYuMDMxMiA0LjAwNzc5IDM2LjAzMTJINDguMDM2NEM1MC4yNDcgMzYuMDMxMiA1Mi4wMzkgMzQuMjM5MiA1Mi4wMzkgMzIuMDI4NlY0LjAxMDQyQzUyLjAzOSAxLjc5OTg0IDUwLjI0NyAwLjAwNzgxMjUgNDguMDM2NCAwLjAwNzgxMjVINC4wMDc3OVpNOC4wMTA0MiA4LjAxMzAySDEyLjAxM1YxMi4wMTU2SDguMDEwNDJWOC4wMTMwMlpNMjAuMDE4MiA4LjAxMzAySDE2LjAxNTZWMTIuMDE1NkgyMC4wMTgyVjguMDEzMDJaTTI0LjAyMDggOC4wMTMwMkgyOC4wMjM0VjEyLjAxNTZIMjQuMDIwOFY4LjAxMzAyWk0zNi4wMjg2IDguMDEzMDJIMzIuMDI2VjEyLjAxNTZIMzYuMDI4NlY4LjAxMzAyWk00MC4wMzEyIDguMDEzMDJINDQuMDMzOVYxMi4wMTU2SDQwLjAzMTJWOC4wMTMwMlpNMTYuMDE1NiAxNi4wMTgySDguMDEwNDJWMjAuMDIwOEgxNi4wMTU2VjE2LjAxODJaTTIwLjAxODIgMTYuMDE4MkgyNC4wMjA4VjIwLjAyMDhIMjAuMDE4MlYxNi4wMTgyWk0zMi4wMjYgMTYuMDE4MkgyOC4wMjM0VjIwLjAyMDhIMzIuMDI2VjE2LjAxODJaTTQ0LjAzMzkgMTYuMDE4MlYyMC4wMjA4SDM2LjAyODZWMTYuMDE4Mkg0NC4wMzM5Wk0xMi4wMTMgMjQuMDIzNEg4LjAxMDQyVjI4LjAyNkgxMi4wMTNWMjQuMDIzNFpNMTYuMDE1NiAyNC4wMjM0SDM2LjAyODZWMjguMDI2SDE2LjAxNTZWMjQuMDIzNFpNNDQuMDMzOSAyNC4wMjM0SDQwLjAzMTJWMjguMDI2SDQ0LjAzMzlWMjQuMDIzNFoiIGZpbGw9IiM0MjQyNDIiLz4NCjwvZz4NCjxkZWZzPg0KPGNsaXBQYXRoIGlkPSJjbGlwMCI+DQo8cmVjdCB3aWR0aD0iNTMiIGhlaWdodD0iMzYiIGZpbGw9IndoaXRlIi8+DQo8L2NsaXBQYXRoPg0KPC9kZWZzPg0KPC9zdmc+DQo="},"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTMiIGhlaWdodD0iMzYiIHZpZXdCb3g9IjAgMCA1MyAzNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMCkiPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00OC4wMzY0IDQuMDEwNDJINC4wMDc3OUw0LjAwNzc5IDMyLjAyODZINDguMDM2NFY0LjAxMDQyWk00LjAwNzc5IDAuMDA3ODEyNUMxLjc5NzIxIDAuMDA3ODEyNSAwLjAwNTE4Nzk5IDEuNzk5ODQgMC4wMDUxODc5OSA0LjAxMDQyVjMyLjAyODZDMC4wMDUxODc5OSAzNC4yMzkyIDEuNzk3MjEgMzYuMDMxMiA0LjAwNzc5IDM2LjAzMTJINDguMDM2NEM1MC4yNDcgMzYuMDMxMiA1Mi4wMzkgMzQuMjM5MiA1Mi4wMzkgMzIuMDI4NlY0LjAxMDQyQzUyLjAzOSAxLjc5OTg0IDUwLjI0NyAwLjAwNzgxMjUgNDguMDM2NCAwLjAwNzgxMjVINC4wMDc3OVpNOC4wMTA0MiA4LjAxMzAySDEyLjAxM1YxMi4wMTU2SDguMDEwNDJWOC4wMTMwMlpNMjAuMDE4MiA4LjAxMzAySDE2LjAxNTZWMTIuMDE1NkgyMC4wMTgyVjguMDEzMDJaTTI0LjAyMDggOC4wMTMwMkgyOC4wMjM0VjEyLjAxNTZIMjQuMDIwOFY4LjAxMzAyWk0zNi4wMjg2IDguMDEzMDJIMzIuMDI2VjEyLjAxNTZIMzYuMDI4NlY4LjAxMzAyWk00MC4wMzEyIDguMDEzMDJINDQuMDMzOVYxMi4wMTU2SDQwLjAzMTJWOC4wMTMwMlpNMTYuMDE1NiAxNi4wMTgySDguMDEwNDJWMjAuMDIwOEgxNi4wMTU2VjE2LjAxODJaTTIwLjAxODIgMTYuMDE4MkgyNC4wMjA4VjIwLjAyMDhIMjAuMDE4MlYxNi4wMTgyWk0zMi4wMjYgMTYuMDE4MkgyOC4wMjM0VjIwLjAyMDhIMzIuMDI2VjE2LjAxODJaTTQ0LjAzMzkgMTYuMDE4MlYyMC4wMjA4SDM2LjAyODZWMTYuMDE4Mkg0NC4wMzM5Wk0xMi4wMTMgMjQuMDIzNEg4LjAxMDQyVjI4LjAyNkgxMi4wMTNWMjQuMDIzNFpNMTYuMDE1NiAyNC4wMjM0SDM2LjAyODZWMjguMDI2SDE2LjAxNTZWMjQuMDIzNFpNNDQuMDMzOSAyNC4wMjM0SDQwLjAzMTJWMjguMDI2SDQ0LjAzMzlWMjQuMDIzNFoiIGZpbGw9IiNDNUM1QzUiLz4NCjwvZz4NCjxkZWZzPg0KPGNsaXBQYXRoIGlkPSJjbGlwMCI+DQo8cmVjdCB3aWR0aD0iNTMiIGhlaWdodD0iMzYiIGZpbGw9IndoaXRlIi8+DQo8L2NsaXBQYXRoPg0KPC9kZWZzPg0KPC9zdmc+DQo=":module=>{module.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTMiIGhlaWdodD0iMzYiIHZpZXdCb3g9IjAgMCA1MyAzNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMCkiPg0KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00OC4wMzY0IDQuMDEwNDJINC4wMDc3OUw0LjAwNzc5IDMyLjAyODZINDguMDM2NFY0LjAxMDQyWk00LjAwNzc5IDAuMDA3ODEyNUMxLjc5NzIxIDAuMDA3ODEyNSAwLjAwNTE4Nzk5IDEuNzk5ODQgMC4wMDUxODc5OSA0LjAxMDQyVjMyLjAyODZDMC4wMDUxODc5OSAzNC4yMzkyIDEuNzk3MjEgMzYuMDMxMiA0LjAwNzc5IDM2LjAzMTJINDguMDM2NEM1MC4yNDcgMzYuMDMxMiA1Mi4wMzkgMzQuMjM5MiA1Mi4wMzkgMzIuMDI4NlY0LjAxMDQyQzUyLjAzOSAxLjc5OTg0IDUwLjI0NyAwLjAwNzgxMjUgNDguMDM2NCAwLjAwNzgxMjVINC4wMDc3OVpNOC4wMTA0MiA4LjAxMzAySDEyLjAxM1YxMi4wMTU2SDguMDEwNDJWOC4wMTMwMlpNMjAuMDE4MiA4LjAxMzAySDE2LjAxNTZWMTIuMDE1NkgyMC4wMTgyVjguMDEzMDJaTTI0LjAyMDggOC4wMTMwMkgyOC4wMjM0VjEyLjAxNTZIMjQuMDIwOFY4LjAxMzAyWk0zNi4wMjg2IDguMDEzMDJIMzIuMDI2VjEyLjAxNTZIMzYuMDI4NlY4LjAxMzAyWk00MC4wMzEyIDguMDEzMDJINDQuMDMzOVYxMi4wMTU2SDQwLjAzMTJWOC4wMTMwMlpNMTYuMDE1NiAxNi4wMTgySDguMDEwNDJWMjAuMDIwOEgxNi4wMTU2VjE2LjAxODJaTTIwLjAxODIgMTYuMDE4MkgyNC4wMjA4VjIwLjAyMDhIMjAuMDE4MlYxNi4wMTgyWk0zMi4wMjYgMTYuMDE4MkgyOC4wMjM0VjIwLjAyMDhIMzIuMDI2VjE2LjAxODJaTTQ0LjAzMzkgMTYuMDE4MlYyMC4wMjA4SDM2LjAyODZWMTYuMDE4Mkg0NC4wMzM5Wk0xMi4wMTMgMjQuMDIzNEg4LjAxMDQyVjI4LjAyNkgxMi4wMTNWMjQuMDIzNFpNMTYuMDE1NiAyNC4wMjM0SDM2LjAyODZWMjguMDI2SDE2LjAxNTZWMjQuMDIzNFpNNDQuMDMzOSAyNC4wMjM0SDQwLjAzMTJWMjguMDI2SDQ0LjAzMzlWMjQuMDIzNFoiIGZpbGw9IiNDNUM1QzUiLz4NCjwvZz4NCjxkZWZzPg0KPGNsaXBQYXRoIGlkPSJjbGlwMCI+DQo8cmVjdCB3aWR0aD0iNTMiIGhlaWdodD0iMzYiIGZpbGw9IndoaXRlIi8+DQo8L2NsaXBQYXRoPg0KPC9kZWZzPg0KPC9zdmc+DQo="}}]);
//# sourceMappingURL=demo-stories.07ebc237.iframe.bundle.js.map