{"version":3,"file":"assets/js/919.d73903cf.js","mappings":"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","sources":["webpack://website/../example-app/src/resources/loading.gif","webpack://website/../example-app/src/LoadingGif.tsx","webpack://website/../example-app/src/resources/loading_dark.gif","webpack://website/../example-app/src/DefaultSuspense.tsx","webpack://website/../example-app/src/file-utils.tsx","webpack://website/../example-app/src/Editor/useEditorTheme.ts","webpack://website/../example-app/src/Editor/Editor.tsx","webpack://website/../example-app/src/fs/browser-fs.tsx","webpack://website/../example-app/src/fs/fs-utils.ts","webpack://website/../example-app/src/fs/fs.tsx","webpack://website/../example-app/src/fs/fs.state.ts","webpack://website/../example-app/src/Project/project-utils.ts","webpack://website/../example-app/src/Project/project.state.ts","webpack://website/../example-app/src/Editor/editor.state.ts","webpack://website/../example-app/src/VersionControl/file-status.ts","webpack://website/../example-app/src/VersionControl/file-status.state.ts","webpack://website/../example-app/src/VersionControl/FileStatusColor.tsx","webpack://website/../example-app/src/ProjectView/ProjectView.state.ts","webpack://website/../example-app/src/ProjectView/ProjectViewPane.tsx","webpack://website/../example-app/src/TreeUtils/tree-utils.ts","webpack://website/../example-app/src/ProjectView/ProjectViewActionButtons.tsx","webpack://website/../example-app/src/Terminal/Terminal.tsx","webpack://website/../example-app/src/VersionControl/Changes/change-lists.state.ts","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/changesGroupings.ts","webpack://website/../example-app/src/VersionControl/Changes/Rollback/rollbackView.state.ts","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ChangesView.state.ts","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ChangesViewTreeContextMenu.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/StyledRepoColorSquare.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/StyledCurrentBranchTag.tsx","webpack://website/../example-app/src/VersionControl/CurrentBranchName.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/changesTreeNodeRenderers.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ChangeViewTree.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ActionButtons/ChangeListsActionButton.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ActionButtons/GroupByActionButton.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ActionButtons/ViewOptionsActionButton.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ChangesViewToolbar.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesSummary.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ChangesViewSplitter.tsx","webpack://website/../example-app/src/VersionControl/Changes/Rollback/RollbackTreeContextMenu.tsx","webpack://website/../example-app/src/VersionControl/Changes/Rollback/RollbackWindow.tsx","webpack://website/../example-app/src/VersionControl/Changes/ChangesView/ChangesViewPane.tsx","webpack://website/../example-app/src/Project/toolWindows.tsx","webpack://website/../example-app/src/Project/toolWindows.state.ts","webpack://website/../example-app/src/Editor/FileEditor.tsx","webpack://website/../example-app/src/usePersistenceFsNotification.tsx","webpack://website/../example-app/src/StatusBar/IdeStatusBar.tsx","webpack://website/../example-app/src/Project/Project.tsx","webpack://website/../example-app/src/SampleRepoInitializer.tsx","webpack://website/../example-app/src/App.tsx"],"sourcesContent":["export default \"data:image/gif;base64,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\"","import { Img } from \"@intellij-platform/core\";\nimport React, { ComponentProps } from \"react\";\nimport loadingGif from \"./resources/loading.gif\";\nimport loadingDarkGif from \"./resources/loading_dark.gif\";\n\nexport const LoadingGif: React.FC = (\n  props: Omit<ComponentProps<typeof Img>, \"src\" | \"darkSrc\" | \"srcSet\">\n) => <Img {...props} src={loadingGif} darkSrc={loadingDarkGif} />;\n","export default \"data:image/gif;base64,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\"","import React, { SuspenseProps } from \"react\";\nimport styled from \"styled-components\";\nimport { LoadingGif } from \"./LoadingGif\";\n\nconst Loading = styled(LoadingGif)`\n  width: fit-content;\n  margin: auto;\n`;\nexport const DefaultSuspense: React.FC<Partial<SuspenseProps>> = ({\n  fallback = <Loading />,\n  children,\n}) => <React.Suspense fallback={fallback}>{children}</React.Suspense>;\n","import path from \"path\";\n\nexport const FILE_ICON = \"fileTypes/text\";\nexport const DIR_ICON = \"nodes/folder\";\n\nconst extensionIconMap: Record<string, string> = {\n  editorconfig: \"nodes/editorconfig\",\n  js: \"fileTypes/javaScript\",\n  gitignore: \"vcs/ignore_file\",\n  archive: \"fileTypes/archive\",\n  as: \"fileTypes/as\",\n  config: \"fileTypes/config\",\n  css: \"fileTypes/css\",\n  dtd: \"fileTypes/dtd\",\n  hpr: \"fileTypes/hprof\",\n  htaccess: \"fileTypes/htaccess\",\n  html: \"fileTypes/html\",\n  idl: \"fileTypes/idl\",\n  java: \"fileTypes/java\",\n  jfr: \"fileTypes/jfr\",\n  json: \"fileTypes/json\",\n  jsp: \"fileTypes/jsp\",\n  jspx: \"fileTypes/jspx\",\n  manifest: \"fileTypes/manifest\",\n  properties: \"fileTypes/properties\",\n  txt: \"fileTypes/text\",\n  wsdl: \"fileTypes/wsdlFile\",\n  xhtml: \"fileTypes/xhtml\",\n  xml: \"fileTypes/xml\",\n  xsd: \"fileTypes/xsdFile\",\n  yaml: \"fileTypes/yaml\",\n};\n\nexport const getIconForFile = (filepath: string) => {\n  const extension = getExtension(filepath);\n  return extensionIconMap[extension] || FILE_ICON;\n};\n\n/**\n * A little different from path.extname(). For \".gitignore\" path.extname returns \"\" while this returns \"gitignore\".\n */\nconst getExtension = (filepath: string): string =>\n  filepath.split(\".\").pop() || \"\";\n\n/**\n * @example\n * \"/a/b/c.ext\" => [\"/a/b\", \"/a\"]\n */\nexport function getParentPaths(\n  filepath: string,\n  upperLimit: string = path.sep\n): string[] {\n  return getParentPathsRecursive(filepath, upperLimit);\n}\n\nfunction getParentPathsRecursive(\n  filepath: string,\n  upperLimit: string,\n  previousPaths: string[] = []\n): string[] {\n  const dirname = path.dirname(filepath);\n  if (dirname !== upperLimit) {\n    return [dirname].concat(\n      getParentPathsRecursive(dirname, upperLimit, previousPaths)\n    );\n  }\n  return previousPaths;\n}\n","import { EditorProps, useMonaco } from \"@monaco-editor/react\";\nimport { Theme } from \"@intellij-platform/core\";\nimport { editor } from \"monaco-editor\";\nimport { useLayoutEffect, useState } from \"react\";\nimport { useTheme } from \"styled-components\";\n\nimport vsCodeTheme from \"../resources/dracula-color-theme.json\"; // FIXME: don't read a fixed color scheme\n\nconst darculaColorSchemeTokenRules: editor.ITokenThemeRule[] = vsCodeTheme.tokenColors.flatMap(\n  ({ scope, settings }) =>\n    ([] as string[])\n      .concat(scope)\n      .flatMap((scope) => scope.split(\" \"))\n      .map((token) => {\n        const values: editor.ITokenThemeRule = {\n          token,\n        };\n        Object.keys(settings).forEach((key) => {\n          const value = settings[key as keyof typeof settings];\n          if (value) {\n            values[key as keyof typeof settings] = value;\n          }\n        });\n        return values;\n      })\n);\n\nexport const useEditorTheme = () => {\n  const monaco = useMonaco();\n  const theme = useTheme() as Theme;\n  const [themeName, setThemeName] = useState<EditorProps[\"theme\"]>(\n    theme.dark ? \"vs-dark\" : \"light\"\n  );\n  useLayoutEffect(() => {\n    if (monaco) {\n      const name = `jui-theme-${theme.name.replace(\" \", \"\")}`;\n      monaco.editor.defineTheme(name, {\n        base: theme.dark ? \"vs-dark\" : \"vs\",\n        inherit: true,\n        // colors and rules should come from color scheme xml files.\n        // see platform/platform-resources/src/DefaultColorSchemesManager.xml\n        colors: theme.dark\n          ? {\n              // FIXME: read from color scheme files. List of available keys: https://github.com/microsoft/monaco-editor/issues/1631\n              \"editor.background\": \"#2B2B2B\",\n              \"editor.lineHighlightBackground\": \"#323232\",\n              \"editor.lineHighlightBorder\": \"none\",\n              \"editorLineNumber.foreground\": \"#606366\", // LINE_NUMBERS_COLOR\n              \"editorActiveLineNumber.foreground\": \"#a4a3a3\", // LINE_NUMBER_ON_CARET_ROW_COLOR\n              \"editorIndentGuide.background\": \"#373737\", // INDENT_GUIDE\n              \"editorIndentGuide.activeBackground\": \"#505050\", // SELECTED_INDENT_GUIDE\n              \"editorGutter.background\": theme.dark ? \"#313335\" : \"#f0f0f0\",\n            }\n          : {},\n        // token rules for syntax highlighting\n        rules: darculaColorSchemeTokenRules,\n      });\n      setThemeName(name);\n    }\n  }, [monaco, theme]);\n\n  return themeName;\n};\n","import MonacoEditor, { EditorProps } from \"@monaco-editor/react\";\nimport { styled } from \"@intellij-platform/core\";\nimport React from \"react\";\nimport { useEditorTheme } from \"./useEditorTheme\";\n\nexport const StyledEditor = styled(MonacoEditor)`\n  .monaco-editor {\n    .margin-view-overlays .line-numbers {\n      text-align: left;\n      padding-left: 7px;\n    }\n  }\n`;\n/**\n * Monaco Editor styled to look like Intellij Platform's editor.\n * TODO:\n *  - folding controls appearance is different and should be changed\n *  - highlighting pairs of parens, brackets, etc. is different.\n *  - context menu look different.\n *  - selection look different.\n *  - BUG: height is more than necessary. Needs investigation first.\n */\nexport const Editor = (props: Omit<EditorProps, \"theme\">) => {\n  const editorTheme = useEditorTheme();\n  return (\n    <StyledEditor\n      {...props}\n      options={{\n        minimap: { enabled: false },\n        lineHeight: 20,\n        showFoldingControls: \"always\",\n        renderIndentGuides: true,\n        scrollbar: {\n          verticalScrollbarSize: 10,\n          verticalSliderSize: 7,\n        },\n        ...props.options,\n      }}\n      theme={editorTheme as any} // FIXME\n    />\n  );\n};\n","// FIXME?: We are importing everything from browserFS, which might be too much, considering many backends it supports\nimport * as BrowserFS from \"browserfs\";\n// @ts-expect-error: https://github.com/sindresorhus/pify/issues/74\nimport pify from \"pify\";\nimport LightningFS from \"@isomorphic-git/lightning-fs\";\nimport { BFSCallback } from \"browserfs/src/core/file_system\";\nimport FS, { FSModule } from \"browserfs/dist/node/core/FS\";\n\nwindow.BrowserFS = BrowserFS;\n// importing the type didn't work as expected\ntype FileSystem = Parameters<typeof BrowserFS[\"initialize\"]>[0];\n\n// not so accurate type.\nexport type PromisifiedFS = Omit<\n  LightningFS.PromisifedFS, // borrowed from LightningFS\n  \"init\" | \"activate\" | \"deactivate\"\n> & { exists: (path: string) => Promise<boolean> };\n\nexport type FSModuleWithPromises = FSModule & {\n  promises: PromisifiedFS;\n};\n\nexport async function createInMemoryFS() {\n  return await createFsBackend((cb) => {\n    BrowserFS.FileSystem.InMemory.Create({}, cb);\n  });\n}\n\nexport async function createIndexedDBFS(storeName = \"bfs-local-fs\") {\n  const idbfs = await createFsBackend((cb) => {\n    BrowserFS.FileSystem.IndexedDB.Create({ storeName }, cb);\n  });\n  // @ts-expect-error wasted several hours on the following f*** line! The reason it's needed is a huge f*** blunder\n  // in browserfs@2.0.0, in which IndexedDBFileSystem doesn't call the init function in Create function.\n  // several things made this issue extremely hard to find and fix:\n  // 1. the latest code on github is actually correct, but unpublished\n  // 2. If browserfs@1.x is used even once, it will initialize the indexedDB correctly, which hides the v2 error.\n  //    it exactly happened when trying to reproduce the issue on codesandbox: https://codesandbox.io/s/browser-fs-2-0-0-indexed-db-bug-5vuecr\n  await new Promise((resolve) => idbfs.init(idbfs.store, resolve));\n  return idbfs;\n}\n\nexport function initializeFS(fsBackend: FileSystem): FSModuleWithPromises {\n  BrowserFS.initialize(fsBackend);\n  const fsm = BrowserFS.BFSRequire(\"fs\");\n\n  // @ts-expect-error\n  fsm.promises = pify(fsm);\n  return fsm as FSModuleWithPromises;\n}\n\nexport const createFs = (backend: FileSystem): FS => {\n  const fs = new (BrowserFS.BFSRequire(\"fs\").FS)();\n  fs.initialize(backend);\n  return fs;\n};\n\nfunction createFsBackend(\n  fn: (cb: BFSCallback<FileSystem>) => void\n): Promise<FileSystem> {\n  return new Promise((resolve, reject) => {\n    fn((err, fs) => {\n      if (err || !fs) {\n        return reject(err);\n      }\n      resolve(fs);\n    });\n  });\n}\n","// @ts-expect-error: https://github.com/sindresorhus/pify/issues/74\nimport pify from \"pify\";\nimport path from \"path\";\nimport FS from \"browserfs/dist/node/core/FS\";\nimport { PromisifiedFS } from \"./browser-fs\";\n// @ts-expect-error caf doesn't have typing :/\nimport { CAF } from \"caf\";\n\ntype CopyFsParams = {\n  source: FS;\n  target: FS;\n  /**\n   * called when a file is being copied\n   */\n  onCopy?: (filepath: string) => void;\n  /**\n   * force copy, even if file already exists in the target fs\n   * @default false\n   */\n  force?: boolean;\n\n  cancelSignal: unknown;\n};\n\nexport async function copyFs({\n  source,\n  target,\n  cancelSignal,\n  ...rest\n}: CopyFsParams) {\n  await copyFsRecursively(cancelSignal, {\n    ...rest,\n    source: pify(source),\n    target: pify(target),\n    rootDir: \"/\",\n  });\n}\n\nconst copyFsRecursively = CAF(function* (\n  cancelSignal: unknown,\n  params: {\n    source: PromisifiedFS;\n    target: PromisifiedFS;\n    onCopy?: (filepath: string) => void;\n    force?: boolean;\n    rootDir: string;\n  }\n): unknown {\n  const { source, target, rootDir, onCopy, force } = params;\n  const items = yield source.readdir(rootDir);\n\n  // While we could parallelize copying files of a given directory, it didn't prove to be much faster. Plus, supporting\n  // cancellation via CAF seems more straightforward if we don't do that.\n  for (const name of items) {\n    const fullPath = path.join(rootDir, name);\n    const stat = yield source.stat(fullPath);\n    if (stat.isFile() || stat.isSymbolicLink()) {\n      if (!force && (yield fileExists(target, fullPath))) {\n        return;\n      }\n      onCopy?.(fullPath);\n      const content = yield source.readFile(fullPath); // is it ok for symlink too?\n      yield ensureDir(target, path.dirname(fullPath));\n      yield target.writeFile(fullPath, content);\n    } else if (stat.isDirectory()) {\n      yield copyFsRecursively(cancelSignal, {\n        ...params,\n        rootDir: path.join(rootDir, name),\n      });\n    } else {\n      console.warn(\"unsupported file system item skipped, when copying:\", stat);\n    }\n  }\n});\nconst fileExists = async (fs: PromisifiedFS, filepath: string) => {\n  const exists = await fs\n    .exists(filepath)\n    // sometimes it throws boolean instead of returning :|\n    .catch((e) => (typeof e === \"boolean\" ? e : Promise.reject(e)));\n\n  return exists && !(await fs.stat(filepath)).isDirectory();\n};\n\nexport async function ensureDir(fs: PromisifiedFS, dirPath: string) {\n  const stat = await fs\n    .stat(dirPath)\n    .catch((e) => (e.code === \"ENOENT\" ? false : Promise.reject(e)));\n  if (stat === false) {\n    // path doesn't exist\n    const dirname = path.dirname(dirPath);\n    if (dirname !== path.dirname(dirname)) {\n      // not root path\n      await ensureDir(fs, dirname);\n    }\n    await fs\n      .mkdir(dirPath)\n      // it can happen that due to async nature of this function, between calling stat and this line, the folder is already created.\n      .catch((e) =>\n        e.code === \"EEXIST\" ? Promise.resolve() : Promise.reject(e)\n      );\n  } else if (!stat.isDirectory()) {\n    throw new Error(`path is not a directory, but already exists: ${dirPath}`);\n  }\n}\n","import * as BrowserFS from \"browserfs\";\nimport React from \"react\";\nimport {\n  createFs,\n  createIndexedDBFS,\n  createInMemoryFS,\n  FSModuleWithPromises,\n  initializeFS,\n} from \"./browser-fs\";\nimport { copyFs } from \"./fs-utils\";\n\n/**\n * local fs, for when used in browser. Most of the things here would be a noop in node environment.\n */\nexport let fs: FSModuleWithPromises;\n\nconst localStorageSetting = <Enum extends string>(key: string) => ({\n  get: () => localStorage.getItem(key) as Enum | undefined,\n  set: (value: Enum) => localStorage.setItem(key, value),\n});\n/**\n * Global fs preferences for which the file system itself can't be used as storage.\n */\nexport const persistentFsPreference = localStorageSetting<\"yes\" | \"no\">(\n  \"demo_app_use_persistent_fs\"\n);\n\n// NOTE: Maybe we can make this module side-effect free by lazy initializing fsPromise, in WaitForFs, if it's enough\n// to assume any code requiring FS is executed via components rendered inside WaitForFs.\n// Also, we can gather exports of this file into an interface to make it easier to provide two implementations, for\n// browser and node.\nconst fsPromise: Promise<FSModuleWithPromises> = (persistentFsPreference.get() ===\n\"yes\"\n  ? createIndexedDBFS()\n  : createInMemoryFS()\n)\n  .then(initializeFS)\n  .then((theFs) => {\n    (window as any).fs = theFs;\n    return (fs = theFs);\n  })\n  .catch((e) => {\n    console.log(\"could not initialize FS:\", e);\n    throw e;\n  });\n\nexport function isFsInMemory() {\n  return fs.getRootFS() instanceof BrowserFS.FileSystem.InMemory;\n}\n\nexport async function switchToPersistentFS({\n  onCopy = console.log,\n  cancelSignal,\n}: {\n  onCopy?: (filepath: string) => void;\n  cancelSignal?: unknown;\n} = {}) {\n  if (!isFsInMemory()) {\n    console.log(\"Already on persistent fs. Nothing to do.\");\n    return;\n  }\n  console.log(\"Creating IndexedDB FS\");\n  console.time(\"creating db\");\n  const indexedDbFsBackend = await createIndexedDBFS();\n\n  await copyFs({\n    source: fs,\n    target: await createFs(indexedDbFsBackend),\n    cancelSignal,\n    force: true,\n    onCopy,\n  });\n  console.timeEnd(\"creating db\");\n\n  initializeFS(indexedDbFsBackend);\n  // persistentFsPreference.set(\"yes\");\n  console.log(\"FS switched to IndexedDB backend\", indexedDbFsBackend);\n}\n\nconst fsResource = wrapPromise(fsPromise);\n\n/**\n * Suspense aware wrapper for waiting for FS to be initialized. initialization API in some fs backends such as\n * BrowserFs, is async. That's why it's safe to use this on a high level.\n */\nexport const WaitForFs: React.FC = ({ children }) => {\n  fsResource.read();\n  return children as React.ReactElement;\n};\n\n/**\n * wrapPromise util for suspense for arbitrary async operation, represented as a promise.\n */\nfunction wrapPromise<T>(promise: Promise<T>) {\n  let status = \"pending\";\n  let response: T;\n\n  const suspender = promise.then(\n    (res) => {\n      status = \"success\";\n      response = res;\n    },\n    (err) => {\n      status = \"error\";\n      response = err;\n    }\n  );\n  const read = () => {\n    switch (status) {\n      case \"pending\":\n        throw suspender;\n      case \"error\":\n        throw response;\n      default:\n        return response;\n    }\n  };\n\n  return { read };\n}\n","import {\n  atomFamily,\n  CallbackInterface,\n  selectorFamily,\n  useRecoilRefresher_UNSTABLE,\n} from \"recoil\";\nimport { fs } from \"./fs\";\n\nexport interface FsItem {\n  type: \"dir\" | \"file\";\n  path: string;\n  size: number;\n}\n\n/**\n * recoil atoms and selectors for keeping list and content of files in recoil state, for components that need on such\n * state.\n * NOTE: still not clear if we should be using atomFamily or selectorFamily for this. changing the current\n * implementation to atomFamily however is easy and side effect free.\n */\nexport const dirContentState = selectorFamily({\n  key: \"dirContents\",\n  get: (path: string) => async (): Promise<null | FsItem[]> => {\n    let fileNames: string[];\n    try {\n      fileNames = await fs.promises.readdir(path);\n    } catch (e) {\n      return null;\n    }\n    const stats = await Promise.all(\n      fileNames.map((fileName) => {\n        const filePath = `${path}/${fileName}`;\n        return fs.promises.stat(filePath).then((stat) => ({\n          ...stat,\n          type: stat.isDirectory() ? (\"dir\" as const) : (\"file\" as const),\n          filePath,\n        }));\n      })\n    );\n    return stats.map((stat) => ({\n      type: stat.type,\n      path: stat.filePath,\n      size: stat.size,\n    }));\n  },\n});\n\nexport const reloadFileFromDiskCallback = ({\n  set,\n}: CallbackInterface) => async (path: string) =>\n  set(fileContent(path), await fetchFileContent(path));\n\nconst fetchFileContent = async (filepath: string) => {\n  if (!filepath) {\n    return \"\";\n  }\n  // @ts-expect-error return type is wrong\n  return fs.promises.readFile(filepath, {\n    encoding: \"utf8\",\n  }) as Promise<string>;\n};\n\n/**\n * **Note**: Still not quite clear if we should use atom and [synchronize with source of truth (FS)][recoil-atom-effects],\n * or if we should use selector and refresh it when needed. We probably need a proper [VFS][vfs] implementation at\n * some point, which would be capable of tracking modifications, and setting up listeners for it, and then atoms, can\n * hold the states like directory content, with effects which uses the listener API.\n * A few things to consider in that regard:\n * - if modifications to files are not directly synchronized to fs, using isomorphic-git for updating the file status\n *   can be tricky, unless an FS implementation is provided which uses the file content that is not yet synced with\n *   the actual local FS. Maybe something like Intellij's VFS, can be implemented as a BrowserFS backend impl.\n *\n * **Note**: currently, only text file is supported, for simplicity.\n *\n * [recoil-atom-effects]: https://recoiljs.org/docs/guides/atom-effects#write-through-cache-example\n * [vfs]: https://plugins.jetbrains.com/docs/intellij/virtual-file-system.html\n **/\nexport const fileContent = atomFamily<string, string>({\n  key: \"fileContent\",\n  default: fetchFileContent,\n  effects: (filepath) => [\n    ({ onSet }) => {\n      onSet((content) => {\n        // Should a sync API be used here?\n        fs.promises\n          .writeFile(\n            filepath,\n            // @ts-expect-error: string should also be acceptable. Seems like bad typing\n            content,\n            { encoding: \"utf8\" }\n          )\n          .catch((e) => {\n            console.error(\"failed to sync the file back to the fs\", e);\n          });\n      });\n    },\n  ],\n});\n\nexport const useReloadFromDisk = (path: string) => {\n  return useRecoilRefresher_UNSTABLE(dirContentState(path));\n};\n","import { FsItem } from \"../fs/fs.state\";\n\nexport const filterPath = ({ path }: FsItem) =>\n  !path.split(\"/\").includes(\".git\");\n","import { atom, selector, selectorFamily } from \"recoil\";\nimport { dirContentState, FsItem } from \"../fs/fs.state\";\nimport { filterPath } from \"./project-utils\";\n\nexport interface Project {\n  name: string;\n  path: string;\n}\n\nconst sampleRepos = {\n  JUI: {\n    path: \"/workspace/jui\",\n    url: \"https://github.com/alirezamirian/jui.git\",\n  },\n  \"React Spectrum\": {\n    path: \"/workspace/react-spectrum\",\n    url: \"https://github.com/adobe/react-spectrum.git\",\n  },\n  Recoil: {\n    path: \"/workspace/recoil\",\n    url: \"https://github.com/facebookexperimental/Recoil.git\",\n  },\n};\nconst sampleRepoKey: keyof typeof sampleRepos = \"JUI\";\n\n/**\n * temporary hard coded sample repo, until clone UI is implemented.\n */\nexport const sampleRepo = sampleRepos[sampleRepoKey];\n\nexport const currentProjectState = atom<Project>({\n  key: \"project\",\n  default: {\n    name: sampleRepoKey,\n    path: sampleRepo.path,\n  },\n});\n\nexport const projectFilePath = selectorFamily({\n  key: \"projectFilePath\",\n  get: (projectRelativePath: string) => ({ get }) =>\n    `${get(currentProjectState).path}/${projectRelativePath}`,\n});\n\nexport const currentProjectFilesState = selector({\n  key: \"projectFiles\",\n  get: async ({ get }): Promise<FsItem[]> => {\n    const project = get(currentProjectState);\n    const items = get(dirContentState(project.path));\n    const files: FsItem[] = [];\n    const addItem = (item: FsItem) => {\n      if (item.type === \"dir\" && filterPath(item)) {\n        const childItems = get(dirContentState(item.path));\n        if (childItems) {\n          childItems.map(addItem);\n        }\n      } else {\n        files.push(item);\n      }\n    };\n    (items || []).forEach((item) => addItem(item));\n    return files;\n  },\n});\n","import {\n  atom,\n  selector,\n  useRecoilCallback,\n  useRecoilState,\n  useSetRecoilState,\n} from \"recoil\";\nimport { Focusable } from \"../common-types\";\nimport { descend, sortWith } from \"ramda\";\nimport {\n  currentProjectFilesState,\n  projectFilePath,\n} from \"../Project/project.state\";\nimport { Position } from \"monaco-editor\";\n\ninterface TextEditorState {\n  cursorPos: { lineNumber: number; column: number };\n}\ntype EditorState = TextEditorState;\n\nexport interface EditorTabState {\n  editorState: EditorState;\n  filePath: string;\n}\n\n// in order to showcase tabs behaviour when many tabs are open. Later on, it should be based on persisted project\n// settings.\nconst temporaryTabsDefaultValue = selector({\n  key: \"editor.tabs/Default\",\n  get: ({ get }) =>\n    sortWith(\n      [\n        // first README.md, then ts and js files.\n        descend((file) => file.path === get(projectFilePath(\"README.md\"))),\n        descend((file) => file.path.endsWith(\".ts\")),\n        descend((file) => file.path.endsWith(\".js\")),\n      ],\n      get(currentProjectFilesState).filter((item) => item.type === \"file\")\n    )\n      .slice(0, 12)\n      // map project file to editor state object\n      .map((file) => ({\n        filePath: file.path,\n        editorState: { cursorPos: { lineNumber: 0, column: 0 } },\n      })),\n});\n\n// it should become something under \"project\" state later.\nconst editorTabsState = atom<EditorTabState[]>({\n  key: \"editor.tabs\",\n  default: temporaryTabsDefaultValue,\n});\n\nconst activeEditorTabIndexState = atom<number>({\n  key: \"editor.activeTabIndex\",\n  default: 0,\n});\n\nexport const activeEditorTabState = selector({\n  key: \"editor.activeTab\",\n  get: ({ get }) => get(editorTabsState)[get(activeEditorTabIndexState)],\n});\n\nexport const editorCursorPositionState = atom<Position>({\n  key: \"editor.cursorPosition\",\n  default: new Position(0, 0),\n});\n\n/**\n * could be a global variable also, since there is no re-rendering need for it. It's kept as an atom, just to avoid\n * global variable and its issues.\n */\nexport const editorRefState = atom<null | Focusable>({\n  key: \"editor.focusHandle\",\n  default: null,\n});\n\nexport interface EditorStateManager {\n  tabs: EditorTabState[];\n  openPath(filePath: string, focus?: boolean): void;\n  closePath(path: string): void;\n  closeOthersTabs(index: number): void;\n  closeTab(index: number): void;\n  select(index: number): void;\n}\n\nexport const useEditorStateManager = (): EditorStateManager => {\n  const [tabsState, setTabsState] = useRecoilState(editorTabsState);\n  const setActiveTabIndex = useSetRecoilState(activeEditorTabIndexState);\n  const focus = useRecoilCallback(\n    ({ snapshot }) => () => {\n      snapshot.getLoadable(editorRefState).valueOrThrow()?.focus();\n    },\n    []\n  );\n\n  const select = (index: number) => {\n    setActiveTabIndex(index);\n  };\n  const closePath = (filePath: string) => {\n    const index = tabsState.findIndex((tab) => tab.filePath === filePath);\n    if (index > -1) {\n      closeTab(index);\n      setActiveTabIndex(Math.max(index - 1, 0));\n    }\n  };\n  const openPath = (filePath: string, shouldFocus = true) => {\n    const index = tabsState.findIndex((tab) => tab.filePath === filePath);\n    if (index > -1) {\n      select(index);\n    } else {\n      const newIndex = tabsState.length;\n      setTabsState((currentState) => [\n        ...currentState,\n        {\n          filePath,\n          editorState: { cursorPos: { lineNumber: 0, column: 0 } }, // no persistence of cursor position for now.\n        },\n      ]);\n      select(newIndex);\n    }\n    if (shouldFocus) {\n      focus();\n    }\n  };\n  const closeTab = (index: number) => {\n    setTabsState((tabsState) =>\n      tabsState.filter((_, tabIndex) => tabIndex !== index)\n    );\n  };\n  const closeOthersTabs = (index: number) => {\n    setTabsState((tabsState) =>\n      tabsState.filter((_, tabIndex) => tabIndex === index)\n    );\n  };\n  return {\n    tabs: tabsState,\n    // This should become an action. Something like \"open project file\", when action system is implemented.\n    openPath,\n    closePath,\n    closeTab,\n    closeOthersTabs,\n    select,\n  };\n};\n","import { status as getStatus } from \"isomorphic-git\";\nimport { StatusRow } from \"isomorphic-git\";\n\n// platform/editor-ui-api/src/com/intellij/openapi/vcs/FileStatus.java\nexport type FileStatus =\n  | \"UNKNOWN\"\n  | \"ADDED\"\n  | \"NOT_CHANGED\"\n  | \"MODIFIED\"\n  | \"DELETED\";\n\n// platform/vcs-api/src/com/intellij/openapi/vcs/VcsDirectoryMapping.java\nexport interface VcsDirectoryMapping {\n  dir: string;\n  vcs: \"git\"; // only supported vcs for now.\n}\n\n// TODO: remove when upgraded TS to >=4.5\ntype Awaited<T> = T extends PromiseLike<infer U> ? U : T;\n\n/**\n * Converts isomorphic-git status string or StatusRow to FileStatus.\n *\n * for status row:\n *   [\"a.txt\", 0, 2, 0], // new, untracked\n *   [\"b.txt\", 0, 2, 2], // added, staged\n *   [\"c.txt\", 0, 2, 3], // added, staged, with unstaged changes\n *   [\"d.txt\", 1, 1, 1], // unmodified\n *   [\"e.txt\", 1, 2, 1], // modified, unstaged\n *   [\"f.txt\", 1, 2, 2], // modified, staged\n *   [\"g.txt\", 1, 2, 3], // modified, staged, with unstaged changes\n *   [\"h.txt\", 1, 0, 1], // deleted, unstaged\n *   [\"i.txt\", 1, 0, 0], // deleted, staged\n *\n * for status:\n *   | status                | description                                                                           |\n * | --------------------- | ------------------------------------------------------------------------------------- |\n * | `\"ignored\"`           | file ignored by a .gitignore rule                                                     |\n * | `\"unmodified\"`        | file unchanged from HEAD commit                                                       |\n * | `\"*modified\"`         | file has modifications, not yet staged                                                |\n * | `\"*deleted\"`          | file has been removed, but the removal is not yet staged                              |\n * | `\"*added\"`            | file is untracked, not yet staged                                                     |\n * | `\"absent\"`            | file not present in HEAD commit, staging area, or working dir                         |\n * | `\"modified\"`          | file has modifications, staged                                                        |\n * | `\"deleted\"`           | file has been removed, staged                                                         |\n * | `\"added\"`             | previously untracked file, staged                                                     |\n * | `\"*unmodified\"`       | working dir and HEAD commit match, but index differs                                  |\n * | `\"*absent\"`           | file not present in working dir or HEAD commit, but present in the index              |\n * | `\"*undeleted\"`        | file was deleted from the index, but is still in the working dir                      |\n * | `\"*undeletemodified\"` | file was deleted from the index, but is present with modifications in the working dir |\n */\nexport function convertGitStatus(\n  status: Awaited<ReturnType<typeof getStatus>> | StatusRow\n): FileStatus {\n  // TODO: complete and refine this logic.\n  if (Array.isArray(status)) {\n    if (status[1] === 1) {\n      return ([\"DELETED\", \"NOT_CHANGED\", \"MODIFIED\"] as const)[status[2]];\n    }\n    if (status[1] === 0) {\n      if (status[3] === 0) {\n        return \"UNKNOWN\";\n      } else {\n        return \"ADDED\";\n      }\n    }\n    return \"UNKNOWN\";\n  }\n  if (status === \"modified\" || status === \"*modified\") {\n    return \"MODIFIED\";\n  }\n  if (status === \"deleted\" || status === \"*deleted\") {\n    return \"DELETED\";\n  }\n  if (status === \"added\") {\n    return \"ADDED\";\n  }\n  if (status === \"unmodified\") {\n    return \"NOT_CHANGED\";\n  }\n  return \"UNKNOWN\";\n}\n","import {\n  atom,\n  atomFamily,\n  CallbackInterface,\n  GetRecoilValue,\n  selector,\n  selectorFamily,\n  useRecoilCallback,\n} from \"recoil\";\nimport { currentProjectState } from \"../Project/project.state\";\nimport { status, statusMatrix } from \"isomorphic-git\";\nimport { fs } from \"../fs/fs\";\nimport {\n  convertGitStatus,\n  FileStatus,\n  VcsDirectoryMapping,\n} from \"./file-status\";\nimport { useEffect } from \"react\";\nimport * as path from \"path\";\n\nconst temporaryVcsMappingsDefault = ({\n  get,\n}: {\n  get: GetRecoilValue;\n}): VcsDirectoryMapping[] => [\n  {\n    dir: get(currentProjectState).path,\n    vcs: \"git\",\n  },\n];\n\n// This should be refactored to have the configuration file(s) as the source of truth.\nexport const vcsRootsState = atom<VcsDirectoryMapping[]>({\n  key: \"vcsRoots\",\n  default: selector({\n    key: \"vcsRoots/temporaryDefault\",\n    get: temporaryVcsMappingsDefault,\n  }),\n});\n\n/**\n * Given the absolute path of a file, returns the relevant VCS root path, if any.\n */\nexport const VcsRootForFile = selectorFamily<string | null, string>({\n  key: \"gitRootForFile\",\n  get: (filepath: string) => ({ get }) =>\n    get(vcsRootsState).find((root) => filepath.startsWith(root.dir))?.dir ??\n    null,\n});\n\n/**\n * Keeps FileStatus of files based on their absolute path.\n * NOTE: Should it be an atom or selector?\n * NOTE: updating files status is now not connected to file updates, as there is no proper (V)FS API allowing change\n * listener. `useUpdateFileStatus` and `useUpdateVcsFileStatuses` can be used to update status of a file, or all files\n * in a git root.\n */\nexport const fileStatusState = atomFamily<FileStatus, string>({\n  key: \"fileStatus\",\n  default: \"NOT_CHANGED\",\n});\n\nexport const useUpdateFileStatus = () =>\n  useRecoilCallback(\n    ({ snapshot, set }: CallbackInterface) => async (filepath: string) => {\n      const repoRoot = await snapshot.getPromise(VcsRootForFile(filepath));\n      if (repoRoot != null) {\n        console.time(`status ${filepath}`);\n        const fileStatus = await status({\n          fs,\n          dir: repoRoot,\n          filepath: path.relative(repoRoot, filepath),\n        });\n        console.timeEnd(`status ${filepath}`);\n        set(fileStatusState(filepath), convertGitStatus(fileStatus));\n      }\n    },\n    []\n  );\n\nexport const useUpdateVcsFileStatuses = () =>\n  useRecoilCallback(\n    ({ snapshot, transact_UNSTABLE }: CallbackInterface) => async () => {\n      const vcsDirectoryMappings = await snapshot.getPromise(vcsRootsState);\n      return Promise.all(\n        vcsDirectoryMappings\n          .filter(({ vcs }) => vcs === \"git\")\n          .map(async ({ dir }) => {\n            console.time(\"statusMatrix\");\n            const rows = await statusMatrix({ fs, dir });\n            console.timeEnd(\"statusMatrix\");\n            transact_UNSTABLE(({ set }) => {\n              rows.forEach((row) => {\n                set(fileStatusState(`${dir}/${row[0]}`), convertGitStatus(row));\n              });\n            });\n          })\n      );\n    },\n    []\n  );\n\nexport const useInitializeVcs = () => {\n  const updateVcsFileStatuses = useUpdateVcsFileStatuses();\n  useEffect(() => {\n    updateVcsFileStatuses().catch((e) => {\n      console.error(\"could not initialize VCS file statuses\", e);\n    });\n  }, []);\n};\n","import { useTheme } from \"styled-components\";\nimport { Theme } from \"@intellij-platform/core\";\nimport { useRecoilValue } from \"recoil\";\nimport { fileStatusState } from \"./file-status.state\";\nimport React from \"react\";\nimport { FileStatus } from \"./file-status\";\n\nexport const useStatusColor = (status: FileStatus) => {\n  const theme = useTheme() as Theme;\n  switch (status) {\n    case \"MODIFIED\":\n      return theme.dark ? \"#6897bb\" : \"#0032a0\"; // FILESTATUS_MODIFIED key from colorScheme\n    case \"ADDED\":\n      return theme.dark ? \"#629755\" : \"#0a7700\"; // FILESTATUS_ADDED key from colorScheme\n    case \"DELETED\":\n      return theme.dark ? \"#6c6c6c\" : \"#616161\"; // FILESTATUS_DELETED key from colorScheme\n    case \"UNKNOWN\":\n      return theme.dark ? \"#d1675a\" : \"#993300\"; // FILESTATUS_UNKNOWN key from colorScheme\n  }\n  return undefined;\n};\nexport const useFileStatusColor = (filepath: string): string | undefined => {\n  const fileStatus = useRecoilValue(fileStatusState(filepath));\n  return useStatusColor(fileStatus);\n};\n\nexport const FileStatusColor: React.FC<{ filepath: string }> = ({\n  children,\n  filepath,\n}) => {\n  const color = useFileStatusColor(filepath);\n  return <span style={{ color }}>{children}</span>;\n};\n\nexport const StatusColor: React.FC<{ status: FileStatus }> = ({\n  children,\n  status,\n}) => {\n  const color = useStatusColor(status);\n  return <span style={{ color }}>{children}</span>;\n};\n","import { Selection } from \"@react-types/shared\";\nimport { TreeRef } from \"@intellij-platform/core\";\nimport { Key, RefObject } from \"react\";\nimport { atom, CallbackInterface, GetRecoilValue, selector } from \"recoil\";\nimport { currentProjectState, Project } from \"../Project/project.state\";\nimport { dirContentState, FsItem } from \"../fs/fs.state\";\nimport { filterPath } from \"../Project/project-utils\";\nimport { getParentPaths } from \"../file-utils\";\nimport * as path from \"path\";\n\ninterface FileTreeNodeBase {\n  parent: (FileTreeNodeBase & { children: FsItem[] }) | null;\n  name: string;\n}\n\nexport type FileTreeDirNode = FileTreeNodeBase &\n  FsItem & {\n    children: FileTreeNode[];\n  };\nexport type FileTreeFileNode = FileTreeNodeBase & FsItem;\nexport type FileTreeNode = FileTreeFileNode | FileTreeDirNode;\n\ninterface ProjectTreeRoot extends FileTreeNodeBase {\n  type: \"project\";\n  path: string;\n  children: FileTreeNode[];\n}\n\nexport type ProjectTreeNode =\n  | ProjectTreeRoot\n  | ProjectTreeRoot[\"children\"][number]; // type def can be improved\n\nexport const foldersOnTopState = atom({\n  key: \"projectView.foldersOnTop\",\n  default: true,\n});\n\nexport const expandedKeysState = atom({\n  key: \"projectView.expandedKeys\",\n  default: selector({\n    key: \"projectView.expandedKeys/default\",\n    get: ({ get }) => new Set<Key>([get(currentProjectState).path]),\n  }),\n});\n\nexport const selectedKeysState = atom<Selection>({\n  key: \"projectView.selectedKeys\",\n  default: new Set<Key>([]),\n});\n\nexport const projectViewTreeRefState = atom<null | RefObject<TreeRef>>({\n  key: \"projectView.focusHandle\",\n  default: null,\n  dangerouslyAllowMutability: true,\n});\n\nexport const currentProjectTreeState = selector({\n  key: \"projectTree\",\n  get: ({ get }) => {\n    const project = get(currentProjectState);\n    return createProjectTree(project, get);\n  },\n});\n\n// NOTE: this function could be sync, and those `await`s before `get` are unnecessary. They are there simply because\n// I didn't realize `get` returns the value, not Promise. But interestingly, when this function is made sync,\n// performance drastically drops for some reason. That needs to be investigated.\nasync function createProjectTree(\n  project: Project,\n  get: GetRecoilValue\n): Promise<ProjectTreeRoot> {\n  const rootItems = await get(dirContentState(project.path));\n  const mapItem = (parent: FileTreeDirNode | null) => async (\n    item: FsItem\n  ): Promise<FileTreeNode> => {\n    const name = path.basename(item.path);\n    const node = {\n      ...item,\n      name,\n      parent,\n    };\n    const dirNode: FileTreeDirNode = { ...node, children: [] };\n    if (item.type === \"dir\") {\n      dirNode.children = await Promise.all(\n        ((await get(dirContentState(item.path))) ?? ([] as FsItem[])).map(\n          mapItem(dirNode)\n        )\n      );\n    }\n    return item.type === \"dir\" ? dirNode : node;\n  };\n\n  return {\n    type: \"project\",\n    path: project.path,\n    name: project.name,\n    parent: null,\n    children: await Promise.all(\n      (rootItems || []).filter(filterPath).map(mapItem(null))\n    ),\n  };\n}\n\n/**\n * a function to be passed to useRecoilCallback to get back a callback for expanding to a certain path in project view.\n * @param snapshot\n * @param set\n */\nexport const expandToPathCallback = ({ snapshot, set }: CallbackInterface) => (\n  path: string\n) => {\n  const expandedKeys = snapshot.getLoadable(expandedKeysState).valueOrThrow();\n  const keysToExpand = [\n    snapshot.getLoadable(currentProjectState).valueOrThrow().path,\n  ].concat(getParentPaths(path));\n  set(expandedKeysState, new Set([...expandedKeys, ...keysToExpand]));\n};\n\n/**\n * a function to be passed to useRecoilCallback to get back a callback for selecting a file in project view and focusing\n * the project view.\n * // TODO: open project view tool window if needed, when tool window state is also moved to recoil instead of local\n * //  state.\n */\nexport const selectKeyAndFocusCallback = ({ snapshot }: CallbackInterface) => (\n  key: Key\n) => {\n  const treeRef = snapshot.getLoadable(projectViewTreeRefState).valueOrThrow()\n    ?.current;\n  treeRef?.replaceSelection(key);\n  treeRef?.focus(key);\n};\n","import {\n  HighlightedTextValue,\n  Item,\n  ItemLayout,\n  ItemStateContext,\n  PlatformIcon,\n  SpeedSearchTree,\n  TreeRef,\n} from \"@intellij-platform/core\";\nimport { identity, sortBy } from \"ramda\";\nimport React, { useContext, useLayoutEffect, useRef } from \"react\";\nimport { useRecoilState, useRecoilValue, useSetRecoilState } from \"recoil\";\nimport { DefaultSuspense } from \"../DefaultSuspense\";\nimport { useEditorStateManager } from \"../Editor/editor.state\";\nimport { DIR_ICON, FILE_ICON, getIconForFile } from \"../file-utils\";\nimport { currentProjectState } from \"../Project/project.state\";\nimport {\n  currentProjectTreeState,\n  expandedKeysState,\n  FileTreeDirNode,\n  FileTreeFileNode,\n  FileTreeNode,\n  foldersOnTopState,\n  ProjectTreeNode,\n  projectViewTreeRefState,\n  selectedKeysState,\n} from \"./ProjectView.state\";\nimport { FileStatusColor } from \"../VersionControl/FileStatusColor\";\n\nexport const ProjectViewPane = (): React.ReactElement => {\n  const project = useRecoilValue(currentProjectState);\n  const editor = useEditorStateManager();\n  const treeRef = useRef<TreeRef>(null);\n  const setProjectViewTreeRef = useSetRecoilState(projectViewTreeRefState);\n  useLayoutEffect(() => {\n    setProjectViewTreeRef(treeRef);\n  }, [treeRef]);\n\n  const projectTree = useRecoilValue(currentProjectTreeState);\n\n  const [expandedKeys, setExpandedKeys] = useRecoilState(expandedKeysState);\n  const [selectedKeys, setSelectedKeys] = useRecoilState(selectedKeysState);\n  const foldersOnTop = useRecoilValue(foldersOnTopState);\n\n  const sortItems = foldersOnTop\n    ? sortBy<ProjectTreeNode>((a) => (a.type === \"dir\" ? 1 : 2))\n    : identity;\n\n  return (\n    <DefaultSuspense>\n      <SpeedSearchTree\n        ref={treeRef}\n        items={[projectTree] as ProjectTreeNode[]}\n        onAction={(path) => {\n          editor.openPath(`${path}`);\n        }}\n        fillAvailableSpace\n        disallowEmptySelection\n        selectionMode=\"multiple\"\n        selectedKeys={selectedKeys}\n        onSelectionChange={setSelectedKeys}\n        expandedKeys={expandedKeys}\n        onExpandedChange={setExpandedKeys}\n      >\n        {(item) => (\n          <Item\n            key={item.path}\n            textValue={item.name}\n            childItems={\n              \"children\" in item ? sortItems(item.children) : undefined\n            }\n          >\n            <ItemLayout>\n              {<ProjectViewNodeIcon node={item} />}\n              {item.type === \"project\" ? (\n                <>\n                  <b>\n                    <HighlightedTextValue />\n                  </b>\n                  <ItemLayout.Hint>{project.path}</ItemLayout.Hint>\n                </>\n              ) : (\n                <FileTreeNodeText node={item} />\n              )}\n              {/* {\"loadingState\" in item &&\n                item.loadingState === \"loading\" && (\n                  <TreeNodeHint>\n                    <Img height={16} src={loading} darkSrc={loadingDark} />\n                  </TreeNodeHint>\n                )}*/}\n            </ItemLayout>\n          </Item>\n        )}\n      </SpeedSearchTree>\n    </DefaultSuspense>\n  );\n};\n\nconst FileTreeNodeText = ({ node }: { node: FileTreeNode }) => {\n  return node.type === \"dir\" ? (\n    // why is the explicit casting necessary? :/ isn't \"type\" enough for TS to figure out the right type?\n    <FileTreeDirNodeText node={node as FileTreeDirNode} />\n  ) : (\n    <FileTreeFileNodeText node={node as FileTreeFileNode} />\n  );\n};\n\nconst FileTreeDirNodeText = ({}: { node: FileTreeFileNode }) => (\n  // TODO: add support for \"Highlight directories that contain modified files in the Project tree\" (showDirtyRecursively)\n  <HighlightedTextValue />\n);\n\nconst FileTreeFileNodeText = ({\n  node,\n}: {\n  node: FileTreeFileNode;\n}): React.ReactElement => {\n  const state = useContext(ItemStateContext);\n  return state?.isSelected && state?.isFocused ? (\n    <HighlightedTextValue />\n  ) : (\n    <FileStatusColor filepath={node.path}>\n      <HighlightedTextValue />\n    </FileStatusColor>\n  );\n};\n\nconst nodeTypeIconMap: { [key in ProjectTreeNode[\"type\"]]?: string } = {\n  project: \"nodes/folder\",\n  dir: DIR_ICON,\n  file: FILE_ICON,\n};\n\nfunction findNodeIcon(value: ProjectTreeNode): string | null {\n  if (value.type === \"file\") {\n    return getIconForFile(value.name);\n  }\n  return nodeTypeIconMap[value.type] ?? null;\n}\n\nfunction ProjectViewNodeIcon({\n  node,\n}: {\n  node: ProjectTreeNode;\n}): React.ReactElement {\n  const icon = findNodeIcon(node);\n  return <>{icon && <PlatformIcon icon={icon} />}</>;\n}\n","import { Key } from \"react\";\n\ntype TreeFn<T> = (root: T | null) => null | readonly T[];\n\nexport const getExpandAllKeys = <T>(\n  /**\n   * represents a tree as a function. Given a node, it should return the array of children or null, if the node is a\n   * leaf. Note that even an empty array will make the node to be considered a non-leaf node and the key is included.\n   * if null is passed, the root(s) node(s) should be returned.\n   */\n  getChildren: TreeFn<T>,\n  /**\n   * a function that converts each node into a key\n   */\n  getKey: (t: T) => Key\n) => {\n  const roots = getChildren(null) || [];\n  const keys: Key[] = roots.map(getKey);\n  const processItem = (node: T | null) => {\n    const children = node ? getChildren(node) : null;\n    if (node == null || !children) {\n      return;\n    }\n    keys.push(getKey(node));\n    children.forEach(processItem);\n  };\n  roots.map(getChildren).flat().forEach(processItem);\n  return keys;\n};\n\nexport const dfsVisit = <T, R>(\n  getChildren: TreeFn<T>,\n  visit: (node: T, childrenValues: null | R[]) => R\n) => {\n  const nodes = getChildren(null) || [];\n  const dfs = (node: T): R => {\n    const children = getChildren(node);\n    const values = children?.map(dfs) ?? null;\n    return visit(node, values);\n  };\n  nodes.forEach(dfs);\n};\n","import {\n  ActionButton,\n  ActionTooltip,\n  PlatformIcon,\n  TooltipTrigger,\n} from \"@intellij-platform/core\";\nimport React from \"react\";\nimport { useRecoilCallback, useRecoilValue, useSetRecoilState } from \"recoil\";\nimport { activeEditorTabState } from \"../Editor/editor.state\";\nimport {\n  currentProjectTreeState,\n  expandedKeysState,\n  expandToPathCallback,\n  FileTreeDirNode,\n  ProjectTreeNode,\n  selectKeyAndFocusCallback,\n} from \"./ProjectView.state\";\nimport { getExpandAllKeys } from \"../TreeUtils/tree-utils\";\n\nexport const ProjectViewActionButtons = (): React.ReactElement => {\n  const setExpandedKeys = useSetRecoilState(expandedKeysState);\n  const root = useRecoilValue(currentProjectTreeState);\n  const activeTab = useRecoilValue(activeEditorTabState);\n\n  const expandToOpenedFile = useRecoilCallback(expandToPathCallback, []);\n  const selectKeyAndFocus = useRecoilCallback(selectKeyAndFocusCallback, []);\n  const selectOpenedFile = () => {\n    if (activeTab) {\n      expandToOpenedFile(activeTab.filePath);\n      selectKeyAndFocus(activeTab.filePath);\n    }\n  };\n\n  const collapseAll = () => setExpandedKeys(new Set()); // in Intellij, it also changes selection sometimes.\n  const expandAll = () => {\n    setExpandedKeys(\n      new Set(\n        getExpandAllKeys<ProjectTreeNode>(\n          (node) =>\n            node === null ? [root] : (node as FileTreeDirNode)?.children,\n          (node) => node.path\n        )\n      )\n    );\n  };\n  return (\n    <>\n      <TooltipTrigger\n        tooltip={<ActionTooltip actionName=\"Select Opened File\" />}\n      >\n        <ActionButton onPress={selectOpenedFile} isDisabled={!activeTab}>\n          <PlatformIcon icon=\"general/locate\" />\n        </ActionButton>\n      </TooltipTrigger>\n      <TooltipTrigger tooltip={<ActionTooltip actionName=\"Expand All\" />}>\n        <ActionButton onPress={expandAll}>\n          <PlatformIcon icon=\"actions/expandall\" />\n        </ActionButton>\n      </TooltipTrigger>\n      <TooltipTrigger tooltip={<ActionTooltip actionName=\"Collapse All\" />}>\n        <ActionButton onPress={collapseAll}>\n          <PlatformIcon icon=\"actions/collapseall\" />\n        </ActionButton>\n      </TooltipTrigger>\n    </>\n  );\n};\n","import React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport styled from \"styled-components\";\nimport * as Xterm from \"xterm\";\nimport { XTerm } from \"xterm-for-react\";\n\nconst useTerminalXtermOptions = (): Xterm.ITerminalOptions => {\n  return useMemo(\n    () => ({\n      theme: {\n        background: \"rgb(43,43,43)\", // CONSOLE_BACKGROUND_KEY from color scheme\n        selection: \"#214283\", // SELECTION_BACKGROUND?\n        // TODO: more colors\n      },\n      fontFamily: \"sans-serif\",\n      letterSpacing: -8,\n      fontSize: 12,\n      lineHeight: 1.3,\n      cursorStyle: \"block\",\n      cursorBlink: true,\n      cursorWidth: 8,\n      rendererType: \"dom\",\n    }),\n    []\n  );\n};\n\nconst StyledXterm = styled(XTerm)`\n  height: 100%;\n  background: rgb(43, 43, 43); // CONSOLE_BACKGROUND_KEY from color scheme\n`;\nexport const Terminal = (): React.ReactElement => {\n  const [input, setInput] = useState(\"\");\n  const xtermRef = useRef<XTerm | null>(null);\n\n  const options = useTerminalXtermOptions();\n  const PROMPT = \"$ \";\n  useEffect(() => {\n    setTimeout(() => {\n      xtermRef.current?.terminal.resize(80, 10);\n      xtermRef.current?.terminal.write(PROMPT);\n    }, 3000);\n  }, []);\n  return (\n    <StyledXterm\n      ref={xtermRef}\n      options={options}\n      onData={(data) => {\n        const code = data.charCodeAt(0);\n        // If the user hits empty and there is something typed echo it.\n        if (code === 13) {\n          if (input.length > 0) {\n            xtermRef.current?.terminal.write(\"\\r\\nYou typed: '\" + input + \"'\");\n          }\n          xtermRef.current?.terminal.write(\"\\r\\n\" + PROMPT);\n          setInput(\"\");\n        } else if (code < 32 || code === 127) {\n          // Disable control Keys such as arrow keys\n          return;\n        } else {\n          // Add general key press characters to the terminal\n          xtermRef.current?.terminal.write(data);\n          setInput(input + data);\n        }\n      }}\n    />\n  );\n};\n","import { atom, CallbackInterface, selector, useRecoilCallback } from \"recoil\";\nimport { checkout, resetIndex, statusMatrix, StatusRow } from \"isomorphic-git\";\nimport { fs } from \"../../fs/fs\";\nimport {\n  useUpdateFileStatus,\n  VcsRootForFile,\n  vcsRootsState,\n} from \"../file-status.state\";\nimport { useEffect } from \"react\";\nimport path from \"path\";\nimport { groupBy } from \"ramda\";\nimport { reloadFileFromDiskCallback } from \"../../fs/fs.state\";\n\nexport type Revision = {\n  path: string;\n  isDir: boolean;\n};\n\nexport interface Change {\n  before: Revision;\n  after: Revision;\n}\n\nexport interface ChangeListObj {\n  id: string;\n  name: string;\n  comment: string;\n  active: boolean;\n  changes: Change[];\n}\n\nexport const changeListsState = atom<ChangeListObj[]>({\n  key: \"changelists.lists\",\n  default: [\n    {\n      id: \"some-UUID\",\n      name: \"Changes\",\n      comment: \"last modified commit message\",\n      changes: [],\n      active: true,\n    },\n    {\n      id: \"some-other-UUID\",\n      name: \"Some other changelist\",\n      comment: \"Some empty changelist for testing\",\n      changes: [],\n      active: false,\n    },\n  ],\n});\n\nexport const activeChangeListState = selector<ChangeListObj | null>({\n  key: \"changelists.lists/default\",\n  get: ({ get }) =>\n    get(changeListsState).find((changeList) => changeList.active) ?? null,\n});\n\nexport const allChangesState = selector<ReadonlyArray<Change>>({\n  key: \"changelists.allChanges\",\n  get: ({ get }) =>\n    get(changeListsState)\n      .map((changeLists) => changeLists.changes)\n      .flat(),\n});\n\nconst isAChange = ([, head, workingDir, stage]: StatusRow): boolean =>\n  head !== 1 || workingDir !== 1 || stage !== 1;\n\nconst refreshChanges = ({ snapshot, set }: CallbackInterface) => async () => {\n  const gitRoots = (await snapshot.getPromise(vcsRootsState)).filter(\n    (root) => root.vcs === \"git\"\n  );\n  const allStatusMatrices = await Promise.all(\n    gitRoots.map(async ({ dir }) => {\n      const rows = await statusMatrix({ fs, dir });\n      return rows\n        .filter(isAChange)\n        .map(\n          ([pathname, ...theRest]) =>\n            [path.join(dir, pathname), ...theRest] as StatusRow\n        );\n    })\n  );\n  const unversionedPaths = []; // FIXME: handle unversioned files\n  const changes = allStatusMatrices\n    .flat()\n    .map(([path, head, workdir, stage]) => ({\n      // FIXME: change object creation doesn't cover all kind of changes.\n      after: { path, isDir: false },\n      before: { path, isDir: false },\n    }));\n\n  // FIXME: changes now all go to default change list on each refresh. fix it.\n  set(changeListsState, (changeLists) =>\n    changeLists.map((changeList) => {\n      if (changeList.active) {\n        console.log(changes);\n        return {\n          ...changeList,\n          changes,\n        };\n      }\n      return {\n        ...changeList,\n        changes: [],\n      };\n    })\n  );\n};\n\nexport interface ChangeListManager {\n  addChangeList(name: string, comment: string): void;\n  removeChangeList(id: string): void;\n  editChangeList(\n    id: string,\n    edits: { name?: string; comment?: string; active?: boolean }\n  ): void;\n  setActiveChangeList(id: string): void;\n  mergeChangeLists(sourceId: string, targetId: string): void;\n  moveChange(change: Change, toChangeListId: string): void;\n  refresh(): Promise<void>;\n  rollback(changes: readonly Change[]): Promise<void>;\n}\n\n/**\n * react hook that returns a rollback function which accepts a list of changes to rollback.\n */\nexport const useRollbackChanges = () => {\n  const updateFileStatus = useUpdateFileStatus();\n  return useRecoilCallback(\n    (callbackInterface) => async (changes: readonly Change[]) => {\n      const { snapshot, set } = callbackInterface;\n      const reloadFileFromDisk = reloadFileFromDiskCallback(callbackInterface);\n\n      const changesWithRepoRoots = await Promise.all(\n        changes\n          .filter((change) => !change.after.isDir)\n          .map(async (change) => {\n            const repoRoot = (await snapshot.getPromise(\n              VcsRootForFile(change.after.path)\n            ))!; // FIXME: handle null\n            return {\n              repoRoot,\n              fullPath: change.after.path,\n              relativePath: path.relative(repoRoot, change.after.path),\n            };\n          })\n      );\n      const groupedChanges = groupBy(\n        ({ repoRoot }) => repoRoot,\n        changesWithRepoRoots\n      );\n      await Promise.all(\n        Object.entries(groupedChanges).map(async ([repoRoot, items]) => {\n          await checkout({\n            fs,\n            dir: repoRoot,\n            force: true,\n            filepaths: items.map(({ relativePath }) => relativePath),\n          });\n          await Promise.all(\n            items.map(async ({ fullPath, relativePath }) => {\n              await resetIndex({ fs, dir: repoRoot, filepath: relativePath });\n              await reloadFileFromDisk(fullPath); // Since fileContent is an atom, we set the value. Could be a selector that we would refresh\n              return updateFileStatus(fullPath);\n            })\n          );\n        })\n      );\n\n      // Remove all changes from changelists. It's much more efficient than refresh.\n      set(changeListsState, (changeLists) =>\n        changeLists.map((changeList) => {\n          return {\n            ...changeList,\n            changes: changeList.changes.filter(\n              (change) => !changes.includes(change)\n            ),\n          };\n        })\n      );\n    },\n    []\n  );\n};\n\n/**\n * Exposes actions related to managing change lists, such as CRUD on change lists or refreshing the list of changes, etc.\n * NOTE: ChangeListManager is not used to get the list of changes or change lists, etc. that is to prevent unnecessary\n * re-renders when a component only needs to perform actions related to change lists, without caring about the state\n * of change lists. to get the list of change lists or active change list or list of all changes, there are several\n * other recoil values that can be used simply by `useRecoilValue` hook. of course setting those recoil values\n * is not expected to be done directly via recoil API, and can be prevented by not exposing the atoms/selectors\n * directly, and exposing small hooks that would simply call useRecoilValue.\n */\nexport const useChangeListManager = (): ChangeListManager => {\n  const refresh = useRecoilCallback(refreshChanges, []);\n  const rollback = useRollbackChanges();\n\n  const addChangeList = (name: string, comment: string) => {\n    throw new Error(\"Not implemented\");\n  };\n  const editChangeList = (\n    id: string,\n    edits: { name?: string; comment?: string; active?: boolean }\n  ) => {\n    throw new Error(\"Not implemented\");\n  };\n  const mergeChangeLists = (sourceId: string, targetId: string) => {\n    throw new Error(\"Not implemented\");\n  };\n  const moveChange = (change: Change, toChangeListId: string) => {\n    throw new Error(\"Not implemented\");\n  };\n  const removeChangeList = (id: string) => {\n    throw new Error(\"Not implemented\");\n  };\n  const setActiveChangeList = (id: string) => {\n    throw new Error(\"Not implemented\");\n  };\n  return {\n    addChangeList,\n    editChangeList,\n    mergeChangeLists,\n    moveChange,\n    removeChangeList,\n    setActiveChangeList,\n    refresh,\n    rollback,\n  };\n};\n\n// temporary, perhaps\nexport const useInitializeChanges = () => {\n  const { refresh } = useChangeListManager();\n  useEffect(() => {\n    refresh().catch((e) => console.error(\"could not initialize changes\", e));\n  }, [refresh]);\n};\n","import { constSelector, GetRecoilValue, selector } from \"recoil\";\nimport { vcsRootsState } from \"../../file-status.state\";\nimport { uniq } from \"ramda\";\nimport {\n  ChangeGrouping,\n  ChangeNode,\n  DirectoryNode,\n  directoryNode,\n  isDirectoryNode,\n  RepositoryNode,\n  repositoryNode,\n} from \"./ChangesView.state\";\nimport { getParentPaths } from \"../../../file-utils\";\n\nconst repositoryGrouping: ChangeGrouping<RepositoryNode, \"repository\"> = {\n  id: \"repository\",\n  title: \"Repository\",\n  isAvailable: selector({\n    key: \"repositoryGrouping/isAvailable\",\n    get: ({ get }) => get(vcsRootsState).length > 0,\n  }),\n  groupFn: selector({\n    key: \"repositoryGrouping/groupFn\",\n    get: ({ get }: { get: GetRecoilValue }) => (\n      nodes: ReadonlyArray<ChangeNode>\n    ) => {\n      const repos = get(vcsRootsState);\n      return repos.map(\n        (repository): RepositoryNode => {\n          return repositoryNode(\n            repository,\n            nodes.filter((node) =>\n              (node.change.after?.path || node.change.before?.path).startsWith(\n                repository.dir\n              )\n            )\n          );\n        }\n      );\n    },\n  }),\n};\n\nconst directoryGrouping: ChangeGrouping<DirectoryNode, \"directory\"> = {\n  id: \"directory\",\n  title: \"Directory\",\n  isAvailable: constSelector(true),\n  groupFn: (nodes: ReadonlyArray<ChangeNode>) => {\n    const pathToNodeCache: Record<string, DirectoryNode> = {};\n    const rootDirNodes = nodes.map((node) => {\n      if (node.change.after.isDir) {\n        throw new Error(\"isDir=true is not supported for changes ATM!\");\n      }\n      const filepath = node.change.after.path;\n      // noinspection UnnecessaryLocalVariableJS\n      const rootDirNode = getParentPaths(filepath).reduce(\n        (prevNode: DirectoryNode | ChangeNode, dirPath) => {\n          if (!pathToNodeCache[dirPath]) {\n            pathToNodeCache[dirPath] = directoryNode(dirPath, \"\");\n          }\n          if (prevNode.type === \"directory\") {\n            prevNode.parentNodePath = dirPath;\n          }\n          const dirNode = pathToNodeCache[dirPath];\n          dirNode.children = dirNode.children.includes(prevNode)\n            ? dirNode.children\n            : [prevNode, ...dirNode.children];\n          return dirNode;\n        },\n        node\n      ) as DirectoryNode; // This is gonna be true if the array is non-empty, but TS can't recongnize it.\n      // whether the array can be empty might be something to consider and guard against\n      return rootDirNode;\n    });\n    const collapseDirectories = (dirNode: DirectoryNode): DirectoryNode => {\n      let { children, dirPath } = dirNode;\n      if (\n        dirNode.children.length === 1 &&\n        isDirectoryNode(dirNode.children[0])\n      ) {\n        children = dirNode.children[0].children;\n        dirPath = dirNode.children[0].dirPath;\n      }\n      return {\n        ...dirNode,\n        dirPath,\n        children: children.map((child) =>\n          isDirectoryNode(child) ? collapseDirectories(child) : child\n        ),\n      };\n    };\n    return uniq(rootDirNodes).map(collapseDirectories);\n  },\n};\n\nexport const groupings = [repositoryGrouping, directoryGrouping];\n","import { atom, selector } from \"recoil\";\nimport { Change } from \"../change-lists.state\";\nimport {\n  AnyNode,\n  changesTreeNodesState,\n  getNodeKeyForChange,\n  isGroupNode,\n} from \"../ChangesView/ChangesView.state\";\nimport { Key } from \"react\";\nimport { dfsVisit, getExpandAllKeys } from \"../../../TreeUtils/tree-utils\";\nimport { Bounds, getDefaultBounds } from \"@intellij-platform/core/Window\";\n\nconst isOpen = atom<boolean>({\n  key: \"rollbackView.isOpen\",\n  default: false,\n});\nconst windowBounds = atom<Bounds>({\n  key: \"rollbackView.windowBounds\",\n  default: new Promise((resolve) => resolve(getDefaultBounds(500, 500))),\n});\nconst initiallyIncludedChanges = atom<ReadonlyArray<Change>>({\n  key: \"rollbackView.initiallySelectedChanges\",\n  default: [],\n});\nconst rootNodes = selector({\n  key: \"rollbackView.includedRootNodes\",\n  get: ({ get }) => {\n    const selectedChanges = get(initiallyIncludedChanges);\n    const { rootNodes } = get(changesTreeNodesState);\n    return rootNodes.filter(\n      ({ changeList: { changes, active } }) =>\n        (selectedChanges.length === 0 && active) ||\n        selectedChanges.some((change) => changes.includes(change))\n    );\n  },\n});\nconst initiallyExpandedKeys = selector({\n  key: \"rollbackView.initiallyExpandedKeys\",\n  get: ({ get }) => {\n    const includedChanges = get(initiallyIncludedChanges);\n    const nodes = get(rootNodes);\n    const expandedKeys: Key[] = [];\n    dfsVisit<AnyNode, boolean>(\n      (node) => (node ? (isGroupNode(node) ? node.children : null) : nodes),\n      (node, childValues) => {\n        const isExpanded: boolean =\n          childValues?.some((childValue) => childValue) ||\n          includedChanges.map(getNodeKeyForChange).includes(node.key);\n        if (isExpanded && isGroupNode(node)) {\n          expandedKeys.push(node.key);\n        }\n        return isExpanded;\n      }\n    );\n    return new Set(\n      expandedKeys.length\n        ? expandedKeys\n        : getExpandAllKeys<AnyNode>(\n            (node) =>\n              node == null ? nodes : isGroupNode(node) ? node.children : null,\n            (node) => node.key\n          )\n    );\n  },\n});\n\nexport const rollbackViewState = {\n  isOpen,\n  windowBounds,\n  initiallyExpandedKeys,\n  initiallyIncludedChanges,\n  rootNodes,\n};\n","import {\n  atom,\n  atomFamily,\n  CallbackInterface,\n  isRecoilValue,\n  RecoilValue,\n  selector,\n} from \"recoil\";\nimport { Selection } from \"@react-types/shared\";\nimport { Key } from \"react\";\nimport {\n  allChangesState,\n  Change,\n  ChangeListObj,\n  changeListsState,\n} from \"../change-lists.state\";\nimport { groupings } from \"./changesGroupings\";\nimport { VcsDirectoryMapping } from \"../../file-status\";\nimport { dfsVisit } from \"../../../TreeUtils/tree-utils\";\nimport {\n  createSetInterface,\n  NestedSelection,\n  NestedSelectionState,\n} from \"@intellij-platform/core\";\nimport { rollbackViewState } from \"../Rollback/rollbackView.state\";\n\nexport interface ChangeBrowserNode<T extends string> {\n  type: T;\n  key: string;\n}\n\nexport interface GroupNode<T extends string> extends ChangeBrowserNode<T> {\n  children: ReadonlyArray<AnyNode>;\n}\n\nexport interface ChangeNode extends ChangeBrowserNode<\"change\"> {\n  change: Change;\n}\n\nexport interface ChangeListNode extends GroupNode<\"changelist\"> {\n  changeList: ChangeListObj;\n}\n\nexport interface DirectoryNode extends GroupNode<\"directory\"> {\n  dirPath: string;\n  parentNodePath: string;\n}\n\nexport interface RepositoryNode extends GroupNode<\"repo\"> {\n  repository: VcsDirectoryMapping;\n}\n\nexport type AnyGroupNode = ChangeListNode | RepositoryNode | DirectoryNode;\nexport type AnyNode = AnyGroupNode | ChangeNode;\n\ntype MaybeRecoilValue<T> = T | RecoilValue<T>;\n\nexport type GroupFn<T extends AnyGroupNode> = (\n  nodes: ReadonlyArray<ChangeNode>\n) => ReadonlyArray<T>;\n\nexport interface ChangeGrouping<T extends AnyGroupNode, I = string> {\n  id: I;\n  title: string;\n  isAvailable: MaybeRecoilValue<boolean>;\n  groupFn: MaybeRecoilValue<GroupFn<T>>;\n}\n\nexport const currentBranchState = atomFamily<string, string>({\n  key: \"vcs/currentBranchName\",\n  default: \"master\",\n  // TODO: effect for syncing (when toolWindow state changes?)\n});\n\nexport const showIgnoredFilesState = atom({\n  key: \"changesView/showIgnoredFiles\",\n  default: false,\n});\n\nexport const showRelatedFilesState = atom({\n  key: \"changesView/showRelatedFiles\",\n  default: false,\n});\n\n// in a more extensible implementation, the id would be just string. but now that groupings are statically defined,\n// why not have more type safety\nexport type GroupingIds = typeof groupings[number][\"id\"];\n\nexport const changesGroupingState = atomFamily<boolean, GroupingIds>({\n  key: \"changesView/grouping\",\n  default: true, // it's false in IntelliJ\n});\n\n/**\n * Selection state for the changes tree. Selection here means UI selection of tree nodes, not the checkboxes.\n */\nexport const selectedKeysState = atom<Selection>({\n  key: \"changesView.selectedKeys\",\n  default: new Set<Key>([]),\n});\n\nexport const changesUnderSelectedKeys = selector<ReadonlyArray<Change>>({\n  key: \"changesView.selectedKeys.changes\",\n  get: ({ get }) => {\n    const selectedKeys = get(selectedKeysState);\n    const { byKey } = get(changesTreeNodesState);\n    if (selectedKeys === \"all\") {\n      return get(allChangesState);\n    }\n    const allChanges: Change[] = [];\n    const processNode = (node: AnyNode | undefined) => {\n      if (!node) {\n        return;\n      }\n      if (node.type === \"change\") {\n        allChanges.push(node.change);\n      }\n      if (isGroupNode(node)) {\n        node.children.forEach(processNode);\n      }\n    };\n    [...selectedKeys].map((key) => byKey.get(key)).forEach(processNode);\n    return allChanges;\n  },\n});\n\n/**\n * The list of changes that are included for the commit (via checkboxes).\n * TODO: for both this and tree selection state, value should be updated to exclude removed keys, when the tree data\n *  is changed\n */\nexport const includedChangeKeysState = atom<Set<string>>({\n  key: \"changesView.includedChangeKeys\",\n  default: new Set<string>([]),\n});\n\nexport const includedChangesState = selector<ReadonlyArray<Change>>({\n  key: \"changesView.includedChanges\",\n  get: ({ get }) => {\n    const includedChangeKeys = get(includedChangeKeysState);\n    const allChanges = get(allChangesState);\n    return allChanges.filter((change) =>\n      includedChangeKeys.has(getNodeKeyForChange(change))\n    );\n  },\n});\n\n/**\n * A NestedSelection state, inferred based on selected changes. NestedSelection holds the checkmark state of all nodes\n * based on the selected leaf nodes.\n */\nexport const includedChangesNestedSelection = selector<\n  NestedSelectionState<AnyNode>\n>({\n  key: \"changesView.selectedChanges.nestedSelectionState\",\n  get: ({ get, getCallback }) => {\n    const { rootNodes } = get(changesTreeNodesState);\n    const includedChangeKeys = get(includedChangeKeysState);\n    const setSelectedKeys = getCallback(\n      ({ set }) => (setValue: (currentValue: Set<string>) => Set<string>) =>\n        set(includedChangeKeysState, setValue)\n    );\n    return new NestedSelection(\n      {\n        items: includedChangeKeys,\n        ...createSetInterface(setSelectedKeys),\n      },\n      {\n        rootNodes,\n        getChildren: (item: AnyNode) =>\n          isGroupNode(item) ? item.children : null,\n        getKey: (item) => item.key,\n      }\n    );\n  },\n});\n\nexport const expandedKeysState = atom<Selection>({\n  key: \"changesView.expandedKeys\",\n  default: selector({\n    key: \"changesView.expandedKeys/temporaryDefault\",\n    get: ({ get }) => {\n      return new Set<Key>(\n        get(changesTreeNodesState)\n          .rootNodes.map((node) => [\n            node.key,\n            ...node.children.map((child) => child.key),\n          ])\n          .flat()\n      );\n    },\n  }),\n});\n\nexport const availableGroupingsState = selector({\n  key: \"changes.availableGroupings\",\n  get: ({ get }) =>\n    groupings\n      .filter((grouping) =>\n        isRecoilValue(grouping.isAvailable)\n          ? get(grouping.isAvailable)\n          : grouping.isAvailable\n      )\n      .map((grouping) => ({\n        grouping,\n        isActive: get(changesGroupingState(grouping.id)),\n      })),\n});\n\nconst changeBrowserNodeKey = (type: string, id: string): string =>\n  `${type}_${id}`;\n\nexport const getNodeKeyForChange = (change: Change) =>\n  changeBrowserNodeKey(\"change\", change.after.path);\n\nexport const changeNode = (change: Change): ChangeNode => ({\n  type: \"change\",\n  key: getNodeKeyForChange(change),\n  change,\n});\n\nexport const changeListNode = (\n  changeList: ChangeListObj,\n  groupFn: GroupFn<any> = (i) => i\n): ChangeListNode => ({\n  type: \"changelist\",\n  key: changeBrowserNodeKey(\"changelist\", changeList.id),\n  changeList,\n  children: groupFn(changeList.changes.map((change) => changeNode(change))),\n});\n\nexport const directoryNode = (\n  dirPath: string,\n  parentNodePath: string,\n  children: AnyNode[] = []\n): DirectoryNode => ({\n  type: \"directory\",\n  key: changeBrowserNodeKey(\"directory\", dirPath),\n  dirPath,\n  parentNodePath,\n  children,\n});\n\nexport const repositoryNode = (\n  repository: VcsDirectoryMapping,\n  children: AnyNode[] = []\n): RepositoryNode => ({\n  type: \"repo\",\n  key: changeBrowserNodeKey(\"repo\", repository.dir),\n  repository,\n  children,\n});\n\nexport const isGroupNode = (\n  node: ChangeBrowserNode<any>\n): node is GroupNode<any> => \"children\" in node;\n\nconst isChangeNode = (node: ChangeBrowserNode<any>): node is ChangeNode =>\n  node.type === \"change\";\n\nexport const isDirectoryNode = (node: AnyNode): node is DirectoryNode =>\n  node.type === \"directory\";\n\nconst recursiveGrouping = (\n  groupingFns: Array<GroupFn<AnyGroupNode>>,\n  nodes: ReadonlyArray<ChangeBrowserNode<any>>\n): ReadonlyArray<AnyGroupNode> => {\n  if (groupingFns.length === 0 || nodes.length === 0) {\n    return nodes as ReadonlyArray<AnyGroupNode>; // can we avoid explicit cast?\n  }\n  const nextGroupingFns = groupingFns.slice(1);\n  const changeNodes = nodes.filter(isChangeNode);\n  const groupNodes = nodes.filter(isGroupNode);\n  const groups = groupingFns[0](changeNodes);\n\n  [...groupNodes, ...groups].forEach((groupNode) => {\n    groupNode.children = recursiveGrouping(nextGroupingFns, groupNode.children);\n  });\n  return groups;\n};\n\nconst getChildren = (node: AnyNode) =>\n  isGroupNode(node) ? node.children : null;\n\nexport const changesTreeNodesState = selector<{\n  rootNodes: ChangeListNode[];\n  fileCountsMap: Map<Key, number>;\n  byKey: Map<Key, AnyNode>;\n}>({\n  key: \"changesView.treeNodes\",\n  get: ({ get }) => {\n    const resolve = <T>(value: MaybeRecoilValue<T>): T =>\n      isRecoilValue(value) ? get(value) : value;\n    const changeLists = get(changeListsState);\n    const groupFns = get(availableGroupingsState)\n      .filter(({ isActive }) => isActive)\n      .map(({ grouping }) => {\n        return resolve(grouping.groupFn);\n      });\n\n    const groupChanges = (changes: readonly ChangeNode[]) =>\n      recursiveGrouping(groupFns, changes);\n\n    const rootNodes = changeLists.map((changeList) =>\n      changeListNode(changeList, groupChanges)\n    );\n    const fileCountsMap = new Map();\n    const byKey = new Map();\n    const getFileCount = (node: GroupNode<any>): number => {\n      return node.children.reduce(\n        (totalSum, child) =>\n          totalSum + (isGroupNode(child) ? getFileCount(child) : 1),\n        0\n      );\n    };\n    dfsVisit<AnyNode, number>(\n      (root) => (root === null ? rootNodes : getChildren(root)),\n      (node, childrenFileCount) => {\n        byKey.set(node.key, node);\n        if (!childrenFileCount) {\n          return 1;\n        }\n        const fileCount = childrenFileCount.reduce(\n          (total, count) => total + count,\n          0\n        );\n        fileCountsMap.set(node.key, fileCount);\n        return fileCount;\n      }\n    );\n    return { rootNodes, fileCountsMap, byKey };\n  },\n});\n\n/**\n * Commit message split width, when the commit tool window is rendered in vertical layout\n */\nexport const commitMessageSizeState = atomFamily<\n  number,\n  \"horizontal\" | \"vertical\"\n>({\n  key: \"changesView/splitter/commitMessageSize\",\n  default: (orientation) => (orientation === \"horizontal\" ? 0.4 : 0.3),\n});\n/**\n * Whether --amend should be used for commit.\n */\nexport const amendCommitState = atom({\n  key: \"changesView/amendCommit\",\n  default: false,\n  // TODO: add a side effect to update message to the one from the last commit, when toggled to true.\n  // it should add a record to the commit message history and switch the message. When toggled to false,\n  // last entry in history should be back again. There is currently no history :D\n});\n/**\n * commit message text bound to the editor.\n */\nexport const commitMessageState = atom({\n  key: \"changesView/commitMessage\",\n  default: \"\",\n});\n\nexport const openRollbackWindowForSelectionCallback = ({\n  set,\n  snapshot,\n}: CallbackInterface) => () => {\n  const changesUnderSelection = snapshot\n    .getLoadable(changesUnderSelectedKeys)\n    .getValue();\n  set(rollbackViewState.initiallyIncludedChanges, changesUnderSelection);\n  set(rollbackViewState.isOpen, true);\n};\n","import { useRecoilCallback, useRecoilValue, useSetRecoilState } from \"recoil\";\nimport {\n  changesUnderSelectedKeys,\n  getNodeKeyForChange,\n  includedChangeKeysState,\n  openRollbackWindowForSelectionCallback,\n  selectedKeysState,\n} from \"./ChangesView.state\";\nimport {\n  Item,\n  Menu,\n  MenuItemLayout,\n  PlatformIcon,\n} from \"@intellij-platform/core\";\nimport React from \"react\";\n\nimport { useChangeViewContext } from \"./ChangesViewSplitter\";\nimport { useEditorStateManager } from \"../../../Editor/editor.state\";\n\nexport const ChangesViewTreeContextMenu = () => {\n  const selectedChanges = useRecoilValue(changesUnderSelectedKeys);\n  const setIncludedChangeKeys = useSetRecoilState(includedChangeKeysState);\n  const selectedKeys = useRecoilValue(selectedKeysState);\n  const disabledKeys = [\"moveToChangelist\"];\n  const { focusCommitMessage } = useChangeViewContext();\n  const editorStateManager = useEditorStateManager();\n  const openRollbackWindowForSelection = useRecoilCallback(\n    openRollbackWindowForSelectionCallback,\n    []\n  );\n  if (selectedChanges.length === 0) {\n    disabledKeys.push(\"commit\");\n  }\n\n  if ([...selectedKeys].length === 0) {\n    return null;\n  }\n  return (\n    <Menu\n      disabledKeys={disabledKeys}\n      aria-label=\"Context menu\"\n      onAction={(key) => {\n        switch (key) {\n          case \"commit\":\n            setIncludedChangeKeys(\n              new Set(selectedChanges.map(getNodeKeyForChange))\n            );\n            focusCommitMessage();\n            break;\n          case \"rollback\":\n            openRollbackWindowForSelection();\n            break;\n          case \"jumpToSource\":\n            selectedChanges.forEach((change, index, arr) => {\n              if (!change.after.isDir) {\n                editorStateManager.openPath(\n                  change.after.path,\n                  index === arr.length - 1\n                );\n              }\n            });\n            break;\n        }\n      }}\n    >\n      <Item key=\"commit\" textValue=\"Commit\">\n        Commit file{selectedChanges.length > 1 ? \"s\" : \"\"}...\n      </Item>\n      <Item key=\"rollback\" textValue=\"Rollback\">\n        <MenuItemLayout\n          icon={<PlatformIcon icon={\"actions/rollback.svg\"} />}\n          content=\"Rollback...\"\n        />\n      </Item>\n      <Item key=\"moveToChangelist\">Move to another Changelist...</Item>\n      <Item key=\"jumpToSource\" textValue=\"Jump to source\">\n        <MenuItemLayout\n          icon={<PlatformIcon icon={\"actions/editSource.svg\"} />}\n          content=\"Jump to source\"\n        />\n      </Item>\n    </Menu>\n  );\n};\n","import { styled, Theme } from \"@intellij-platform/core\";\nimport React from \"react\";\nimport { useRecoilValue } from \"recoil\";\nimport { vcsRootsState } from \"../../file-status.state\";\nimport { useTheme } from \"styled-components\";\n\nconst StyledRepoColorSquare = styled.span`\n  width: 14px;\n  height: 14px;\n  align-self: center;\n  margin-right: 0.1rem;\n  position: relative;\n\n  //  after pseudo element is used to create the color mixing implemented here:\n  //  https://github.com/JetBrains/intellij-community/blob/82f201386c3f7a339ff25fc8f3389024c8078a87/platform/vcs-log/impl/src/com/intellij/vcs/log/ui/VcsLogColorManagerImpl.java#L60\n  &&:after {\n    content: \"\";\n    position: absolute;\n    inset: 0;\n    opacity: 0.75;\n    background: ${({ theme }) =>\n      theme.color(\"Table.background\") || (theme.dark ? \"#3C3F41\" : \"#fff\")};\n  }\n`;\n\nconst useRepoRootColor = (rootPath: string) => {\n  const index = useRecoilValue(vcsRootsState).findIndex(\n    (root) => root.dir === rootPath\n  );\n  const theme = useTheme() as Theme;\n  const colors = [theme.commonColors.red, theme.commonColors.blue];\n  return colors[index % colors.length] ?? colors[0];\n};\n\nexport const RepoColorIcon = ({ rootPath }: { rootPath: string }) => (\n  <StyledRepoColorSquare\n    style={{ backgroundColor: useRepoRootColor(rootPath) }}\n  />\n);\n","import React from \"react\";\nimport {\n  Color,\n  SelectionAwareSpan,\n  styled,\n  UnknownThemeProp,\n} from \"@intellij-platform/core\";\n\nexport const StyledCurrentBranchTag = styled(SelectionAwareSpan)`\n  display: inline-flex;\n  align-self: center;\n  height: 1.1rem;\n  line-height: 1.1rem;\n  padding: 0 0.25rem;\n\n  background: ${({ theme }) =>\n    new Color(\n      theme.color(\n        \"VersionControl.RefLabel.backgroundBase\",\n        theme.dark ? \"#fff\" : \"#000\"\n      )\n    )\n      .withTransparency(\n        theme.value<number>(\"VersionControl.RefLabel.backgroundBrightness\") ??\n          0.08\n      )\n      .toString()};\n  color: ${({ theme }) =>\n    theme.color(\n      \"VersionControl.RefLabel.foreground\" as UnknownThemeProp<\"VersionControl.RefLabel.foreground\">,\n      theme.dark ? \"#909090\" : \"#7a7a7a\"\n    )};\n`;\n","import React from \"react\";\nimport { VcsDirectoryMapping } from \"./file-status\";\nimport { currentBranchState } from \"./Changes/ChangesView/ChangesView.state\";\nimport { useRecoilValue } from \"recoil\";\n\nexport const CurrentBranchName = ({ repo }: { repo?: VcsDirectoryMapping }) => {\n  const branch = useRecoilValue(currentBranchState(repo?.dir ?? \"\"));\n  return <>{branch}</>;\n};\n","import { IntlMessageFormat } from \"intl-messageformat\";\nimport {\n  AnyNode,\n  ChangeBrowserNode,\n  ChangeListNode,\n  ChangeNode,\n  changesGroupingState,\n  DirectoryNode,\n  isGroupNode,\n  RepositoryNode,\n} from \"./ChangesView.state\";\nimport React, { Key } from \"react\";\nimport { ItemProps } from \"@react-types/shared\";\nimport path from \"path\";\nimport {\n  HighlightedTextValue,\n  ItemLayout,\n  PlatformIcon,\n} from \"@intellij-platform/core\";\nimport { RepoColorIcon } from \"./StyledRepoColorSquare\";\nimport { StyledCurrentBranchTag } from \"./StyledCurrentBranchTag\";\nimport { CurrentBranchName } from \"../../CurrentBranchName\";\nimport { DIR_ICON, getIconForFile } from \"../../../file-utils\";\nimport { useRecoilValue } from \"recoil\";\n\n/**\n * Necessary properties for each node, to be passed to `Item`s rendered in tree.\n * Some properties like `key` or `childItems` are not included, as they are calculated similarly\n * for all types of nodes.\n */\ntype RenderedNode = { textValue: string; rendered: React.ReactNode };\ntype NodeRenderer<T extends ChangeBrowserNode<any>> = (\n  node: T,\n  metadata: { fileCount: number; dirCount: number }\n) => RenderedNode;\nconst fileCountMsg = new IntlMessageFormat(\n  `{fileCount, plural,\n    =0 {No files}\n    =1 {1 file}\n    other {# files}\n  }`,\n  \"en-US\"\n);\nconst repoNodeItemProps: NodeRenderer<RepositoryNode> = (\n  node,\n  { fileCount }\n) => ({\n  textValue: path.basename(node.repository.dir),\n  rendered: (\n    <ItemLayout>\n      <RepoColorIcon rootPath={node.repository.dir} />\n      <HighlightedTextValue />\n      <ItemLayout.Hint>{fileCountMsg.format({ fileCount })}</ItemLayout.Hint>\n      <StyledCurrentBranchTag>\n        <CurrentBranchName repo={node.repository} />\n      </StyledCurrentBranchTag>\n    </ItemLayout>\n  ),\n});\nconst directoryNodeItemProps: NodeRenderer<DirectoryNode> = (\n  node,\n  { fileCount }\n) => ({\n  textValue: path.relative(node.parentNodePath, node.dirPath),\n  rendered: (\n    <ItemLayout>\n      <PlatformIcon icon={DIR_ICON} />\n      <HighlightedTextValue />\n      <ItemLayout.Hint>{fileCountMsg.format({ fileCount })}</ItemLayout.Hint>\n    </ItemLayout>\n  ),\n});\nconst changeListNodeItemProps: NodeRenderer<ChangeListNode> = (\n  node,\n  { fileCount }\n) => ({\n  textValue: node.changeList.name,\n  rendered: (\n    <ItemLayout>\n      <span style={{ fontWeight: node.changeList.active ? \"bold\" : undefined }}>\n        <HighlightedTextValue />\n      </span>\n      <ItemLayout.Hint>\n        {fileCountMsg.format({ fileCount })}{\" \"}\n        {/*in IntelliJ it's not shown if it's empty, but why not!*/}\n      </ItemLayout.Hint>\n    </ItemLayout>\n  ),\n});\nconst ChangeNodeHint = ({ node }: { node: ChangeNode }): React.ReactElement => {\n  const isGroupedByDirectory = useRecoilValue(\n    changesGroupingState(\"directory\")\n  );\n  return (\n    <ItemLayout.Hint>\n      {!isGroupedByDirectory && path.dirname(node.change.after.path)}\n    </ItemLayout.Hint>\n  );\n};\nconst changeNodeItemProps: NodeRenderer<ChangeNode> = (node) => ({\n  textValue: path.basename(node.change.after.path),\n  rendered: (\n    <ItemLayout>\n      <PlatformIcon icon={getIconForFile(node.change.after.path)} />\n      <HighlightedTextValue />\n      <ChangeNodeHint node={node} />\n    </ItemLayout>\n  ),\n});\n\nconst nodeRenderers: {\n  [type in AnyNode[\"type\"]]: NodeRenderer<AnyNode & { type: type }>;\n} = {\n  repo: repoNodeItemProps,\n  directory: directoryNodeItemProps,\n  changelist: changeListNodeItemProps,\n  change: changeNodeItemProps,\n};\n\nexport const getChangeListTreeItemProps = ({\n  node,\n  fileCountsMap,\n}: {\n  node: AnyNode;\n  fileCountsMap: Map<Key, number>;\n}): ItemProps<AnyNode> & { key: Key } => {\n  // Would make sense to handle missing renderer case if implementation is changed to be extensible with regard\n  // to node types\n  const nodeRenderer: NodeRenderer<any> /* FIXME: why is any needed? */ =\n    nodeRenderers[node.type];\n  const { textValue, rendered } = nodeRenderer(node, {\n    fileCount: fileCountsMap.get(node.key) || 0,\n    dirCount: 0, // It seems it's only used for ignored files subtree\n  });\n  return {\n    key: node.key,\n    childItems: isGroupNode(node) ? node.children : [],\n    hasChildItems: isGroupNode(node) && node.children?.length > 0,\n    textValue,\n    children: rendered,\n  };\n};\n","import React from \"react\";\nimport { useRecoilState, useRecoilValue } from \"recoil\";\nimport {\n  ContextMenuContainer,\n  Item,\n  SpeedSearchTreeWithCheckboxes,\n  TreeNodeCheckbox,\n} from \"@intellij-platform/core\";\nimport {\n  changesTreeNodesState,\n  expandedKeysState,\n  includedChangesNestedSelection,\n  selectedKeysState,\n} from \"./ChangesView.state\";\nimport { ChangesViewTreeContextMenu } from \"./ChangesViewTreeContextMenu\";\nimport { getChangeListTreeItemProps } from \"./changesTreeNodeRenderers\";\n\n/**\n * TODO: fix horizontal scroll issue (https://github.com/alirezamirian/jui/issues/6)\n * TODO: use the real changes instead of the dummy ones\n * TODO: unversioned files\n * TODO: show diff/source on double click (on action to be more precise)\n */\nexport const ChangeViewTree = (): JSX.Element => {\n  const { rootNodes, fileCountsMap } = useRecoilValue(changesTreeNodesState);\n  const [selectedKeys, setSelectedKeys] = useRecoilState(selectedKeysState);\n  const [expandedKeys, setExpandedKeys] = useRecoilState(expandedKeysState);\n  const nestedSelection = useRecoilValue(includedChangesNestedSelection);\n\n  return (\n    <ContextMenuContainer\n      renderMenu={() => <ChangesViewTreeContextMenu />}\n      style={{ height: \"100%\" }}\n    >\n      <SpeedSearchTreeWithCheckboxes\n        items={rootNodes}\n        selectionMode=\"multiple\"\n        selectedKeys={selectedKeys}\n        expandedKeys={expandedKeys}\n        onExpandedChange={setExpandedKeys}\n        onSelectionChange={setSelectedKeys}\n        nestedSelection={nestedSelection}\n        disallowEmptySelection\n        fillAvailableSpace\n      >\n        {(node) => {\n          const props = getChangeListTreeItemProps({\n            fileCountsMap,\n            node,\n          });\n          return (\n            <Item {...props}>\n              {node.children?.length !== 0 && (\n                <TreeNodeCheckbox\n                  selectionState={nestedSelection.getSelectionState(node)}\n                  onToggle={() => nestedSelection.toggle(node)}\n                />\n              )}\n              {props.children}\n            </Item>\n          );\n        }}\n      </SpeedSearchTreeWithCheckboxes>\n    </ContextMenuContainer>\n  );\n};\n","import React from \"react\";\nimport {\n  ActionButtonWithMenu,\n  Item,\n  Menu,\n  MenuItemLayout,\n  PlatformIcon,\n} from \"@intellij-platform/core\";\n\nexport const ChangeListsActionButton = (): React.ReactElement => {\n  // Grouping is extensible in Intellij platform, but we only support grouping by directory here.\n\n  return (\n    <ActionButtonWithMenu\n      renderMenu={({ menuProps }) => (\n        <Menu\n          {...menuProps}\n          onAction={(key) => {\n            alert(\"Not implemented\");\n          }}\n        >\n          <Item key=\"new\">\n            <MenuItemLayout\n              content=\"New Changelist...\"\n              icon={<PlatformIcon icon=\"general/add.svg\" />}\n            />\n          </Item>\n          <Item key=\"edit\">\n            <MenuItemLayout\n              content=\"Edit Changelist...\"\n              icon={<PlatformIcon icon=\"actions/edit.svg\" />}\n            />\n          </Item>\n          <Item key=\"delete\">\n            <MenuItemLayout\n              content=\"Delete Changelist\"\n              icon={<PlatformIcon icon=\"general/remove.svg\" />}\n            />\n          </Item>\n          <Item key=\"moveToAnotherChangelist\">\n            <MenuItemLayout content=\"Move Files to Another Changelist...\" />\n          </Item>\n        </Menu>\n      )}\n    >\n      <PlatformIcon icon=\"vcs/changelist.svg\" />\n    </ActionButtonWithMenu>\n  );\n};\n","import React from \"react\";\nimport { useRecoilCallback, useRecoilValue } from \"recoil\";\nimport {\n  availableGroupingsState,\n  changesGroupingState,\n  GroupingIds,\n} from \"../ChangesView.state\";\nimport {\n  ActionButtonWithMenu,\n  Item,\n  Menu,\n  PlatformIcon,\n  Section,\n} from \"@intellij-platform/core\";\n\nexport const GroupByActionButton = (): React.ReactElement => {\n  // Grouping is extensible in Intellij platform, but we only support grouping by directory here.\n\n  const availableGroupings = useRecoilValue(availableGroupingsState);\n\n  const toggleGroup = useRecoilCallback(\n    ({ set }) => (id: GroupingIds) => {\n      set(changesGroupingState(id), (value) => !value);\n    },\n    []\n  );\n\n  return (\n    <ActionButtonWithMenu\n      renderMenu={({ menuProps }) => (\n        <Menu\n          {...menuProps}\n          selectedKeys={availableGroupings\n            .filter(({ isActive }) => isActive)\n            .map(({ grouping }) => grouping.id)}\n          onAction={(key) => {\n            const id = availableGroupings.find(\n              ({ grouping }) => grouping.id === key\n            )?.grouping.id;\n            if (id) {\n              toggleGroup(id);\n            }\n          }}\n        >\n          <Section title=\"Group By\">\n            {availableGroupings.map(({ grouping }) => (\n              <Item key={grouping.id}>{grouping.title}</Item>\n            ))}\n          </Section>\n        </Menu>\n      )}\n    >\n      <PlatformIcon icon=\"actions/groupBy.svg\" />\n    </ActionButtonWithMenu>\n  );\n};\n","import React from \"react\";\nimport { useRecoilState } from \"recoil\";\nimport {\n  showIgnoredFilesState,\n  showRelatedFilesState,\n} from \"../ChangesView.state\";\nimport {\n  ActionButtonWithMenu,\n  Item,\n  Menu,\n  PlatformIcon,\n} from \"@intellij-platform/core\";\n\nexport const ViewOptionsActionButton = (): React.ReactElement => {\n  const [showRelatedFiles, setShowRelatedFiles] = useRecoilState(\n    showRelatedFilesState\n  );\n  const [showIgnoredFiles, setShowIgnoredFiles] = useRecoilState(\n    showIgnoredFilesState\n  );\n  const viewOptions = { showRelatedFiles, showIgnoredFiles };\n\n  return (\n    <ActionButtonWithMenu\n      renderMenu={({ menuProps }) => (\n        <Menu\n          {...menuProps}\n          selectedKeys={Object.keys(viewOptions).filter(\n            (key) => viewOptions[key as keyof typeof viewOptions]\n          )}\n          onAction={(key) => {\n            switch (key) {\n              case \"showIgnoredFiles\":\n                return setShowIgnoredFiles((value) => !value);\n              case \"showRelatedFiles\":\n                return setShowRelatedFiles((value) => !value);\n            }\n          }}\n        >\n          <Item key=\"showIgnoredFiles\">Show Ignored Files</Item>\n          <Item key=\"showRelatedFiles\">\n            Show Files Related to Active Changelist\n          </Item>\n        </Menu>\n      )}\n    >\n      <PlatformIcon icon=\"actions/show.svg\" />\n    </ActionButtonWithMenu>\n  );\n};\n","import { useChangeListManager } from \"../change-lists.state\";\nimport { useRecoilCallback, useSetRecoilState } from \"recoil\";\nimport {\n  AnyNode,\n  changesTreeNodesState,\n  expandedKeysState,\n  GroupNode,\n  openRollbackWindowForSelectionCallback,\n} from \"./ChangesView.state\";\nimport { getExpandAllKeys } from \"../../../TreeUtils/tree-utils\";\nimport {\n  ActionButton,\n  ActionToolbar,\n  ActionToolbarSeparator,\n  ActionTooltip,\n  PlatformIcon,\n  TooltipTrigger,\n} from \"@intellij-platform/core\";\nimport { ChangeListsActionButton } from \"./ActionButtons/ChangeListsActionButton\";\nimport { GroupByActionButton } from \"./ActionButtons/GroupByActionButton\";\nimport { ViewOptionsActionButton } from \"./ActionButtons/ViewOptionsActionButton\";\nimport React from \"react\";\n\nexport function ChangesViewToolbar() {\n  const { refresh } = useChangeListManager();\n  const openRollbackWindow = useRecoilCallback(\n    openRollbackWindowForSelectionCallback,\n    []\n  );\n  const setExpandedKeys = useSetRecoilState(expandedKeysState);\n  const collapseAll = () => setExpandedKeys(new Set()); // in Intellij, it also changes selection sometimes.\n  const expandAll = useRecoilCallback(\n    ({ set, snapshot }) => () => {\n      set(\n        expandedKeysState,\n        new Set(\n          getExpandAllKeys<AnyNode>(\n            (node) =>\n              node === null\n                ? snapshot.getLoadable(changesTreeNodesState).valueMaybe()\n                    ?.rootNodes || []\n                : (node as GroupNode<any>)?.children,\n            (item) => item.key\n          )\n        )\n      );\n    },\n    []\n  );\n  return (\n    <ActionToolbar hasBorder>\n      <TooltipTrigger tooltip={<ActionTooltip actionName=\"Refresh\" />}>\n        <ActionButton onPress={refresh}>\n          <PlatformIcon icon=\"actions/refresh.svg\" />\n        </ActionButton>\n      </TooltipTrigger>\n      <TooltipTrigger tooltip={<ActionTooltip actionName=\"Rollback...\" />}>\n        <ActionButton onPress={openRollbackWindow}>\n          <PlatformIcon icon=\"actions/rollback.svg\" />\n        </ActionButton>\n      </TooltipTrigger>\n      <TooltipTrigger tooltip={<ActionTooltip actionName=\"Show Diff\" />}>\n        <ActionButton onPress={() => alert(\"Not implemented\")}>\n          <PlatformIcon icon=\"actions/diff.svg\" />\n        </ActionButton>\n      </TooltipTrigger>\n      <TooltipTrigger tooltip={<ActionTooltip actionName=\"Changelists\" />}>\n        <ChangeListsActionButton />\n      </TooltipTrigger>\n      <TooltipTrigger tooltip={<ActionTooltip actionName=\"Shelve Silently\" />}>\n        <ActionButton onPress={() => alert(\"Not implemented\")}>\n          <PlatformIcon icon=\"vcs/shelveSilent.svg\" />\n        </ActionButton>\n      </TooltipTrigger>\n      <ActionToolbarSeparator />\n      <TooltipTrigger tooltip={<ActionTooltip actionName=\"Group By\" />}>\n        <GroupByActionButton />\n      </TooltipTrigger>\n      <TooltipTrigger tooltip={<ActionTooltip actionName=\"View Options\" />}>\n        <ViewOptionsActionButton />\n      </TooltipTrigger>\n      <TooltipTrigger tooltip={<ActionTooltip actionName=\"Expand All\" />}>\n        <ActionButton onPress={expandAll}>\n          <PlatformIcon icon=\"actions/expandall.svg\" />\n        </ActionButton>\n      </TooltipTrigger>\n      <TooltipTrigger tooltip={<ActionTooltip actionName=\"Collapse All\" />}>\n        <ActionButton onPress={collapseAll}>\n          <PlatformIcon icon=\"actions/collapseall.svg\" />\n        </ActionButton>\n      </TooltipTrigger>\n    </ActionToolbar>\n  );\n}\n","import React from \"react\";\nimport { Change } from \"./change-lists.state\";\nimport { StatusColor } from \"../FileStatusColor\";\n\nexport const ChangesSummary = ({\n  changes,\n}: {\n  changes: ReadonlyArray<Change>;\n}) => {\n  const modifiedCount = changes.filter(\n    (change) => change.after.path && change.before.path\n  ).length;\n  const addedCount = changes.filter(\n    (change) => change.after.path && !change.before.path\n  ).length;\n  const deletedCount = changes.filter(\n    (change) => change.before.path && !change.after.path\n  ).length;\n\n  return (\n    <>\n      {addedCount > 0 && (\n        <StatusColor status=\"ADDED\">{addedCount} added</StatusColor>\n      )}\n      {modifiedCount > 0 && (\n        <StatusColor status=\"MODIFIED\">{modifiedCount} modified</StatusColor>\n      )}\n      {deletedCount > 0 && (\n        <StatusColor status=\"DELETED\">{deletedCount} deleted</StatusColor>\n      )}\n    </>\n  );\n};\n","import styled from \"styled-components\";\nimport {\n  ActionButton,\n  ActionHelpTooltip,\n  ActionTooltip,\n  Button,\n  Checkbox,\n  getAnchorOrientation,\n  PlatformIcon,\n  ThreeViewSplitter,\n  TooltipTrigger,\n  useDefaultToolWindowContext,\n  useToolWindowState,\n} from \"@intellij-platform/core\";\nimport { useRecoilState, useRecoilValue } from \"recoil\";\nimport {\n  amendCommitState,\n  commitMessageSizeState,\n  commitMessageState,\n  includedChangesState,\n} from \"./ChangesView.state\";\nimport React, { useContext, useImperativeHandle, useRef } from \"react\";\nimport { ChangeViewTree } from \"./ChangeViewTree\";\nimport { ChangesViewToolbar } from \"./ChangesViewToolbar\";\nimport { ChangesSummary } from \"../ChangesSummary\";\n\nconst StyledContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n`;\n\nconst StyledTreeViewWrapper = styled.div`\n  flex: 1;\n  overflow: auto;\n`;\n\nconst StyledActionsRow = styled.div`\n  display: flex;\n  padding: 0.125rem;\n  position: relative;\n`;\n\nconst StyledAmendCheckbox = styled(Checkbox)`\n  padding-right: 0.625rem;\n`;\n\nconst StyledCommitMessageContainer = styled.div`\n  background: ${({ theme }) =>\n    theme.dark\n      ? \"#2b2b2b\" /*FIXME: should come from color scheme. attributes.TEXT.BACKGROUND*/\n      : \"#fff\"};\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst StyledCommitMessageTextArea = styled.textarea`\n  flex: 1;\n  background: none;\n  padding: 0.25rem 0.375rem;\n  color: ${({ theme }) =>\n    theme.dark\n      ? \"#a9b7c6\" /*FIXME: should come from color scheme. attributes.TEXT.BACKGROUND*/\n      : \"#000\"};\n  font-family: inherit;\n  border: none;\n  resize: none;\n  outline: none;\n`;\n\nconst StyledCommitActionsRow = styled.div`\n  display: flex;\n  gap: 0.3rem;\n  padding: 0.4rem;\n`;\n\nconst StyledChangesSummaryContainer = styled.span`\n  position: absolute;\n  right: 0.5rem;\n  top: 0.25rem;\n  background: ${({ theme }) => theme.color(\"Panel.background\")};\n  z-index: 1;\n`;\n\nconst ChangeViewContext = React.createContext({\n  focusCommitMessage: () => {},\n});\n\nexport const useChangeViewContext = () => useContext(ChangeViewContext);\n\nexport const ChangesViewSplitter = () => {\n  const {\n    state: { anchor },\n  } = useToolWindowState();\n  const editorRef = useRef<{ focus: () => void }>(null);\n  const orientation = getAnchorOrientation(anchor);\n  const [commitMessageSize, setCommitMessageSize] = useRecoilState(\n    commitMessageSizeState(orientation)\n  );\n  // TODO(lib-candidate): ToolWindowAwareSplitter. A wrapper around ThreeViewSplitter which sets orientation based\n  //  on anchor orientation from useToolWindowState.\n  return (\n    <ChangeViewContext.Provider\n      value={{\n        focusCommitMessage: () => {\n          setTimeout(() => {\n            editorRef.current?.focus();\n          });\n        },\n      }}\n    >\n      <ThreeViewSplitter\n        orientation={orientation}\n        innerView={\n          <StyledContainer>\n            <ChangesViewToolbar />\n            <StyledTreeViewWrapper>\n              <ChangeViewTree />\n            </StyledTreeViewWrapper>\n            <CommitActionsRow />\n          </StyledContainer>\n        }\n        innerViewMinSize={50}\n        lastView={<CommitMessageEditorAndButtons editorRef={editorRef} />}\n        lastSize={commitMessageSize}\n        onLastResize={setCommitMessageSize}\n      />\n    </ChangeViewContext.Provider>\n  );\n};\n\nconst ChangesViewChangesSummary = () => {\n  const changes = useRecoilValue(includedChangesState);\n  return <ChangesSummary changes={changes} />;\n};\n\nfunction CommitActionsRow() {\n  const [amend, setAmend] = useRecoilState(amendCommitState);\n\n  return (\n    <StyledActionsRow>\n      <TooltipTrigger\n        tooltip={\n          <ActionHelpTooltip\n            actionName=\"Amend Commit\"\n            helpText=\"Modify the latest commit of the current branch\"\n          />\n        }\n      >\n        {(props) => (\n          <span {...props}>\n            <StyledAmendCheckbox\n              isSelected={amend}\n              onChange={setAmend}\n              preventFocus\n            >\n              Amend\n            </StyledAmendCheckbox>\n          </span>\n        )}\n      </TooltipTrigger>\n      <TooltipTrigger\n        tooltip={<ActionTooltip actionName=\"Show Commit Options\" />}\n      >\n        <ActionButton onPress={() => alert(\"Not implemented\")}>\n          <PlatformIcon icon=\"general/gear.svg\" />\n        </ActionButton>\n      </TooltipTrigger>\n      <TooltipTrigger\n        tooltip={<ActionTooltip actionName=\"Commit Message History\" />}\n      >\n        <ActionButton isDisabled onPress={() => alert(\"Not implemented\")}>\n          <PlatformIcon icon=\"vcs/historyInline.svg\" />\n        </ActionButton>\n      </TooltipTrigger>\n      <StyledChangesSummaryContainer>\n        <ChangesViewChangesSummary />\n      </StyledChangesSummaryContainer>\n    </StyledActionsRow>\n  );\n}\n\nfunction CommitMessageEditorAndButtons({\n  editorRef,\n}: {\n  editorRef: React.RefObject<{ focus: () => void }>;\n}) {\n  const commitMessageTextAreaRef = useRef<HTMLTextAreaElement>(null);\n  const [commitMessage, setCommitMessage] = useRecoilState(commitMessageState);\n\n  const { hasFocus } = useDefaultToolWindowContext();\n\n  useImperativeHandle(\n    editorRef,\n    () => ({\n      focus: () => {\n        commitMessageTextAreaRef.current?.focus();\n      },\n    }),\n    []\n  );\n\n  return (\n    <StyledCommitMessageContainer>\n      <StyledCommitMessageTextArea\n        ref={commitMessageTextAreaRef}\n        value={commitMessage}\n        onChange={(event) => {\n          setCommitMessage(event.target.value);\n        }}\n        placeholder=\"Commit Message\"\n        data-gramm=\"false\"\n      />\n      <StyledCommitActionsRow>\n        <Button\n          preventFocusOnPress\n          variant={hasFocus ? \"default\" : undefined}\n          onPress={() => {}}\n        >\n          Commit\n        </Button>\n        <Button preventFocusOnPress onPress={() => alert(\"Not implemented\")}>\n          Commit and Push...\n        </Button>\n      </StyledCommitActionsRow>\n    </StyledCommitMessageContainer>\n  );\n}\n","import {\n  Item,\n  Menu,\n  MenuItemLayout,\n  PlatformIcon,\n} from \"@intellij-platform/core\";\nimport React from \"react\";\n\nexport const RollbackTreeContextMenu = () => {\n  const disabledKeys = [\"showDiff\"];\n\n  return (\n    <Menu\n      disabledKeys={disabledKeys}\n      aria-label=\"Context menu\"\n      onAction={() => {\n        alert(\"Not implemented\");\n      }}\n    >\n      <Item key=\"showDiff\" textValue=\"Show Diff\">\n        <MenuItemLayout\n          icon={<PlatformIcon icon={\"actions/diff.svg\"} />}\n          content=\"Show Diff\"\n        />\n      </Item>\n    </Menu>\n  );\n};\n","import React, { Key, useState } from \"react\";\nimport { Selection } from \"@react-types/shared\";\nimport { useRecoilState, useRecoilValue, useSetRecoilState } from \"recoil\";\nimport {\n  ActionButton,\n  ActionButtonWithMenu,\n  ActionToolbar,\n  Button,\n  Checkbox,\n  ContextMenuContainer,\n  Item,\n  Menu,\n  ModalWindow,\n  PlatformIcon,\n  Section,\n  SpeedSearchTreeWithCheckboxes,\n  styled,\n  TreeNodeCheckbox,\n  useBalloons,\n  useNestedSelectionState,\n  WindowLayout,\n} from \"@intellij-platform/core\";\nimport {\n  AnyNode,\n  changesTreeNodesState,\n  getNodeKeyForChange,\n  isGroupNode,\n} from \"../ChangesView/ChangesView.state\";\nimport { getChangeListTreeItemProps } from \"../ChangesView/changesTreeNodeRenderers\";\nimport { rollbackViewState } from \"./rollbackView.state\";\nimport { allChangesState, useChangeListManager } from \"../change-lists.state\";\nimport { getExpandAllKeys } from \"../../../TreeUtils/tree-utils\";\nimport { ChangesSummary } from \"../ChangesSummary\";\nimport { groupings } from \"../ChangesView/changesGroupings\";\nimport { RollbackTreeContextMenu } from \"./RollbackTreeContextMenu\";\n\nconst StyledContainer = styled.div`\n  box-sizing: border-box;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  padding: 1rem 0.75rem 0;\n`;\nconst StyledFrame = styled.div`\n  border: 1px solid ${({ theme }) => theme.commonColors.contrastBorder};\n  flex: 1;\n  overflow: auto;\n`;\n\nconst StyledLine = styled.div`\n  line-height: 2;\n  padding-left: 0.5rem;\n`;\n\nexport function RollbackWindow() {\n  const defaultExpandedKeys = useRecoilValue(\n    rollbackViewState.initiallyExpandedKeys\n  );\n  const initiallyIncludedChangeKeys = useRecoilValue(\n    rollbackViewState.initiallyIncludedChanges\n  ).map(getNodeKeyForChange);\n  const { fileCountsMap } = useRecoilValue(changesTreeNodesState);\n  const [windowBounds, setWindowBounds] = useRecoilState(\n    rollbackViewState.windowBounds\n  );\n  const rootNodes = useRecoilValue(rollbackViewState.rootNodes);\n  const [selectedKeys, setSelectedKeys] = useState<Selection>(new Set<Key>());\n  const [expandedKeys, setExpandedKeys] = useState<Set<Key>>(\n    defaultExpandedKeys\n  );\n  const [includedChangeKeys, setIncludedChangeKeys] = useState(\n    new Set<Key>(initiallyIncludedChangeKeys)\n  );\n  const nestedSelection = useNestedSelectionState<AnyNode>(\n    {\n      rootNodes,\n      getKey: (node) => node.key,\n      getChildren: (node) => (isGroupNode(node) ? node.children : null),\n    },\n    {\n      selectedKeys: includedChangeKeys,\n      onSelectedKeysChange: setIncludedChangeKeys,\n    }\n  );\n  const allChanges = useRecoilValue(allChangesState);\n  const includedChanges = allChanges.filter((change) =>\n    includedChangeKeys.has(getNodeKeyForChange(change))\n  );\n  const changeListManager = useChangeListManager();\n  const balloons = useBalloons();\n  const setOpen = useSetRecoilState(rollbackViewState.isOpen);\n  const close = () => setOpen(false);\n  const expandAll = () =>\n    setExpandedKeys(\n      new Set(\n        getExpandAllKeys<AnyNode>(\n          (node) =>\n            node == null ? rootNodes : isGroupNode(node) ? node.children : null,\n          (node) => node.key\n        )\n      )\n    );\n  const collapseAll = () => setExpandedKeys(new Set());\n\n  return (\n    <ModalWindow\n      title=\"Rollback changes\"\n      onClose={close}\n      bounds={windowBounds}\n      onBoundsChange={setWindowBounds}\n      minHeight={200}\n      footer={\n        <>\n          <div\n            style={{\n              padding: \"0 .75rem\",\n              display: \"flex\",\n              flexDirection: \"column\",\n            }}\n          >\n            <StyledLine>\n              <ChangesSummary changes={includedChanges} />\n            </StyledLine>\n            <Checkbox isDisabled>\n              Delete local copies of the added files\n            </Checkbox>\n          </div>\n          <WindowLayout.Footer\n            right={\n              <>\n                <Button onPress={close}>Cancel</Button>\n                <Button\n                  variant=\"default\"\n                  onPress={() => {\n                    changeListManager\n                      .rollback(includedChanges)\n                      .catch((e) => {\n                        balloons.show({\n                          title: \"Reverting changes failed\",\n                          icon: \"Error\",\n                          body:\n                            \"Could not revert selected changes. See console for more info\",\n                        });\n                        console.error(\"Git revert error:\", e);\n                      })\n                      .finally(close);\n                  }}\n                >\n                  Rollback\n                </Button>\n              </>\n            }\n          />\n        </>\n      }\n    >\n      <StyledContainer>\n        <div style={{ display: \"flex\" }}>\n          <ActionToolbar>\n            <ActionButton isDisabled>\n              <PlatformIcon icon=\"actions/diff\" />\n            </ActionButton>\n            <ActionButtonWithMenu\n              renderMenu={({ menuProps }) => (\n                <Menu\n                  {...menuProps}\n                  selectedKeys={[] /* FIXME */}\n                  onAction={(key) => {\n                    // FIXME\n                    alert(\"not implemented\");\n                  }}\n                >\n                  <Section title=\"Group By\">\n                    {\n                      // FIXME\n                      groupings.map((grouping) => (\n                        <Item key={grouping.id}>{grouping.title}</Item>\n                      ))\n                    }\n                  </Section>\n                </Menu>\n              )}\n            >\n              <PlatformIcon icon=\"actions/groupBy.svg\" />\n            </ActionButtonWithMenu>\n          </ActionToolbar>\n          <span style={{ flex: 1 }} />\n          <ActionToolbar>\n            <ActionButton onPress={expandAll}>\n              <PlatformIcon icon=\"actions/expandall\" />\n            </ActionButton>\n            <ActionButton onPress={collapseAll}>\n              <PlatformIcon icon=\"actions/collapseall\" />\n            </ActionButton>\n          </ActionToolbar>\n        </div>\n\n        <StyledFrame>\n          <ContextMenuContainer\n            renderMenu={() => <RollbackTreeContextMenu />}\n            style={{ height: \"100%\" }}\n          >\n            <SpeedSearchTreeWithCheckboxes\n              items={rootNodes}\n              selectionMode=\"multiple\"\n              selectedKeys={selectedKeys}\n              onSelectionChange={setSelectedKeys}\n              expandedKeys={expandedKeys}\n              onExpandedChange={setExpandedKeys}\n              nestedSelection={nestedSelection}\n              disallowEmptySelection\n              fillAvailableSpace\n            >\n              {(node) => {\n                const props = getChangeListTreeItemProps({\n                  node,\n                  fileCountsMap,\n                });\n                return (\n                  <Item {...props}>\n                    {node.children?.length !== 0 && (\n                      <TreeNodeCheckbox\n                        selectionState={nestedSelection.getSelectionState(node)}\n                        onToggle={() => nestedSelection.toggle(node)}\n                      />\n                    )}\n                    {props.children}\n                  </Item>\n                );\n              }}\n            </SpeedSearchTreeWithCheckboxes>\n          </ContextMenuContainer>\n        </StyledFrame>\n      </StyledContainer>\n    </ModalWindow>\n  );\n}\n","import React, { useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport { ChangesViewSplitter } from \"./ChangesViewSplitter\";\nimport { useChangeListManager } from \"../change-lists.state\";\nimport { rollbackViewState } from \"../Rollback/rollbackView.state\";\nimport { RollbackWindow } from \"../Rollback/RollbackWindow\";\nimport { useRecoilValue } from \"recoil\";\n\nconst StyledContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n`;\n\nexport const ChangesViewPane = () => {\n  const { refresh } = useChangeListManager();\n  const isRollbackWindowOpen = useRecoilValue(rollbackViewState.isOpen);\n  useEffect(() => {\n    refresh();\n  }, []);\n  // FIXME: Rollback window should be moved to upper levels. It should not be coupled with the changes view pane UI\n  return (\n    <StyledContainer>\n      <ChangesViewSplitter />\n      {isRollbackWindowOpen && <RollbackWindow />}\n    </StyledContainer>\n  );\n};\n","import React from \"react\";\nimport { indexBy } from \"ramda\";\nimport { ProjectViewPane } from \"../ProjectView/ProjectViewPane\";\nimport { ProjectViewActionButtons } from \"../ProjectView/ProjectViewActionButtons\";\nimport {\n  DefaultToolWindow,\n  MultiViewToolWindow,\n  ToolWindowState,\n  toolWindowState,\n} from \"@intellij-platform/core\";\nimport { Terminal } from \"../Terminal\";\nimport { ChangesViewPane } from \"../VersionControl/Changes/ChangesView/ChangesViewPane\";\nimport { CurrentBranchName } from \"../VersionControl/CurrentBranchName\";\n\ntype ToolWindowDescriptor = {\n  id: string;\n  title: string;\n  icon: string;\n  element: React.ReactElement;\n  initialState: ToolWindowState;\n};\nconst windows: ToolWindowDescriptor[] = [\n  {\n    id: \"project\",\n    title: \"Project\",\n    icon: \"toolwindows/toolWindowProject\",\n    element: (\n      <DefaultToolWindow\n        headerContent=\"Project\"\n        additionalActions={<ProjectViewActionButtons />}\n      >\n        <ProjectViewPane />\n      </DefaultToolWindow>\n    ),\n    initialState: toolWindowState({ isVisible: true, weight: 0.22 }),\n  },\n  {\n    id: \"terminal\",\n    title: \"Terminal\",\n    icon: \"toolwindows/toolWindowProject\",\n    element: (\n      <DefaultToolWindow headerContent=\"Terminal\">\n        <Terminal />\n      </DefaultToolWindow>\n    ),\n    initialState: toolWindowState({ anchor: \"bottom\" }),\n  },\n  {\n    id: \"commit\",\n    title: \"Commit\",\n    icon: \"toolwindows/toolWindowCommit\",\n    element: (\n      <MultiViewToolWindow>\n        <MultiViewToolWindow.View\n          tabContent={\n            <>\n              Commit to <CurrentBranchName />\n            </>\n          }\n          key=\"commit\"\n        >\n          <ChangesViewPane />\n        </MultiViewToolWindow.View>\n      </MultiViewToolWindow>\n    ),\n    initialState: toolWindowState({ anchor: \"left\", isVisible: false }),\n  },\n];\nexport const windowById = indexBy(({ id }) => id, windows);\n","import { atom, useRecoilState } from \"recoil\";\nimport { ToolWindowsState, ViewMode } from \"@intellij-platform/core\";\nimport { filter, map } from \"ramda\";\nimport { windowById } from \"./toolWindows\";\nimport { useRef } from \"react\";\n\nexport const toolWindowsState = atom({\n  key: \"toolWindows\",\n  default: new ToolWindowsState(\n    map(({ initialState }) => initialState, windowById)\n  ),\n});\n\ninterface ToolWindowsManager {\n  toggleHideAll(): void;\n}\n\nexport const useToolWindowsManager = (): ToolWindowsManager => {\n  const [state, setState] = useRecoilState(toolWindowsState);\n  const hideAllIdsToRestore = useRef<string[]>([]);\n\n  const toggleHideAll = (): void => {\n    const viewModes: ViewMode[] = [\n      \"docked_unpinned\",\n      \"docked_pinned\",\n      \"undock\",\n    ];\n    const idsToHide = Object.keys(\n      filter(\n        ({ viewMode, isVisible }) => isVisible && viewModes.includes(viewMode),\n        state.windows\n      )\n    );\n    if (idsToHide.length > 0) {\n      hideAllIdsToRestore.current = idsToHide;\n      setState(\n        state.mapWindows((toolWindow, id) =>\n          idsToHide.includes(id)\n            ? {\n                ...toolWindow,\n                isVisible: false,\n              }\n            : toolWindow\n        )\n      );\n    } else {\n      setState(\n        state.mapWindows((toolWindow, id) =>\n          hideAllIdsToRestore.current.includes(id)\n            ? {\n                ...toolWindow,\n                isVisible: true,\n              }\n            : toolWindow\n        )\n      );\n    }\n  };\n  return {\n    toggleHideAll,\n  };\n};\n","import { Monaco } from \"@monaco-editor/react\";\nimport {\n  ActionTooltip,\n  ContextMenuContainer,\n  EditorTabContent,\n  EditorTabs,\n  Item,\n  Menu,\n  MenuItemLayout,\n  PlatformIcon,\n  styled,\n  TabCloseButton,\n  TabItem,\n  TooltipTrigger,\n  useLatest,\n} from \"@intellij-platform/core\";\nimport { editor, languages } from \"monaco-editor\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport {\n  useRecoilValue,\n  useRecoilValueLoadable,\n  useSetRecoilState,\n} from \"recoil\";\nimport { getIconForFile } from \"../file-utils\";\nimport { LoadingGif } from \"../LoadingGif\";\nimport { Editor } from \"./Editor\";\nimport {\n  activeEditorTabState,\n  editorCursorPositionState,\n  editorRefState,\n  useEditorStateManager,\n} from \"./editor.state\";\nimport { fileContent } from \"../fs/fs.state\";\nimport { useUpdateFileStatus } from \"../VersionControl/file-status.state\";\nimport * as path from \"path\";\nimport { FileStatusColor } from \"../VersionControl/FileStatusColor\";\nimport { useToolWindowsManager } from \"../Project/toolWindows.state\";\n\n/**\n * Used as main content in the main ToolWindows. Shows currently opened files tabs and the editor.\n *\n * TODO: preserve editor state when switching between tabs\n * TODO: support multiple editors in split view.\n */\nexport const FileEditor = () => {\n  const editorStateManager = useEditorStateManager();\n  const toolWindowsManager = useToolWindowsManager();\n  const activeTab = useRecoilValue(activeEditorTabState);\n  const editorRef = useRef<editor.IEditor>();\n  const [active, setActive] = useState(false);\n  const setCursorPositionState = useSetRecoilState(editorCursorPositionState);\n\n  // For functions that are needed in tab action callbacks. Because items are cached and referencing anything\n  // other than the collection item (tab) itself has a risk of working with stale data because of the caching\n  // More info: https://react-spectrum.adobe.com/react-stately/collections.html#why-not-array-map\n  // We can alternatively switch to mapping over tabs array, instead of using the Collection's dynamic api (items),\n  // which is subject to this caching.\n  const tabActionsRef = useLatest({\n    closePath: editorStateManager.closePath,\n    closeOthersTabs: editorStateManager.closeOthersTabs,\n  });\n  const toolWindowsManagerRef = useLatest(toolWindowsManager);\n\n  const setEditorRef = useSetRecoilState(editorRefState);\n\n  const fileContentState = fileContent(activeTab?.filePath);\n  const contentLoadable = useRecoilValueLoadable(fileContentState);\n  const setContent = useSetRecoilState(fileContentState);\n  const updateFileStatus = useUpdateFileStatus();\n\n  const updateContent = (newContent: string = \"\") => {\n    setActive(false);\n    setContent(newContent);\n    updateFileStatus(activeTab.filePath).catch((e) => {\n      console.error(\"Could not update file status\", e);\n    });\n  };\n\n  // For now, when the first tab content is changed, we focus the editor.\n  // FIXME when action system is implemented and there is an action like \"open project file\".\n  // Note that it's event currently buggy\n  useEffect(() => {\n    editorRef.current?.focus();\n    if (activeTab?.editorState.cursorPos) {\n      editorRef.current?.setPosition(activeTab?.editorState.cursorPos);\n    }\n  }, [activeTab?.filePath]);\n\n  const content = contentLoadable.valueMaybe();\n\n  return (\n    <StyledFileEditorContainer\n      onFocus={() => {\n        setActive(true);\n        setEditorRef({\n          focus: () => editorRef.current?.focus(),\n        });\n      }}\n    >\n      {editorStateManager.tabs.length > 0 && (\n        <ContextMenuContainer\n          renderMenu={() => (\n            <Menu\n              onAction={() => {\n                // TODO: detect which tab was triggering context menu and handle the action accordingly\n                //  One idea is to use use the data-key attribute, from the closes parent that has one. Maybe a\n                //  CollectionContextMenuContainer component which implements that, while ContextMenuContainer is\n                //  modified to pass the MouseEvent object, in renderMenu.\n                alert(\"not implemented!\");\n              }}\n            >\n              <Item key=\"close\">Close</Item>\n              <Item key=\"closeOthers\">Close Other tabs</Item>\n              <Item key=\"closeAll\">Close all tabs</Item>\n              <Item key=\"closeLeft\">Close tabs to the left</Item>\n              <Item key=\"closeRight\">Close tabs to the right</Item>\n            </Menu>\n          )}\n        >\n          <EditorTabs\n            items={editorStateManager.tabs}\n            active={active}\n            selectedKey={activeTab?.filePath}\n            onSelectionChange={(key) =>\n              editorStateManager.select(\n                editorStateManager.tabs.findIndex((tab) => tab.filePath === key)\n              )\n            }\n            noBorders\n          >\n            {(tab) => {\n              const filename = path.basename(tab.filePath);\n              const icon = <PlatformIcon icon={getIconForFile(tab.filePath)} />;\n              return (\n                <TabItem\n                  key={tab.filePath}\n                  textValue={filename}\n                  inOverflowMenu={\n                    <MenuItemLayout content={filename} icon={icon} />\n                  }\n                >\n                  <TooltipTrigger\n                    tooltip={<ActionTooltip actionName={tab.filePath} />}\n                  >\n                    <EditorTabContent\n                      icon={icon}\n                      title={\n                        <FileStatusColor filepath={tab.filePath}>\n                          {filename}\n                        </FileStatusColor>\n                      }\n                      closeButton={\n                        <TooltipTrigger\n                          tooltip={\n                            <ActionTooltip actionName=\"Close. Alt-Click to Close Others\" />\n                          }\n                        >\n                          <TabCloseButton\n                            onPress={(e) => {\n                              if (e.altKey) {\n                                tabActionsRef.current.closeOthersTabs(\n                                  editorStateManager.tabs.indexOf(tab)\n                                );\n                              } else {\n                                tabActionsRef.current.closePath(tab.filePath);\n                              }\n                            }}\n                          />\n                        </TooltipTrigger>\n                      }\n                      containerProps={{\n                        onDoubleClick: () => {\n                          toolWindowsManagerRef.current.toggleHideAll();\n                        },\n                      }}\n                    />\n                  </TooltipTrigger>\n                </TabItem>\n              );\n            }}\n          </EditorTabs>\n        </ContextMenuContainer>\n      )}\n      {activeTab &&\n        (typeof content === \"string\" ? (\n          <Editor\n            height=\"100%\"\n            path={activeTab.filePath}\n            onMount={(monacoEditor, monaco) => {\n              monacoEditor.focus();\n              enableJsx(monaco);\n              editorRef.current = monacoEditor;\n              monacoEditor.onDidChangeCursorPosition((e) => {\n                setCursorPositionState(e.position);\n              });\n              monacoEditor.onDidChangeModel(() => {\n                const position = editorRef.current?.getPosition();\n                if (position) {\n                  setCursorPositionState(position);\n                }\n              });\n            }}\n            onChange={updateContent}\n            value={content}\n          />\n        ) : (\n          content && \"UNSUPPORTED CONTENT\"\n        ))}\n      {contentLoadable.state === \"loading\" && <FileEditorLoading />}\n    </StyledFileEditorContainer>\n  );\n};\n\nconst StyledFileEditorContainer = styled.div`\n  position: relative;\n  height: 100%;\n  background: ${({ theme }) =>\n    theme.color(\n      \"Editor.background\",\n      theme.isUnderDarcula()\n        ? \"rgb(40,40,40)\"\n        : theme.commonColors.panelBackground // FIXME: ColorUtil.darker(theme.commonColors.panelBackground, 3)\n    )};\n`;\n\nconst FileEditorLoading = styled(LoadingGif)`\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n`;\n\nfunction enableJsx(monaco: Monaco) {\n  monaco.languages.typescript.typescriptDefaults.setCompilerOptions({\n    jsx: languages.typescript.JsxEmit.React,\n  });\n\n  monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({\n    noSemanticValidation: false,\n    noSyntaxValidation: false,\n  });\n}\n","import { atom, useSetRecoilState } from \"recoil\";\nimport { BalloonActionLink, useBalloons } from \"@intellij-platform/core\";\nimport React, { useEffect } from \"react\";\n// @ts-expect-error caf doesn't have typing :/\nimport { CAF } from \"caf\";\nimport { persistentFsPreference, switchToPersistentFS } from \"./fs/fs\";\nimport path from \"path\";\n\nexport interface ProcessState {\n  state:\n    | \"STARTED\"\n    | \"PAUSED\"\n    | \"PAUSING\"\n    | \"CANCELED\"\n    | \"CANCELING\"\n    | \"FINISHED\";\n  /**\n   * between 1 and 100\n   */\n  progress: number;\n  isIndeterminate: boolean;\n  name: string;\n  details: string;\n  onCancel?: () => void;\n  onPause?: () => void;\n}\n\nexport const switchToPersistentFsProcess = atom<ProcessState | null>({\n  key: \"switchToPersistentFsProcess\",\n  default: null,\n});\n\nexport function usePersistenceFsNotification() {\n  const balloons = useBalloons();\n  const setProcessState = useSetRecoilState(switchToPersistentFsProcess);\n\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      if (persistentFsPreference.get() == undefined) {\n        balloons.showSticky({\n          title: \"Switch to IndexedDB filesystem\",\n          body:\n            \"By default an in-memory filesystem is used to have a faster git clone. But it means all changes will be lost upon refresh. You can switch in the background to a persistence fs implementation which uses IndexedDB to store files.\",\n          actions: (\n            <>\n              <BalloonActionLink\n                onPress={() => {\n                  const token = new CAF.cancelToken();\n                  setProcessState({\n                    details: \"Copying ...\",\n                    isIndeterminate: true,\n                    state: \"STARTED\",\n                    progress: 0,\n                    onCancel: () => {\n                      token.abort(\"canceled\");\n                    },\n                    name: \"Switching to IndexedDB FS\",\n                  });\n                  const update = (updates: Partial<ProcessState>) =>\n                    setProcessState((state) =>\n                      state ? { ...state, ...updates } : null\n                    );\n                  switchToPersistentFS({\n                    cancelSignal: token.signal,\n                    onCopy: (filepath) => {\n                      update({ name: `Copying ${path.dirname(filepath)}` });\n                    },\n                  })\n                    .then(() => {\n                      persistentFsPreference.set(\"yes\");\n                    })\n                    .catch((e) => {\n                      if (e !== \"canceled\") {\n                        console.error(\n                          \"Error during switch to persistent FS:\",\n                          e\n                        );\n                      }\n                    })\n                    .finally(() => {\n                      setProcessState(null);\n                    });\n                }}\n              >\n                Switch to IndexedDB FS\n              </BalloonActionLink>\n              <BalloonActionLink\n                onPress={() => persistentFsPreference.set(\"no\")}\n              >\n                Don't ask again\n              </BalloonActionLink>\n            </>\n          ),\n        });\n      }\n    }, 3000);\n    return () => clearTimeout(timeoutId);\n  }, []);\n}\n","import {\n  Divider,\n  Item,\n  Menu,\n  MenuItemLayout,\n  MenuTrigger,\n  PlatformIcon,\n  ProgressBar,\n  ProgressBarPauseButton,\n  ProgressBarStopButton,\n  StatusBar,\n  StatusBarWidget,\n} from \"@intellij-platform/core\";\nimport React from \"react\";\nimport styled from \"styled-components\";\nimport { useRecoilValue } from \"recoil\";\nimport { editorCursorPositionState } from \"../Editor/editor.state\";\nimport { currentBranchState } from \"../VersionControl/Changes/ChangesView/ChangesView.state\";\nimport { switchToPersistentFsProcess } from \"../usePersistenceFsNotification\";\n\nconst StyledLastMessage = styled.div`\n  margin-left: 0.75rem;\n  cursor: pointer;\n`;\n\nconst StatusBarProcess = () => {\n  const process = useRecoilValue(switchToPersistentFsProcess);\n\n  return (\n    process && (\n      <ProgressBar\n        name={process.name}\n        isIndeterminate={process.isIndeterminate}\n        value={process.progress}\n        dense\n        namePosition=\"side\"\n        width={146}\n        button={\n          <>\n            {process.onPause && (\n              <ProgressBarPauseButton\n                small\n                paused={false}\n                onPausedChange={() => {}}\n              />\n            )}\n            {process.onCancel && (\n              <ProgressBarStopButton small onPress={process.onCancel} />\n            )}\n          </>\n        }\n      />\n    )\n  );\n};\n\nexport const IdeStatusBar = () => {\n  const cursorPosition = useRecoilValue(editorCursorPositionState);\n  const currentBranch = useRecoilValue(currentBranchState(\"\" /*FIXME*/));\n\n  return (\n    <StatusBar\n      left={\n        <>\n          <PlatformIcon\n            icon=\"general/tbHidden.svg\"\n            role=\"button\"\n            onClick={() => alert(\"Not implemented\")}\n          />\n          <StyledLastMessage>\n            Tooltip content or last message will show up here.\n          </StyledLastMessage>\n        </>\n      }\n      right={\n        <>\n          {<StatusBarProcess />}\n          <StatusBarWidget\n            onPress={() => alert(\"Not implemented\")}\n            label=\"LF\"\n          />\n          <StatusBarWidget\n            onPress={() => alert(\"Not implemented\")}\n            label={`${cursorPosition.lineNumber},${cursorPosition.column}`}\n          />\n          <StatusBarWidget label=\"UTF-8\" />\n          <MenuTrigger\n            renderMenu={({ menuProps }) => (\n              <Menu\n                {...menuProps}\n                onAction={() => {\n                  alert(\"Not implemented\");\n                }}\n              >\n                <Item>Configure Indents for Typescript</Item>\n                <Item>Disable Indents Detection for Project</Item>\n              </Menu>\n            )}\n          >\n            {(props, ref) => (\n              <StatusBarWidget {...props} ref={ref} label=\"2 spaces\" />\n            )}\n          </MenuTrigger>\n          <MenuTrigger\n            renderMenu={({ menuProps }) => (\n              <Menu\n                {...menuProps}\n                onAction={() => {\n                  alert(\"Not implemented\");\n                }}\n              >\n                <Item title=\"Compile\">\n                  <Item>packages/jui/tsconfig.json</Item>\n                  <Item>packages/jui/src/StatusBar/StatusBar.stories.tsx</Item>\n                  <Item>Compile All</Item>\n                </Item>\n                <Divider />\n                <Item>\n                  <MenuItemLayout\n                    icon={\n                      <PlatformIcon icon=\"javaee/updateRunningApplication.svg\" />\n                    }\n                    content=\"Restart Typescript Service\"\n                  />\n                </Item>\n                <Item>\n                  <MenuItemLayout\n                    icon={<PlatformIcon icon=\"general/settings.svg\" />}\n                    content=\"Configure Typescript...\"\n                  />\n                </Item>\n              </Menu>\n            )}\n          >\n            {(props, ref) => (\n              <StatusBarWidget {...props} ref={ref} label=\"TypeScript 4.4.3\" />\n            )}\n          </MenuTrigger>\n          <StatusBarWidget\n            icon={<PlatformIcon icon=\"vcs/branch.svg\" />}\n            label={currentBranch}\n          />\n          <StatusBarWidget icon={<PlatformIcon icon=\"ide/readwrite.svg\" />} />\n          <StatusBarWidget icon={<PlatformIcon icon=\"ide/fatalError.svg\" />} />\n        </>\n      }\n    />\n  );\n};\n","import {\n  ActionTooltip,\n  PlatformIcon,\n  TooltipTrigger,\n  ToolWindows,\n} from \"@intellij-platform/core\";\nimport React from \"react\";\nimport { FileEditor } from \"../Editor/FileEditor\";\nimport { useInitializeVcs } from \"../VersionControl/file-status.state\";\nimport { windowById } from \"./toolWindows\";\nimport { useRecoilState } from \"recoil\";\nimport { toolWindowsState } from \"./toolWindows.state\";\nimport { useInitializeChanges } from \"../VersionControl/Changes/change-lists.state\";\nimport styled from \"styled-components\";\nimport { IdeStatusBar } from \"../StatusBar/IdeStatusBar\";\nimport { usePersistenceFsNotification } from \"../usePersistenceFsNotification\";\n\nconst StyledWindowFrame = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  min-height: 0;\n`;\n\nexport const Project = () => {\n  const [state, setState] = useRecoilState(toolWindowsState);\n\n  useInitializeVcs();\n  useInitializeChanges();\n  usePersistenceFsNotification();\n\n  return (\n    <StyledWindowFrame>\n      <ToolWindows\n        toolWindowsState={state}\n        onToolWindowStateChange={setState}\n        renderToolbarButton={(id) => (\n          <TooltipTrigger\n            tooltip={<ActionTooltip actionName={windowById[id].title} />}\n          >\n            <span>\n              <PlatformIcon icon={windowById[id].icon} />\n              &nbsp;\n              {windowById[id].title}\n            </span>\n          </TooltipTrigger>\n        )}\n        renderWindow={(id) => windowById[id].element}\n      >\n        <FileEditor />\n      </ToolWindows>\n      <IdeStatusBar />\n    </StyledWindowFrame>\n  );\n};\n","import React, { useEffect, useState } from \"react\";\nimport { sampleRepo } from \"./Project/project.state\";\nimport { fs } from \"./fs/fs\";\nimport { clone } from \"isomorphic-git\";\nimport http from \"isomorphic-git/http/web\";\nimport styled from \"styled-components\";\nimport { WINDOW_SHADOW } from \"@intellij-platform/core\";\n\nconst StyledDialog = styled.div`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  background: ${({ theme }) => theme.color(\"*.background\")};\n  color: ${({ theme }) => theme.color(\"*.foreground\")};\n  ${WINDOW_SHADOW};\n  text-align: center;\n  line-height: 1.5;\n`;\nconst StyledDialogHeader = styled.div`\n  background: ${({ theme }) => theme.color(\"Popup.Header.activeBackground\")};\n  padding: 4px;\n  text-align: center;\n`;\nconst StyledDialogContent = styled.div`\n  padding: 8px 16px;\n`;\n\nasync function isSuccessfullyCloned(dir: string) {\n  try {\n    const stats = await fs.promises.stat(dir);\n    if (!stats.isDirectory()) {\n      console.info(\n        `Already cloned repo was not found. \"${dir}\" is not a directory.`\n      );\n      return false;\n    }\n    const files = await fs.promises.readdir(dir);\n    if (files.length === 1 && files[0] === \".git\") {\n      console.info(\n        `Already cloned repo was not found at \"${dir}\". \".git\" folder exists, but it's not successfully unpacked.`\n      );\n      return false;\n    }\n  } catch (e) {\n    console.info(`Already cloned repo was not found at \"${dir}\".`);\n    return false;\n  }\n  return true;\n}\n\nexport const SampleRepoInitializer: React.FC = ({ children }) => {\n  const [state, setState] = useState<\n    \"error\" | \"cloning\" | \"uninitialized\" | \"initialized\"\n  >(\"uninitialized\");\n  useEffect(() => {\n    async function init(dir: string, repoUrl: string) {\n      if (!(await isSuccessfullyCloned(dir))) {\n        setState(\"cloning\");\n        await cloneRepo(dir, repoUrl);\n      }\n    }\n\n    init(sampleRepo.path, sampleRepo.url)\n      .then(() => {\n        console.log(\"demo repo initialized\");\n        setState(\"initialized\");\n      })\n      .catch((e) => {\n        console.error(\"could not initialize the demo repo\", e);\n        setState(\"error\");\n      });\n  }, []);\n\n  if (state === \"uninitialized\") {\n    return null;\n  }\n  if (state === \"initialized\") {\n    return <>{children}</>;\n  }\n  return (\n    <div style={{ minHeight: \"100vh\", position: \"relative\" }}>\n      <StyledDialog>\n        <StyledDialogHeader>Cloning sample repo</StyledDialogHeader>\n        <StyledDialogContent>\n          {state === \"cloning\" ? (\n            <>\n              Cloning <b>{sampleRepo.url}</b>. <br />\n              It may take several seconds.\n            </>\n          ) : (\n            <>Something went wrong!</>\n          )}\n        </StyledDialogContent>\n      </StyledDialog>\n    </div>\n  );\n};\n\nasync function cloneRepo(dir: string, repoUrl: string) {\n  console.log(\"cloning repo: \");\n  await clone({\n    fs,\n    url: repoUrl,\n    http,\n    corsProxy: \"https://cors.isomorphic-git.org\",\n    dir,\n    singleBranch: true,\n  });\n}\n","import React from \"react\";\nimport { RecoilRoot } from \"recoil\";\nimport { DefaultSuspense } from \"./DefaultSuspense\";\nimport { Project } from \"./Project/Project\";\nimport { SampleRepoInitializer } from \"./SampleRepoInitializer\";\nimport { BalloonsProvider } from \"@intellij-platform/core\";\nimport { WaitForFs } from \"./fs/fs\";\n\n/**\n * Example app root component. It expects ThemeProvider to be provided based on where it's rendered.\n */\nexport const App = () => {\n  return (\n    // TODO: add an error boundary\n    <DefaultSuspense>\n      <WaitForFs>\n        <SampleRepoInitializer>\n          <RecoilRoot>\n            <BalloonsProvider disablePortal>\n              {/* disablePortal to make example app more portable*/}\n              <Project />\n            </BalloonsProvider>\n          </RecoilRoot>\n        </SampleRepoInitializer>\n      </WaitForFs>\n    </DefaultSuspense>\n  );\n};\n\nexport default App;\n"],"names":["LoadingGif","props","Img","src","darkSrc","Loading","styled","DefaultSuspense","fallback","children","FILE_ICON","DIR_ICON","extensionIconMap","editorconfig","js","gitignore","archive","as","config","css","dtd","hpr","htaccess","html","idl","java","jfr","json","jsp","jspx","manifest","properties","txt","wsdl","xhtml","xml","xsd","yaml","getIconForFile","filepath","extension","getExtension","split","pop","getParentPaths","upperLimit","path","getParentPathsRecursive","previousPaths","dirname","concat","darculaColorSchemeTokenRules","vsCodeTheme","scope","settings","flatMap","map","token","values","Object","keys","forEach","key","value","StyledEditor","MonacoEditor","Editor","editorTheme","monaco","useMonaco","theme","useTheme","themeName","setThemeName","useState","dark","useLayoutEffect","name","replace","editor","defineTheme","base","inherit","colors","rules","useEditorTheme","options","minimap","enabled","lineHeight","showFoldingControls","renderIndentGuides","scrollbar","verticalScrollbarSize","verticalSliderSize","async","createIndexedDBFS","storeName","idbfs","createFsBackend","cb","BrowserFS","Promise","resolve","init","store","initializeFS","fsBackend","fsm","promises","pify","window","createFs","backend","fs","initialize","fn","reject","err","copyFsRecursively","CAF","cancelSignal","params","source","target","rootDir","onCopy","force","items","readdir","fullPath","stat","isFile","isSymbolicLink","fileExists","content","readFile","ensureDir","writeFile","isDirectory","console","warn","exists","catch","e","dirPath","code","mkdir","Error","persistentFsPreference","get","localStorage","getItem","set","setItem","switchToPersistentFS","log","getRootFS","time","indexedDbFsBackend","rest","copyFs","timeEnd","fsResource","promise","response","status","suspender","then","res","read","wrapPromise","createInMemoryFS","theFs","WaitForFs","dirContentState","selectorFamily","fileNames","all","fileName","filePath","type","size","fetchFileContent","encoding","fileContent","atomFamily","default","effects","onSet","error","filterPath","includes","sampleRepo","url","currentProjectState","atom","projectFilePath","projectRelativePath","currentProjectFilesState","selector","project","files","addItem","item","childItems","push","temporaryTabsDefaultValue","sortWith","descend","file","endsWith","filter","slice","editorState","cursorPos","lineNumber","column","editorTabsState","activeEditorTabIndexState","activeEditorTabState","editorCursorPositionState","Position","editorRefState","useEditorStateManager","tabsState","setTabsState","useRecoilState","setActiveTabIndex","useSetRecoilState","focus","useRecoilCallback","snapshot","getLoadable","valueOrThrow","select","index","closeTab","_","tabIndex","tabs","openPath","shouldFocus","findIndex","tab","newIndex","length","currentState","closePath","Math","max","closeOthersTabs","convertGitStatus","Array","isArray","vcsRootsState","dir","vcs","VcsRootForFile","find","root","startsWith","fileStatusState","useUpdateFileStatus","repoRoot","getPromise","fileStatus","useInitializeVcs","updateVcsFileStatuses","transact_UNSTABLE","vcsDirectoryMappings","rows","statusMatrix","row","useEffect","useStatusColor","FileStatusColor","color","useRecoilValue","useFileStatusColor","style","StatusColor","foldersOnTopState","expandedKeysState","Set","selectedKeysState","projectViewTreeRefState","dangerouslyAllowMutability","currentProjectTreeState","rootItems","mapItem","parent","node","dirNode","createProjectTree","expandToPathCallback","expandedKeys","keysToExpand","selectKeyAndFocusCallback","treeRef","current","replaceSelection","ProjectViewPane","useRef","setProjectViewTreeRef","projectTree","setExpandedKeys","selectedKeys","setSelectedKeys","sortItems","sortBy","a","identity","SpeedSearchTree","ref","onAction","fillAvailableSpace","disallowEmptySelection","selectionMode","onSelectionChange","onExpandedChange","Item","textValue","undefined","ItemLayout","ProjectViewNodeIcon","HighlightedTextValue","FileTreeNodeText","FileTreeDirNodeText","FileTreeFileNodeText","state","useContext","ItemStateContext","isSelected","isFocused","nodeTypeIconMap","icon","PlatformIcon","getExpandAllKeys","getChildren","getKey","roots","processItem","flat","dfsVisit","visit","nodes","dfs","ProjectViewActionButtons","activeTab","expandToOpenedFile","selectKeyAndFocus","TooltipTrigger","tooltip","ActionTooltip","actionName","ActionButton","onPress","isDisabled","StyledXterm","XTerm","Terminal","input","setInput","xtermRef","useMemo","background","selection","fontFamily","letterSpacing","fontSize","cursorStyle","cursorBlink","cursorWidth","rendererType","setTimeout","terminal","resize","write","onData","data","charCodeAt","changeListsState","id","comment","changes","active","allChangesState","changeList","changeLists","isAChange","head","workingDir","stage","refreshChanges","gitRoots","pathname","theRest","workdir","after","isDir","before","useRollbackChanges","updateFileStatus","callbackInterface","reloadFileFromDisk","reloadFileFromDiskCallback","changesWithRepoRoots","change","relativePath","groupedChanges","groupBy","entries","checkout","filepaths","resetIndex","useChangeListManager","addChangeList","editChangeList","edits","mergeChangeLists","sourceId","targetId","moveChange","toChangeListId","removeChangeList","setActiveChangeList","refresh","rollback","groupings","title","isAvailable","groupFn","repository","repositoryNode","constSelector","pathToNodeCache","rootDirNodes","reduce","prevNode","directoryNode","parentNodePath","collapseDirectories","isDirectoryNode","child","uniq","isOpen","windowBounds","getDefaultBounds","initiallyIncludedChanges","rootNodes","selectedChanges","changesTreeNodesState","some","rollbackViewState","initiallyExpandedKeys","includedChanges","isGroupNode","childValues","isExpanded","childValue","getNodeKeyForChange","currentBranchState","showIgnoredFilesState","showRelatedFilesState","changesGroupingState","changesUnderSelectedKeys","byKey","allChanges","processNode","includedChangeKeysState","includedChangesState","includedChangeKeys","has","includedChangesNestedSelection","getCallback","setValue","NestedSelection","createSetInterface","availableGroupingsState","grouping","isRecoilValue","isActive","changeBrowserNodeKey","changeListNode","i","changeNode","isChangeNode","recursiveGrouping","groupingFns","nextGroupingFns","changeNodes","groupNodes","groups","groupNode","groupFns","groupChanges","fileCountsMap","Map","childrenFileCount","fileCount","total","count","commitMessageSizeState","orientation","amendCommitState","commitMessageState","openRollbackWindowForSelectionCallback","changesUnderSelection","getValue","ChangesViewTreeContextMenu","setIncludedChangeKeys","disabledKeys","focusCommitMessage","useChangeViewContext","editorStateManager","openRollbackWindowForSelection","Menu","arr","MenuItemLayout","StyledRepoColorSquare","useRepoRootColor","rootPath","commonColors","red","blue","RepoColorIcon","backgroundColor","StyledCurrentBranchTag","SelectionAwareSpan","Color","withTransparency","toString","CurrentBranchName","repo","branch","fileCountMsg","IntlMessageFormat","ChangeNodeHint","isGroupedByDirectory","nodeRenderers","rendered","format","directory","changelist","fontWeight","getChangeListTreeItemProps","nodeRenderer","dirCount","hasChildItems","ChangeViewTree","nestedSelection","ContextMenuContainer","renderMenu","height","SpeedSearchTreeWithCheckboxes","TreeNodeCheckbox","selectionState","getSelectionState","onToggle","toggle","ChangeListsActionButton","ActionButtonWithMenu","menuProps","alert","GroupByActionButton","availableGroupings","toggleGroup","ViewOptionsActionButton","showRelatedFiles","setShowRelatedFiles","showIgnoredFiles","setShowIgnoredFiles","viewOptions","ChangesViewToolbar","openRollbackWindow","expandAll","valueMaybe","ActionToolbar","hasBorder","ChangesSummary","modifiedCount","addedCount","deletedCount","StyledContainer","StyledTreeViewWrapper","StyledActionsRow","StyledAmendCheckbox","Checkbox","StyledCommitMessageContainer","StyledCommitMessageTextArea","StyledCommitActionsRow","StyledChangesSummaryContainer","ChangeViewContext","React","ChangesViewSplitter","anchor","useToolWindowState","editorRef","getAnchorOrientation","commitMessageSize","setCommitMessageSize","Provider","ThreeViewSplitter","innerView","CommitActionsRow","innerViewMinSize","lastView","CommitMessageEditorAndButtons","lastSize","onLastResize","ChangesViewChangesSummary","amend","setAmend","ActionHelpTooltip","helpText","onChange","preventFocus","commitMessageTextAreaRef","commitMessage","setCommitMessage","hasFocus","useDefaultToolWindowContext","useImperativeHandle","event","placeholder","Button","preventFocusOnPress","variant","RollbackTreeContextMenu","StyledFrame","contrastBorder","StyledLine","RollbackWindow","defaultExpandedKeys","initiallyIncludedChangeKeys","setWindowBounds","useNestedSelectionState","onSelectedKeysChange","changeListManager","balloons","useBalloons","setOpen","close","ModalWindow","onClose","bounds","onBoundsChange","minHeight","footer","padding","display","flexDirection","WindowLayout","right","show","body","finally","flex","ChangesViewPane","isRollbackWindowOpen","windows","element","DefaultToolWindow","headerContent","additionalActions","initialState","toolWindowState","isVisible","weight","MultiViewToolWindow","tabContent","windowById","indexBy","toolWindowsState","ToolWindowsState","FileEditor","toolWindowsManager","setState","hideAllIdsToRestore","toggleHideAll","viewModes","idsToHide","viewMode","mapWindows","toolWindow","useToolWindowsManager","setActive","setCursorPositionState","tabActionsRef","useLatest","toolWindowsManagerRef","setEditorRef","fileContentState","contentLoadable","useRecoilValueLoadable","setContent","setPosition","StyledFileEditorContainer","onFocus","EditorTabs","selectedKey","noBorders","filename","TabItem","inOverflowMenu","EditorTabContent","closeButton","TabCloseButton","altKey","indexOf","containerProps","onDoubleClick","onMount","monacoEditor","languages","typescript","typescriptDefaults","setCompilerOptions","jsx","setDiagnosticsOptions","noSemanticValidation","noSyntaxValidation","enableJsx","onDidChangeCursorPosition","position","onDidChangeModel","getPosition","newContent","FileEditorLoading","isUnderDarcula","panelBackground","switchToPersistentFsProcess","usePersistenceFsNotification","setProcessState","timeoutId","showSticky","actions","Balloon","details","isIndeterminate","progress","onCancel","abort","signal","updates","clearTimeout","StyledLastMessage","StatusBarProcess","process","ProgressBar","dense","namePosition","width","button","onPause","ProgressBarPauseButton","P","small","paused","onPausedChange","ProgressBarStopButton","IdeStatusBar","cursorPosition","currentBranch","StatusBar","left","role","onClick","StatusBarWidget","label","MenuTrigger","Divider","StyledWindowFrame","Project","useInitializeChanges","ToolWindows","onToolWindowStateChange","renderToolbarButton","renderWindow","StyledDialog","WINDOW_SHADOW","StyledDialogHeader","StyledDialogContent","SampleRepoInitializer","repoUrl","info","isSuccessfullyCloned","clone","http","corsProxy","singleBranch","cloneRepo","App","BalloonsProvider","disablePortal"],"sourceRoot":""}